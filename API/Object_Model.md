# AddByCoord

## Syntax

SapObject.SapModel.AreaObj.AddByCoord

## VB6 Procedure

Function AddByCoord(ByVal NumberPoints As long, ByRef x() As Double, ByRef y() As
Double, ByRef z() As Double, ByRef Name As String, Optional ByVal PropName As String =
"Default", Optional ByVal UserName As String = "", Optional ByVal CSys As String = "Global")
As Long

## Parameters

NumberPoints

The number of points in the area abject.

x, y, z

These are arrays of x, y and z coordinates, respectively, for the corner points of the area object.
The coordinates are in the coordinate system defined by the CSys item. The coordinates should be
ordered to run clockwise or counter clockwise around the area object.

Name

This is the name that the program ultimately assigns to the area object. If no UserName is
specified, the program assigns a default name to the area object. If a UserName is specified and
that name is not used for another area object, the UserName is assigned to the area object;
otherwise a default name is assigned to the area object.

PropName

This is Default, None or the name of a defined area property.

If it is Default, the program assigns a default area property to the area object. If it is None, no area
property is assigned to the area object. If it is the name of a defined area property, that property is
assigned to the area object.

UserName

This is an optional user specified name for the area object. If a UserName is specified and that
name is already used for another area object, the program ignores the UserName.

CSys

The name of the coordinate system in which the area object point coordinates are defined.


## Remarks

This function adds a new area object, defining points at the specified coordinates.

The function returns zero if the area object is successfully added, otherwise it returns a nonzero
value.

## VBA Example

Sub AddAreaObjByCoord()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim x() As Double
Dim y() As Double
Dim z() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewBlank

'add area object by coordinates
ReDim x(5)
ReDim y(5)
ReDim z(5)
x(0) = 50: y(0) = 0
x(1) = 100: y(1) = 0
x(2) = 150: y(2) = 40
x(3) = 100: y(3) = 80
x(4) = 50: y(4) = 80
x(5) = 0: y(5) = 40
ret = SapModel.AreaObj.AddByCoord(6, x, y, z, Name)

'refresh view
ret = SapModel.View.RefreshView(0, False)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByPoint

# AddByPoint

## Syntax

SapObject.SapModel.AreaObj.AddByPoint

## VB6 Procedure

Function AddByPoint(ByVal NumberPoints as Long, ByRef Point() as String, ByRef Name As
String, Optional ByVal PropName As String = "Default", Optional ByVal UserName As String =
"") As Long

## Parameters

NumberPoints

The number of points in the area abject.

Point

This is an array containing the names of the point objects that define the added area object. The
point object names should be ordered to run clockwise or counter clockwise around the area
object.

Name

This is the name that the program ultimately assigns for the area object. If no UserName is
specified, the program assigns a default name to the area object. If a UserName is specified and
that name is not used for another area object, the UserName is assigned to the area object;
otherwise a default name is assigned to the area object.

PropName

This is Default, None or the name of a defined area property.

If it is Default, the program assigns a default area property to the area object. If it is None, no area
property is assigned to the area object. If it is the name of a defined area property, that property is
assigned to the area object.


UserName

This is an optional user specified name for the area object. If a UserName is specified and that
name is already used for another area object, the program ignores the UserName.

## Remarks

This function adds a new area object whose defining points are specified by name.

The function returns zero if the area object is successfully added; otherwise it returns a nonzero
value.

## VBA Example

Sub AddAreaObjByPoint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Point() As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add area object by points
Redim Point(3)
Point(0) = "1"
Point(1) = "4"
Point(2) = "5"
Point(3) = "2"
ret = SapModel.AreaObj.AddByPoint(4, Point, Name)

'refresh view
ret = SapModel.View.RefreshView(0, False)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

# ChangeName

## Syntax

SapObject.SapModel.AreaObj.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined area object.

NewName

The new name for the area object.

## Remarks

This function applies a new name to an area object.

The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeAreaObjName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'change name
ret = SapModel.AreaObj.ChangeName("1", "MyArea")

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Count

## Syntax

SapObject.SapModel.AreaObj.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns a count of the area objects in the model.


## VBA Example

Sub CountAreaObjects()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'return number of area objects
Count = SapModel.AreaObj.Count

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.AreaObj.Delete

## VB6 Procedure


Function Delete(ByVal Name As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the area object specified by the Name item is deleted.

If this item is Group, all of the area objects in the group specified by the Name item are deleted.

If this item is SelectedObjects, all of the selected area objects are deleted, and the Name item is
ignored.

## Remarks

The function deletes area objects.

The function returns zero if the area objects are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObj()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'delete area object
ret = SapModel.AreaObj.Delete("4")

'update view
ret = SapModel.View.RefreshView(0, True)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

AddByPoint

# DeleteLoadGravity

## Syntax

SapObject.SapModel.AreaObj.DeleteLoadGravity

## VB6 Procedure

Function DeleteLoadGravity(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:


```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the area object specified by the Name
item.

If this item is Group, the load assignments are deleted for all area objects in the group specified by
the Name item.

If this item is SelectedObjects,the load assignments are deleted for all selected area objects, and
the Name item is ignored.

## Remarks

This function deletes the gravity load assignments to the specified area objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObjectGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object gravity loads
ret = SapModel.AreaObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'delete area object gravity load
ret = SapModel.AreaObj.DeleteLoadGravity("3", "DEAD")

'close Sap


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

SetLoadGravity

# DeleteLoadPorePressure

## Syntax

SapObject.SapModel.AreaObj.DeleteLoadPorePressure

## VB6 Procedure

Function DeleteLoadPorePressure(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the load assignments are deleted for the area object specified by the Name
item.

If this item is Group, the load assignments are deleted for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected area objects, and
the Name item is ignored.

## Remarks

This function deletes the pore pressure load assignments to the specified area objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObjectPorePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object pore pressure load
ret = SapModel.AreaObj.SetLoadPorePressure("ALL", "DEAD", .1, , , Group)

'delete area object pore pressure load
ret = SapModel.AreaObj.DeleteLoadPorePressure("3", "DEAD")

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadPorePressure

SetLoadPorePressure

# DeleteLoadRotate

## Syntax

SapObject.SapModel.AreaObj.DeleteLoadRotate

## VB6 Procedure

Function DeleteLoadRotate(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the area object specified by the Name
item.

If this item is Group, the load assignments are deleted for all area objects in the group specified by
the Name item.


If this item is SelectedObjects, the load assignments are deleted for all selected area objects, and
the Name item is ignored.

## Remarks

This function deletes the rotate load assignments to the specified area objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObjectRotateLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object rotate load
ret = SapModel.AreaObj.SetLoadRotate("ALL", "DEAD", 30, , Group)

'delete area object rotate load
ret = SapModel.AreaObj.DeleteLoadRotate("3", "DEAD")

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadRotate

SetLoadRotate

# DeleteLoadStrain

## Syntax

SapObject.SapModel.AreaObj.DeleteLoadStrain

## VB6 Procedure

Function DeleteLoadStrain(ByVal Name As String, ByVal LoadPat As String, ByVal Component
As Long, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Component

This is 1, 2, 3, 4, 5, 6, 7, 8, or 9, indicating the component to which the strain load is applied.

```
1 = Strain
2 = Strain
3 = Strain
4 = Curvature
5 = Curvature
6 = Curvature
7 = Strain
8 = Strain
9 = Strain
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
```

```
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the area object specified by the Name
item.

If this item is Group, the load assignments are deleted for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected area objects, and
the Name item is ignored.

## Remarks

This function deletes the strain load assignments to the specified area objects, for the specified
load pattern, for the specified components.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObjectStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object strain load
ret = SapModel.AreaObj.SetLoadStrain("ALL", "DEAD", 1, 0.001, , , Group)

'delete area object strain load
ret = SapModel.AreaObj.DeleteLoadStrain("3", "DEAD", 1)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Added Strain33 component in v19.0.0.

## See Also

GetLoadStrain

SetLoadStrain

# DeleteLoadSurfacePressure

## Syntax

SapObject.SapModel.AreaObj.DeleteLoadSurfacePressure

## VB6 Procedure

Function DeleteLoadSurfacePressure(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the load assignments are deleted for the area object specified by the Name
item.

If this item is Group, the load assignments are deleted for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected area objects, and
the Name item is ignored.

## Remarks

This function deletes the surface pressure load assignments to the specified area objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObjectSurfacePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object surface pressure load
ret = SapModel.AreaObj.SetLoadSurfacePressure("ALL", "DEAD", -1, .1, , , Group)

'delete area object surface pressure load
ret = SapModel.AreaObj.DeleteLoadSurfacePressure("3", "DEAD")

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadSurfacePressure

SetLoadSurfacePressure

# DeleteLoadTemperature

## Syntax

SapObject.SapModel.AreaObj.DeleteLoadTemperature

## VB6 Procedure

Function DeleteLoadTemperature(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the area object specified by the Name
item.

If this item is Group, the load assignments are deleted for all area objects in the group specified by
the Name item.


If this item is SelectedObjects, the load assignments are deleted for all selected area objects, and
the Name item is ignored.

## Remarks

This function deletes the temperature load assignments to the specified area objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObjectTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object temperature load
ret = SapModel.AreaObj.SetLoadTemperature("All", "DEAD", 1, 50, , , Group)

'delete area object temperature load
ret = SapModel.AreaObj.DeleteLoadTemperature("3", "DEAD")

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTemperature

SetLoadTemperature

# DeleteLoadUniform

## Syntax

SapObject.SapModel.AreaObj.DeleteLoadUniform

## VB6 Procedure

Function DeleteLoadUniform(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the area object specified by the Name
item.

If this item is Group, the load assignments are deleted for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected area objects, and
the Name item is ignored.


## Remarks

This function deletes the uniform load assignments to the specified area objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObjectUniformLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object uniform loads
ret = SapModel.AreaObj.SetLoadUniform("ALL", "DEAD", -0.01, 2, False, "Local", Group)

'delete area object uniform load
ret = SapModel.AreaObj.DeleteLoadUniform("3", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetLoadUniform

SetLoadUniform

# DeleteLoadUniformToFrame

## Syntax

SapObject.SapModel.AreaObj.DeleteLoadUniformToFrame

## VB6 Procedure

Function DeleteLoadUniformToFrame(ByVal Name As String, ByVal LoadPat As String,
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the area object specified by the Name
item.

If this item is Group, the load assignments are deleted for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected area objects, and
the Name item is ignored.

## Remarks

This function deletes the uniform to frame load assignments to the specified area objects for the
specified load pattern.


The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObjectUniformToFrameLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 288, 2, 288)

'assign area object uniform to frame loads
ret = SapModel.AreaObj.SetLoadUniformToFrame("ALL", "DEAD", 0.01, 10, 2, False,
"Global", Group)

'delete area object uniform to frame load
ret = SapModel.AreaObj.DeleteLoadUniformToFrame("8", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadUniformToFrame

SetLoadUniformToFrame


# DeleteLoadWindPressure

## Syntax

SapObject.SapModel.AreaObj.DeleteLoadWindPressure

## VB6 Procedure

Function DeleteLoadWindPressure(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the area object specified by the Name
item.

If this item is Group, the load assignments are deleted for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected area objects, and
the Name item is ignored.

## Remarks

This function deletes the wind pressure load assignments to the specified area objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example


Sub DeleteAreaObjectWindPressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object wind pressure load
ret = SapModel.AreaObj.SetLoadWindPressure("ALL", "DEAD", 1, 0.8, Group)

'delete area object wind pressure load
ret = SapModel.AreaObj.DeleteLoadWindPressure("3", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadWindPressure_1

SetLoadWindPressure_1

# DeleteMass

## Syntax


SapObject.SapModel.AreaObj.DeleteMass

## VB6 Procedure

Function DeleteMass(ByVal Name As String, Optional ByVal ItemType As eItemType = Object)
As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the mass assignments are deleted for the area object specified by the Name
item.

If this item is Group, the mass assignments are deleted for all area objects in the group specified
by the Name item.

If this item is SelectedObjects, the mass assignments are deleted for all selected area objects, and
the Name item is ignored.

## Remarks

This function deletes the mass assignments for area objects.

The function returns zero if the mass assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObjectMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object mass
ret = SapModel.AreaObj.SetMass("ALL", .0001, False, Group)

'delete area object mass
ret = SapModel.AreaObj.DeleteMass("1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMass

SetMass

# DeleteModifiers

## Syntax

SapObject.SapModel.AreaObj.DeleteModifiers

## VB6 Procedure

Function DeleteModifiers(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.


ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the modifier assignments are deleted for the area object specified by the
Name item.

If this item is Group, the modifier assignments are deleted for all area objects in the group
specified by the Name item.

If this item is SelectedObjects, the modifier assignments are deleted for all selected area objects,
and the Name item is ignored.

## Remarks

This function deletes the modifier assignments for area objects.

The function returns zero if the modifier assignments are successfully deleted, otherwise it returns
a nonzero value.

## VBA Example

Sub DeleteAreaObjectsModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign modifiers
ReDim Value(9)


For i = 0 To 9
Value(i) = 1
Next i
Value(0) = 0.01
ret = SapModel.AreaObj.SetModifiers("ALL", Value, Group)

'delete modifiers
ret = SapModel.AreaObj.DeleteModifiers("3")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetModifiers

SetModifiers

# DeleteSpring

## Syntax

SapObject.SapModel.AreaObj.DeleteSpring

## VB6 Procedure

Function DeleteSpring(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the spring assignments are deleted for the area object specified by the Name
item.

If this item is Group, the spring assignments are deleted for all area objects in the group specified
by the Name item.

If this item is SelectedObjects, the spring assignments are deleted for all selected area objects, and
the Name item is ignored.

## Remarks

This function deletes all spring assignments for the specified area objects.

The function returns zero if the assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteAreaObjectSprings()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Vec() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign springs to area objects
ReDim Vec(2)
ret = SapModel.AreaObj.SetSpring("ALL", 1, 1, 1, "", -1, 1, 3, True, Vec, 0, False, "Local",
Group)

'delete springs
ret = SapModel.AreaObj.DeleteSpring("3")

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

SetSpring

# GetAutoMesh

## Syntax

SapObject.SapModel.AreaObj.GetAutoMesh

## VB6 Procedure

Function GetAutoMesh(ByVal Name As String, ByRef MeshType As Long, ByRef n1 As Long,
ByRef n2 As Long, ByRef MaxSize1 As Double, ByRef MaxSize2 As Double, ByRef
PointOnEdgeFromLine As Boolean, ByRef PointOnEdgeFromPoint As Boolean, ByRef
ExtendCookieCutLines As Boolean, ByRef Rotation As Double, ByRef MaxSizeGeneral As
Double, ByRef LocalAxesOnEdge As Boolean, ByRef LocalAxesOnFace As Boolean, ByRef
RestraintsOnEdge As Boolean, ByRef RestraintsOnFace As Boolean, ByRef Group As String,
ByRef SubMesh As Boolean, ByRef SubMeshSize As Double) As Long

## Parameters

Name

The name of an existing area object.

MeshType

This item is 0, 1, 2, 3, 4, 5 or 6, indicating the automatic mesh type for the area object.

```
0 = No automatic meshing
1 = Mesh area into a specified number of objects
2 = Mesh area into objects of a specified maximum size
3 = Mesh area based on points on area edges
4 = Cookie cut mesh area based on lines intersecting edges
5 = Cookie cut mesh area based on points
6 = Mesh area using General Divide Tool
```

Mesh options 1, 2 and 3 apply to quadrilaterals and triangles only.

n1

This item applies when MeshType = 1. It is the number of objects created along the edge of the
meshed area object that runs from point 1 to point 2.

n2

This item applies when MeshType = 1. It is the number of objects created along the edge of the
meshed area object that runs from point 1 to point 3.

MaxSize1

This item applies when MeshType = 2. It is the maximum size of objects created along the edge of
the meshed area object that runs from point 1 to point 2. [L]

MaxSize2

This item applies when MeshType = 2. It is the maximum size of objects created along the edge of
the meshed area object that runs from point 1 to point 3. [L]

PointOnEdgeFromLine

This item applies when MeshType = 3. If it is True, points on the area object edges are determined
from intersections of straight line objects included in the group specified by the Group item with
the area object edges.

PointOnEdgeFromPoint

This item applies when MeshType = 3. If it is True, points on the area object edges are determined
from point objects included in the group specified by the Group item that lie on the area object
edges.

ExtendCookieCutLines

This item applies when MeshType = 4. MeshType = 4 provides cookie cut meshing based on
straight line objects included in the group specified by the Group item that intersect the area object
edges. If the ExtendCookieCutLines item is True, all straight line objects included in the group
specified by the Group item are extended to intersect the area object edges for the purpose of
meshing the area object.

Rotation

This item applies when MeshType = 5. MeshType = 5 provides cookie cut meshing based on two
perpendicular lines passing through point objects included in the group specified by the Group
item. By default these lines align with the area object local 1 and 2 axes. The Rotation item is an
angle in degrees that the meshing lines are rotated from their default orientation. [deg]

MaxSizeGeneral

This item applies when MeshType = 6. It is the maximum size of objects created by the General
Divide Tool.

LocalAxesOnEdge


If this item is True, and if both points along an edge of the original area object have the same local
axes, the program makes the local axes for added points along the edge the same as the edge end
points.

LocalAxesOnFace

If this item is True, and if all points around the perimeter of the original area object have the same
local axes, the program makes the local axes for all added points the same as the perimeter points.

RestraintsOnEdge

If this item is True, and if both points along an edge of the original area object have the same
restraint/constraint, then, if the added point and the adjacent corner points have the same local
axes definition, the program includes the restraint/constraint for added points along the edge.

RestraintsOnFace

If this item is True, and if all points around the perimeter of the original area object have the same
restraint/constraint, then, if an added point and the perimeter points have the same local axes
definition, the program includes the restraint/constraint for the added point.

Group

The name of a defined group. Some of the meshing options make use of point and line objects
included in this group.

SubMesh

If this item is True, after initial meshing, the program further meshes any area objects that have an
edge longer than the length specified by the SubMeshSize item.

SubMeshSize

This item applies when the SubMesh item is True. It is the maximum size of area objects to
remain when the auto meshing is complete. [L]

## Remarks

This function retrieves the automatic meshing assignments to area objects.

The function returns zero if the meshing assignments are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetAreaObjAutoMesh()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MeshType As Long
Dim n1 As Long
Dim n2 As Long


Dim MaxSize1 As Double
Dim MaxSize2 As Double
Dim PointOnEdgeFromLine As Boolean
Dim PointOnEdgeFromPoint As Boolean
Dim ExtendCookieCutLines As Boolean
Dim Rotation As Double
Dim MaxSizeGeneral As Double
Dim LocalAxesOnEdge As Boolean
Dim LocalAxesOnFace As Boolean
Dim RestraintsOnEdge As Boolean
Dim RestraintsOnFace As Boolean
Dim MyGroup As String
Dim SubMesh As Boolean
Dim SubMeshSize As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign auto mesh options
ret = SapModel.AreaObj.SetAutoMesh("ALL", 1, 3, 3, , , , , , , , , , , , , True, , Group)

'get auto mesh options for area object
ret = SapModel.AreaObj.GetAutoMesh("1", MeshType, n1, n2, MaxSize1, MaxSize2,
PointOnEdgeFromLine, PointOnEdgeFromPoint, ExtendCookieCutLines, Rotation,
MaxSizeGeneral, LocalAxesOnEdge, LocalAxesOnFace, RestraintsOnEdge, RestraintsOnFace,
MyGroup, SubMesh, SubMeshSize)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also


SetAutoMesh

# GetEdgeConstraint

## Syntax

SapObject.SapModel.AreaObj.GetEdgeConstraint

## VB6 Procedure

Function GetEdgeConstraint(ByVal Name As String, ByRef ConstraintExists As Boolean) As
Long

## Parameters

Name

The name of an existing area object.

ConstraintExists

This item is True if an automatic edge constraint is generated by the program for the area object in
the analysis model.

## Remarks

This function retrieves the generated edge constraint assignments to area objects.

The function returns zero if the assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjEdgeConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ConstraintExists As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign auto edge constraint option
ret = SapModel.AreaObj.SetEdgeConstraint("ALL", True, Group)

'get auto edge constraint option
ret = SapModel.AreaObj.GetEdgeConstraint("1", ConstraintExists)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetEdgeConstraint

# GetElm

## Syntax

SapObject.SapModel.AreaObj.GetElm

## VB6 Procedure

Function GetElm(ByVal Name As String, ByRef nelm As Long, ByRef Elm() as String) As Long

## Parameters

Name

The name of an existing area object.

nelm

The number of area elements created from the specified area object.

Elm

An array that includes the name of a area element created from the specified area object.


## Remarks

This function retrieves the names of the area elements (analysis model area) associated with a
specified area object in the object-based model.

This function returns zero if the area element information is successfully returned; otherwise it
returns nonzero. An error occurs if the analysis model does not currently exist.

## VBA Example

Sub GetAreaElementInfoForAreaObject()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim nelm As Long
Dim Elm() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'create the analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get area element information
ret = SapModel.AreaObj.GetElm("1", nelm, Elm)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

# GetGroupAssign

## Syntax

SapObject.SapModel.AreaObj.GetGroupAssign

## VB6 Procedure

Function GetGroupAssign(ByVal Name As String, ByRef NumberGroups As Long, ByRef
Groups() As String) As Long

## Parameters

Name

The name of an existing area object.

NumberGroups

The number of group names retrieved.

Groups

The names of the groups to which the area object is assigned.

## Remarks

This function retrieves the names of the groups to which a specified area object is assigned.

The function returns zero if the group assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectGroups()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberGroups As Long
Dim Groups() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'define new groups
ret = SapModel.GroupDef.SetGroup("Group1")
ret = SapModel.GroupDef.SetGroup("Group2")

'add area object to groups
ret = SapModel.AreaObj.SetGroupAssign("1", "Group1")
ret = SapModel.AreaObj.SetGroupAssign("1", "Group2")

'get area object groups
ret = SapModel.AreaObj.GetGroupAssign("1", NumberGroups, Groups)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 20.0.0.

## See Also

SetGroupAssign

# GetGUID

## Syntax

SapObject.SapModel.AreaObj.GetGUID

## VB6 Procedure

Function GetGUID(ByVal name As String, ByRef GUID As String) As Long

## Parameters


Name

The name of an existing area object.

GUID

The GUID (Global Unique ID) for the specified area object.

## Remarks

This function retrieves the GUID for the specified area object.

This function returns zero if the area object GUID is successfully retrieved; otherwise, it returns
nonzero.

## VBA Example

Sub GetAreaObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set program created GUID
ret = SapObject.SapModel.AreaObj.SetGUID("1")

'get GUID
ret = SapObject.SapModel.AreaObj.GetGUID("1", GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

## See Also

SetGUID

# GetLoadGravity

## Syntax

SapObject.SapModel.AreaObj.GetLoadGravity

## VB6 Procedure

Function GetLoadGravity(ByVal Name As String, ByRef NumberItems As Long, ByRef
AreaName() As String, ByRef LoadPat() As String, ByRef CSys() As String, ByRef x() As
Double, ByRef y() As Double, ByRef z() As Double, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

NumberItems

The total number of gravity loads retrieved for the specified area objects.

AreaName

This is an array that includes the name of the area object associated with each gravity load.

LoadPat

This is an array that includes the name of the coordinate system in which the gravity load
multipliers are specified.

CSys

This is an array that includes the name of the coordinate system associated with each gravity load.

x, y, z

These are arrays of gravity load multipliers in the x, y and z directions of the specified coordinate
system.

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the area object specified by the Name item.

If this item is Group, the assignments are retrieved for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected area objects, and the
Name item is ignored.

## Remarks

This function retrieves the gravity load assignments to area objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim AreaName() As String
Dim LoadPat() As String
Dim CSys() As String
Dim x() As Double
Dim y() As Double
Dim z() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)


'assign area object gravity loads
ret = SapModel.AreaObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'get area object gravity load
ret = SapModel.AreaObj.GetLoadGravity("3", NumberItems, AreaName, LoadPat, CSys, x,
y, z)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadGravity

DeleteLoadGravity

# GetLoadPorePressure

## Syntax

SapObject.SapModel.AreaObj.GetLoadPorePressure

## VB6 Procedure

Function GetLoadPorePressure(ByVal Name As String, ByRef NumberItems As Long, ByRef
AreaName() As String, ByRef LoadPat() As String, ByRef Value() As Double, ByRef
PatternName() As String, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

NumberItems

The total number of pore pressure loads retrieved for the specified area objects.

AreaName


This is an array that includes the name of the area object associated with each pore pressure load.

LoadPat

This is an array that includes the name of the load pattern associated with each pore pressure load.

Value

This is an array that includes the pore pressure load value. [F/L^2 ]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the pore pressure load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the area object specified by the Name item.

If this item is Group, the assignments are retrieved for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected area objects, and the
Name item is ignored.

## Remarks

This function retrieves the pore pressure load assignments to area objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectPorePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim AreaName() As String
Dim LoadPat() As String
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object pore pressure load
ret = SapModel.AreaObj.SetLoadPorePressure("ALL", "DEAD", .1, , , Group)

'get area object pore pressure load
ret = SapModel.AreaObj.GetLoadPorePressure("ALL", NumberItems, AreaName, LoadPat,
Value, PatternName, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadPorePressure

DeleteLoadPorePressure

# GetLoadRotate

## Syntax

SapObject.SapModel.AreaObj.GetLoadRotate

## VB6 Procedure


Function GetLoadRotate(ByVal Name As String, ByRef NumberItems As Long, ByRef
AreaName() As String, ByRef LoadPat() As String, ByRef Value() As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

NumberItems

The total number of rotate loads retrieved for the specified area objects.

AreaName

This is an array that includes the name of the area object associated with each rotate load.

LoadPat

This is an array that includes the name of the load pattern associated with each rotate load.

Value

This is an array that includes the angular velocity value. [Cyc/T]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the area object specified by the Name item.

If this item is Group, the assignments are retrieved for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected area objects, and the
Name item is ignored.

## Remarks

This function retrieves the rotate load assignments to area objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example


Sub GetAreaObjectRotateLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim AreaName() As String
Dim LoadPat() As String
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object rotate load
ret = SapModel.AreaObj.SetLoadRotate("ALL", "DEAD", 30, , Group)

'get area object rotate load
ret = SapModel.AreaObj.GetLoadRotate("ALL", NumberItems, AreaName, LoadPat, Value,
Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadRotate

DeleteLoadRotate


# GetLoadStrain

## Syntax

SapObject.SapModel.AreaObj.GetLoadStrain

## VB6 Procedure

Function GetLoadStrain(ByVal Name As String, ByRef NumberItems As Long, ByRef
AreaName() As String, ByRef LoadPat() As String, ByRef Component() As Long, ByRef Value()
As Double, ByRef PatternName() As String, Optional ByVal ItemType As eItemType = Object)
As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

NumberItems

The total number of strain loads retrieved for the specified area objects.

AreaName

This is an array that includes the name of the area object associated with each strain load.

LoadPat

This is an array that includes the name of the load pattern associated with each strain load.

Component

This is an array that includes 1, 2, 3, 4, 5, 6, 7, 8, or 9, indicating the component associated with
each strain load.

```
1 = Strain11
2 = Strain22
3 = Strain12
4 = Curvature11
5 = Curvature22
6 = Curvature12
7 = Strain13
8 = Strain23
9 = Strain33
```
Value

This is an array that includes the strain value. [L/L] for Component = 1, 2, 3, 7, 8, and 9, and [1/L]
for Component = 4, 5 and 6


PatternName

This is an array that includes the joint pattern name, if any, used to specify the strain load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the area object specified by the Name item.

If this item is Group, the assignments are retrieved for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected area objects, and the
Name item is ignored.

## Remarks

This function retrieves the strain load assignments to area objects.

The function returns zero if the strain load assignments are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetAreaObjectStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim AreaName() As String
Dim LoadPat() As String
Dim Component() As Long
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object strain load
ret = SapModel.AreaObj.SetLoadStrain("ALL", "DEAD", 1, 0.001, , , Group)

'get area object strain load
ret = SapModel.AreaObj.GetLoadStrain("3", NumberItems, AreaName, LoadPat, Component,
Value, PatternName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Added Strain33 component in v19.0.0.

## See Also

SetLoadStrain

DeleteLoadStrain

# GetLoadSurfacePressure

## Syntax

SapObject.SapModel.AreaObj.GetLoadSurfacePressure

## VB6 Procedure

Function GetLoadSurfacePressure(ByVal Name As String, ByRef NumberItems As Long, ByRef
AreaName() As String, ByRef LoadPat() As String, ByRef Face() As Long, ByRef Value() As
Double, ByRef PatternName() As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters


Name

The name of an existing area object or group, depending on the value of the ItemType item.

NumberItems

The total number of surface pressure loads retrieved for the specified area objects.

AreaName

This is an array that includes the name of the area object associated with each surface pressure
load.

LoadPat

This is an array that includes the name of the load pattern associated with each surface pressure
load.

Face

This is an array that includes either -1, -2 or a nonzero, positive integer, indicating the area object
face to which the specified load assignment applies.

```
-1 = Bottom face
-2 = Top face
>0 = Edge face
```
Note that edge face n is from area object point n to area object point n + 1. For example, edge face
2 is from area object point 2 to area object point 3.

Value

This is an array that includes the surface pressure load value. [F/L^2 ]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the surface pressure
load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the area object specified by the Name item.

If this item is Group, the assignments are retrieved for all area objects in the group specified by
the Name item.


If this item is SelectedObjects, assignments are retrieved for all selected area objects, and the
Name item is ignored.

## Remarks

This function retrieves the surface pressure load assignments to area objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectSurfacePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim AreaName() As String
Dim LoadPat() As String
Dim Face() As Long
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object surface pressure load
ret = SapModel.AreaObj.SetLoadSurfacePressure("ALL", "DEAD", -1, .1, , , Group)

'get area object surface pressure load
ret = SapModel.AreaObj.GetLoadSurfacePressure("ALL", NumberItems, AreaName,
LoadPat, Face, Value, PatternName, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadSurfacePressure

DeleteLoadSurfacePressure

# GetLoadTemperature

## Syntax

SapObject.SapModel.AreaObj.GetLoadTemperature

## VB6 Procedure

Function GetLoadTemperature(ByVal Name As String, ByRef NumberItems As Long, ByRef
AreaName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef Value() As
Double, ByRef PatternName() As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

NumberItems

The total number of temperature loads retrieved for the specified area objects.

AreaName

This is an array that includes the name of the area object associated with each temperature load.

LoadPat

This is an array that includes the name of the load pattern associated with each temperature load.

MyType

This is an array that includes either 1 or 3, indicating the type of temperature load.

```
1 = Temperature
3 = Temperature gradient along local 3 axis
```

Value

This is an array that includes the temperature load value. [T] for MyType= 1 and [T/L] for
MyType= 3

PatternName

This is an array that includes the joint pattern name, if any, used to specify the temperature load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the area object specified by the Name item.

If this item is Group, the assignments are retrieved for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected area objects, and the
Name item is ignored.

## Remarks

This function retrieves the temperature load assignments to area objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim AreaName() As String
Dim LoadPat() As String
Dim MyType() As Long
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object temperature load
ret = SapModel.AreaObj.SetLoadTemperature("All", "DEAD", 1, 50, , , Group)

'get area object temperature load
ret = SapModel.AreaObj.GetLoadTemperature("ALL", NumberItems, AreaName, LoadPat,
MyType, Value, PatternName, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadTemperature

DeleteLoadTemperature

# GetLoadUniform

## Syntax

SapObject.SapModel.AreaObj.GetLoadUniform

## VB6 Procedure

Function GetLoadUniform(ByVal Name As String, ByRef NumberItems As Long, ByRef
AreaName() As String, ByRef LoadPat() As String, ByRef CSys() As String, ByRef Dir() As
Long, ByRef Value() As Double, Optional ByVal ItemType As eItemType = Object) As Long


## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

NumberItems

The total number of uniform loads retrieved for the specified area objects.

AreaName

This is an array that includes the name of the area object associated with each uniform load.

LoadPat

This is an array that includes the name of the coordinate system in which the uniform load is
specified.

CSys

This is an array that includes the name of the coordinate system associated with each uniform
load.

Dir

This is an integer between 1 and 11, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Projected Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

Value

The uniform load value. [F/L^2 ]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the assignments are retrieved for the area object specified by the Name item.

If this item is Group, the assignments are retrieved for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected area objects, and the
Name item is ignored.

## Remarks

This function retrieves the uniform load assignments to area objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectUniformLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim AreaName() As String
Dim LoadPat() As String
Dim CSys() As String
Dim Dir() As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object uniform loads
ret = SapModel.AreaObj.SetLoadUniform("ALL", "DEAD", -0.01, 2, False, "Local", Group)

'get area object uniform load
ret = SapModel.AreaObj.GetLoadUniform("3", NumberItems, AreaName, LoadPat, CSys,
Dir, Value)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadUniform

DeleteLoadUniform

# GetLoadUniformToFrame

## Syntax

SapObject.SapModel.AreaObj.GetLoadUniformToFrame

## VB6 Procedure

Function GetLoadUniformToFrame(ByVal Name As String, ByRef NumberItems As Long,
ByRef AreaName() As String, ByRef LoadPat() As String, ByRef CSys() As String, ByRef Dir()
As Long, ByRef Value() As Double, ByRef DistType As Long,Optional ByVal ItemType As
eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

NumberItems

The total number of uniform loads retrieved for the specified area objects.

AreaName

This is an array that includes the name of the area object associated with each uniform load.

LoadPat


This is an array that includes the name of the coordinate system in which the uniform load is
specified.

CSys

This is an array that includes the name of the coordinate system associated with each uniform
load.

Dir

This is an integer between 1 and 11, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Projected Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

Value

The uniform load value. [F/L^2 ]

DistType

This is either 1 or 2, indicating the load distribution type.

```
1 = One-way load distribution
2 = Two-way load distribution
```
One-way distribution is parallel to the area object local 1 axis. Two-way distribution is parallel to
the area object local 1 and 2 axes.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the area object specified by the Name item.

If this item is Group, the assignments are retrieved for all area objects in the group specified by
the Name item.


If this item is SelectedObjects, assignments are retrieved for all selected area objects, and the
Name item is ignored.

## Remarks

This function retrieves the uniform to frame load assignments to area objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectUniformToFrameLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim AreaName() As String
Dim LoadPat() As String
Dim CSys() As String
Dim Dir() As Long
Dim Value() As Double
Dim DistType() As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 288, 2, 288)

'assign area object uniform to frame loads
ret = SapModel.AreaObj.SetLoadUniformToFrame("ALL", "DEAD", 0.01, 10, 2, False,
"Global", Group)

'get area object uniform to frame load
ret = SapModel.AreaObj.GetLoadUniformToFrame("3", NumberItems, AreaName, LoadPat,
CSys, Dir, Value, DistType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadUniformToFrame

DeleteLoadUniformToFrame

# GetLoadWindPressure_1

## Syntax

SapObject.SapModel.AreaObj.GetLoadWindPressure_1

## VB6 Procedure

Function GetLoadWindPressure(ByVal Name As String, ByRef NumberItems As Long, ByRef
AreaName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef Cp() As
Double, ByRef DistributionType() As Long, Optional ByVal ItemType As eItemType = Object)
As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

NumberItems

The total number of wind pressure loads retrieved for the specified area objects.

AreaName

This is an array that includes the name of the area object associated with each wind pressure load.

LoadPat

This is an array that includes the name of the load pattern associated with each wind pressure load.

MyType

This is an array that includes either 1 or 2, indicating the wind pressure type.


```
1 = Windward, pressure varies over height
2 = Other, pressure is constant over height
```
Cp

This is an array that includes the wind pressure coefficient value.

DistributionType

This is either 1 or 2, indicating the distribution type.

```
1 = To Joints
2 = To Frames  One-way
3 = To Frames  Two-way
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the area object specified by the Name item.

If this item is Group, the assignments are retrieved for all area objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected area objects, and the
Name item is ignored.

## Remarks

This function retrieves the wind pressure load assignments to area objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectWindPressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim AreaName() As String
Dim LoadPat() As String
Dim MyType() As Long
Dim Cp() As Double
Dim DistributionType() As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object wind pressure load
ret = SapModel.AreaObj.SetLoadWindPressure("ALL", "DEAD", 1, 0.8, 1, Group)

'get area object wind pressure load
ret = SapModel.AreaObj.GetLoadWindPressure("ALL", NumberItems, AreaName, LoadPat,
MyType, Cp, DistributionType, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 22.1.0.

## See Also

SetLoadWindPressure_1

DeleteLoadWindPressure

# GetLocalAxes

## Syntax

SapObject.SapModel.AreaObj.GetLocalAxes

## VB6 Procedure

Function GetLocalAxes(ByVal Name As String, ByRef Ang As Double, ByRef Advanced As
Boolean) As Long


## Parameters

Name

The name of an existing area object.

Ang

This is the angle that the local 1 and 2 axes are rotated about the positive local 3 axis from the
default orientation. The rotation for a positive angle appears counter clockwise when the local +3
axis is pointing toward you. [deg]

Advanced

This item is True if the area object local axes orientation was obtained using advanced local axes
parameters.

## Remarks

This function retrieves the local axis angle assignment for area objects.

The function returns zero if the assignment is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetAreaObjectLocalAxisAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Ang As Double
Dim Advanced As boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'get area object local axis angle
ret = SapModel.AreaObj.GetLocalAxes("3", Ang, Advanced)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetLocalAxes

# GetLocalAxesAdvanced

## Syntax

SapObject.SapModel.AreaObj.GetLocalAxesAdvanced

## VB6 Procedure

Function GetLocalAxesAdvanced(ByVal Name As String, ByRef Active As Boolean, ByRef
Plane2 As Long, ByRef PlVectOpt As Long, ByRef PlCSys As String, ByRef PlDir() As Long,
ByRef PlPt() As String, ByRef PlVect() As Double) As Long

## Parameters

Name

The name of an existing area object.

Active

This is True if advanced local axes exist.

Plane2

This is 31 or 32, indicating that the local plane determined by the plane reference vector is the 3-1
plane or the 3-2 plane. This item applies only when the Active item is True.

PlVectOpt

This is 1, 2, or 3, indicating the plane reference vector option. This item applies only when the
Active item is True.

```
1 = Coordinate direction
2 = Two joints
3 = User vector
```

PlCSys

The coordinate system used to define the plane reference vector coordinate directions and the
plane user vector. This item applies when the Active item is True and the PlVectOpt item is 1 or 3.

PlDir

This is an array dimensioned to 1 (2 integers) indicating the plane reference vector primary and
secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center in
the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the PlVectOpt item is 1. Possible coordinate direction
values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
PlPt

This is an array dimensioned to 1 (2 strings) indicating the labels of two joints that define the
plane reference vector. Either of these joints may be specified as None to indicate the center of the
specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the PlVectOpt item is 2.

PlVect

This is an array dimensioned to 2 (3 doubles) that defines the plane reference vector. This item
applies when the Active item is True and the PlVectOpt item is 3.

## Remarks

This function retrieves the advanced local axes assignments to area objects.

The function returns zero if the advanced local axes assignments are retrieved successfully;
otherwise it returns a nonzero value.

## VBA Example

Sub GetAreaAdvancedLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyPlDir(1) As Long
Dim MyPlPt(1) As String
Dim MyPlVect(2) As Double
Dim Ang As Double


Dim Advanced As Boolean
Dim Active As Boolean
Dim Plane2 As Long
Dim PlVectOpt As Long
Dim PlCSys As String
Dim PlDir() As Long
Dim PlPt() As String
Dim PlVect() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area advanced local axes
MyPlDir(0) = 2
MyPlDir(1) = 3
ret = SapModel.AreaObj.SetLocalAxesAdvanced("3", True, 31, 1, "Global", MyPlDir,
MyPlPt, MyPlVect)

'get area object local axis angle
ret = SapModel.AreaObj.GetLocalAxes("3", Ang, Advanced)

'get area advanced local axes data
If Advanced Then
ret = SapModel.AreaObj.GetLocalAxesAdvanced("3", Active, Plane2, PlVectOpt, PlCSys,
PlDir, PlPt, PlVect)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also


SetLocalAxesAdvanced

SetLocalAxes

GetLocalAxes

# GetMass

## Syntax

SapObject.SapModel.AreaObj.GetMass

## VB6 Procedure

Function GetMass(ByVal Name As String, ByRef MassOverL2 As Double) As Long

## Parameters

Name

The name of an existing area object.

MassOverL2

The mass per unit area assigned to the area object. [M/L^2 ]

## Remarks

This function retrieves the mass per unit area assignment for area objects.

The function returns zero if the mass assignment is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MassOverL2 As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object mass
ret = SapModel.AreaObj.SetMass("ALL", .0001, False, Group)

'get area object mass assignment
ret = SapModel.AreaObj.GetMass("1", MassOverL2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetMass

DeleteMass

# GetMaterialOverwrite

## Syntax

SapObject.SapModel.AreaObj.GetMaterialOverwrite

## VB6 Procedure

Function GetMaterialOverwrite(ByVal Name As String, ByRef PropName As String) As Long

## Parameters

Name

The name of a defined area object.

PropName


This is None, indicating that no material overwrite exists for the specified area object, or it is the
name of an existing material property.

## Remarks

This function retrieves the material overwrite assigned to an area object, if any. The material
property name is indicated as None if there is no material overwrite assignment.

The function returns zero if the material overwrite assignment is successfully retrieved; otherwise
it returns a nonzero value.

## VBA Example

Sub GetAreaMaterialOverwrite()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign material overwrite
ret = SapModel.AreaObj.SetMaterialOverwrite("3", "A992Fy50")

'get material overwrite assignment
ret = SapModel.AreaObj.GetMaterialOverwrite("3", PropName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

SetMaterialOverwrite

# GetMatTemp

## Syntax

SapObject.SapModel.AreaObj.GetMatTemp

## VB6 Procedure

Function GetMatTemp(ByVal Name As String, ByRef Temp As Double, ByRef PatternName As
String) As Long

## Parameters

Name

The name of an existing area object.

Temp

This is the material temperature value assigned to the area object. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
area object is uniform over the object at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the area object
may vary. The material temperature at each corner point around the area object perimeter is equal
to the specified temperature multiplied by the pattern value at the associated point object. The
material temperature at other points in the area object is calculated by interpolation from the
corner points.

## Remarks

This function retrieves the material temperature assignments to area objects.

The function returns zero if the material temperature assignments are successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetAreaObjectMatTemp()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim Temp As Double
Dim PatternName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign material temperature
ret = SapModel.AreaObj.SetMatTemp("ALL", 50, , Group)

'get material temperature
ret = SapModel.AreaObj.GetMatTemp("3", Temp, PatternName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetMatTemp

# GetModifiers

## Syntax

SapObject.SapModel.AreaObj.GetModifiers

## VB6 Procedure

Function GetModifiers(ByVal Name As String, ByRef Value() As Double) As Long


## Parameters

Name

The name of an existing area object.

Value

This is an array of ten unitless modifiers.

```
Value(0) = Membrane f11 modifier
Value(1) = Membrane f22 modifier
Value(2) = Membrane f12 modifier
Value(3) = Bending m11 modifier
Value(4) = Bending m22 modifier
Value(5) = Bending m12 modifier
Value(6) = Shear v13 modifier
Value(7) = Shear v23 modifier
Value(8) = Mass modifier
Value(9) = Weight modifier
```
## Remarks

This function retrieves the modifier assignment for area objects. The default value for all
modifiers is one.

The function returns zero if the modifier assignments are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetAreaObjectModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign modifiers
ReDim Value(9)
For i = 0 To 9
Value(i) = 1
Next i
Value(0) = 0.01
ret = SapModel.AreaObj.SetModifiers("ALL", Value, Group)

'get modifiers
ReDim Value(9)
ret = SapModel.AreaObj.GetModifiers("3", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetModifiers

DeleteModifiers

# GetNameList

## Syntax

SapObject.SapModel.AreaObj.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of area object names retrieved by the program.


MyName

This is a one-dimensional array of area object names. The MyName array is created as a dynamic,
zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames  1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined area objects.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetAreaObjectNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'get area object names
ret = SapModel.AreaObj.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

# GetNotionalSize

## Syntax

SapObject.SapModel.PropArea.GetNotionalSize

## VB6 Procedure

Function GetNotionalSize(ByVal Name As String, ByRef stype As String, ByRef Value As
Double) As Long

## Parameters

Name

The name of an existing shell-type area section property.

stype

The type to define the notional size of a section. It can be:

```
"Auto" = Program will determine the notional size based on the average thickness of
an area element.
```
```
"User" = The notional size is based on the user-defined value.
```
```
"None" = Notional size will not be considered. In other words, the time-dependent
effect of this section will not be considered.
```
Value

For **stype** is "Auto", the Value represents for the scale factor to the program-determined notional
size; for **stype** is User, the **Value** represents for the user-defined notional size [L]; for **stype** is
None, the **Value** will not be used and can be set to 1.

## Remarks

This function retrieves the method to determine the notional size of an area section for the creep
and shrinkage calculations. This function is currently worked for shell type area section.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetAreaPropNotionalSize()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long

```
Dim stype As String
```
```
Dim Value As Double
```
```
'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
SapObject.ApplicationStart
```
```
'create SapModel object
Set SapModel = SapObject.SapModel
```
```
'initialize model
ret = SapModel.InitializeNewModel
```
```
'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)
```
```
'assign parameters
stype = Auto
Value = 1.1
ret = SapModel.PropArea.SetNotionalSize("ASEC1", Auto, 1.1)
```
```
'get parameters
ret = SapModel.PropArea.GetNotionalSize("ASEC1", stype, Value)
```
```
'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.1.0

## See Also


SetNotionalSize

# GetOffsets

## Syntax

SapObject.SapModel.AreaObj.GetOffsets

## VB6 Procedure

Function GetOffsets(ByVal Name As String, ByRef OffsetType As Long, ByRef OffsetPattern As
String, ByRef OffsetPatternSF As Double, ByRef Offset() As Double) As Long

## Parameters

Name

The name of an existing area object.

OffsetType

This is 0, 1 or 2, indicating the joint offset type.

```
0 = No joint offsets
1 = User defined joint offsets specified by joint pattern
2 = User defined joint offsets specified by point
```
OffsetPattern

This item applies only when OffsetType = 1. It is the name of the defined joint pattern that is used
to calculate the joint offsets.

OffsetPatternSF

This item applies only when OffsetType = 1. It is the scale factor applied to the joint pattern when
calculating the joint offsets. [L]

Offset

This item applies only when OffsetType = 2. It is an array of joint offsets for each of the points
that define the area object. [L]

## Remarks

This function retrieves the joint offset assignments for area objects.

The function returns zero if the assignments are successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetAreaObjectJointOffsets()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i as long
Dim OffsetType As Long
Dim OffsetPattern As String
Dim OffsetPatternSF As Double
Dim Offset() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign joint offsets
ReDim Offset(3)
For i = 0 To 3
Offset(i) = 12
Next i
ret = SapModel.AreaObj.SetOffsets("ALL", 2, "", 1, Offset, Group)

'get joint offsets
ret = SapModel.AreaObj.GetOffsets("3", OffsetType, OffsetPattern, OffsetPatternSF, Offset)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetOffsets


# GetPoints

## Syntax

SapObject.SapModel.AreaObj.GetPoints

## VB6 Procedure

Function GetPoints(ByVal Name As String, ByRef NumberPoints As Long, ByRef Point() As
String) As Long

## Parameters

Name

The name of a defined area object.

NumberPoints

The number of point objects that define the area object.

Point

This is an array containing the names of the point objects that define the area object. The point
names are in order around the area object.

## Remarks

This function retrieves the names of the point objects that define an area object.

The function returns zero if the point object names are successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetAreaObjPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberPoints As Long
Dim Point() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'get names of points
ret = SapModel.AreaObj.GetPoints("1", NumberPoints, Point)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetProperty

## Syntax

SapObject.SapModel.AreaObj.GetProperty

## VB6 Procedure

Function GetProperty(ByVal Name As String, ByRef PropName As String) As Long

## Parameters

Name

The name of a defined area object.

PropName

The name of the area property assigned to the area object. This item is None if no area property is
assigned to the area object.

## Remarks

This function retrieves the area property assigned to an area object.


The function returns zero if the property is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetAreaObjectProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'get area property
ret = SapModel.AreaObj.GetProperty("1", PropName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetProperty

# GetSelected

## Syntax

Sap2000.AreaObj.GetSelected


## VB6 Procedure

Function GetSelected(ByVal Name As String, ByRef Selected As Boolean) As Long

## Parameters

Name

The name of an existing area object.

Selected

This item is True if the specified area object is selected; otherwise it is False.

## Remarks

This function retrieves the selected status for an area object.

The function returns zero if the selected status is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectSelectedStatus()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Selected As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set all area objects selected
ret = SapModel.AreaObj.SetSelected("ALL", True, Group)

'get area object selected status
ret = SapModel.AreaObj.GetSelected("1", Selected)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSelected

GetSelectedEdge

SetSelectedEdge

# GetSelectedEdge

## Syntax

Sap2000.AreaObj.GetSelectedEdge

## VB6 Procedure

Function GetSelectedEdge(ByVal Name As String, ByRef NumberEdges As Long, ByRef
Selected() As Boolean) As Long

## Parameters

Name

The name of an existing area object.

NumberEdges

The number of edges in the specified area object.

Selected

This is an array of items that is True if the specified area object edge is selected; otherwise it is
False.

```
Selected(0) = Selected status for edge 1
Selected(1) = Selected status for edge 2
Selected(n) = Selected status for edge (n + 1)
```

This array is internally dimensioned by Sap2000 to (NumberEdges  1).

## Remarks

This function retrieves the selected status for area object edges.

The function returns zero if the selected status is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectEdgesSelectedStatus()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberEdges As Long
Dim Selected() As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set area object edge selected
ret = SapModel.AreaObj.SetSelectedEdge("1", 2, True)
ret = SapModel.AreaObj.SetSelectedEdge("1", 3, True)

'get area object edge selected status
ret = SapModel.AreaObj.GetSelectedEdge("1", NumberEdges, Selected)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

SetSelected

GetSelected

SetSelectedEdge

# GetSpring

## Syntax

SapObject.SapModel.AreaObj.GetSpring

## VB6 Procedure

Function GetSpring(ByVal Name As String, ByRef NumberSprings As Long, ByRef MyType()
As Long, ByRef s() As Double, ByRef SimpleSpringType() As Long, ByRef LinkProp() As
String, ByRef Face() As Long, ByRef SpringLocalOneType() As Long, ByRef Dir() As Long,
ByRef Outward() As Boolean, ByRef VecX() As Double, ByRef VecY() As Double, ByRef VecZ
() As Double, ByRef CSys() As String, ByRef Ang() As Double) As Long

## Parameters

Name

The name of an existing area object.

NumberSprings

The number of spring assignments made to the specified area object.

MyType

Each value in this array is either 1 or 2, indicating the spring property type.

```
1 = Simple spring
2 = Link property
```
s

Each value in this array is the simple spring stiffness per unit area of the specified area object face.
This item applies only when the corresponding MyType = 1. [F/L^3 ]

SimpleSpringType

Each value in this array is 1, 2 or 3, indicating the simple spring type. This item applies only when
the corresponding MyType = 1.

```
1 = Spring resists tension and compression
2 = Spring resists compression only
```

```
3 = Spring resists tension only
```
LinkProp

Each value in this array is the name of the link property assigned to the spring. This item applies
only when the corresponding MyType = 2.

Face

Each value in this array is -1, -2 or a nonzero, positive integer, indicating the area object face to
which the specified spring assignment applies.

```
-1 = Bottom face
-2 = Top face
>0 = Edge face
```
Note that edge face n is from area object point n to area object point n + 1. For example, edge face
2 is from area object point 2 to area object point 3.

SpringLocalOneType

Each value in this array is 1, 2 or 3, indicating the method used to specify the spring positive local
1-axis orientation.

```
1 = Parallel to area object local axis
2 = Normal to specified area object face
3 = User specified direction vector
```
Dir

Each value in this array is 1, 2, 3, -1, -2 or -3, indicating the area object local axis that corresponds
to the positive local 1-axis of the spring. This item applies only when the corresponding
SpringLocalOneType = 1.

Outward

Each value in this array is True if the spring positive local 1 axis is outward from the specified
area object face. This item applies only when SpringLocalOneType = 2.

VecX

Each value in this array is the X-axis or area object local 1-axis component (depending on the
CSys specified) of the user specified direction vector for the spring local 1-axis. The direction
vector is in the coordinate system specified by the CSys item. This item applies only when the
corresponding SpringLocalOneType = 3.

VecY

Each value in this array is the Y-axis or area object local 2-axis component (depending on the
CSys specified) of the user specified direction vector for the spring local 1-axis. The direction
vector is in the coordinate system specified by the CSys item. This item applies only when the
corresponding SpringLocalOneType = 3.

VecZ


Each value in this array is the X-axis or area object local 3-axis component (depending on the
CSys specified) of the user specified direction vector for the spring local 1-axis. The direction
vector is in the coordinate system specified by the CSys item. This item applies only when the
corresponding SpringLocalOneType = 3.

CSys

Each value in this array is Local (meaning the area object local coordinate system) or the name of
a defined coordinate system. This item is the coordinate system in which the user specified
direction vector, Vec, is specified. This item applies only when the corresponding
SpringLocalOneType = 3.

Ang

Each value in this array is the angle that the link local 2-axis is rotated from its default orientation.
This item applies only when the corresponding MyType = 2. [deg]

## Remarks

This function retrieves the spring assignments to an area object face.

The function returns zero if the assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectSprings()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Vec() As Double
Dim NumberSprings As Long
Dim MyType() As Long
Dim s() As Double
Dim SimpleSpringType() As Long
Dim LinkProp() As String
Dim Face() As Long
Dim SpringLocalOneType() As Long
Dim Dir() As Long
Dim Outward() As Boolean
Dim VecX() As Double
Dim VecY() As Double
Dim VecZ() As Double
Dim CSys() As String
Dim Ang() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign springs to area objects
ReDim Vec(2)
ret = SapModel.AreaObj.SetSpring("ALL", 1, 1, 1, "", -1, 1, 3, True, Vec, 0, False, "Local",
Group)

'get spring assignments to area objects
ret = SapModel.AreaObj.GetSpring("1", NumberSprings, MyType, s, SimpleSpringType,
LinkProp, Face, SpringLocalOneType, Dir, Outward, VecX, VecY, VecZ, CSys, Ang)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSpring

DeleteSpring

# GetThickness

## Syntax

SapObject.SapModel.AreaObj.GetThickness

## VB6 Procedure

Function GetThickness(ByVal Name As String, ByRef ThicknessType As Long, ByRef
ThicknessPattern As String, ByRef ThicknessPatternSF As Double, ByRef Thickness() As
Double) As Long


## Parameters

Name

The name of an existing area object.

ThicknessType

This is 0, 1 or 2, indicating the thickness overwrite type.

```
0 = No thickness overwrites
1 = User defined thickness overwrites specified by joint pattern
2 = User defined thickness overwrites specified by point
```
ThicknessPattern

This item applies only when ThicknessType = 1. It is the name of the defined joint pattern that is
used to calculate the thicknesses.

ThicknessPatternSF

This item applies only when ThicknessType = 1. It is the scale factor applied to the joint pattern
when calculating the thicknesses. [L]

Thickness

This item applies only when ThicknessType = 2. It is an array of thicknesses at each of the points
that define the area object. [L]

## Remarks

This function retrieves the thickness overwrite assignments for area objects.

The function returns zero if the assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaObjectThicknessOverwrites()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i as long
Dim ThicknessType As Long
Dim ThicknessPattern As String
Dim ThicknessPatternSF As Double
Dim Thickness() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign thickness overwrites
ReDim Thickness(3)
For i = 0 To 3
Thickness(i) = 11
Next i
ret = SapModel.AreaObj.SetThickness("ALL", 2, "", 1, Thickness, Group)

'get thickness overwrites
ret = SapModel.AreaObj.GetThickness("3", ThicknessType, ThicknessPattern,
ThicknessPatternSF, Thickness)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetThickness

# GetTransformationMatrix

## Syntax

Sap2000.AreaObj.GetTransformationMatrix

## VB6 Procedure

Function GetTransformationMatrix(ByVal Name As String, ByRef Value() As Double,Optional
ByVal IsGlobal As Boolean = True) As Long


## Parameters

Name

The name of an existing area object.

Value

Value is an array of nine direction cosines that define the transformation matrix.

The following matrix equation shows how the transformation matrix is used to convert items from
the area object local coordinate system to the global coordinate system.

In the equation, c0 through c8 are the nine values from the transformation array, (Local1, Local2,
Local3) are an item (such as a load) in the object local coordinate system, and (GlobalX, GlobalY,
GlobalZ) are the same item in the global coordinate system.

The transformation from the local coordinate system to the present coordinate system is the same
as that shown above for the global system if you substitute the present system for the global
system.

IsGlobal

If this item is True, the transformation matrix is between the Global coordinate system and the
area object local coordinate system.

If this item is False, the transformation matrix is between the present coordinate system and the
area object local coordinate system.

## Remarks

The function returns zero if the area object transformation matrix is successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetAreaObjectMatrix()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value() As Double

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object local axis angle
ret = SapModel.AreaObj.SetLocalAxes("3", 30)

'get area object transformation matrix
ReDim Value(8)
ret = SapModel.AreaObj.GetTransformationMatrix("3", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# SetAutoMesh

## Syntax

SapObject.SapModel.AreaObj.SetAutoMesh

## VB6 Procedure

Function SetAutoMesh(ByVal Name As String, ByVal MeshType As Long, Optional ByVal n1
As Long = 2, Optional ByVal n2 As Long = 2, Optional ByVal MaxSize1 As Double = 0,
Optional ByVal MaxSize2 As Double = 0, Optional ByVal PointOnEdgeFromLine As Boolean =
False, Optional ByVal PointOnEdgeFromPoint As Boolean = False, Optional ByVal
ExtendCookieCutLines As Boolean = False, Optional ByVal Rotation As Double = 0, Optional
ByVal MaxSizeGeneral As Double = 0, Optional ByVal LocalAxesOnEdge As Boolean = False,
Optional ByVal LocalAxesOnFace As Boolean = False, Optional ByVal RestraintsOnEdge As
Boolean = False, Optional ByVal RestraintsOnFace As Boolean = False, Optional ByVal Group


As String = "ALL", Optional ByVal SubMesh As Boolean = False, Optional ByVal SubMeshSize
As Double = 0, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

MeshType

This item is 0, 1, 2, 3, 4, 5 or 6, indicating the automatic mesh type for the area object.

```
0 = No automatic meshing
1 = Mesh area into a specified number of objects
2 = Mesh area into objects of a specified maximum size
3 = Mesh area based on points on area edges
4 = Cookie cut mesh area based on lines intersecting edges
5 = Cookie cut mesh area based on points
6 = Mesh area using General Divide Tool
```
Mesh options 1, 2 and 3 apply to quadrilaterals and triangles only.

n1

This item applies when MeshType = 1. It is the number of objects created along the edge of the
meshed area object that runs from point 1 to point 2.

n2

This item applies when MeshType = 1. It is the number of objects created along the edge of the
meshed area object that runs from point 1 to point 3.

MaxSize1

This item applies when MeshType = 2. It is the maximum size of objects created along the edge of
the meshed area object that runs from point 1 to point 2. [L]

If this item is input as 0, the default value is used. The default value is 48 inches if the database
units are English or 120 centimeters if the database units are metric.

MaxSize2

This item applies when MeshType = 2. It is the maximum size of objects created along the edge of
the meshed area object that runs from point 1 to point 3. [L]

If this item is input as 0, the default value is used. The default value is 48 inches if the database
units are English or 120 centimeters if the database units are metric.

PointOnEdgeFromLine


This item applies when MeshType = 3. If it is True, points on the area object edges are determined
from intersections of straight line objects included in the group specified by the Group item with
the area object edges.

PointOnEdgeFromPoint

This item applies when MeshType = 3. If it is True, points on the area object edges are determined
from point objects included in the group specified by the Group item that lie on the area object
edges.

ExtendCookieCutLines

This item applies when MeshType = 4. MeshType = 4 provides cookie cut meshing based on
straight line objects included in the group specified by the Group item that intersect the area object
edges. If the ExtendCookieCutLines item is True, all straight line objects included in the group
specified by the Group item are extended to intersect the area object edges for the purpose of
meshing the area object.

Rotation

This item applies when MeshType = 5. MeshType = 5 provides cookie cut meshing based on two
perpendicular lines passing through point objects included in the group specified by the Group
item. By default these lines align with the area object local 1 and 2 axes. The Rotation item is an
angle in degrees that the meshing lines are rotated from their default orientation. [deg]

MaxSizeGeneral

This item applies when MeshType = 6. It is the maximum size of objects created by the General
Divide Tool.

If this item is input as 0, the default value is used. The default value is 48 inches if the database
units are English or 120 centimeters if the database units are metric.

LocalAxesOnEdge

If this item is True, and if both points along an edge of the original area object have the same local
axes, then the program makes the local axes for added points along the edge the same as the edge
end points.

LocalAxesOnFace

If this item is True, and if all points around the perimeter of the original area object have the same
local axes, the program makes the local axes for all added points the same as the perimeter points.

RestraintsOnEdge

If this item is True, and if both points along an edge of the original area object have the same
restraint/constraint, then, if the added point and the adjacent corner points have the same local
axes definition, the program includes the restraint/constraint for added points along the edge.

RestraintsOnFace

If this item is True, and if all points around the perimeter of the original area object have the same
restraint/constraint, then, if an added point and the perimeter points have the same local axes
definition, the program includes the restraint/constraint for the added point.


Group

The name of a defined group. Some of the meshing options make use of point and line objects
included in this group.

SubMesh

If this item is True, after initial meshing, the program further meshes any area objects that have an
edge longer than the length specified by the SubMeshSize item.

SubMeshSize

This item applies when the SubMesh item is True. It is the maximum size of area objects to
remain when the auto meshing is complete. [L]

If this item is input as 0, the default value is used. The default value is 12 inches if the database
units are English or 30 centimeters if the database units are metric.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function makes automatic meshing assignments to area objects.

The function returns zero if the meshing options are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignAreaObjAutoMesh()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign auto mesh options
ret = SapModel.AreaObj.SetAutoMesh("ALL", 1, 3, 3, , , , , , , , , , , , , , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetAutoMesh

# SetEdgeConstraint

## Syntax

SapObject.SapModel.AreaObj.SetEdgeConstraint

## VB6 Procedure

Function SetEdgeConstraint(ByVal Name As String, ByVal ConstraintExists As Boolean,
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

ConstraintExists


This item is True if an automatic edge constraint is generated by the program for the area object in
the analysis model.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function makes generated edge constraint assignments to area objects.

The function returns zero if the edge constraint option is successfully assigned; otherwise it
returns a nonzero value.

## VBA Example

Sub AssignAreaObjAutoEdgeConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign auto edge constraint option
ret = SapModel.AreaObj.SetEdgeConstraint("ALL", True, Group)


ret = SapModel.AreaObj.SetEdgeConstraint("2", False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetEdgeConstraint

# SetGroupAssign

## Syntax

SapObject.SapModel.AreaObj.SetGroupAssign

## VB6 Procedure

Function SetGroupAssign(ByVal Name As String, ByVal GroupName As String, Optional By Val
Remove As Boolean = False, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

GroupName

The name of an existing group to which the assignment is made.

Remove

If this item is False, the specified area objects are added to the group specified by the GroupName
item. If it is True, the area objects are removed from the group.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the area object specified by the Name item is added or removed from the
group specified by the GroupName item.

If this item is Group, all area objects in the group specified by the Name item are added or
removed from the group specified by the GroupName item.

If this item is SelectedObjects, all selected area objects are added or removed from the group
specified by the GroupName item, and the Name item is ignored.

## Remarks

This function adds or removes area objects from a specified group.

The function returns zero if the group assignment is successful; otherwise it returns a nonzero
value.

## VBA Example

Sub AddAreaObjectsToGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'add area objects to group
ret = SapModel.AreaObj.SetGroupAssign("1", "Group1")
ret = SapModel.AreaObj.SetGroupAssign("3", "Group1")

'select objects in group
ret = SapModel.SelectObj.Group("Group1")

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetGroupAssign

# SetGUID

## Syntax

SapObject.SapModel.AreaObj.SetGUID

## VB6 Procedure

Function SetGUID(ByVal Name As String, Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing area object.

GUID

The GUID (Global Unique ID) for the specified area object.

## Remarks

This function sets the GUID for the specified area object. If the GUID is passed in as a blank
string, the program automatically creates a GUID for the object.

This function returns zero if the area object GUID is successfully set; otherwise, it returns
nonzero.

## VBA Example

Sub SetAreaObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim Name As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set program created GUID
ret = SapObject.SapModel.AreaObj.SetGUID("1")

'get GUID
ret = SapObject.SapModel.AreaObj.GetGUID("1", GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetGUID

# SetLoadGravity

## Syntax

SapObject.SapModel.AreaObj.SetLoadGravity

## VB6 Procedure


Function SetLoadGravity(ByVal Name As String, ByVal LoadPat As String, ByVal x As Double,
ByVal y As Double, ByVal z As Double, Optional ByVal Replace As Boolean = True, Optional
ByVal CSys As String = "Global", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

x, y, z

These are the gravity load multipliers in the x, y and z directions of the specified coordinate
system.

Replace

If this item is True, all previous gravity loads, if any, assigned to the specified area object(s), in
the specified load pattern, are deleted before making the new assignment.

CSys

The coordinate system in which the x, y and z multipliers are specified.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function assigns gravity load multipliers to area objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.


## VBA Example

Sub AssignAreaObjectGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object gravity loads
ret = SapModel.AreaObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

DeleteLoadGravity

# SetLoadPorePressure

## Syntax


SapObject.SapModel.AreaObj.SetLoadPorePressure

## VB6 Procedure

Function SetLoadPorePressure(ByVal Name As String, ByVal LoadPat As String, ByVal Value
As Double, Optional ByVal PatternName As String = "", Optional ByVal Replace As Boolean =
True, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Value

This is the pore pressure value. [F/L^2 ]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the pore pressure load for the
area object is uniform over the object at the value specified by Value.

If PatternName is the name of a defined joint pattern, the pore pressure load for the area object is
based on the specified pore pressure value multiplied by the pattern value at the point objects that
define the area object.

Replace

If this item is True, all previous pore pressure loads, if any, assigned to the specified area object
(s), in the specified load case, are deleted before making the new assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.


## Remarks

This function assigns pore pressure loads to area objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignAreaObjectPorePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object pore pressure load
ret = SapModel.AreaObj.SetLoadPorePressure("ALL", "DEAD", .1, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadPorePressure


DeleteLoadPorePressure

# SetLoadRotate

## Syntax

SapObject.SapModel.AreaObj.SetLoadRotate

## VB6 Procedure

Function SetLoadRotate(ByVal Name As String, ByVal LoadPat As String, ByVal Value As
Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Value

This is the angular velocity. [Cyc/T]

## Remarks

This function assigns rotate loads to area objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignAreaObjectRotateLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object rotate load
ret = SapModel.AreaObj.SetLoadRotate("ALL", "DEAD", 30, , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadRotate

DeleteLoadRotate

# SetLoadStrain

## Syntax

SapObject.SapModel.AreaObj.SetLoadStrain

## VB6 Procedure

Function SetLoadStrain(ByVal Name As String, ByVal LoadPat As String, ByVal Component As
Long, ByVal Value As Double, Optional ByVal Replace As Boolean = True, Optional ByVal
PatternName As String = "", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat


The name of a defined load pattern.

Component

This is 1, 2, 3, 4, 5, 6, 7, 8, or 9, indicating the component to which the strain load is applied.

```
1 = Strain11
2 = Strain22
3 = Strain12
4 = Curvature11
5 = Curvature22
6 = Curvature12
7 = Strain13
8 = Strain23
9 = Strain33
```
Value

This is the strain load value. [L/L] for Component = 1, 2, 3, 7, 8, and 9 and [1/L] for Component =
4, 5 and 6

Replace

If this item is True, all previous strain loads, if any, assigned to the specified area object(s), in the
specified load pattern, for the specified degree of freedom, are deleted before making the new
assignment.

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the strain load for the area object
is uniform over the object at the value specified by Value.

If PatternName is the name of a defined joint pattern, the strain load for the area object is based on
the specified strain value multiplied by the pattern value at the corner points of the area object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks


This function assigns strain loads to area objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignAreaObjectStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object strain load
ret = SapModel.AreaObj.SetLoadStrain("ALL", "DEAD", 1, 0.001, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Added Strain33 component in v19.0.0.

## See Also

GetLoadStrain

DeleteLoadStrain


# SetLoadSurfacePressure

## Syntax

SapObject.SapModel.AreaObj.SetLoadSurfacePressure

## VB6 Procedure

Function SetLoadSurfacePressure(ByVal Name As String, ByVal LoadPat As String, ByVal Face
As Long, ByVal Value As Double, Optional ByVal PatternName As String = "", Optional ByVal
Replace As Boolean = True, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Face

This is -1, -2 or a nonzero, positive integer, indicating the area object face to which the specified
load assignment applies.

```
-1 = Bottom face
-2 = Top face
>0 = Edge face
```
Note that edge face n is from area object point n to area object point n + 1. For example, edge face
2 is from area object point 2 to area object point 3.

Value

This is the surface pressure value. [F/L^2 ]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the surface pressure load for the
area object face is uniform over the face at the value specified by Value.

If PatternName is the name of a defined joint pattern, the surface pressure load for the area object
face is based on the specified surface pressure value multiplied by the pattern value at the point
objects that are part of the face.

Replace


If this item is True, all previous surface pressure loads, if any, assigned to the specified area object
(s), in the specified load case, are deleted before making the new assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function assigns surface pressure loads to area objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignAreaObjectSurfacePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object surface pressure load
ret = SapModel.AreaObj.SetLoadSurfacePressure("ALL", "DEAD", -1, .1, , , Group)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadSurfacePressure

DeleteLoadSurfacePressure

# SetLoadTemperature

## Syntax

SapObject.SapModel.AreaObj.SetLoadTemperature

## VB6 Procedure

Function SetLoadTemperature(ByVal Name As String, ByVal LoadPat As String, ByVal MyType
As Long, ByVal Value As Double, Optional ByVal PatternName As String = "", Optional ByVal
Replace As Boolean = True, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

MyType

This is either 1 or 3, indicating the type of temperature load.

```
1 = Temperature
3 = Temperature gradient along local 3 axis
```

Value

This is the temperature change value. [T] for MyType = 1 and [T/L] for MyType = 3

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the temperature load for the area
object is uniform over the object at the value specified by Value.

If PatternName is the name of a defined joint pattern the temperature load for the area object is
based on the specified temperature value multiplied by the pattern value at the joints that define
the area object.

Replace

If this item is True, all previous temperature loads, if any, assigned to the specified area object(s),
in the specified load case, are deleted before making the new assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function assigns temperature loads to area objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignAreaObjectTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object temperature load
ret = SapModel.AreaObj.SetLoadTemperature("All", "DEAD", 1, 50, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTemperature

DeleteLoadTemperature

# SetLoadUniform

## Syntax

SapObject.SapModel.AreaObj.SetLoadUniform

## VB6 Procedure

Function SetLoadUniform(ByVal Name As String, ByVal LoadPat As String, ByVal Value As
Double, ByVal Dir As Long, Optional ByVal Replace As Boolean = True, Optional ByVal CSys
As String = "Global", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters


Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Value

The uniform load value. [F/L^2 ]

Dir

This is an integer between 1 and 11, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Projected Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

Replace

If this item is True, all previous uniform loads, if any, assigned to the specified area object(s), in
the specified load pattern, are deleted before making the new assignment.

CSys

This is Local or the name of a defined coordinate system, indicating the coordinate system in
which the uniform load is specified.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.


If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function assigns uniform loads to area objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignAreaObjectUniformLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object uniform loads
ret = SapModel.AreaObj.SetLoadUniform("ALL", "DEAD", -0.01, 2, False, "Local", Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetLoadUniform

DeleteLoadUniform

# SetLoadUniformToFrame

## Syntax

SapObject.SapModel.AreaObj.SetLoadUniformToFrame

## VB6 Procedure

Function SetLoadUniformToFrame(ByVal Name As String, ByVal LoadPat As String, ByVal
Value As Double, ByVal Dir As Long, ByVal DistType As Long, Optional ByVal Replace As
Boolean = True, Optional ByVal CSys As String = "Global", Optional ByVal ItemType As
eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Value

The uniform load value. [F/L^2 ]

Dir

This is an integer between 1 and 11, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Projected Gravity direction (only applies when CSys is Global)
```

The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

DistType

This is either 1 or 2, indicating the load distribution type.

```
1 = One-way load distribution
2 = Two-way load distribution
```
One-way distribution is parallel to the area object local 1 axis. Two-way distribution is parallel to
the area object local 1 and 2 axes.

Replace

If this item is True, all previous uniform loads, if any, assigned to the specified area object(s), in
the specified load pattern, are deleted before making the new assignment.

CSys

This is Local or the name of a defined coordinate system, indicating the coordinate system in
which the uniform load is specified.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects and the Name item
is ignored.

## Remarks

This function assigns uniform to frame loads to area objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignAreaObjectUniformToFrameLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 288, 2, 288)

'assign area object uniform to frame loads
ret = SapModel.AreaObj.SetLoadUniformToFrame("ALL", "DEAD", 0.01, 10, 2, False,
"Global", Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadUniformToFrame

DeleteLoadUniformToFrame

# SetLoadWindPressure_1

## Syntax

SapObject.SapModel.AreaObj.SetLoadWindPressure_1

## VB6 Procedure


Function SetLoadWindPressure(ByVal Name As String, ByVal LoadPat As String, ByVal
MyType As Long, ByVal Cp As Double, ByVal DistributionType As Long, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

MyType

This is either 1 or 2, indicating the wind pressure type.

```
1 = Windward, pressure varies over height
2 = Other, pressure is constant over height
```
Cp

This is the wind pressure coefficient.

DistributionType

This is either 1 or 2, indicating the distribution type.

```
1 = To Joints
2 = To Frames  One-way
3 = To Frames  Two-way
```
**ItemType**

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function assigns wind pressure loads to area objects.


The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignAreaObjectWindPressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object wind pressure load
ret = SapModel.AreaObj.SetLoadWindPressure("ALL", "DEAD", 1, 0.8, 1, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 22.1.0.

## See Also

GetLoadWindPressure_1

DeleteLoadWindPressure

# SetLocalAxes

## Syntax


SapObject.SapModel.AreaObj.SetLocalAxes

## VB6 Procedure

Function SetLocalAxes(ByVal Name As String, ByVal Ang As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

Ang

This is the angle that the local 1 and 2 axes are rotated about the positive local 3 axis from the
default orientation. The rotation for a positive angle appears counter clockwise when the local +3
axis is pointing toward you. [deg]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function assigns a local axis angle to area objects.

The function returns zero if the local axis angle is successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignAreaObjectLocalAxisAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object local axis angle
ret = SapModel.AreaObj.SetLocalAxes("3", 30)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetLocalAxes

# SetLocalAxesAdvanced

## Syntax

SapObject.SapModel.AreaObj.SetLocalAxesAdvanced

## VB6 Procedure

Function SetLocalAxesAdvanced(ByVal Name As String, ByVal Active As Boolean, ByVal
Plane2 As Long, ByVal PlVectOpt As Long, ByVal PlCSys As String, ByRef PlDir() As Long,
ByRef PlPt() As String, ByRef PlVect() As Double, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name


The name of an existing area object or group depending on the value of the ItemType item.

Active

This is True if advanced local axes exist.

Plane2

This is 31 or 32, indicating that the local plane determined by the plane reference vector is the 3-1
plane or the 3-2 plane. This item applies only when the Active item is True.

PlVectOpt

This is 1, 2, or 3, indicating the plane reference vector option. This item applies only when the
Active item is True.

```
1 = Coordinate direction
2 = Two joints
3 = User vector
```
PlCSys

The coordinate system used to define the plane reference vector coordinate directions and the
plane user vector. This item applies when the Active item is True and the PlVectOpt item is 1 or 3.

PlDir

This is an array dimensioned to 1 (2 integers), indicating the plane reference vector primary and
secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center in
the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the PlVectOpt item is 1. Possible coordinate direction
values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
PlPt

This is an array dimensioned to 1 (2 strings) indicating the labels of two joints that define the
plane reference vector. Either of these joints may be specified as None to indicate the center of the
specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the PlVectOpt item is 2.

PlVect

This is an array dimensioned to 2 (3 doubles) that defines the plane reference vector. This item
applies when the Active item is True and the PlVectOpt item is 3.


ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
Selection = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is Selection, assignment is made to all selected area objects and the Name item is
ignored.

## Remarks

This function assigns advanced local axes to area objects.

The function returns zero if the advanced local axes assignments are successfully assigned;
otherwise it returns a nonzero value.

## VBA Example

Sub AssignAreaAdvancedLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyPlDir(1) As Long
Dim MyPlPt(1) As String
Dim MyPlVect(2) As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area advanced local axes
MyPlDir(0) = 2


MyPlDir(1) = 3
ret = SapModel.AreaObj.SetLocalAxesAdvanced("3", True, 31, 1, "Global", MyPlDir,
MyPlPt, MyPlVect)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also

GetLocalAxesAdvanced

GetLocalAxes

# SetMass

## Syntax

SapObject.SapModel.AreaObj.SetMass

## VB6 Procedure

Function SetMass(ByVal Name As String, ByVal MassOverL2 As Double, Optional ByVal
Replace As Boolean = False, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

MassOverL2

The mass per unit area assigned to the area object. [M/L^2 ]

Replace

If this item is True, all existing mass assignments to the area object are removed before assigning
the specified mas. If it is False, the specified mass is added to any existing mass already assigned
to the area object.

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects and the Name item
is ignored.

## Remarks

This function assigns mass per unit area to area objects.

The function returns zero if the mass is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignAreaObjectMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign area object mass
ret = SapModel.AreaObj.SetMass("ALL", .0001, False, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetMass

DeleteMass

# SetMaterialOverwrite

## Syntax

SapObject.SapModel.AreaObj.SetMaterialOverwrite

## VB6 Procedure

Function SetMaterialOverwrite(ByVal Name As String, ByVal PropName As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

PropName

This is None or a blank string, indicating that any existing material overwrites assigned to the
specified area objects are to be removed, or it is the name of an existing material property.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.


## Remarks

This function sets the material overwrite assignment for area objects.

The function returns zero if the material overwrite assignment is successfully assigned; otherwise
it returns a nonzero value.

## VBA Example

Sub AssignAreaMaterialOverwrite()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign material overwrite
ret = SapModel.AreaObj.SetMaterialOverwrite("3", "A992Fy50")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMaterialOverwrite

# SetMatTemp


## Syntax

SapObject.SapModel.AreaObj.SetMatTemp

## VB6 Procedure

Function SetMatTemp(ByVal Name As String, ByVal Temp As Double, Optional ByVal
PatternName As String = "", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

Temp

This is the material temperature value assigned to the area object. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
area object is uniform over the object at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the area object
may vary. The material temperature at each corner point around the area object perimeter is equal
to the specified temperature multiplied by the pattern value at the associated point object. The
material temperature at other points in the area object is calculated by interpolation from the
corner points.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function assigns material temperatures to area objects.


The function returns zero if the material temperatures are successfully assigned; otherwise it
returns a nonzero value.

## VBA Example

Sub AssignAreaObjectMatTemp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign material temperature
ret = SapModel.AreaObj.SetMatTemp("ALL", 50, , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMatTemp

# SetModifiers

## Syntax

SapObject.SapModel.AreaObj.SetModifiers


## VB6 Procedure

Function SetModifiers(ByVal Name As String, ByRef Value() As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

Value

This is an array of ten unitless modifiers.

```
Value(0) = Membrane f11 modifier
Value(1) = Membrane f22 modifier
Value(2) = Membrane f12 modifier
Value(3) = Bending m11 modifier
Value(4) = Bending m22 modifier
Value(5) = Bending m12 modifier
Value(6) = Shear v13 modifier
Value(7) = Shear v23 modifier
Value(8) = Mass modifier
Value(9) = Weight modifier
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function sets the modifier assignment for area objects. The default value for all modifiers is
one.

The function returns zero if the modifier assignments are successfully assigned; otherwise it
returns a nonzero value.


## VBA Example

Sub AssignAreaModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign modifiers
ReDim Value(9)
For i = 0 To 9
Value(i) = 1
Next i
Value(0) = 0.01
ret = SapModel.AreaObj.SetModifiers("ALL", Value, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetModifiers

DeleteModifiers


# SetNotionalSize

## Syntax

SapObject.SapModel.PropArea.SetNotionalSize

## VB6 Procedure

Function SetNotionalSize(ByVal Name As String, ByVal stype As String, ByVal Value As
Double) As Long

## Parameters

Name

The name of an existing shell-type area section property.

stype

The type to define the notional size of a section. It can be:

```
"Auto" = Program will determine the notional size based on the average thickness of
an area element.
```
```
"User" = The notional size is based on the user-defined value.
```
```
"None" = Notional size will not be considered. In other words, the time-dependent
effect of this section will not be considered.
```
Value

For **stype** is "Auto", the Value represents for the scale factor to the program-determined notional
size; for **stype** is User, the **Value** represents for the user-defined notional size [L]; for **stype** is
None, the **Value** will not be used and can be set to 1.

## Remarks

This function assigns the method to determine the notional size of an area section for the creep
and shrinkage calculations. This function is currently worked for shell type area section.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignAreaPropNotionalSize()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim i As Long

```
Dim stype As String
```
```
Dim Value As Double
```
```
'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
SapObject.ApplicationStart
```
```
'create SapModel object
Set SapModel = SapObject.SapModel
```
```
'initialize model
ret = SapModel.InitializeNewModel
```
```
'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)
```
```
'assign parameters
stype = Auto
Value = 1.1
ret = SapModel.PropArea.SetNotionalSize("ASEC1", stype, Value)
```
```
'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.1.0

## See Also

GetNotionalSize

# SetOffsets

## Syntax

SapObject.SapModel.AreaObj.SetOffsets


## VB6 Procedure

Function SetOffsets(ByVal Name As String, ByVal OffsetType As Long, ByVal OffsetPattern As
String, ByVal OffsetPatternSF As Double, ByRef Offset() As Double, Optional ByVal ItemType
As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

OffsetType

This is 0, 1 or 2, indicating the joint offset type.

```
0 = No joint offsets
1 = User defined joint offsets specified by joint pattern
2 = User defined joint offsets specified by point
```
OffsetPattern

This item applies only when OffsetType = 1. It is the name of the defined joint pattern that is used
to calculate the joint offsets.

OffsetPatternSF

This item applies only when OffsetType = 1. It is the scale factor applied to the joint pattern when
calculating the joint offsets. [L]

Offset

This item applies only when OffsetType = 2. It is an array of joint offsets for each of the points
that define the area object. [L]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.


## Remarks

This function sets the joint offset assignments for area objects.

The function returns zero if the offsets are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignAreaObjectJointOffsets()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i as long
Dim Offset() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign joint offsets
ReDim Offset(3)
For i = 0 To 3
Offset(i) = 12
Next i
ret = SapModel.AreaObj.SetOffsets("ALL", 2, "", 1, Offset, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

GetOffsets

# SetProperty

## Syntax

SapObject.SapModel.AreaObj.SetProperty

## VB6 Procedure

Function SetProperty(ByVal name As String, ByVal PropName As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

PropName

This is None or the name of a area property to be assigned to the specified area object(s). None
means that no property is assigned to the area object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function assigns an area property to area objects.

The function returns zero if the property is successfully assigned; otherwise it returns a nonzero
value.


## VBA Example

Sub SetAreaObjectProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set area property
ret = SapModel.AreaObj.SetProperty("4", "None")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetProperty

# SetSelected

## Syntax

Sap2000.AreaObj.SetSelected

## VB6 Procedure


Function SetSelected(ByVal Name As String, ByVal Selected As Boolean, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

Selected

This item is True if the specified area object is selected, otherwise it is False.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the selected status is set for the area object specified by the Name item.

If this item is Group, the selected status is set for all area objects in the group specified by the
Name item.

If this item is SelectedObjects, the selected status is set for all selected area objects, and the Name
item is ignored.

## Remarks

This function sets the selected status for area objects.

The function returns zero if the selected status is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetAreaObjectSelected()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set area objects selected
ret = SapModel.AreaObj.SetSelected("ALL", True, Group)

'update window
ret = SapModel.View.RefreshWindow

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSelected

GetSelectedEdge

SetSelectedEdge

# SetSelectedEdge

## Syntax

Sap2000.AreaObj.SetSelectedEdge

## VB6 Procedure

Function SetSelectedEdge(ByVal Name As String, ByVal EdgeNum As Long, ByVal Selected As
Boolean) As Long

## Parameters

Name

The name of an existing area object.


EdgeNum

The area object edge that is have its selected status set.

Selected

This item is True if the specified area object edge is selected; otherwise it is False.

## Remarks

This function sets the selected status for area object edges.

The function returns zero if the selected status is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetAreaObjectEdgeSelected()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set area object edge selected
ret = SapModel.AreaObj.SetSelectedEdge("1", 2, True)

'update window
ret = SapModel.View.RefreshWindow

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetSelectedEdge

GetSelected

SetSelected

# SetSpring

## Syntax

SapObject.SapModel.AreaObj.SetSpring

## VB6 Procedure

Function SetSpring(ByVal Name As String, ByVal MyType As Long, ByVal s As Double, ByVal
SimpleSpringType As Long, ByVal LinkProp As String, ByVal Face as Long, ByVal
SpringLocalOneType As Long, ByVal Dir As Long, ByVal Outward As Boolean, ByRef Vec()
As Double, ByVal Ang As Double, ByVal Replace As Boolean, Optional ByVal CSys As String =
"Local", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

MyType

This is either 1 or 2, indicating the spring property type.

```
1 = Simple spring
2 = Link property
```
s

The simple spring stiffness per unit area of the specified area object face. This item applies only

when MyType = 1. [F/L^3 ]

SimpleSpringType

This is 1, 2 or 3, indicating the simple spring type. This item applies only when MyType = 1.

```
1 = Spring resists tension and compression
```

```
2 = Spring resists compression only
3 = Spring resists tension only
```
LinkProp

The name of the link property assigned to the spring. This item applies only when MyType = 2.

Face

This is -1, -2 or a nonzero, positive integer indicating the area object face to which the specified
spring assignment applies.

```
-1 = Bottom face
-2 = Top face
>0 = Edge face
```
Note that edge face n is from area object point n to area object point n + 1. For example, edge face
2 is from area object point 2 to area object point 3.

SpringLocalOneType

This is 1, 2 or 3, indicating the method used to specify the spring positive local 1-axis orientation.

```
1 = Parallel to area object local axis
2 = Normal to specified area object face
3 = User specified direction vector
```
Dir

This is 1, 2, 3, -1, -2 or -3, indicating the area object local axis that corresponds to the positive
local 1-axis of the spring. This item applies only when SpringLocalOneType = 1.

Outward

This item is True if the spring positive local 1 axis is outward from the specified area object face.
This item applies only when SpringLocalOneType = 2.

Vec

This is an array of three values that define the direction vector of the spring positive local 1-axis.
The direction vector is in the coordinate system specified by the CSys item. This item applies only
when SpringLocalOneType = 3.

Ang

This is the angle that the link local 2-axis is rotated from its default orientation. This item applies
only when MyType = 2. [deg]

Replace

If this item is True, all existing spring assignments to the area object are removed before assigning
the specified spring. If it is False, the specified spring is added to any existing springs already
assigned to the area object.


CSys

This is Local (meaning the area object local coordinate system) or the name of a defined
coordinate system. This item is the coordinate system in which the user specified direction vector,
Vec, is specified. This item applies only when SpringLocalOneType = 3.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function makes spring assignments to area objects. The springs are assigned to a specified
area object face.

The function returns zero if the assignments are successfully applied; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignAreaObjectSprings()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Vec() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign springs to area objects
ReDim Vec(2)
ret = SapModel.AreaObj.SetSpring("ALL", 1, 1, 1, "", -1, 1, 3, True, Vec, 0, False, "Local",
Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

DeleteSpring

# SetThickness

## Syntax

SapObject.SapModel.AreaObj.SetThickness

## VB6 Procedure

Function SetThickness(ByVal Name As String, ByVal ThicknessType As Long, ByVal
ThicknessPattern As String, ByVal ThicknessPatternSF As Double, ByRef Thickness() As
Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing area object or group, depending on the value of the ItemType item.

ThicknessType

This is 0, 1 or 2, indicating the thickness overwrite type.

```
0 = No thickness overwrites
1 = User defined thickness overwrites specified by joint pattern
2 = User defined thickness overwrites specified by point
```

ThicknessPattern

This item applies only when ThicknessType = 1. It is the name of the defined joint pattern that is
used to calculate the thicknesses.

ThicknessPatternSF

This item applies only when ThicknessType = 1. It is the scale factor applied to the joint pattern
when calculating the thicknesses. [L]

Thickness

This item applies only when ThicknessType = 2. It is an array of thicknesses at each of the points
that define the area object. [L]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the area object specified by the Name item.

If this item is Group, the assignment is made to all area objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected area objects, and the Name item
is ignored.

## Remarks

This function sets the thickness overwrite assignments for area objects.

The function returns zero if the thickness overwrites are successfully assigned; otherwise it returns
a nonzero value.

## VBA Example

Sub AssignAreaObjectThicknessOverwrites()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i as long
Dim Thickness() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign thickness overwrites
ReDim Thickness(3)
For i = 0 To 3
Thickness(i) = 11
Next i
ret = SapModel.AreaObj.SetThickness("ALL", 2, "", 1, Thickness, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetThickness

# GetPoints

## Syntax

SapObject.SapModel.PlaneElm.GetPoints

## VB6 Procedure

Function GetPoints(ByVal Name As String, ByRef NumberPoints As Long, ByRef Point() As
String) As Long

## Parameters

Name


The name of an plane element.

NumberPoints

The number of point elements that define the plane element.

Point

This is an array containing the names of the point elements that define the plane element. The
point names are in order around the plane element.

## Remarks

This function retrieves the names of the point elements that define an plane element.

The function returns zero if the point element names are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetPlaneElmPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberPoints As Long
Dim Point() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign auto mesh options
ret = SapModel.AreaObj.SetAutoMesh("ALL", 1, 3, 3, , , , , , , , , , , , , , , Group)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get names of points
ret = SapModel.PlaneElm.GetPoints("3-2", NumberPoints, Point)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetObj

## Syntax

Sap2000.PlaneElm.GetObj

## VB6 Procedure

Function GetObj(ByVal Name As String, ByRef Obj As String) As Long

## Parameters

Name

The name of an existing plane element.

Obj

The name of the area object from which the plane element was created.

## Remarks

This function retrieves the name of the area object from which an plane element was created.

The function returns zero if the information is successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetObjForPlaneElm()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Obj As String
Dim ObjType As Long


Dim RDI As Double
Dim RDJ As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign auto mesh options
ret = SapModel.AreaObj.SetAutoMesh("ALL", 1, 3, 3, , , , , , , , , , , , , , , Group)

'create the analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get object information for an plane element
ret = SapModel.PlaneElm.GetObj("3-2", Obj)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Count

## Syntax

Sap2000.PlaneElm.Count

## VB6 Procedure

Function Count() As Long


## Parameters

None

## Remarks

This function returns the total number of plane elements in the analysis model.

## VBA Example

Sub CountPlaneElements()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign auto mesh options
ret = SapModel.AreaObj.SetAutoMesh("ALL", 1, 2, 2, , , , , , , , , , , , , , , Group)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'return number of plane elements
Count = SapModel.PlaneElm.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

# GetProperty

## Syntax

SapObject.SapModel.PlaneElm.GetProperty

## VB6 Procedure

Function GetProperty(ByVal Name As String, ByRef PropName As String) As Long

## Parameters

Name

The name of a defined plane element.

PropName

The name of the area property assigned to the plane element. This item is None if there is no area
property assigned to the plane element.

## Remarks

This function retrieves the area property assigned to an plane element.

The function returns zero if the property is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetPlaneElementProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get area property for plane element
ret = SapModel.PlaneElm.GetProperty("1", PropName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetTransformationMatrix

## Syntax

Sap2000.PlaneElm.GetTransformationMatrix

## VB6 Procedure

Function GetTransformationMatrix(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing plane element.

Value

Value is an array of nine direction cosines that define the transformation matrix.

The following matrix equation shows how the transformation matrix is used to convert items from
the plane element local coordinate system to the global coordinate system.


In the equation, c0 through c8 are the nine values from the transformation array, (Local1, Local2,
Local3) are an item (such as a load) in the element local coordinate system, and (GlobalX,
GlobalY, GlobalZ) are the same item in the global coordinate system.

## Remarks

The function returns zero if the transformation matrix is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetPlaneElementMatrix()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign area object local axis angle
ret = SapModel.AreaObj.SetLocalAxes("3", 30)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get plane element transformation matrix
redim Value(8)
ret = SapModel.PlaneElm.GetTransformationMatrix("3", Value)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetLoadGravity

## Syntax

SapObject.SapModel.PlaneElm.GetLoadGravity

## VB6 Procedure

Function GetLoadGravity(ByVal Name As String, ByRef NumberItems As Long, ByRef
PlaneName() As String, ByRef LoadPat() As String, ByRef CSys() As String, ByRef x() As
Double, ByRef y() As Double, ByRef z() As Double, Optional ByVal ItemTypeElm As
eItemTypeElm = Element) As Long

## Parameters

Name

The name of an existing plane element or group, depending on the value of the ItemType item.

NumberItems

The total number of gravity loads retrieved for the specified plane elements.

PlaneName

This is an array that includes the name of the plane element associated with each gravity load.

LoadPat

This is an array that includes the name of the coordinate system in which the gravity load
multipliers are specified.

CSys

This is an array that includes the name of the coordinate system associated with each gravity load.

x, y, z


These are arrays of gravity load multipliers in the x, y and z directions of the specified coordinate
system.

ItemTypeElm

This is one of the following items in the eItemTypeElm enumeration:

```
ObjectElm = 0
Element = 1
GroupElm = 2
SelectionElm = 3
```
If this item is ObjectElm, the load assignments are retrieved for the plane elements corresponding
to the area object specified by the Name item.

If this item is Element, the load assignments are retrieved for the plane element specified by the
Name item.

If this item is GroupElm, the load assignments are retrieved for the plane elements corresponding
to all area objects included in the group specified by the Name item.

If this item is SelectionElm, the load assignments are retrieved for plane elements corresponding
to all selected area objects, and the Name item is ignored.

## Remarks

This function retrieves the gravity load assignments to plane elements.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetPlaneElementGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim PlaneName() As String
Dim LoadPat() As String
Dim CSys() As String
Dim x() As Double
Dim y() As Double
Dim z() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign auto mesh options
ret = SapModel.AreaObj.SetAutoMesh("ALL", 1, 3, 3, , , , , , , , , , , , , , , Group)

'assign area object gravity loads
ret = SapModel.AreaObj.SetLoadGravity("ALL", "Membrane", 0, 0, -1, , , Group)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get plane element gravity load
ret = SapModel.PlaneElm.GetLoadGravity("3-1", NumberItems, PlaneName, LoadPat, CSys,
x, y, z)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# GetLoadPorePressure

## Syntax

SapObject.SapModel.PlaneElm.GetLoadPorePressure

## VB6 Procedure

Function GetLoadPorePressure(ByVal Name As String, ByRef NumberItems As Long, ByRef
PlaneName() As String, ByRef LoadPat() As String, ByRef Value() As Double, ByRef
PatternName() As String, Optional ByVal ItemTypeElm As eItemTypeElm = Element) As Long


## Parameters

Name

The name of an existing plane element or group, depending on the value of the ItemType item.

NumberItems

The total number of pore pressure loads retrieved for the specified plane elements.

PlaneName

This is an array that includes the name of the plane element associated with each pore pressure
load.

LoadPat

This is an array that includes the name of the load pattern associated with each pore pressure load.

Value

This is an array that includes the pore pressure load value. [F/L^2 ]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the pore pressure load.

ItemTypeElm

This is one of the following items in the eItemTypeElm enumeration:

```
ObjectElm = 0
Element = 1
GroupElm = 2
SelectionElm = 3
```
If this item is ObjectElm, the load assignments are retrieved for the plane elements corresponding
to the area object specified by the Name item.

If this item is Element, the load assignments are retrieved for the plane element specified by the
Name item.

If this item is GroupElm, the load assignments are retrieved for the plane elements corresponding
to all area objects included in the group specified by the Name item.

If this item is SelectionElm, the load assignments are retrieved for plane elements corresponding
to all selected area objects, and the Name item is ignored.

## Remarks

This function retrieves the pore pressure load assignments to plane elements.


The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetPlaneElementPorePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim PlaneName() As String
Dim LoadPat() As String
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign area object pore pressure load
ret = SapModel.AreaObj.SetLoadPorePressure("ALL", "Membrane", .1, , , Group)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get plane element pore pressure load
ret = SapModel.PlaneElm.GetLoadPorePressure("ALL", NumberItems, PlaneName, LoadPat,
Value, PatternName, GroupElm)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# GetLoadRotate

## Syntax

SapObject.SapModel.PlaneElm.GetLoadRotate

## VB6 Procedure

Function GetLoadRotate(ByVal Name As String, ByRef NumberItems As Long, ByRef
PlaneName() As String, ByRef LoadPat() As String, ByRef Value() As Double, ByRef
PatternName() As String, Optional ByVal ItemTypeElm As eItemTypeElm = Element) As Long

## Parameters

Name

The name of an existing plane element or group, depending on the value of the ItemType item.

NumberItems

The total number of rotate loads retrieved for the specified plane elements.

PlaneName

This is an array that includes the name of the plane element associated with each rotate load.

LoadPat

This is an array that includes the name of the load pattern associated with each rotate load.

Value

This is an array that includes the rotate load value. [F/L^2 ]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the rotate load.

ItemTypeElm

This is one of the following items in the eItemTypeElm enumeration:

```
ObjectElm = 0
Element = 1
GroupElm = 2
SelectionElm = 3
```

If this item is ObjectElm, the load assignments are retrieved for the plane elements corresponding
to the area object specified by the Name item.

If this item is Element, the load assignments are retrieved for the plane element specified by the
Name item.

If this item is GroupElm, the load assignments are retrieved for the plane elements corresponding
to all area objects included in the group specified by the Name item.

If this item is SelectionElm, the load assignments are retrieved for plane elements corresponding
to all selected area objects, and the Name item is ignored.

## Remarks

This function retrieves the rotate load assignments to plane elements.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetPlaneElementRotateLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim PlaneName() As String
Dim LoadPat() As String
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 4-001-incomp.sdb")

'assign area object rotate load
ret = SapModel.AreaObj.SetLoadRotate("ALL", "FTG", 30, , Group)

'create analysis model


ret = SapModel.Analyze.CreateAnalysisModel

'get plane element rotate load
ret = SapModel.PlaneElm.GetLoadRotate("ALL", NumberItems, PlaneName, LoadPat,
Value, GroupElm)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# GetLoadStrain

## Syntax

SapObject.SapModel.PlaneElm.GetLoadStrain

## VB6 Procedure

Function GetLoadStrain(ByVal Name As String, ByRef NumberItems As Long, ByRef
PlaneName() As String, ByRef LoadPat() As String, ByRef Component() As Long, ByRef Value
() As Double, ByRef PatternName() As String, Optional ByVal ItemTypeElm As eItemTypeElm
= Element) As Long

## Parameters

Name

The name of an existing plane element or group, depending on the value of the ItemType item.

NumberItems

The total number of strain loads retrieved for the specified plane elements.

PlaneName

This is an array that includes the name of the plane element associated with each strain load.

LoadPat


This is an array that includes the name of the load pattern associated with each strain load.

Component

This is an array that includes 1, 2, 3, 4, 5 or 6, indicating the component associated with each
strain load.

```
1 = Strain11
2 = Strain22
3 = Strain12
4 = Strain13
5 = Strain23
6 = Strain33
```
Value

This is an array that includes the strain value. [L/L]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the strain load.

ItemTypeElm

This is one of the following items in the eItemTypeElm enumeration:

```
ObjectElm = 0
Element = 1
GroupElm = 2
SelectionElm = 3
```
If this item is ObjectElm, the load assignments are retrieved for the plane elements corresponding
to the area object specified by the Name item.

If this item is Element, the load assignments are retrieved for the plane element specified by the
Name item.

If this item is GroupElm, the load assignments are retrieved for the plane elements corresponding
to all area objects included in the group specified by the Name item.

If this item is SelectionElm, the load assignments are retrieved for plane elements corresponding
to all selected area objects, and the Name item is ignored.

## Remarks

This function retrieves the strain load assignments to plane elements.

The function returns zero if the strain load assignments are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example


Sub GetPlaneElementStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim PlaneName() As String
Dim LoadPat() As String
Dim Component() As Long
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign area object strain load
ret = SapModel.AreaObj.SetLoadStrain("ALL", "Membrane", 1, 0.001, , , Group)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get plane element strain load
ret = SapModel.PlaneElm.GetLoadStrain("3", NumberItems, PlaneName, LoadPat,
Component, Value, PatternName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Added strain in the 33 direction for version 24.1.0.


## See Also

# GetLoadSurfacePressure

## Syntax

SapObject.SapModel.PlaneElm.GetLoadSurfacePressure

## VB6 Procedure

Function GetLoadSurfacePressure(ByVal Name As String, ByRef NumberItems As Long, ByRef
PlaneName() As String, ByRef LoadPat() As String, ByRef Face() As Long, ByRef Value() As
Double, ByRef PatternName() As String, Optional ByVal ItemTypeElm As eItemTypeElm =
Element) As Long

## Parameters

Name

The name of an existing plane element or group, depending on the value of the ItemType item.

NumberItems

The total number of surface pressure loads retrieved for the specified plane elements.

PlaneName

This is an array that includes the name of the plane element associated with each surface pressure
load.

LoadPat

This is an array that includes the name of the load pattern associated with each surface pressure
load.

Face

This is an array that includes -1, -2 or a nonzero, positive integer, indicating the area element face
to which the specified load assignment applies.

```
-1 = Bottom face
-2 = Top face
>0 = Edge face
```
Note that edge face n is from plane element point n to plane element point n + 1. For example,
edge face 2 is from plane element point 2 to plane element point 3.

Value

This is an array that includes the surface pressure load value. [F/L^2 ]


PatternName

This is an array that includes the joint pattern name, if any, used to specify the surface pressure
load.

ItemTypeElm

This is one of the following items in the eItemTypeElm enumeration:

```
ObjectElm = 0
Element = 1
GroupElm = 2
SelectionElm = 3
```
If this item is ObjectElm, the load assignments are retrieved for the plane elements corresponding
to the area object specified by the Name item.

If this item is Element, the load assignments are retrieved for the plane element specified by the
Name item.

If this item is GroupElm, the load assignments are retrieved for the plane elements corresponding
to all area objects included in the group specified by the Name item.

If this item is SelectionElm, the load assignments are retrieved for plane elements corresponding
to all selected area objects, and the Name item is ignored.

## Remarks

This function retrieves the surface pressure load assignments to plane elements.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetPlaneElementSurfacePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim PlaneName() As String
Dim LoadPat() As String
Dim Face() As Long
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign area object surface pressure load
ret = SapModel.AreaObj.SetLoadSurfacePressure("ALL", "Membrane", -1, .1, , , Group)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get plane element surface pressure load
ret = SapModel.PlaneElm.GetLoadSurfacePressure("ALL", NumberItems, PlaneName,
LoadPat, Face, Value, PatternName, GroupElm)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# GetLoadTemperature

## Syntax

SapObject.SapModel.PlaneElm.GetLoadTemperature

## VB6 Procedure

Function GetLoadTemperature(ByVal Name As String, ByRef NumberItems As Long, ByRef
PlaneName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef Value()
As Double, ByRef PatternName() As String, Optional ByVal ItemTypeElm As eItemTypeElm =
Element) As Long


## Parameters

Name

The name of an existing plane element or group, depending on the value of the ItemType item.

NumberItems

The total number of temperature loads retrieved for the specified plane elements.

PlaneName

This is an array that includes the name of the plane element associated with each temperature load.

LoadPat

This is an array that includes the name of the load pattern associated with each temperature load.

MyType

This is an array that includes either 1 or 3, indicating the type of temperature load.

```
1 = Temperature
3 = Temperature gradient along local 3 axis
```
Value

This is an array that includes the temperature load value. [T] for MyType= 1 and [T/L] for
MyType= 3

PatternName

This is an array that includes the joint pattern name, if any, used to specify the temperature load.

ItemTypeElm

This is one of the following items in the eItemTypeElm enumeration:

```
ObjectElm = 0
Element = 1
GroupElm = 2
SelectionElm = 3
```
If this item is ObjectElm, the load assignments are retrieved for the plane elements corresponding
to the area object specified by the Name item.

If this item is Element, the load assignments are retrieved for the plane element specified by the
Name item.

If this item is GroupElm, the load assignments are retrieved for the plane elements corresponding
to all area objects included in the group specified by the Name item.

If this item is SelectionElm, the load assignments are retrieved for plane elements corresponding
to all selected area objects, and the Name item is ignored.


## Remarks

This function retrieves the temperature load assignments to plane elements.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetPlaneElementTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim PlaneName() As String
Dim LoadPat() As String
Dim MyType() As Long
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign area object temperature load
ret = SapModel.AreaObj.SetLoadTemperature("All", "Membrane", 1, 50, , , Group)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get plane element temperature load
ret = SapModel.PlaneElm.GetLoadTemperature("ALL", NumberItems, PlaneName, LoadPat,
MyType, Value, PatternName, GroupElm)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# GetLoadUniform

## Syntax

SapObject.SapModel.PlaneElm.GetLoadUniform

## VB6 Procedure

Function GetLoadUniform(ByVal Name As String, ByRef NumberItems As Long, ByRef
PlaneName() As String, ByRef LoadPat() As String, ByRef CSys() As String, ByRef Dir() As
Long, ByRef Value() As Double, Optional ByVal ItemTypeElm As eItemTypeElm = Element) As
Long

## Parameters

Name

The name of an existing plane element or group, depending on the value of the ItemType item.

NumberItems

The total number of uniform loads retrieved for the specified plane elements.

PlaneName

This is an array that includes the name of the plane element associated with each uniform load.

LoadPat

This is an array that includes the name of the coordinate system in which the uniform load is
specified.

CSys

This is an array that includes the name of the coordinate system associated with each uniform
load.

Dir

This is an integer between 1 and 11, indicating the direction of the load.


```
1 = Local 1 axis (applies only when CSys is Local)
2 = Local 2 axis (applies only when CSys is Local)
3 = Local 3 axis (applies only when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (applies only when CSys is Global)
11 = Projected Gravity direction (applies only when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

Value

The uniform load value. [F/L^2 ]

ItemTypeElm

This is one of the following items in the eItemTypeElm enumeration:

```
ObjectElm = 0
Element = 1
GroupElm = 2
SelectionElm = 3
```
If this item is ObjectElm, the load assignments are retrieved for the plane elements corresponding
to the area object specified by the Name item.

If this item is Element, the load assignments are retrieved for the plane element specified by the
Name item.

If this item is GroupElm, the load assignments are retrieved for the plane elements corresponding
to all area objects included in the group specified by the Name item.

If this item is SelectionElm, the load assignments are retrieved for plane elements corresponding
to all selected area objects, and the Name item is ignored.

## Remarks

This function retrieves the uniform load assignments to plane elements.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetPlaneElementUniformLoad()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim PlaneName() As String
Dim LoadPat() As String
Dim CSys() As String
Dim Dir() As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign area object uniform loads
ret = SapModel.AreaObj.SetLoadUniform("ALL", "Membrane", -0.01, 2, False, "Local",
Group)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get plane element uniform load
ret = SapModel.PlaneElm.GetLoadUniform("3", NumberItems, PlaneName, LoadPat, CSys,
Dir, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also


# GetLocalAxes

## Syntax

SapObject.SapModel.PlaneElm.GetLocalAxes

## VB6 Procedure

Function GetLocalAxes(ByVal Name As String, ByRef Ang As Double) As Long

## Parameters

Name

The name of an existing plane element.

Ang

This is the angle that the local 1 and 2 axes are rotated about the positive local 3 axis from the
default orientation. The rotation for a positive angle appears counter clockwise when the local +3
axis is pointing toward you. [deg]

## Remarks

This function retrieves the local axis angle assignment for plane elements.

The function returns zero if the assignment is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetPlaneElementLocalAxisAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Ang As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign area object local axis angle
ret = SapModel.AreaObj.SetLocalAxes("3", 30)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get plane element local axis angle
ret = SapModel.PlaneElm.GetLocalAxes("3", Ang)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetMatTemp

## Syntax

SapObject.SapModel.PlaneElm.GetMatTemp

## VB6 Procedure

Function GetMatTemp(ByVal Name As String, ByRef Temp As Double, ByRef PatternName As
String) As Long

## Parameters

Name

The name of an existing plane element.

Temp

This is the material temperature value assigned to the plane element. [T]

PatternName


This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
plane element is uniform over the element at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the plane
element may vary. The material temperature at each corner point around the plane element
perimeter is equal to the specified temperature multiplied by the pattern value at the associated
point element. The material temperature at other points in the plane element is calculated by
interpolation from the corner points.

## Remarks

This function retrieves the material temperature assignments to plane elements.

The function returns zero if the material temperature assignments are successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetPlaneElementMatTemp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Temp As Double
Dim PatternName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'assign material temperature
ret = SapModel.AreaObj.SetMatTemp("ALL", 50, , Group)

'create analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get material temperature for plane element
ret = SapModel.PlaneElm.GetMatTemp("3", Temp, PatternName)

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetNameList

## Syntax

SapObject.SapModel.PlaneElm.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of plane element names retrieved by the program.

MyName

This is a one-dimensional array of plane element names. The MyName array is created as a
dynamic, zero-based, array by the API user:

Dim MyName() as String

The array is dimensioned to (NumberNames  1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined plane elements.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetPlaneElementNames()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 3-001-incomp.sdb")

'create the analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get plane element names
ret = SapModel.PlaneElm.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# AddByCoord

## Syntax

SapObject.SapModel.CableObj.AddByCoord

## VB6 Procedure

Function AddByCoord(ByVal xi As Double, ByVal yi As Double, ByVal zi As Double, ByVal xj
As Double, ByVal yj As Double, ByVal zj As Double, ByRef Name As String, Optional ByVal


PropName As String = "Default", Optional ByVal UserName As String = "", Optional ByVal
CSys As String = "Global") As Long

## Parameters

xi, yi, zi

The coordinates of the I-End of the added cable object. The coordinates are in the coordinate
system defined by the CSys item.

xj, yj, zj

The coordinates of the J-End of the added cable object. The coordinates are in the coordinate
system defined by the CSys item.

Name

This is the name that the program ultimately assigns for the cable object. If no UserName is
specified,n the program assigns a default name to the cable object. If a UserName is specified and
that name is not used for another frame, cable or tendon object, the UserName is assigned to the
cable object; otherwise a default name is assigned to the cable object.

PropName

This is Default or the name of a defined cable property.

If it is Default, the program assigns a default cable property to the cable object. If it is the name of
a defined cable property, that property is assigned to the cable object.

UserName

This is an optional user specified name for the cable object. If a UserName is specified and that
name is already used for another cable object, the program ignores the UserName.

CSys

The name of the coordinate system in which the cable object end point coordinates are defined.

## Remarks

This function adds a new cable object whose end points are at the specified coordinates.

The function returns zero if the cable object is successfully added, otherwise it returns a nonzero
value.

## VBA Example

Sub AddCableObjByCoord()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by coordinates
ret = SapModel.CableObj.AddByCoord(-300, 0, 0, -100, 0, 124, Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByPoint

SetCableData

# AddByPoint

## Syntax

SapObject.SapModel.CableObj.AddByPoint

## VB6 Procedure

Function AddByPoint(ByVal Point1 as String, ByVal Point2 as String, ByRef Name As String,
Optional ByVal PropName As String = "Default", Optional ByVal UserName As String = "") As
Long


## Parameters

Point1

The name of a defined point object at the I-End of the added cable object.

Point2

The name of a defined point object at the J-End of the added cable object.

Name

This is the name that the program ultimately assigns for the cable object. If no UserName is
specified, the program assigns a default name to the cable object. If a UserName is specified and
that name is not used for another frame, cable or tendon object, the UserName is assigned to the
cable object; otherwise a default name is assigned to the cable object.

PropName

This is Default or the name of a defined cable property.

If it is Default, the program assigns a default cable property to the cable object. If it is the name of
a defined cable property, that property is assigned to the cable object.

UserName

This is an optional user specified name for the cable object. If a UserName is specified and that
name is already used for another cable object, the program ignores the UserName.

## Remarks

This function adds a new cable object whose end points are specified by name.

The function returns zero if the cable object is successfully added, otherwise it returns a nonzero
value.

## VBA Example

Sub AddCableObjByPoint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

SetCableData

# ChangeName

## Syntax

SapObject.SapModel.CableObj.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined cable object.

NewName

The new name for the cable object.


## Remarks

The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeCableObjName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'change name
ret = SapModel.CableObj.ChangeName(Name, "MyCable")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Count


## Syntax

SapObject.SapModel.CableObj.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns a count of the cable objects in the model.

## VBA Example

Sub CountCableObjects()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'return number of cable objects
Count = SapModel.CableObj.Count

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.CableObj.Delete

## VB6 Procedure

Function Delete(ByVal Name As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters

Name

The name of an existing cable object or group depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the cable object specified by the Name item is deleted.

If this item is Group, the all cable objects in the group specified by the Name item are deleted.

If this item is SelectedObjects, all selected cable objects are deleted, and the Name item is
ignored.

## Remarks

The function deletes cable objects.

The function returns zero if the cable objects are successfully deleted, otherwise it returns a
nonzero value.


## VBA Example

Sub DeleteCableObj()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable objects by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name1)
ret = SapModel.CableObj.AddByPoint("5", "10", Name2)

'delete cable object
ret = SapModel.CableObj.Delete(Name1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

AddByPoint

# DeleteLoadDeformation


## Syntax

SapObject.SapModel.CableObj.DeleteLoadDeformation

## VB6 Procedure

Function DeleteLoadDeformation(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the cable object specified by the Name
item.

If this item is Group, the load assignments are deleted for all cable objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected cable objects, and
the Name item is ignored.

## Remarks

This function deletes the deformation load assignments to the specified cable objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteCableDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable deformation loads
ret = SapModel.CableObj.SetLoadDeformation("ALL", "DEAD", 2, Group)

'delete cable deformation load
ret = SapModel.CableObj.DeleteLoadDeformation(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDeformation

SetLoadDeformation


# DeleteLoadDistributed

## Syntax

SapObject.SapModel.CableObj.DeleteLoadDistributed

## VB6 Procedure

Function DeleteLoadDistributed(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the cable object specified by the Name
item.

If this item is Group, the load assignments are deleted for all cable objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected cable objects, and
the Name item is ignored.

## Remarks

This function deletes the distributed load assignments to the specified cable objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example


Sub DeleteCableDistributedLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable distributed load
ret = SapModel.CableObj.SetLoadDistributed(Name, "DEAD", 1, 10, 0.08)

'delete cable distributed load
ret = SapModel.CableObj.DeleteLoadDistributed(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDistributed

SetLoadDistributed


# DeleteLoadDistributedWithGUID

## Syntax

SapObject.SapModel.CableObj.DeleteLoadDistributedWithGUID

## VB6 Procedure

Function DeleteLoadDistributedWithGUID(ByVal Name As String, ByVal GUID As String) As
Long

## Parameters

Name

The name of an existing cable object.

GUID

The global unique ID of one of the distributed loads on that cable object.

## Remarks

This function deletes the distributed load assignment with the specified global unique ID for the
specified cable object.

The function returns zero if the load assignment is successfully deleted, otherwise it returns a
nonzero value.

## Release Notes

Initial release in version 17.2.0.

## See Also

GetLoadDistributedWithGUID

SetLoadDistributedWithGUID

# DeleteLoadGravity

## Syntax

SapObject.SapModel.CableObj.DeleteLoadGravity


## VB6 Procedure

Function DeleteLoadGravity(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the cable object specified by the Name
item.

If this item is Group, the load assignments are deleted for all cable objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected cable objects, and
the Name item is ignored.

## Remarks

This function deletes the gravity load assignments to the specified cable objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteCableGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable gravity loads
ret = SapModel.CableObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'delete cable gravity load
ret = SapModel.CableObj.DeleteLoadGravity(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

SetLoadGravity

# DeleteLoadStrain

## Syntax

SapObject.SapModel.CableObj.DeleteLoadStrain


## VB6 Procedure

Function DeleteLoadStrain(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the cable object specified by the Name
item.

If this item is Group, the load assignments are deleted for all cable objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected cable objects, and
the Name item is ignored.

## Remarks

This function deletes the strain load assignments to the specified cable objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteCableStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable strain load
ret = SapModel.CableObj.SetLoadStrain(Name, "DEAD", 0.001)

'delete cable strain load
ret = SapModel.CableObj.DeleteLoadStrain(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadStrain

SetLoadStrain

# DeleteLoadTargetForce

## Syntax

SapObject.SapModel.CableObj.DeleteLoadTargetForce


## VB6 Procedure

Function DeleteLoadTargetForce(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the cable object specified by the Name
item.

If this item is Group, the load assignments are deleted for all cable objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected cable objects, and
the Name item is ignored.

## Remarks

This function deletes the target force assignments to the specified cable objects for the specified
load pattern.

The function returns zero if the target force assignments are successfully deleted, otherwise it
returns a nonzero value.

## VBA Example

Sub DeleteCableTargetForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable target force
ret = SapModel.CableObj.SetLoadTargetForce(Name, "DEAD", 50, 0.5)

'delete cable target force
ret = SapModel.CableObj.DeleteLoadTargetForce(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTargetForce

SetLoadTargetForce

# DeleteLoadTemperature

## Syntax

SapObject.SapModel.CableObj.DeleteLoadTemperature


## VB6 Procedure

Function DeleteLoadTemperature(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the cable object specified by the Name
item.

If this item is Group, the load assignments are deleted for all cable objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected cable objects, and
the Name item is ignored.

## Remarks

This function deletes the temperature load assignments to the specified cable objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteCableTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable temperature load
ret = SapModel.CableObj.SetLoadTemperature("ALL", "DEAD", 50, , , Group)

'delete cable temperature load
ret = SapModel.CableObj.DeleteLoadTemperature(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTemperature

SetLoadTemperature

# DeleteMass

## Syntax

SapObject.SapModel.CableObj.DeleteMass


## VB6 Procedure

Function DeleteMass(ByVal Name As String, Optional ByVal ItemType As eItemType = Object)
As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the cable mass assignments are deleted for the cable object specified by the
Name item.

If this item is Group, the cable mass assignments are deleted for all cable objects in the group
specified by the Name item.

If this item is SelectedObjects, the cable mass assignments are deleted for all selected cable
objects, and the Name item is ignored.

## Remarks

This function deletes the cable mass assignments for cable objects.

The function returns zero if the mass assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteCableMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable mass
ret = SapModel.CableObj.SetMass("ALL", .0001, False, Group)

'delete cable mass
ret = SapModel.CableObj.DeleteMass(Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMass

SetMass

# DeleteModifiers

## Syntax

SapObject.SapModel.CableObj.DeleteModifiers

## VB6 Procedure

Function DeleteModifiers(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long


## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the cable modifier assignments are deleted for the cable object specified by
the Name item.

If this item is Group, the cable modifier assignments are deleted for all cable objects in the group
specified by the Name item.

If this item is SelectedObjects, the cable modifier assignments are deleted for all selected cable
objects, and the Name item is ignored.

## Remarks

This function deletes the cable modifier assignments for cable objects.

The function returns zero if the modifier assignments are successfully deleted, otherwise it returns
a nonzero value.

## VBA Example

Sub DeleteCableModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign modifiers
ReDim Value(2)
For i = 0 To 2
Value(i) = 1
Next i
Value(0) = 100
ret = SapModel.CableObj.SetModifiers(Name, Value)

'delete modifiers
ret = SapModel.CableObj.DeleteModifiers(Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetModifiers

SetModifiers

# GetCableData

## Syntax

SapObject.SapModel.CableObj.GetCableData

## VB6 Procedure

Function GetCableData(ByRef Name As String, ByRef CableType As Long, ByRef NumSegs As
Long, ByRef Weight As Double, ByRef ProjectedLoad As Double, ByRef UseDeformedGeom As
Boolean, ByRef ModelUsingFrames As Boolean, ByRef Parameter() As Double) As Long


## Parameters

Name

The name of a defined cable object.

CableType

This is 1, 2, 3, 4, 5, 6, 7, 8, or 9, indicating the cable definition parameter.

```
1 = Minimum tension at I-End
2 = Minimum tension at J-End
3 = Tension at I-End
4 = Tension at J-End
5 = Horizontal tension component
6 = Maximum vertical sag
7 = Low-point vertical sag
8 = Undeformed length
9 = Relative undeformed length
```
NumSegs

This is the number of segments into which the program internally divides the cable.

Weight

The added weight per unit length used when calculating the cable shape. [F/L]

ProjectedLoad

The projected uniform gravity load used when calculating the cable shape. [F/L]

UseDeformedGeom

If this item is True, the program uses the deformed geometry for the cable object; otherwise it uses
the undeformed geometry.

ModelUsingFrames

If this item is True, the analysis model uses frame elements to model the cable instead of using
cable elements.

Parameter

This is an array of parameters related to the cable shape. The array is dimensioned by Sap2000.

```
Parameter(0) = Tension at I-End [F]
Parameter(1) = Tension at J-End [F]
Parameter(2) = Horizontal tension component [F]
Parameter(3) = Maximum deformed vertical sag [L]
Parameter(4) = Deformed low-point vertical sag [L]
Parameter(5) = Deformed length [L]
Parameter(6) = Deformed relative length
```

```
Parameter(7) = Maximum undeformed vertical sag [L]
Parameter(8) = Undeformed low-point vertical sag [L]
Parameter(9) = Undeformed length [L]
Parameter(10) = Undeformed relative length
```
## Remarks

This function retrieves definition data for a specified cable object.

The function returns zero if the data is successfully retrieved, otherwise it returns a nonzero value.

## VBA Example

Sub GetCableObjectData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim CableType As Long
Dim NumSegs As Long
Dim Weight As Double
Dim ProjectedLoad As Double
Dim UseDeformedGeom As Boolean
Dim ModelUsingFrames As Boolean
Dim Parameter() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'get cable data
ret = SapModel.CableObj.GetCableData(Name, CableType, NumSegs, Weight,
ProjectedLoad, UseDeformedGeom, ModelUsingFrames, Parameter)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

AddByPoint

SetCableData

GetCableGeometry

# GetCableGeometry

## Syntax

SapObject.SapModel.CableObj.GetCableGeometry

## VB6 Procedure

Function GetCableGeometry(ByRef Name As String, ByRef NumberPoints As Long, ByRef x()
As Double, ByRef y() As Double, ByRef z() As Double, ByRef Sag() As Double, ByRef Dist() As
Double, ByRef RD() As Double, Optional ByVal CSys As String = "Global") As Long

## Parameters

Name

The name of a defined cable object.

NumberPoints

The number of points defining the cable geometry.

x, y, z

The x, y and z coordinates of the considered point on the cable in the coordinate system specified
by the CSys item. [L]

Sag


The cable vertical sag, measured from the chord, at the considered point. [L]

Distance

The distance along the cable, measured from the cable I-End, to the considered point. [L]

RD

The relative distance along the cable, measured from the cable I-End, to the considered point.

CSys

The name of the coordinate system in which the x, y and z coordinates are to be reported.

## Remarks

This function retrieves geometric data for a specified cable object.

The function returns zero if the data is successfully retrieved, otherwise it returns a nonzero value.

## VBA Example

Sub GetCableObjectGeometry()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberPoints As Long
Dim x() As Double
Dim y() As Double
Dim z() As Double
Dim Sag() As Double
Dim Dist() As Double
Dim RD() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points


ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'get cable geometry
ret = SapModel.CableObj.GetCableGeometry(Name, NumberPoints , x, y, z, Sag, Dist, RD)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

AddByPoint

SetCableData

GetCableData

# GetElm

## Syntax

SapObject.SapModel.CableObj.GetElm

## VB6 Procedure

Function GetElm(ByVal Name As String, ByRef nelm As Long, ByRef Elm() as String, ByRef
RDI() As Double, ByRef RDJ() As Double) As Long

## Parameters

Name

The name of an existing cable object.

nelm

The number of line elements created from the specified cable object.


Elm

An array that includes the name of a line element created from the specified cable object.

RDI

An array that includes the relative distance along the cable object to the I-End of the line element.

RDJ

An array that includes the relative distance along the cable object to the J-End of the line element.

## Remarks

This function retrieves the names of the line elements (analysis model lines) associated with a
specified cable object in the object-based model. It also retrieves information about the location of
the line elements along the cable object.

This function returns zero if the line element information is successfully returned; otherwise it
returns nonzero. An error occurs if the analysis model does not currently exist.

## VBA Example

Sub GetLineElementInfoForCableObject()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim nelm As Long
Dim Elm() As String
Dim RDI() As Double
Dim RDJ() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)


'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'create the analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get line element information
ret = SapModel.CableObj.GetElm(Name, nelm, Elm, RDI, RDJ)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetGroupAssign

## Syntax

SapObject.SapModel.CableObj.GetGroupAssign

## VB6 Procedure

Function GetGroupAssign(ByVal Name As String, ByRef NumberGroups As Long, ByRef
Groups() As String) As Long

## Parameters

Name

The name of an existing cable object.

NumberGroups

The number of group names retrieved.

Groups

The names of the groups to which the cable object is assigned.

## Remarks


This function retrieves the names of the groups to which a specified cable object is assigned.

The function returns zero if the group assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetCableObjectGroups()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name1 As String
Dim Name2 As String
Dim NumberGroups As Long
Dim Groups() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name1)
ret = SapModel.CableObj.AddByPoint("5", "10", Name2)

'set cable data
ret = SapModel.CableObj.SetCableData(Name1, 7, 1, 0, 0, 24)
ret = SapModel.CableObj.SetCableData(Name2, 7, 1, 0, 0, 24)

'define new groups
ret = SapModel.GroupDef.SetGroup("Group1")
ret = SapModel.GroupDef.SetGroup("Group2")

'add cable object to groups
ret = SapModel.CableObj.SetGroupAssign(Name1, "Group1")
ret = SapModel.CableObj.SetGroupAssign(Name1, "Group2")

'get cable object groups
ret = SapModel.CableObj.GetGroupAssign(Name1, NumberGroups, Groups)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 20.0.0.

## See Also

SetGroupAssign

# GetGUID

## Syntax

SapObject.SapModel.CableObj.GetGUID

## VB6 Procedure

Function GetGUID(ByVal name As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing cable object.

GUID

The GUID (Global Unique ID) for the specified cable object.

## Remarks

This function retrieves the GUID for the specified cable object.

This function returns zero if the cable object GUID is successfully retrieved; otherwise it returns
nonzero.

## VBA Example

Sub GetCableObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim Name As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'set program created GUID
ret = SapObject.SapModel.CableObj.SetGUID(Name)

'get GUID
ret = SapObject.SapModel.CableObj.GetGUID(Name, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetGUID

# GetLoadDeformation

## Syntax


SapObject.SapModel.CableObj.GetLoadDeformation

## VB6 Procedure

Function GetLoadDeformation(ByVal Name As String, ByRef NumberItems As Long, ByRef
CableName() As String, ByRef LoadPat() As String, ByRef U1() As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

NumberItems

The total number of deformation loads retrieved for the specified cable objects.

CableName

This is an array that includes the name of the cable object associated with each deformation load.

LoadPat

This is an array that includes the name of the load pattern associated with each deformation load.

U1

This is an array of axial deformation load values. [L]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the cable object specified by the Name
item.

If this item is Group, the assignments are retrieved for all cable objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected cable objects, and the
Name item is ignored.

## Remarks

This function retrieves the deformation load assignments to cable objects.


The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetCableDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim CableName() As String
Dim LoadPat() As String
Dim U1() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable deformation loads
ret = SapModel.CableObj.SetLoadDeformation("ALL", "DEAD", 2, Group)

'get cable deformation loads
ret = SapModel.CableObj.GetLoadDeformation(Name, NumberItems, CableName, LoadPat,
U1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadDeformation

DeleteLoadDeformation

# GetLoadDistributed

## Syntax

SapObject.SapModel.CableObj.GetLoadDistributed

## VB6 Procedure

Function GetLoadDistributed(ByVal Name As String, ByRef NumberItems As Long, ByRef
CableName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef CSys() As
String, ByRef Dir() As Long, ByRef ByRef Value() As Double, Optional ByVal ItemType As
eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

NumberItems

The total number of distributed loads retrieved for the specified cable objects.

CableName

This is an array that includes the name of the cable object associated with each distributed load.

LoadPat

This is an array that includes the name of the coordinate system in which the distributed loads are
specified.

MyType

This is an array that includes 1 or 2, indicating the type of distributed load.

```
1 = Force
```

```
2 = Moment
```
CSys

This is an array that includes the name of the coordinate system in which each distributed load is
defined. It may be Local or the name of a defined coordinate system.

Dir

This is 1, 2, 3, 4, 5, 6 or 10, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10) is in the negative Global Z direction.

Value

This is the load value of the distributed load. The distributed load is applied over the full length of
the cable. [F/L] when MyType is 1 and [FL/L] when MyType is 2

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the cable object specified by the Name
item.

If this item is Group, the assignments are retrieved for all cable objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected cable objects, and the
Name item is ignored.

## Remarks

This function retrieves the distributed load assignments to cable objects. The loads are uniformly
distributed over the full length of cable objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.


## VBA Example

Sub GetCableDistributedLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim CableName() As String
Dim LoadPat() As String
Dim MyType() As Long
Dim CSys() As String
Dim Dir() As Long
Dim Value() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable distributed load
ret = SapModel.CableObj.SetLoadDistributed(Name, "DEAD", 1, 10, 0.08)

'get cable distributed loads
ret = SapModel.CableObj.GetLoadDistributed("ALL", NumberItems, CableName, LoadPat,
MyType, CSys, Dir, Value, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadDistributed

DeleteLoadDistributed

# GetLoadDistributedWithGUID

## Syntax

SapObject.SapModel.CableObj.GetLoadDistributedWithGUID

## VB6 Procedure

Function GetLoadDistributedWithGUID(ByVal Name As String, ByRef NumberItems As Long,
ByRef CableName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef
CSys() As String, ByRef Dir() As Long, ByRef Value() As Double, ByRefGUID() As String,
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

NumberItems

The total number of distributed loads retrieved for the specified cable objects.

CableName

This is an array that includes the name of the cable object associated with each distributed load.

LoadPat

This is an array that includes the name of the coordinate system in which the distributed loads are
specified.

MyType

This is an array that includes 1 or 2, indicating the type of distributed load.

```
1 = Force
```

```
2 = Moment
```
CSys

This is an array that includes the name of the coordinate system in which each distributed load is
defined. It may be Local or the name of a defined coordinate system.

Dir

This is 1, 2, 3, 4, 5, 6 or 10, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10) is in the negative Global Z direction.

Value

This is the load value of the distributed load. The distributed load is applied over the full length of
the cable. [F/L] when MyType is 1 and [FL/L] when MyType is 2

GUID

This is an array that includes the global unique ID of each load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the cable object specified by the Name
item.

If this item is Group, the assignments are retrieved for all cable objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected cable objects, and the
Name item is ignored.

## Remarks


This function retrieves the distributed load assignments to cable objects. The loads are uniformly
distributed over the full length of cable objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## Release Notes

Initial release in version 17.2.0.

## See Also

SetLoadDistributedWithGUID

DeleteLoadDistributedWithGUID

# GetLoadGravity

## Syntax

SapObject.SapModel.CableObj.GetLoadGravity

## VB6 Procedure

Function GetLoadGravity(ByVal Name As String, ByRef NumberItems As Long, ByRef
CableName() As String, ByRef LoadPat() As String, ByRef CSys() As String, ByRef x() As
Double, ByRef y() As Double, ByRef z() As Double, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

NumberItems

The total number of gravity loads retrieved for the specified cable objects.

CableName

This is an array that includes the name of the cable object associated with each gravity load.

LoadPat

This is an array that includes the name of the coordinate system in which the gravity load
multipliers are specified.

CSys


This is an array that includes the name of the coordinate system associated with each gravity load.

x, y, z

These are arrays of gravity load multipliers in the x, y and z directions of the specified coordinate
system.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the cable object specified by the Name
item.

If this item is Group, the assignments are retrieved for all cable objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected cable objects, and the
Name item is ignored.

## Remarks

This function retrieves the gravity load assignments to cable objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetCableGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim CableName() As String
Dim LoadPat() As String
Dim CSys() As String
Dim x() As Double
Dim y() As Double
Dim z() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable gravity loads
ret = SapModel.CableObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'get cable gravity load
ret = SapModel.CableObj.GetLoadGravity(Name, NumberItems, CableName, LoadPat, CSys,
x, y, z)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadGravity

DeleteLoadGravity

# GetLoadStrain

## Syntax

SapObject.SapModel.CableObj.GetLoadStrain


## VB6 Procedure

Function GetLoadStrain(ByVal Name As String, ByRef NumberItems As Long, ByRef
CableName() As String, ByRef LoadPat() As String, ByRef Strain() As Double, ByRef
PatternName() As String, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

NumberItems

The total number of strain loads retrieved for the specified cable objects.

CableName

This is an array that includes the name of the cable object associated with each strain load.

LoadPat

This is an array that includes the name of the load pattern associated with each strain load.

Strain

This is an array that includes the axial strain value. [L/L]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the strain load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the cable object specified by the Name
item.

If this item is Group, the assignments are retrieved for all cable objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected cable objects, and the
Name item is ignored.

## Remarks

This function retrieves the strain load assignments to cable objects.


The function returns zero if the strain load assignments are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetCableStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim CableName() As String
Dim LoadPat() As String
Dim Strain() As Double
Dim PatternName() As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable strain load
ret = SapModel.CableObj.SetLoadStrain(Name, "DEAD", 0.001)

'get cable strain load
ret = SapModel.CableObj.GetLoadStrain(Name, NumberItems, CableName, LoadPat,
Strain,PatternName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadStrain

DeleteLoadStrain

# GetLoadTargetForce

## Syntax

SapObject.SapModel.CableObj.GetLoadTargetForce

## VB6 Procedure

Function GetLoadTargetForce(ByVal Name As String, ByRef NumberItems As Long, ByRef
CableName() As String, ByRef LoadPat() As String, ByRef P() As Double, ByRef RD() As
Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

NumberItems

The total number of deformation loads retrieved for the specified cable objects.

CableName

This is an array that includes the name of the cable object associated with each target force.

LoadPat

This is an array that includes the name of the load pattern associated with each target force.

P

This is an array of axial target force values. [F]

RD


This is an array of the relative distances along the cable objects where the axial target force values
apply.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the cable object specified by the Name
item.

If this item is Group, the assignments are retrieved for all cable objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected cable objects, and the
Name item is ignored.

## Remarks

This function retrieves the target force assignments to cable objects.

The function returns zero if the target force assignments are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetCableTargetForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim CableName() As String
Dim LoadPat() As String
Dim P() As double
Dim RD() As double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable target force
ret = SapModel.CableObj.SetLoadTargetForce(Name, "DEAD", 50, 0.5)

'get cable target force
ret = SapModel.CableObj.GetLoadTargetForce(Name, NumberItems, CableName, LoadPat,
P, RD)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadTargetForce

DeleteLoadTargetForce

# GetLoadTemperature

## Syntax

SapObject.SapModel.CableObj.GetLoadTemperature

## VB6 Procedure

Function GetLoadTemperature(ByVal Name As String, ByRef NumberItems As Long, ByRef
CableName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef Val() As
Double, ByRef PatternName() As String, Optional ByVal ItemType As eItemType = Object) As
Long


## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

NumberItems

The total number of temperature loads retrieved for the specified cable objects.

CableName

This is an array that includes the name of the cable object associated with each temperature load.

LoadPat

This is an array that includes the name of the load pattern associated with each temperature load.

Val

This is an array that includes the temperature load value. [T]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the temperature load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the cable object specified by the Name
item.

If this item is Group, the assignments are retrieved for all cable objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected cable objects, and the
Name item is ignored.

## Remarks

This function retrieves the temperature load assignments to cable objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example


Sub GetCableTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim CableName() As String
Dim LoadPat() As String
Dim Val() As Double
Dim PatternName() As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable temperature load
ret = SapModel.CableObj.SetLoadTemperature("ALL", "DEAD", 50, , , Group)

'get cable temperature load
ret = SapModel.CableObj.GetLoadTemperature("ALL", NumberItems, CableName, LoadPat,
Val, PatternName, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

SetLoadTemperature

DeleteLoadTemperature

# GetMass

## Syntax

SapObject.SapModel.CableObj.GetMass

## VB6 Procedure

Function GetMass(ByVal Name As String, ByRef MassOverL As Double) As Long

## Parameters

Name

The name of an existing cable object.

MassOverL

The mass per unit length assigned to the cable object. [M/L]

## Remarks

This function retrieves the mass per unit length assignment for cable objects.

The function returns zero if the mass assignment is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetCableMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MassOverL As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable mass
ret = SapModel.CableObj.SetMass("ALL", .0001, False, Group)

'get cable mass assignment
ret = SapModel.CableObj.GetMass(Name, MassOverL)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetMass

DeleteMass

# GetMaterialOverwrite

## Syntax

SapObject.SapModel.CableObj.GetMaterialOverwrite

## VB6 Procedure

Function GetMaterialOverwrite(ByVal Name As String, ByRef PropName As String) As Long


## Parameters

Name

The name of a defined cable object.

PropName

This is None, indicating that no material overwrite exists for the specified cable object, or it is the
name of an existing material property.

## Remarks

This function retrieves the material overwrite assigned to a cable object, if any. It returns None if
there is no material overwrite assignment.

The function returns zero if the material overwrite assignment is successfully retrieved, otherwise
it returns a nonzero value.

## VBA Example

Sub GetCableMaterialOverwrite()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropName As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by coordinates
ret = SapModel.CableObj.AddByCoord(-300, 0, 0, -100, 0, 124, Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign material overwrite


ret = SapModel.CableObj.SetMaterialOverwrite(Name, "4000Psi")

'get material overwrite assignment
ret = SapModel.CableObj.GetMaterialOverwrite(Name, PropName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetMaterialOverwrite

# GetMatTemp

## Syntax

SapObject.SapModel.CableObj.GetMatTemp

## VB6 Procedure

Function GetMatTemp(ByVal Name As String, ByRef Temp As Double, ByRef PatternName As
String) As Long

## Parameters

Name

The name of an existing cable object.

Temp

This is the material temperature value assigned to the cable object. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
cable object is uniform along the object at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the cable object
may vary from one end to the other. The material temperature at each end of the object is equal to
the specified temperature multiplied by the pattern value at the joint at the end of the cable object.


## Remarks

This function retrieves the material temperature assignments to cable objects.

The function returns zero if the material temperature assignments are successfully retrieved,
otherwise it returns a nonzero value.

## VBA Example

Sub GetCableMatTemp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Temp As Double
Dim PatternName As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign material temperature
ret = SapModel.CableObj.SetMatTemp("ALL", 50, , Group)

'get material temperature
ret = SapModel.CableObj.GetMatTemp(Name, Temp, PatternName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

SetMatTemp

# GetModifiers

## Syntax

SapObject.SapModel.CableObj.GetModifiers

## VB6 Procedure

Function GetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing cable object.

Value

This is an array of three unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Mass modifier
Value(2) = Weight modifier
```
## Remarks

This function retrieves the cable modifier assignment for cable objects. The default value for all
modifiers is one.

The function returns zero if the modifier assignments are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetCableModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long


Dim Value() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign modifiers
ReDim Value(2)
For i = 0 To 2
Value(i) = 1
Next i
Value(0) = 100
ret = SapModel.CableObj.SetModifiers(Name, Value)

'get modifiers
ReDim Value(2)
ret = SapModel.CableObj.GetModifiers(Name, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetModifiers

DeleteModifiers


# GetNameList

## Syntax

SapObject.SapModel.CableObj.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of cable object names retrieved by the program.

MyName

This is a one-dimensional array of cable object names. The MyName array is created as a
dynamic, zero-based, array by the APIuser:

Dim MyName() as String

The array is dimensioned to (NumberNames  1) inside the Sap2000 program, filled with the
names, and returned to the APIuser.

## Remarks

This function retrieves the names of all defined cable objects.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetCableObjectNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name1)
ret = SapModel.CableObj.AddByPoint("5", "10", Name2)

'set cable data
ret = SapModel.CableObj.SetCableData(Name1, 7, 1, 0, 0, 24)
ret = SapModel.CableObj.SetCableData(Name2, 7, 1, 0, 0, 24)

'get cable object names
ret = SapModel.CableObj.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetOutputStations

## Syntax

SapObject.SapModel.CableObj.GetOutputStations

## VB6 Procedure

Function GetOutputStations(ByVal Name As String, ByRef MyType As Long, ByRef
MaxSegSize As Double, ByRef MinSections As Long, ByRef
NoOutPutAndDesignAtElementEnds As Boolean, ByRef NoOutPutAndDesignAtPointLoads As
Boolean) As Long


## Parameters

Name

The name of an existing cable object.

MyType

This is 1 or 2, indicating how the output stations are specified.

```
1 = maximum segment size, that is, maximum station spacing
2 = minimum number of stations
```
MaxSegSize

The maximum segment size, that is, the maximum station spacing. This item applies only when
MyType = 1. [L]

MinSections

The minimum number of stations. This item applies only when MyType = 2.

NoOutPutAndDesignAtElementEnds

If this item is True, no additional output stations are added at the ends of line elements when the
cable object is internally meshed.

NoOutPutAndDesignAtPointLoads

If this item is True, no additional output stations are added at point load locations.

## Remarks

This function retrieves cable object output station data.

The function returns zero if the data is successfully retrieved, otherwise it returns a nonzero value.

## VBA Example

Sub GetCableOutputStationData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As Long
Dim MaxSegSize As Double
Dim MinSections As Long
Dim NoOutPutAndDesignAtElementEnds As Boolean
Dim NoOutPutAndDesignAtPointLoads As Boolean
Dim Name As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'get cable output station data
ret = SapModel.CableObj.GetOutputStations(Name, MyType, MaxSegSize, MinSections,
NoOutPutAndDesignAtElementEnds, NoOutPutAndDesignAtPointLoads)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetOutputStations

# GetPoints

## Syntax

SapObject.SapModel.CableObj.GetPoints

## VB6 Procedure

Function GetPoints(ByVal Name As String, ByRef Point1 As String, ByRef Point2 As String) As
Long


## Parameters

Name

The name of a defined cable object.

Point1

The name of the point object at the I-End of the specified cable object.

Point2

The name of the point object at the J-End of the specified cable object.

## Remarks

This function retrieves the names of the point objects at each end of a specified cable object.

The function returns zero if the point names are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetCableObjPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Point1 As String
Dim Point2 As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by coordinates
ret = SapModel.CableObj.AddByCoord(-300, 0, 0, -100, 0, 124, Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)


'get names of points
ret = SapModel.CableObj.GetPoints(Name, Point1, Point2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetProperty

## Syntax

SapObject.SapModel.CableObj.GetProperty

## VB6 Procedure

Function GetProperty(ByVal Name As String, ByRef PropName As String) As Long

## Parameters

Name

The name of a defined cable object.

PropName

The name of the cable property assigned to the cable object.

## Remarks

This function retrieves the cable property assigned to a cable object.

The function returns zero if the cable object property is successfully retrieved, otherwise it returns
a nonzero value.

## VBA Example

Sub GetCableSectionProp()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropName As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'get cable property
ret = SapModel.CableObj.GetProperty(Name, PropName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetProperty

# GetSelected

## Syntax

Sap2000.CableObj.GetSelected


## VB6 Procedure

Function GetSelected(ByVal Name As String, ByRef Selected As Boolean) As Long

## Parameters

Name

The name of an existing cable object.

Selected

This item returns True if the specified cable object is selected, otherwise it returns False.

## Remarks

This function retrieves the selected status for a cable object.

The function returns zero if the selected status is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetCableObjectSelectedStatus()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Selected As Boolean
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name1)
ret = SapModel.CableObj.AddByPoint("5", "10", Name2)


'set cable data
ret = SapModel.CableObj.SetCableData(Name1, 7, 1, 0, 0, 24)
ret = SapModel.CableObj.SetCableData(Name2, 7, 1, 0, 0, 24)

'set all cables selected
ret = SapModel.CableObj.SetSelected("All", True, Group)

'get cable object selected status
ret = SapModel.CableObj.GetSelected(Name1, Selected)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSelected

# GetTransformationMatrix

## Syntax

Sap2000.CableObj.GetTransformationMatrix

## VB6 Procedure

Function GetTransformationMatrix(ByVal Name As String, ByRef Value() As Double,Optional
ByVal IsGlobal As Boolean = True) As Long

## Parameters

Name

The name of an existing cable object.

Value

Value is an array of nine direction cosines that define the transformation matrix.

The following matrix equation shows how the transformation matrix is used to convert items from
the cable object local coordinate system to the global coordinate system.


In the equation, c0 through c8 are the nine values from the transformation array, (Local1, Local2,
Local3) are an item (such as a load) in the object local coordinate system, and (GlobalX, GlobalY,
GlobalZ) are the same item in the global coordinate system.

The transformation from the local coordinate system to the present coordinate system is the same
as that shown above for the global system if you substitute the present system for the global
system.

IsGlobal

If this item is True, the transformation matrix is between the Global coordinate system and the
cable object local coordinate system.

If this item is False, the transformation matrix is between the present coordinate system and the
cable object local coordinate system.

## Remarks

The function returns zero if the cable object transformation matrix is successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetCableObjectMatrix()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'get cable object transformation matrix
ReDim Value(8)
ret = SapModel.CableObj.GetTransformationMatrix(Name, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# SetCableData

## Syntax

SapObject.SapModel.CableObj.SetCableData

## VB6 Procedure

Function SetCableData(ByVal Name As String, ByVal CableType As Long, ByVal NumSegs As
Long, ByVal Weight As Double, ByVal ProjectedLoad As Double, ByVal Value As Double,
Optional ByVal UseDeformedGeom As Boolean = False, Optional ByVal ModelUsingFrames As
Boolean = False) As Long

## Parameters

Name

The name of a defined cable object.

CableType

This is 1, 2, 3, 4, 5, 6, 7, 8, or 9, indicating the cable definition parameter.

```
1 = Minimum tension at I-End
2 = Minimum tension at J-End
```

```
3 = Tension at I-End
4 = Tension at J-End
5 = Horizontal tension component
6 = Maximum vertical sag
7 = Low-point vertical sag
8 = Undeformed length
9 = Relative undeformed length
```
NumSegs

This is the number of segments into which the program internally divides the cable.

Weight

The added weight per unit length used when calculating the cable shape. [F/L]

ProjectedLoad

The projected uniform gravity load used when calculating the cable shape. [F/L]

Value

This is the value of the parameter used to define the cable shape. The item that Value represents
depends on the CableType item.

```
CableType = 1: Not Used
CableType = 2: Not Used
CableType = 3: Tension at I-End [F]
CableType = 4: Tension at J-End [F]
CableType = 5: Horizontal tension component [F]
CableType = 6: Maximum vertical sag [L]
CableType = 7: Low-point vertical sag [L]
CableType = 8: Undeformed length [L]
CableType = 9: Relative undeformed length
```
UseDeformedGeom

If this item is True, the program uses the deformed geometry for the cable object; otherwise it uses
the undeformed geometry.

ModelUsingFrames

If this item is True, the analysis model uses frame elements to model the cable instead of using
cable elements.

## Remarks

This function assigns the cable definition parameters to a cable object.

The function returns zero if the cable object is successfully defined; otherwise it returns a nonzero
value. If the cable object is not successfully defined, it may be deleted.


## VBA Example

Sub SetCableDefinitionData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Modified optional arguments UseDeformedGeom and ModelUsingFrames to both be ByVal in
version 12.0.1.

## See Also

AddByCoord

AddByPoint

GetCableData


GetCableGeometry

# SetGroupAssign

## Syntax

SapObject.SapModel.CableObj.SetGroupAssign

## VB6 Procedure

Function SetGroupAssign(ByVal Name As String, ByVal GroupName As String, Optional By
Val Remove As Boolean = False, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

GroupName

The name of an existing group to which the assignment is made.

Remove

If this item is False, the specified cable objects are added to the group specified by the
GroupName item. If it is True, the cable objects are removed from the group.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the cable object specified by the Name item is added or removed from the
group specified by the GroupName item.

If this item is Group, all cable objects in the group specified by the Name item are added or
removed from the group specified by the GroupName item.

If this item is SelectedObjects, all selected cable objects are added or removed from the group
specified by the GroupName item, and the Name item is ignored.

## Remarks

This function adds or removes cable objects from a specified group.


The function returns zero if the group assignment is successful, otherwise it returns a nonzero
value.

## VBA Example

Sub AddCableObjectsToGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name1)
ret = SapModel.CableObj.AddByPoint("5", "10", Name2)

'set cable data
ret = SapModel.CableObj.SetCableData(Name1, 7, 1, 0, 0, 24)
ret = SapModel.CableObj.SetCableData(Name2, 7, 1, 0, 0, 24)

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'add cable objects to group
ret = SapModel.CableObj.SetGroupAssign(Name1, "Group1")
ret = SapModel.CableObj.SetGroupAssign(Name2, "Group1")

'select objects in group
ret = SapModel.SelectObj.Group("Group1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetGroupAssign

# SetGUID

## Syntax

SapObject.SapModel.CableObj.SetGUID

## VB6 Procedure

Function SetGUID(ByVal Name As String, Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing cable object.

GUID

The GUID (Global Unique ID) for the specified cable object.

## Remarks

This function sets the GUID for the specified cable object. If the GUID is passed in as a blank
string, the program automatically creates a GUID for the object.

This function returns zero if the cable object GUID is successfully set; otherwise it returns
nonzero.

## VBA Example

Sub SetCableObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim GUID As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'set program created GUID
ret = SapObject.SapModel.CableObj.SetGUID(Name)

'get GUID
ret = SapObject.SapModel.CableObj.GetGUID(Name, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetGUID

# SetLoadDeformation

## Syntax

SapObject.SapModel.CableObj.SetLoadDeformation

## VB6 Procedure


Function SetLoadDeformation(ByVal Name As String, ByVal LoadPat As String, ByRef d As
Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

d

This is the axial deformation load value. [L]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks

This function assigns deformation loads to cable objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignCableDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable deformation loads
ret = SapModel.CableObj.SetLoadDeformation("ALL", "DEAD", 2, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDeformation

DeleteLoadDeformation

# SetLoadDistributed

## Syntax

SapObject.SapModel.CableObj.SetLoadDistributed

## VB6 Procedure


Function SetLoadDistributed(ByVal Name As String, ByVal LoadPat As String, ByVal MyType
As Long, ByVal Dir As Long, ByVal Value As Double, Optional ByVal CSys As String =
"Global", Optional ByVal Replace As Boolean = True, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

MyType

This is 1 or 2, indicating the type of distributed load.

```
1 = Force per unit length
2 = Moment per unit length
```
Dir

This is 1, 2, 3, 4, 5, 6 or 10, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10) is in the negative Global Z direction.

Value

This is the load value of the distributed load. The distributed load is applied over the full length of
the cable. [F/L] when MyType is 1 and [FL/L] when MyType is 2

CSys

This is Local or the name of a defined coordinate system. It is the coordinate system in which the
loads are specified.

Replace

If this item is True, all previous loads, if any, assigned to the specified cable object(s), in the
specified load pattern, are deleted before making the new assignment.

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks

This function assigns uniform distributed loads over the full length of cable objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignCableDistributedLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)


'assign cable distributed load
ret = SapModel.CableObj.SetLoadDistributed(Name, "DEAD", 1, 10, 0.08)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDistributed

DeleteLoadDistributed

# SetLoadDistributedWithGUID

## Syntax

SapObject.SapModel.CableObj.SetLoadDistributedWithGUID

## VB6 Procedure

Function SetLoadDistributedWithGUID (ByVal Name As String, ByVal LoadPat As String,
ByVal MyType As Long, ByVal Dir As Long, ByVal Value As Double, ByRef GUID As String,
Optional ByVal CSys As String = "Global", Optional ByVal Replace As Boolean = True) As
Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

MyType

This is 1 or 2, indicating the type of distributed load.


```
1 = Force per unit length
2 = Moment per unit length
```
Dir

This is 1, 2, 3, 4, 5, 6 or 10, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10) is in the negative Global Z direction.

Value

This is the load value of the distributed load. The distributed load is applied over the full length of
the cable. [F/L] when MyType is 1 and [FL/L] when MyType is 2

GUID

This is the global unique ID of a distributed load assigned to the cable object or if it is not the
global unique ID of a distributed load assigned to the cable object and it is not blank, the global
unique ID which is assigned to the newly assigned load. If left blank, a new load assigned to the
cable object and the value of this parameter is set to the global unique ID of the newly assigned
load.

CSys

This is Local or the name of a defined coordinate system. It is the coordinate system in which the
loads are specified.

Replace

If this item is True and the input GUID is not the GUID of any distributed load assigned to the
cable object, all previous distributed loads, if any, assigned to the specified cable object, in the
specified load pattern, are deleted before making the new assignment. If the input GUID is the
GUID of a distributed load already assigned to the frame object, the parameters of the distributed
load are updated with the values provided and this item is ignored.

If this item is True, all previous loads, if any, assigned to the specified cable object(s), in the
specified load pattern, are deleted before making the new assignment.

## Remarks

If the cable object is already assigned a distributed load with a global unique ID matching the
specified global unique ID, this function modifies that distributed load. Otherwise, this function
assigns a new distributed load over the full length of the cable object and sets its global unique ID
to the specified global unique ID.


This function assigns uniform distributed loads over the full length of cable objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## Release Notes

Initial release in version 17.2.0.

## See Also

GetLoadDistributedWithGUID

DeleteLoadDistributedWithGUID

# SetLoadGravity

## Syntax

SapObject.SapModel.CableObj.SetLoadGravity

## VB6 Procedure

Function SetLoadGravity(ByVal Name As String, ByVal LoadPat As String, ByVal x As Double,
ByVal y As Double, ByVal z As Double, Optional ByVal Replace As Boolean = True, Optional
ByVal CSys As String = "Global", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

x, y, z

These are the gravity load multipliers in the x, y and z directions of the specified coordinate
system.

Replace

If this item is True, all previous gravity loads, if any, assigned to the specified cable object(s), in
the specified load pattern, are deleted before making the new assignment.

CSys

The coordinate system in which the x, y and z multipliers are specified.


ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks

This function assigns gravity load multipliers to cable objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignCableGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data


ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable gravity loads
ret = SapModel.CableObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

DeleteLoadGravity

# SetLoadStrain

## Syntax

SapObject.SapModel.CableObj.SetLoadStrain

## VB6 Procedure

Function SetLoadStrain(ByVal Name As String, ByVal LoadPat As String, ByVal Strain As
Double, Optional ByVal Replace As Boolean = True, Optional ByVal PatternName As String =
"", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Strain

This is the axial strain load value. [L/L]


Replace

If this item is True, all previous strain loads, if any, assigned to the specified cable object(s), in the
specified load pattern, are deleted before making the new assignment.

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the strain load for the cable
object is uniform along the object at the value specified by Strain.

If PatternName is the name of a defined joint pattern, the strain load for the cable object is based
on the specified strain value multiplied by the pattern value at the joints at each end of the cable
object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks

This function assigns strain loads to cable objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignCableStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create apModel object
Set SapModel = SapObject.SapModel

'initialize model
ret= SapModel.InitializeNewModel

'create model from template
ret= SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret= SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret= SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable strain load
ret= SapModel.CableObj.SetLoadStrain(Name, "DEAD", 0.001)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadStrain

DeleteLoadStrain

# SetLoadTargetForce

## Syntax

SapObject.SapModel.CableObj.SetLoadTargetForce

## VB6 Procedure

Function SetLoadTargetForce(ByVal Name As String, ByVal LoadPat As String, ByRef P As
Double, ByRef RD As Double, Optional ByVal ItemType As eItemType = Object) As Long


## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

P

This is the axial target force value. [F]

RD

This is the relative distance along the cable object to the location where the target force value
applies. The relative distance must be between 0 and 1, 0 <= RD <=1.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks

This function assigns target forces to cable objects.

The function returns zero if the target forces are successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignCableTargetForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable target force
ret = SapModel.CableObj.SetLoadTargetForce(Name, "DEAD", 50, 0.5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTargetForce

DeleteLoadTargetForce

# SetLoadTemperature

## Syntax

SapObject.SapModel.CableObj.SetLoadTemperature


## VB6 Procedure

Function SetLoadTemperature(ByVal Name As String, ByVal LoadPat As String, ByVal Val As
Double, Optional ByVal PatternName As String = "", Optional ByVal Replace As Boolean =
True, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Val

This is the temperature change value. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the temperature load for the
cable object is uniform along the object at the value specified by Val.

If PatternName is the name of a defined joint pattern, the temperature load for the cable object is
based on the specified temperature value multiplied by the pattern value at the joints at each end
of the cable object.

Replace

If this item is True, all previous temperature loads, if any, assigned to the specified cable object(s),
in the specified load case, are deleted before making the new assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks


This function assigns temperature loads to cable objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignCableTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable temperature load
ret = SapModel.CableObj.SetLoadTemperature("ALL", "DEAD", 50, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetLoadTemperature

DeleteLoadTemperature

# SetMass

## Syntax

SapObject.SapModel.CableObj.SetMass

## VB6 Procedure

Function SetMass(ByVal Name As String, ByVal MassOverL As Double, Optional ByVal
Replace As Boolean = False, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

MassOverL

The mass per unit length assigned to the cable object. [M/L]

Replace

If this item is True, all existing mass assignments to the cable object are removed before assigning
the specified mas. If it is False, the specified mass is added to any mass already assigned to the
cable object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.


## Remarks

This function assigns mass per unit length to cable objects.

The function returns zero if the mass is successfully assigned, otherwise it returns a nonzero value.

## VBA Example

Sub AssignCableMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign cable mass
ret = SapModel.CableObj.SetMass("ALL", .0001, False, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

GetMass

DeleteMass

# SetMaterialOverwrite

## Syntax

SapObject.SapModel.CableObj.SetMaterialOverwrite

## VB6 Procedure

Function SetMaterialOverwrite(ByVal Name As String, ByVal PropName As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

PropName

This is None or a blank string, indicating that any existing material overwrites assigned to the
specified cable objects are to be removed, or it is the name of an existing material property.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks

This function sets the material overwrite assignment for cable objects.


The function returns zero if the material overwrite assignment is successfully assigned, otherwise
it returns a nonzero value.

## VBA Example

Sub AssignCableMaterialOverwrite()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by coordinates
ret = SapModel.CableObj.AddByCoord(-300, 0, 0, -100, 0, 124, Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign material overwrite
ret = SapModel.CableObj.SetMaterialOverwrite(Name, "4000Psi")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMaterialOverwrite


# SetMatTemp

## Syntax

SapObject.SapModel.CableObj.SetMatTemp

## VB6 Procedure

Function SetMatTemp(ByVal Name As String, ByVal Temp As Double, Optional ByVal
PatternName As String = "", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

Temp

This is the material temperature value assigned to the cable object. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
cable object is uniform along the object at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the cable object
may vary from one end to the other. The material temperature at each end of the object is equal to
the specified temperature multiplied by the pattern value at the joint at the end of the cable object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks

This function assigns material temperatures to cable objects.


The function returns zero if the material temperatures are successfully assigned, otherwise it
returns a nonzero value.

## VBA Example

Sub AssignCableMatTemp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign material temperature
ret = SapModel.CableObj.SetMatTemp("ALL", 50, , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMatTemp


# SetModifiers

## Syntax

SapObject.SapModel.CableObj.SetModifiers

## VB6 Procedure

Function SetModifiers(ByVal Name As String, ByRef Value() As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

Value

This is an array of three unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Mass modifier
Value(2) = Weight modifier
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks

This function sets the cable modifier assignment for cable objects. The default value for all
modifiers is one.

The function returns zero if the modifier assignments are successfully assigned, otherwise it
returns a nonzero value.


## VBA Example

Sub AssignCableModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'assign modifiers
ReDim Value(2)
For i = 0 To 2
Value(i) = 1
Next i
Value(0) = 100
ret = SapModel.CableObj.SetModifiers(Name, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

GetModifiers

DeleteModifiers

# SetOutputStations

## Syntax

SapObject.SapModel.CableObj.SetOutputStations

## VB6 Procedure

Function SetOutputStations(ByVal Name As String, ByVal MyType As Long, ByVal
MaxSegSize As Double, ByVal MinSections As Long, Optional ByVal
NoOutPutAndDesignAtElementEnds As Boolean, Optional ByVal
NoOutPutAndDesignAtPointLoads As Boolean, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

MyType

This is 1 or 2, indicating how the output stations are specified.

```
1 = maximum segment size, that is, maximum station spacing
2 = minimum number of stations
```
MaxSegSize

The maximum segment size, that is, the maximum station spacing. This item applies only when
MyType = 1. [L]

MinSections

The minimum number of stations. This item applies only when MyType = 2.

NoOutPutAndDesignAtElementEnds

If this item is True, no additional output stations are added at the ends of line elements when the
cable object is internally meshed.

NoOutPutAndDesignAtPointLoads

If this item is True, no additional output stations are added at point load locations.


ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.

If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks

This function assigns cable object output station data.

The function returns zero if the data is successfully assigned, otherwise it returns a nonzero value.

## VBA Example

Sub AssignCableOutputStationData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)


'assign cable output station data
ret = SapModel.CableObj.SetOutputStations(Name, 1, 18, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetOutputStations

# SetProperty

## Syntax

SapObject.SapModel.CableObj.SetProperty

## VB6 Procedure

Function SetProperty(ByVal name As String, ByVal PropName As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

PropName

The name of a cable property to be assigned to the specified cable object(s).

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the cable object specified by the Name item.


If this item is Group, the assignment is made to all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected cable objects, and the Name
item is ignored.

## Remarks

This function assigns a cable property to a cable object.

The function returns zero if the cable property is successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub SetCableSectionProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'set cable property
ret = SapModel.CableObj.SetProperty(Name, "CAB1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetProperty

# SetSelected

## Syntax

Sap2000.CableObj.SetSelected

## VB6 Procedure

Function SetSelected(ByVal Name As String, ByVal Selected As Boolean, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing cable object or group, depending on the value of the ItemType item.

Selected

This item is True if the specified cable object is selected, otherwise it is False.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the selected status is set for the cable object specified by the Name item.

If this item is Group, the selected status is set for all cable objects in the group specified by the
Name item.

If this item is SelectedObjects, the selected status is set for all selected cable objects, and the
Name item is ignored.

## Remarks

This function sets the selected status for a cable object.


The function returns zero if the selected status is successfully set, otherwise it returns a nonzero
value.

## VBA Example

Sub SetCableObjectSelected()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "6", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'set cable object selected
ret = SapModel.CableObj.SetSelected(Name, True)

'update view
ret = SapModel.View.RefreshView

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also


GetSelected

# DeleteAllFrameForces

## Syntax

```
SapObject.SapModel.ExternalAnalysisResults.DeleteAllFrameForces
```
## VB6 Procedure

Function DeleteAllFrameForces () As Long

## Remarks

```
This function deletes all the external results previously provided for all frame objects. The
function returns zero if the results are successfully deleted, otherwise it returns a nonzero
value.
```
## VBA Example

```
Sub DeleteAllFrameExternalResultForces ()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim ObjSta() As Double = New Double() {0.0, 124.0}
```
```
Dim LoadCase() As String = New String()
{"EXTERNAL"}
```
```
Dim P() As Double = New Double() {5.0, 5.0}
```
```
Dim V2() As Double = New Double() {-5.0, 5.0}
```
```
Dim V3() As Double = Nothing
```
```
Dim T() As Double = Nothing
```
```
Dim M2() As Double = Nothing
```
```
Dim M3() As Double = New Double() {100.0, 100.0}
```

'create Sap2000 object

```
SapObject = New Sap2000v16.SapObject
```
'start Sap2000 application

```
SapObject.ApplicationStart()
```
'create SapModel object

```
SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame
(e2DFrameType.PortalFrame, 3, 124, 3, 200)
```
'create load case for external results

```
ret = SapModel.LoadCases.ExternalResults.SetCase
("EXTERNAL")
```
'set cases and stations for frame external results

```
ret =
SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1,
LoadCase)
```
```
ret =
SapModel.ExternalAnalysisResults.SetFrameStations("1", ObjSta)
```
'set frame external result forces at case first step

```
ret = SapModel.ExternalAnalysisResults.SetFrameForce
("1", "EXTERNAL", 0, P, V2, V3, T, M2, M3)
```

```
'delete all frame external results
```
ret = SapModel.ExternalAnalysisResults.DeleteAllFrames
()

```
'close Sap2000
```
```
SapObject.ApplicationExit(False)
```
```
SapModel = Nothing
```
```
SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.00.

# DeleteFrameForces

## Syntax

```
SapObject.SapModel.ExternalAnalysisResults.DeleteFrameForces
```
## VB6 Procedure

Function DeleteFrameForces (Name As String) As Long

## Parameters

```
Name
```
```
The name of an existing frame object.
```
## Remarks

```
This function deletes all the external results previously provided for a given frame object.
This function returns zero if the external results are successfully deleted, otherwise it
returns a nonzero value.
```
## VBA Example

```
Sub DeleteFrameExternalResults ()
```

```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim ObjSta() As Double = New Double() {0.0, 124.0}
```
```
Dim LoadCase() As String = New String() {"EXTERNAL"}
```
```
Dim P() As Double = New Double() {5.0, 5.0}
```
```
Dim V2() As Double = New Double() {-5.0, 5.0}
```
```
Dim V3() As Double = Nothing
```
```
Dim T() As Double = Nothing
```
```
Dim M2() As Double = Nothing
```
```
Dim M3() As Double = New Double() {100.0, 100.0}
```
'create Sap2000 object

```
SapObject = New Sap2000v16.SapObject
```
'start Sap2000 application

```
SapObject.ApplicationStart()
```
'create SapModel object

```
SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(e2DFrameType.PortalFrame, 3, 124,
3, 200)
```

```
'create load case for external results
```
```
ret = SapModel.LoadCases.ExternalResults.SetCase("EXTERNAL")
```
```
'set cases and stations for frame external results
```
```
ret = SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1,
LoadCase)
```
```
ret = SapModel.ExternalAnalysisResults.SetFrameStations("1",
ObjSta)
```
```
'set frame external result forces at case first step
```
```
ret = SapModel.ExternalAnalysisResults.SetFrameForce("1",
"EXTERNAL", 0, P, V2, V3, T, M2, M3)
```
```
ret = SapModel.ExternalAnalysisResults.DeleteFrameForces("1")
```
```
'close Sap2000
```
```
SapObject.ApplicationExit(False)
```
```
SapModel = Nothing
```
```
SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.00.

# GetFrameForces

## Syntax

```
SapObject.SapModel.ExternalAnalysisResults.GetFrameForce
```

## VB6 Procedure

Function GetFrameForce(ByVal Name As String, ByVal InitialCase As String, _

ByVal NumStep As Long, ByRef NumberStations As Long, _

ByRef P() As Double, ByRef V2() As Double, _

ByRef V3() As Double, ByRef T() As Double, _

ByRef M2() As Double, ByRef M3() As Double) As Long

## Parameters

```
Name
```
```
The name of an existing frame object.
```
```
InitialCase
```
```
The name of an existing external results load case for which external results relevant to the
object may have been previously provided.
```
```
NumStep
```
```
The zero based index of a load case step: 0 for the first step, 1 for the second, and so on.
```
```
NumberStations
```
```
The number of frame stations on the object at which external result forces are reported.
```
```
P, V2, V3
```
```
One dimensional arrays that include the axial force, shear force in the local 2 direction, and
shear force in the local 3 direction, respectively, for each frame station. [F]
```
```
T, M2, M3
```
```
One dimensional arrays that include the torsion, moment about the local 2axis, and
moment about the local 3-axis, respectively, for each frame station. [FL]
```
## Remarks

```
This function reports the external result forces for a given step of a given external results
load case on a given object.
```
```
The function returns zero if the external result forces are successfully recovered, otherwise
it returns a nonzero value.
```
## VBA Example

```
Sub GetFrameExternalResultForces ()
```

```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim ObjSta() As Double = New Double() {0.0, 124.0}
```
```
Dim LoadCase() As String = New String() {"EXTERNAL"}
```
```
Dim P() As Double = New Double() {5.0, 5.0}
```
```
Dim V2() As Double = New Double() {-5.0, 5.0}
```
```
Dim V3() As Double = Nothing
```
```
Dim T() As Double = Nothing
```
```
Dim M2() As Double = Nothing
```
```
Dim M3() As Double = New Double() {100.0, 100.0}
```
```
Dim numberStations As Long
```
'create Sap2000 object

```
SapObject = New Sap2000v16.SapObject
```
'start Sap2000 application

```
SapObject.ApplicationStart()
```
'create SapModel object

```
SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel()
```
'create model from template


```
ret = SapModel.File.New2DFrame(e2DFrameType.PortalFrame, 3, 124, 3,
200)
```
'create load case for external results

```
ret = SapModel.LoadCases.ExternalResults.SetCase("EXTERNAL")
```
```
ret = SapModel.LoadCases.ExternalResults.SetNumberSteps("EXTERNAL",
1)
```
'set cases and stations for frame external results

```
ret = SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1,
LoadCase)
```
```
ret = SapModel.ExternalAnalysisResults.SetFrameStations("1", ObjSta)
```
'set frame external result forces at case first step

```
ret = SapModel.ExternalAnalysisResults.SetFrameForce("1",
"EXTERNAL", 0, P, V2, V3, T, M2, M3)
```
ret = SapModel.ExternalAnalysisResults.GetFrameForce("1",
"EXTERNAL", 0, numberStations, P, V2, V3, T, M2, M3)

'close Sap2000

```
SapObject.ApplicationExit(False)
```
```
SapModel = Nothing
```
```
SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.00.

# GetFrameStations

## Syntax


```
SapObject.SapModel.ExternalAnalysisResults.GetFrameStations
```
## VB6 Procedure

Function GetFrameStations(Name As String, ByRef nStations As Long, ByRef ObjSta() As Double) As Long

## Parameters

```
Name
```
```
The name of an existing frame object.
```
```
nStation
```
```
Number of the stations of an existing frame object.
```
```
ObjSta
```
```
This is an array that includes the distance measured from the I-end of the object to the
result location.
```
## Remarks

```
This function gets the frame stations on a frame object for which user-supplied external
analysis results are available.
```
```
The function returns zero if the stations are successfully get, otherwise it returns a nonzero
value.
```
## VBA Example

```
Sub GetFrameExternalResultStations()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim ObjSta() As Double = New Double() {0.0, 124.0}
```
```
Dim nStations As Long
```
```
Dim Sta() As Double
```
```
Dim LoadCase() As String = New String() {"EXTERNAL"}
```
```
Dim P() As Double = New Double() {5.0, 5.0}
```

```
Dim V2() As Double = New Double() {-5.0, 5.0}
```
```
Dim V3() As Double = Nothing
```
```
Dim T() As Double = Nothing
```
```
Dim M2() As Double = Nothing
```
```
Dim M3() As Double = New Double() {100.0, 100.0}
```
'create Sap2000 object

```
SapObject = New Sap2000v16.SapObject
```
'start Sap2000 application

```
SapObject.ApplicationStart()
```
'create SapModel object

```
SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(e2DFrameType.PortalFrame, 3, 124,
3, 200)
```
'create load case for external results

```
ret = SapModel.LoadCases.ExternalResults.SetCase("EXTERNAL")
```
'set cases and stations for frame external results

```
ret = SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1,
LoadCase)
```
```
ret = SapModel.ExternalAnalysisResults.SetFrameStations("1",
ObjSta)
```

```
ret = SapModel.ExternalAnalysisResults.GetFrameStations("1",
nStations, Sta)
```
```
'set frame external result forces at case first step
```
```
ret = SapModel.ExternalAnalysisResults.SetFrameForce("1",
"EXTERNAL", 0, P, V2, V3, T, M2, M3)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit(False)
```
```
SapModel = Nothing
```
```
SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.00.

# PresetFrameCases

## Syntax

```
SapObject.SapModel.ExternalAnalysisResults.PresetFrameCases
```
## VB6 Procedure

Function PresetFrameCases(Name As String, ByVal Count As Long, ByRef casname() As String) As Long

## Parameters

```
Name
```
```
The name of an existing frame object.
```
```
Count
```
```
The length of the subsequent array.
```
```
casename
```

```
An array listing the names of previously defined external result load cases for which user-
supplied external analysis results are available for the frame object.
```
## Remarks

```
Calling this function is optional, but it can speed up subsequent assignment of external
analysis results which are available for more than one load case.
```
```
The first time this function is called for a particular frame object, it sets the list of names of
external result load cases for which results relevant to the object are available. Subsequent
calls to this function for the same object reset the results for load cases already in the list,
and add load cases not already in.
```
```
This function returns zero if the stations are successfully set, otherwise it returns a nonzero
value.
```
## VBA Example

```
Sub PresetFrameExternalCases()
```
```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim ObjSta() As Double = New Double() {0.0, 124.0}
```
```
Dim LoadCase() As String = New String() {"EXTERNAL"}
```
```
Dim P() As Double = New Double() {5.0, 5.0}
```
```
Dim V2() As Double = New Double() {-5.0, 5.0}
```
```
Dim V3() As Double = Nothing
```
```
Dim T() As Double = Nothing
```
```
Dim M2() As Double = Nothing
```
```
Dim M3() As Double = New Double() {100.0, 100.0}
```
```
'create Sap2000 object
```
```
SapObject = New Sap2000v16.SapObject
```

'start Sap2000 application

```
SapObject.ApplicationStart()
```
'create SapModel object

```
SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(e2DFrameType.PortalFrame, 3, 124,
3, 200)
```
'create load case for external results

```
ret = SapModel.LoadCases.ExternalResults.SetCase("EXTERNAL")
```
'set cases and stations for frame external results

```
ret = SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1,
LoadCase)
```
```
ret = SapModel.ExternalAnalysisResults.SetFrameStations("1",
ObjSta)
```
'set frame external result forces at case first step

```
ret = SapModel.ExternalAnalysisResults.SetFrameForce("1",
"EXTERNAL", 0, P, V2, V3, T, M2, M3)
```
'close Sap2000

```
SapObject.ApplicationExit(False)
```
```
SapModel = Nothing
```
```
SapObject = Nothing
```

End Sub

## Release Notes

Initial release in version 16.00.

# SetFrameForceMultiple

## Syntax

```
SapObject.SapModel.ExternalAnalysisResults.SetFrameForceMultiple
```
## VB6 Procedure

Function SetFrameForceMultiple(ByVal NumberFrameNames As Long, ByVal FrameName() As
String, ByVal NumberLoadCases As Long, ByVal LoadCase() As String, ByVal FirstStep() As
Long, ByVal LastStep() As Long, ByRef P() As Double, ByRef M2() As Double, ByRef M3() As
Double) As Long

## Parameters

**NumberFrameNames**

The number of input frames

**FrameName**

An array of existing frame objects

**NumberLoadCases**

The number of input load cases

**LoadCase**

An array of existing external results load cases for which user-supplied external analysis results
relevant to the frame objects are available.

**FirstStep**

An array of the first step values for each load case. This should be of length NumberLoadCases.

**LastStep**

An array of the last step values for each load case. This should be of length NumberLoadCases.

**P**


An array of the axial forces for each frame station. [F]

**V2**

An array of the shear forces in the local 2 direction for each frame station. [F]

**V3**

An array of the shear forces in the local 3 direction for each frame station. [F]

**T**

An array of the torsion for each frame station. [F]

**M2**

An array of the moment about the local 2-axis for each frame station. [F]

**M3**

An array of the moment about the local 3-axis for each frame station. [F]

## Remarks

This function sets the external result forces for all input frames and load cases.

The P, V2, V3, T, M2, M3 arrays should be of length:

(Sum of all steps for all input Load Cases) * (Sum of all stations for all input Frames)

As an example, consider setting results for two Frames, each with two defined Stations, for two
Load Cases, each Load Case containing three steps, eg First Step = 1, Last step = 3.

The values of this array will be iterated over in the following order:

The P[0] value will be the axial force for FrameName[0], LoadCase[0], FirstStep[0], 1st Station

The P[1] value will be the axial force for FrameName[0], LoadCase[0], FirstStep[0], 2nd Station

The P[2] value will be the axial force for FrameName[0], LoadCase[0], FirstStep[0]+1, 1st Station

The P[3] value will be the axial force for FrameName[0], LoadCase[0], FirstStep[0]+1, 2nd
Station

The P[4] value will be the axial force for FrameName[0], LoadCase[0], LastStep[0], 1st Station

The P[5] value will be the axial force for FrameName[0], LoadCase[0], LastStep[0], 2nd Station

The P[6] value will be the axial force for FrameName[0], LoadCase[1], FirstStep[1], 1st Station

The P[7] value will be the axial force for FrameName[0], LoadCase[1], FirstStep[1], 2nd Station

The P[8] value will be the axial force for FrameName[0], LoadCase[1], FirstStep[1]+1, 1st Station


The P[9] value will be the axial force for FrameName[0], LoadCase[1], FirstStep[1]+1, 2nd
Station

The P[10] value will be the axial force for FrameName[0], LoadCase[1], LastStep[1], 1st Station

The P[11] value will be the axial force for FrameName[0], LoadCase[1], LastStep[1], 2nd Station

The P[12] value will be the axial force for FrameName[1], LoadCase[0], FirstStep[0], 1st Station

And so on...

The number of stations must be previously declared using SetFrameStations

Enter 0 for any unneeded values in these arrays

The function returns zero if the forces are successfully set, otherwise it returns a nonzero value.

## VBA Example

## Release Notes

Initial Release in version 16.0.0.

# SetFrameForce

## Syntax

```
SapObject.SapModel.ExternalAnalysisResults.SetFrameForce
```
## VB6 Procedure

Function SetFrameForce(ByVal Name As String, ByVal InitialCase As String, ByVal StepNum
As Long, ByRef P() As Double, ByRef V2() As Double, ByRef V3() As Double, ByRef T() As
Double, ByRef M2() As Double, ByRef M3() As Double) As Long


## Parameters

**Name**

```
The name of an existing frame object.
```
**InitialCase**

```
The name of an existing external results load case for which user-supplied external
analysis results relevant to the object are available.
```
**StepNum**

```
The zero based index of a load case step: 0 for the first step, 1 for the second, and so on.
```
**P, V2, V3**

```
These are one dimensional arrays that include the axial force, shear force in the local 2
direction, and shear force in the local 3 direction, respectively, for each frame station.[F]
These arrays are each expected to contain a number of values equal to the previously
declared number of stations at which external results are available for the object  see
SapObject.SapModel.ExternalAnalysisResults.SetFrameStations() for that declaration.
```
```
If any of these arrays is empty, the function substitutes zero values for the missing values.
```
**T, M2, M3**

```
These are one dimensional arrays that include the torsion, moment about the local 2axis,
and moment about the local 3-axis, respectively, for each frame station. [FL] Again, these
arrays are each expected to contain a number of values equal to the previously declared
number of stations at which external results are provided for the object. If any of these
arrays is empty, the function substitutes zero values for the missing values.
```
## Remarks

```
This function sets the external result forces for a given step of a given external results load
case on a frame object.
```
```
The function returns zero if the forces are successfully set, otherwise it returns a nonzero
value.
```
## VBA Example

```
Sub SetFrameExternalResultForces ()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```

```
Dim ret As Long
```
```
Dim ObjSta() As Double = New Double() {0.0, 124.0}
```
```
Dim LoadCase() As String = New String() {"EXTERNAL"}
```
```
Dim P() As Double = New Double() {5.0, 5.0}
```
```
Dim V2() As Double = New Double() {-5.0, 5.0}
```
```
Dim V3() As Double = Nothing
```
```
Dim T() As Double = Nothing
```
```
Dim M2() As Double = Nothing
```
```
Dim M3() As Double = New Double() {100.0, 100.0}
```
**'create Sap2000 object**

```
SapObject = New Sap2000v16.SapObject
```
**'start Sap2000 application**

```
SapObject.ApplicationStart()
```
**'create SapModel object**

```
SapModel = SapObject.SapModel
```
**'initialize model**

```
ret = SapModel.InitializeNewModel
```
**'create model from template**

```
ret = SapModel.File.New2DFrame(e2DFrameType.PortalFrame, 3, 124,
3, 200)
```
**'create load case for external results**

```
ret = SapModel.LoadCases.ExternalResults.SetCase("EXTERNAL")
```

```
'set cases and stations for frame external results
```
```
ret = SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1,
LoadCase)
```
```
ret = SapModel.ExternalAnalysisResults.SetFrameStations("1",
ObjSta)
```
```
'set frame external result forces at case first step
```
```
ret = SapModel.ExternalAnalysisResults.SetFrameForce("1",
"EXTERNAL", 0, P, V2, V3, T, M2, M3)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit(False)
```
```
SapModel = Nothing
```
```
SapObject = Nothing
```
**End Sub**

## Release Notes

Initial release in version 16.00.

# SetFrameStations

## Syntax

```
SapObject.SapModel.ExternalAnalysisResults.SetFrameStations
```
## VB6 Procedure

Function SetFrameStations(Name As String, ByRef ObjSta() As Double) As Long

## Parameters

```
Name
```
```
The name of an existing frame object.
```
```
ObjSta
```

```
This is an array that includes the distance measured from the I-end of the object to the
result location.
```
## Remarks

```
This function sets the frame stations on a frame object for which user-supplied external
analysis results are available.
```
```
The function returns zero if the stations are successfully set, otherwise it returns a nonzero
value.
```
## VBA Example

```
SubSetFrameExternalResultStations()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim ObjSta() As Double = New Double() {0.0, 124.0}
```
```
Dim LoadCase() As String = New String() {"EXTERNAL"}
```
```
Dim P() As Double = New Double() {5.0, 5.0}
```
```
Dim V2() As Double = New Double() {-5.0, 5.0}
```
```
Dim V3() As Double = Nothing
```
```
Dim T() As Double = Nothing
```
```
Dim M2() As Double = Nothing
```
```
Dim M3() As Double = New Double() {100.0, 100.0}
```
```
'create Sap2000 object
```
```
SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart()
```

'create SapModel object

```
SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(e2DFrameType.PortalFrame, 3, 124,
3, 200)
```
'create load case for external results

```
ret = SapModel.LoadCases.ExternalResults.SetCase("EXTERNAL")
```
'set cases and stations for frame external results

```
ret = SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1,
LoadCase)
```
```
ret = SapModel.ExternalAnalysisResults.SetFrameStations("1",
ObjSta)
```
'set frame external result forces at case first step

```
ret = SapModel.ExternalAnalysisResults.SetFrameForce("1",
"EXTERNAL", 0, P, V2, V3, T, M2, M3)
```
'close Sap2000

```
SapObject.ApplicationExit(False)
```
```
SapModel = Nothing
```
```
SapObject = Nothing
```
```
End Sub
```

## Release Notes

Initial release in version 16.00.

# AddByCoord

## Syntax

SapObject.SapModel.FrameObj.AddByCoord

## VB6 Procedure

Function AddByCoord(ByVal xi As Double, ByVal yi As Double, ByVal zi As Double, ByVal xj
As Double, ByVal yj As Double, ByVal zj As Double, ByRef Name As String, Optional ByVal
PropName As String = "Default", Optional ByVal UserName As String = "", Optional ByVal
CSys As String = "Global") As Long

## Parameters

xi, yi, zi

The coordinates of the I-End of the added frame object. The coordinates are in the coordinate
system defined by the CSys item.

xj, yj, zj

The coordinates of the J-End of the added frame object. The coordinates are in the coordinate
system defined by the CSys item.

Name

This is the name that the program ultimately assigns for the frame object. If no UserName is
specified, the program assigns a default name to the frame object. If a UserName is specified and
that name is not used for another frame, cable or tendon object, the UserName is assigned to the
frame object, otherwise a default name is assigned to the frame object.

PropName

This is Default, None, or the name of a defined frame section property.

If it is Default, the program assigns a default section property to the frame object. If it is None, no
section property is assigned to the frame object. If it is the name of a defined frame section
property, that property is assigned to the frame object.

UserName

This is an optional user specified name for the frame object. If a UserName is specified and that
name is already used for another frame object, the program ignores the UserName.

CSys


The name of the coordinate system in which the frame object end point coordinates are defined.

## Remarks

This function adds a new frame object whose end points are at the specified coordinates.

The function returns zero if the frame object is successfully added, otherwise it returns a nonzero
value.

## VBA Example

Sub AddFrameObjByCoord()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add frame object by coordinates
ret = SapModel.FrameObj.AddByCoord(-300, 0, 0, -100, 0, 124, Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByPoint


# AddByPoint

## Syntax

SapObject.SapModel.FrameObj.AddByPoint

## VB6 Procedure

Function AddByPoint(ByVal Point1 as String, ByVal Point2 as String, ByRef Name As String,
Optional ByVal PropName As String = "Default", Optional ByVal UserName As String = "") As
Long

## Parameters

Point1

The name of a defined point object at the I-End of the added frame object.

Point2

The name of a defined point object at the J-End of the added frame object.

Name

This is the name that the program ultimately assigns for the frame object. If no UserName is
specified, the program assigns a default name to the frame object. If a UserName is specified and
that name is not used for another frame, cable or tendon object, the UserName is assigned to the
frame object, otherwise a default name is assigned to the frame object.

PropName

This is Default, None, or the name of a defined frame section property.

If it is Default, the program assigns a default section property to the frame object. If it is None, no
section property is assigned to the frame object. If it is the name of a defined frame section
property, that property is assigned to the frame object.

UserName

This is an optional user specified name for the frame object. If a UserName is specified and that
name is already used for another frame object, the program ignores the UserName.

## Remarks

This function adds a new frame object whose end points are specified by name.

The function returns zero if the frame object is successfully added, otherwise it returns a nonzero
value.


## VBA Example

Sub AddFrameObjByPoint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add frame object by points
ret = SapModel.FrameObj.AddByPoint("1", "6", Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

# ChangeName

## Syntax

SapObject.SapModel.FrameObj.ChangeName


## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined frame object.

NewName

The new name for the frame object.

## Remarks

The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeFrameObjName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'change name
ret = SapModel.FrameObj.ChangeName("1", "MyFrame")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

# Count

## Syntax

SapObject.SapModel.FrameObj.Count

## VB6 Procedure

Function Count(Optional ByVal MyType As String = "All") As Long

## Parameters

MyType

This is All, Straight, or Curved.

All returns a count of all frame objects in the model, including both straight and curved frame
objects. Straight returns a count of all straight frame objects in the model. Curved returns a count
of all curved frame objects in the model.

## Remarks

This function returns a count of the frame objects in the model. Depending on the value of the
MyType item, the count may be of all frame objects in the model, just the straight frame objects in
the model or just the curved frame objects in the model.

## VBA Example

Sub CountFrameObjects()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'return number of frame objects
Count = SapModel.FrameObj.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.FrameObj.Delete

## VB6 Procedure

Function Delete(ByVal Name As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters

Name

The name of an existing frame object or group depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the frame object specified by the Name item is deleted.

If this item is Group, all of the frame objects in the group specified by the Name item are deleted.

If this item is SelectedObjects, all selected frame objects are deleted, and the Name item is
ignored.

## Remarks

The function deletes frame objects.

The function returns zero if the frame object is successfully deleted, otherwise it returns a nonzero
value.

## VBA Example

Sub DeleteFrameObj()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'delete frame object
ret = SapModel.FrameObj.Delete("1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

AddByCoord

AddByPoint

# DeleteFireproofing

## Syntax

SapObject.SapModel.FrameObj.DeleteFireproofing

## VB6 Procedure

Function DeleteFireproofing(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing frame object or group depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the fireproofing assignments are deleted for the frame object specified by the
Name item.

If this item is Group, the fireproofing assignments are deleted for all frame objects in the group
specified by the Name item.

If this item is SelectedObjects, the fireproofing assignments are deleted for all selected frame
objects, and the Name item is ignored.

## Remarks

This function deletes the fireproofing assignments for frame objects.

The function returns zero if the fireproofing assignments are successfully deleted, otherwise it
returns a nonzero value.

## VBA Example


Sub DeleteFireproofing()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign fireproofing
ret = SapModel.FrameObj.SetFireproofing("ALL", 1, 2, 0, 8.68E-06, False, Group)

'delete fireproofing
ret = SapModel.FrameObj.DeleteFireproofing("3")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetFireproofing

SetFireproofing

# DeleteLateralBracing

## Syntax

SapObject.SapModel.FrameObj.DeleteLateralBracing


## VB6 Procedure

Function DeleteLateralBracing(ByVal Name As String, Optional ByVal MyType As Long = 3,
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

MyType

This is 1, 2 or 3, indicating the bracing to be deleted.

```
1 = Delete point bracing
2 = Delete uniform bracing
3 = Delete both point and uniform bracing
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the lateral bracing assignments are deleted for the frame object specified by
the Name item.

If this item is Group, the lateral bracing assignments are deleted for all frame objects in the group
specified by the Name item.

If this item is SelectedObjects then the lateral bracing assignments are deleted for all selected
frame objects, and the Name item is ignored.

## Remarks

This function deletes the lateral bracing assignments for frame objects.

The function returns zero if the assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteFrameLatealBracing()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'assign frame lateral bracing
ret = SapModel.FrameObj.SetLateralBracing("8", 1, 3, 0, 0)
ret = SapModel.FrameObj.SetLateralBracing("8", 1, 3, 0.25, 0)
ret = SapModel.FrameObj.SetLateralBracing("8", 1, 3, 1, 0)
ret = SapModel.FrameObj.SetLateralBracing("8", 2, 1, 0.5, 1)

'delete frame lateral bracing
ret = SapModel.FrameObj.DeleteLateralBracing("8", 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.03.

## See Also

SetLateralBracing

GetLateralBracing

# DeleteLoadDeformation

## Syntax

SapObject.SapModel.FrameObj.DeleteLoadDeformation

## VB6 Procedure


Function DeleteLoadDeformation(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the frame object specified by the Name
item.

If this item is Group, the load assignments are deleted for all frame objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected frame objects, and
the Name item is ignored.

## Remarks

This function deletes the deformation load assignments to the specified frame objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteFrameDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim d() As double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame deformation loads
ReDim DOF(5)
ReDim d(5)
DOF(0) = True
D(0) = 2
ret = SapModel.FrameObj.SetLoadDeformation("ALL", "DEAD", DOF, d, Group)

'delete frame deformation load
ret = SapModel.FrameObj.DeleteLoadDeformation("3", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDeformation

SetLoadDeformation

# DeleteLoadDistributed

## Syntax

SapObject.SapModel.FrameObj.DeleteLoadDistributed

## VB6 Procedure


Function DeleteLoadDistributed(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the frame object specified by the Name
item.

If this item is Group, the load assignments are deleted for all frame objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected frame objects, and
the Name item is ignored.

## Remarks

This function deletes the distributed load assignments to the specified frame objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteFrameDistributedLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame distributed loads
ret = SapModel.FrameObj.SetLoadDistributed("14", "DEAD", 1, 10, 0, 1, 0.08, 0.08)
ret = SapModel.FrameObj.SetLoadDistributed("15", "DEAD", 1, 10, 0, 1, 0.08, 0.08)

'delete frame distributed load
ret = SapModel.FrameObj.DeleteLoadDistributed("14", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDistributed

SetLoadDistributed

# DeleteLoadDistributedWithGUID

## Syntax

SapObject.SapModel.FrameObj.DeleteLoadDistributedWithGUID

## VB6 Procedure

Function DeleteLoadDistributedWithGUID(ByVal Name As String, ByVal GUID As String) As
Long


## Parameters

Name

The name of an existing frame object.

GUID

The global unique ID of one of the distributed loads on that frame object.

## Remarks

This function deletes the distributed load assignment with the specified global unique ID for the
frame objects for the specified frame object.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## Release Notes

Initial release in version 17.20.

## See Also

GetLoadDistributedWithGUID

SetLoadDistributedWithGUID

# DeleteLoadGravity

## Syntax

SapObject.SapModel.FrameObj.DeleteLoadGravity

## VB6 Procedure

Function DeleteLoadGravity(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.


ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object,the load assignments are deleted for the frame object specified by the Name
item.

If this item is Group, the load assignments are deleted for all frame objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected frame objects, and
the Name item is ignored.

## Remarks

This function deletes the gravity load assignments to the specified frame objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteFrameGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame gravity loads
ret = SapModel.FrameObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)


'delete frame gravity load
ret = SapModel.FrameObj.DeleteLoadGravity("3", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

SetLoadGravity

# DeleteLoadPoint

## Syntax

SapObject.SapModel.FrameObj.DeleteLoadPoint

## VB6 Procedure

Function DeleteLoadPoint(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
```

```
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the frame object specified by the Name
item.

If this item is Group, the load assignments are deleted for all frame objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected frame objects, and
the Name item is ignored.

## Remarks

This function deletes the point load assignments to the specified frame objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteFramePointLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame point loads
ret = SapModel.FrameObj.SetLoadPoint("14", "DEAD", 1, 10, .5, 20)
ret = SapModel.FrameObj.SetLoadPoint("15", "DEAD", 1, 10, .5, 20)

'delete frame point load
ret = SapModel.FrameObj.DeleteLoadPoint("14", "DEAD")

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadPoint

SetLoadPoint

# DeleteLoadPointWithGUID {Frame Object}

## Syntax

SapObject.SapModel.FrameObj.DeleteLoadPointWithGUID

## VB6 Procedure

Function DeleteLoadPointWithGUID(ByVal Name As String, ByVal GUID As String) As Long

## Parameters

Name

The name of an existing frame object.

GUID

The global unique ID for one of the point loads on that frame object.

## Remarks

This function deletes the point load assignment with the specified global unique ID for the
specified frame object.

The function returns zero if the load assignment is successfully deleted, otherwise it returns a
nonzero value.

## Release Notes

Initial release in version 17.2.0.


## See Also

GetLoadPointWithGUID

SetLoadPointWithGUID

# DeleteLoadStrain

## Syntax

SapObject.SapModel.FrameObj.DeleteLoadStrain

## VB6 Procedure

Function DeleteLoadStrain(ByVal Name As String, ByVal LoadPat As String, ByVal DOF As
Long, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

DOF

This is 1, 2, 3, 4, 5 or 6, indicating the degree of freedom to which the strain load is applied.

```
1 = Strain11
2 = Strain12
3 = Strain13
4 = Curvature1
5 = Curvature2
6 = Curvature3
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the frame object specified by the Name
item.


If this item is Group, the load assignments are deleted for all frame objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected frame objects, and
the Name item is ignored.

## Remarks

This function deletes the strain load assignments to the specified frame objects, for the specified
load pattern, for the specified degree of freedom.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteFrameStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame strain load
ret = SapModel.FrameObj.SetLoadStrain("1", "DEAD", 1, 0.001)
ret = SapModel.FrameObj.SetLoadStrain("2", "DEAD", 1, 0.001)

'delete frame strain load
ret = SapModel.FrameObj.DeleteLoadStrain("1", "DEAD", 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadStrain

SetLoadStrain

# DeleteLoadTargetForce

## Syntax

SapObject.SapModel.FrameObj.DeleteLoadTargetForce

## VB6 Procedure

Function DeleteLoadTargetForce(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the frame object specified by the Name
item.

If this item is Group, the load assignments are deleted for all frame objects in the group specified
by the Name item.


If this item is SelectedObjects, the load assignments are deleted for all selected frame objects, and
the Name item is ignored.

## Remarks

This function deletes the target force assignments to the specified frame objects for the specified
load pattern.

The function returns zero if the target force assignments are successfully deleted, otherwise it
returns a nonzero value.

## VBA Example

Sub DeleteFrameTargetForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim f() As double
Dim RD() As double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame target force
ReDim DOF(5)
ReDim f(5)
ReDim RD(5)
DOF(0) = True
f(0) = 50
RD(0) = 0.5
ret = SapModel.FrameObj.SetLoadTargetForce("1", "DEAD", DOF, f, RD)
ret = SapModel.FrameObj.SetLoadTargetForce("2", "DEAD", DOF, f, RD)

'delete frame target force
ret = SapModel.FrameObj.DeleteLoadTargetForce("1", "DEAD")

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTargetForce

SetLoadTargetForce

# DeleteLoadTemperature

## Syntax

SapObject.SapModel.FrameObj.DeleteLoadTemperature

## VB6 Procedure

Function DeleteLoadTemperature(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the load assignments are deleted for the frame object specified by the Name
item.

If this item is Group, the load assignments are deleted for all frame objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected frame objects, and
the Name item is ignored.

## Remarks

This function deletes the temperature load assignments to the specified frame objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteFrameTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame temperature load
ret = SapModel.FrameObj.SetLoadTemperature("All", "DEAD", 1, 50, , , Group)

'delete frame temperature load
ret = SapModel.FrameObj.DeleteLoadTemperature("3", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTemperature

SetLoadTemperature

# DeleteMass

## Syntax

SapObject.SapModel.FrameObj.DeleteMass

## VB6 Procedure

Function DeleteMass(ByVal Name As String, Optional ByVal ItemType As eItemType = Object)
As Long

## Parameters

Name

The name of an existing frame object or group depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the frame mass assignments are deleted for the frame object specified by the
Name item.

If this item is Group, the frame mass assignments are deleted for all frame objects in the group
specified by the Name item.

If this item is SelectedObjects, the frame mass assignments are deleted for all selected frame
objects and the Name item is ignored.


## Remarks

This function deletes the frame mass assignments for frame objects.

The function returns zero if the mass assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteFrameMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame mass
ret = SapModel.FrameObj.SetMass("ALL", .0001, False, Group)

'delete frame mass
ret = SapModel.FrameObj.DeleteMass("15")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMass


SetMass

# DeleteModifiers

## Syntax

SapObject.SapModel.FrameObj.DeleteModifiers

## VB6 Procedure

Function DeleteModifiers(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing frame object or group depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the frame modifier assignments are deleted for the frame object specified by
the Name item.

If this item is Group, the frame modifier assignments are deleted for all frame objects in the group
specified by the Name item.

If this item is SelectedObjects, the frame modifier assignments are deleted for all selected frame
objects, and the Name item is ignored.

## Remarks

This function deletes the frame modifier assignments for frame objects.

The function returns zero if the modifier assignments are successfully deleted, otherwise it returns
a nonzero value.

## VBA Example

Sub DeleteFrameModifiers()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign modifiers
ReDim Value(7)
For i = 0 To 7
Value(i) = 1
Next i
Value(5) = 100
ret = SapModel.FrameObj.SetModifiers("ALL", Value, Group)

'delete modifiers
ret = SapModel.FrameObj.DeleteModifiers("3")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetModifiers

SetModifiers


# DeletePDeltaForce

## Syntax

SapObject.SapModel.FrameObj.DeletePDeltaForce

## VB6 Procedure

Function DeletePDeltaForce(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the frame modifier assignments are deleted for the frame object specified by
the Name item.

If this item is Group, the frame modifier assignments are deleted for all frame objects in the group
specified by the Name item.

If this item is SelectedObjects, the frame modifier assignments are deleted for all selected frame
objects, and the Name item is ignored.

## Remarks

This function deletes the P-Delta force assignments for frame objects.

The function returns zero if the assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeletePDeltaForces()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign P-Delta force
ret = SapModel.FrameObj.SetPDeltaForce("ALL", 100, 0, True, , Group)

'delete P-Delta force
ret = SapModel.FrameObj.DeletePDeltaForce("3")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetPDeltaForce

SetPDeltaForce

# DeleteSpring

## Syntax

SapObject.SapModel.FrameObj.DeleteSpring

## VB6 Procedure

Function DeleteSpring(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long


## Parameters

Name

The name of an existing frame object or group depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the frame spring assignments are deleted for the frame object specified by
the Name item.

If this item is Group, the frame spring assignments are deleted for all frame objects in the group
specified by the Name item.

If this item is SelectedObjects, the frame spring assignments are deleted for all selected frame
objects and the Name item is ignored.

## Remarks

This function deletes all spring assignments for the specified frame objects.

The function returns zero if the assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteFrameSprings()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Vec() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign springs to frame
ReDim Vec(2)
ret = SapModel.FrameObj.SetSpring("ALL", 1, 1, 1, "", 1, 2, 0, Vec, 0, False, "Local",
Group)

'delete springs
ret = SapModel.FrameObj.DeleteSpring("15")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

SetSpring

# GetAutoMesh

## Syntax

SapObject.SapModel.FrameObj.GetAutoMesh

## VB6 Procedure

Function GetAutoMesh(ByVal Name As String, ByRef AutoMesh As Boolean, ByRef
AutoMeshAtPoints As Boolean, ByRef AutoMeshAtLines As Boolean, ByRef NumSegs As
Long, ByRef AutoMeshMaxLength As Double) As Long

## Parameters

Name

The name of an existing frame object.

AutoMesh

This item is True if the frame object is to be automatically meshed by the program when the
analysis model is created.


AutoMeshAtPoints

This item is applicable only when the AutoMesh item is True. If this item is True, the frame object
is automatically meshed at intermediate joints along its length.

AutoMeshAtLines

This item is applicable only when the AutoMesh item is True. If this item is True, the frame object
is automatically meshed at intersections with other frames, area object edges and solid object
edges.

NumSegs

This item is applicable only when the AutoMesh item is True. It is the minimum number of
elements into which the frame object is automatically meshed. If this item is zero, the number of
elements is not checked when the automatic meshing is done.

AutoMeshMaxLength

This item is applicable only when the AutoMesh item is True. It is the maximum length of auto
meshed frame elements. If this item is zero, the element length is not checked when the automatic
meshing is done. [L]

## Remarks

This function retrieves the automatic meshing assignments to frame objects.

The function returns zero if the meshing assignments are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetFrameAutoMesh()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim AutoMesh As Boolean
Dim AutoMeshAtPoints As Boolean
Dim AutoMeshAtLines As Boolean
Dim NumSegs As Long
Dim AutoMeshMaxLength As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign automesh options
ret = SapModel.FrameObj.SetAutoMesh("ALL", True, True, True, 0, 0, Group)

'get automesh assignment
ret = SapModel.FrameObj.GetAutoMesh("3", AutoMesh, AutoMeshAtPoints,
AutoMeshAtLines,NumSegs, AutoMeshMaxLength)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetAutoMesh

# GetCurved_1

## Syntax

SapObject.SapModel.FrameObj.GetCurved_1

## VB6 Procedure

Function GetCurved_1(ByRef NumberItems As Integer, ByRef MyName As String(), ByRef
MyType() As Integer, ByRef gx() As Double, ByRef gy() As Double, ByRef gz() As Double,
ByRef PointName() As String, ByRef Radius() As Double, ByRef NumSegs() As Integer) As
Long

## Parameters

NumberItems

The number of curved frame objects returned.

MyName


This is a one-dimensional array of frame object names. The MyName array is created as a
dynamic, zero-based, array by the APIuser:

```
Dim MyName() as String
```
```
The array is dimensioned to (NumberNames  1) inside the Sap2000 program, filled
with the names, and returned to the APIuser
```
MyType

This is an array that includes a numeric value indicating the curved frame type. The type is 1, 2, 3,
4, or 5.

```
1 = Circular Arc Specified by a Third Point Name
```
```
2 = Circular Arc Specified by Third Point Coordinates
```
```
3 = Circular Arc Specified by Planar Point Coordinates and Radius
```
```
4 = Parabolic Arc Specified by a Third Point Name
```
```
5 = Parabolic Arc Specified by Third Point Coordinates
```
MyTypes 1, 2, 4, and 5 all define the curve by three points. The three points are the two end point
of the frame object and a third point defined by naming an existing point object or specifying
point coordinates.

MyType 3 defines a circular curved frame by it end points, the coordinates of another point that
lies in the plane of the curve but not necessarily on the curved frame, and a curve radius.

gx, gy, gz

These are arrays that include the point coordinates in the global coordinate system. [L]

For MyType 1 and 4 these items do not apply.

For MyType 2 and 5 these are the coordinates of the third point on the curved frame.

For MyType 3 these are the coordinates of the planar point that lies in the plane of the curved
frame.

PointName

This is an array that includes the name of the point object that is the third point on the curved
frame. This item applies for MyType 1 and 4. It does not apply for MyType 2, 3 and 5.

Radius

This is an array of the radii of the circular curved frame. This item only applies for MyType 3. [L]

NumSegs

This is an array that includes the number of segments into which the program internally divides
the curved frame.


## Remarks

This function retrieves definition data for all curved frame objects and returns the data in arrays.

The function returns zero if the curved frame object data is successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetCurvedFrames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim MyName() As String

Dim MyType() As Long
Dim gx() As Double
Dim gy() As Double
Dim gz() As Double
Dim PointName() As String
Dim Radius() As Double
Dim NumSegs() As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set frames curved
ret = SapModel.FrameObj.SetCurved("13", 1, 0, 0, 0, "1", 0, 16)
ret = SapModel.FrameObj.SetCurved("14", 2, -200, 0, 176, "", 0, 16)
ret = SapModel.FrameObj.SetCurved("15", 3, 0, 0, 0, "", 100, 16)
ret = SapModel.FrameObj.SetCurved("16", 4, 0, 0, 0, "3", 0, 16)
ret = SapModel.FrameObj.SetCurved("17", 5, 0, 0, 176, "", 0, 16)

'get curved frame data
ret = SapModel.FrameObj.GetCurved_1(NumberItems, MyName, MyType, gx, gy, gz,
PointName, Radius, NumSegs)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.

This function supersedes GetCurved.

## See Also

SetStraight

SetCurved

GetType

### GetDAMModifiers

```
Syntax
```
```
SapObject.SapModel.FrameObj.GetDAMModifiers
```
```
VB6 Procedure
Function GetDAMModifiers(ByVal Name As String, ByRef EAModifier As Double, ByRef
EIModifier As Double) As Long
```
```
Parameters
Name
The name of an existing frame section whose design type is Steel Frame design.
EAModifier
The modification factor for axial stiffness if the Direct Analysis method is used.
EIModifier
The modification factor for flexural stiffness if the Direct Analysis method is used.
```
```
Remarks
This function gets the modification factors for axial and flexural stiffness for a frame object if the
Direct Analysis method is used.
```
```
The function returns zero if the factors are successfully retrieved, otherwise it returns a nonzero
value. The function will return nonzero the modification factors are not available for the frame
object.
```
```
VBA Example
Sub GetDAMModifiers()
'dimension variables
Dim SapObject As Sap2000v16.SapObject
Dim SapModel As cSapModel
Dim ret As Long
Dim EAModifier As Double
Dim EIModifier As Double
```
```
'create Sap2000 object
```

```
Set SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
SapObject.ApplicationStart
```
```
'create SapModel object
Set SapModel = SapObject.SapModel
```
```
'initialize model
ret = SapModel.InitializeNewModel
```
```
'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
```
'set the steel frame design code
ret =SapModel.DesignSteel.SetCode("AISC360-05/IBC2006")
```
```
'save model
ret = SapModel.File.Save("C:\SapAPI\x.sdb")
```
```
'run analysis
ret =SapModel.Analyze.RunAnalysis
```
```
'run design
ret =SapModel.DesignSteel.StartDesign
```
```
'get direct analysis method modification factors
ret = SapModel.FrameObj.GetDAMModifiers("1", EAModifier,
EIModifier)
```
```
'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub
```
```
Release Notes
Initial release in version 16.0.0.
```
```
See Also
```
# GetDesignProcedure

## Syntax

SapObject.SapModel.FrameObj.GetDesignProcedure

## VB6 Procedure

Function GetDesignProcedure(ByVal Name As String, ByRef MyType As Long) As Long

## Parameters

Name

The name of an existing frame object.


MyType

This is 1, 2, 7, 8 or 9, indicating the design procedure for the specified frame object.

```
1 = Steel
2 = Concrete
7 = Aluminum
8 = Cold Formed
9 = No Design
```
## Remarks

This function retrieves the design procedure for a frame object.

The function returns zero if the design procedure is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameObjDesignProcedure()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get design procedure
ret = SapModel.FrameObj.GetDesignProcedure("8", MyType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

SetDesignProcedure

# GetElm

## Syntax

SapObject.SapModel.FrameObj.GetElm

## VB6 Procedure

Function GetElm(ByVal Name As String, ByRef nelm As Long, ByRef Elm() as String, ByRef
RDI() As Double, ByRef RDJ() As Double) As Long

## Parameters

Name

The name of an existing frame object.

nelm

The number of line elements created from the specified frame object.

Elm

An array that includes the name of a frame element created from the specified frame object.

RDI

An array that includes the relative distance along the frame object to the I-End of the frame
element.

RDJ

An array that includes the relative distance along the line object to the J-End of the frame element.

## Remarks

This function retrieves the names of the frame elements (analysis model lines) associated with a
specified frame object in the object-based model. It also retrieves information about the location of
the frame elements along the frame object.


This function returns zero if the frame element information is successfully returned; otherwise it
returns nonzero. An error occurs if the analysis model does not exist.

## VBA Example

Sub GetLineElementInfo()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim nelm As Long
Dim Elm() As String
Dim RDI() As Double
Dim RDJ() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'create the analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get line element information
ret = SapModel.FrameObj.GetElm("5", nelm, Elm, RDI, RDJ)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

# GetEndLengthOffset

## Syntax

SapObject.SapModel.FrameObj.GetEndLengthOffset

## VB6 Procedure

Function GetEndLengthOffset(ByVal Name As String, ByRef AutoOffset As Boolean, ByRef
Length1 As Double, ByRef Length2 As Double, ByRef rz As Double) As Long

## Parameters

Name

The name of an existing frame object.

AutoOffset

If this item is True, the end length offsets are automatically determined by the program from
object connectivity.

Length1

The offset length along the 1-axis of the frame object at the I-End of the frame object. [L]

Length2

The offset along the 1-axis of the frame object at the J-End of the frame object. [L]

rz

The rigid zone factor. This is the fraction of the end offset length assumed to be rigid for bending
and shear deformations.

## Remarks

This function retrieves the frame object end offsets along the 1-axis of the object.

The function returns zero if the offsets are successfully retrieved, otherwise it returns a nonzero
value.

## VBA Example

Sub GetFrameEndOffsets()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim AutoOffset As Boolean
Dim Length1 As Double
Dim Length2 As Double
Dim rz As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get offsets
ret = SapModel.FrameObj.GetEndLengthOffset("15", AutoOffset, Length1, Length2, rz)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetEndLengthOffset

# GetEndSkew

## Syntax

SapObject.SapModel.FrameObj.GetEndSkew

## VB6 Procedure

Function GetEndSkew(ByVal Name As String, ByRef SkewI As Double, ByRef SkewJ As
Double) As Long


## Parameters

Name

The name of an existing frame object.

SkewI

The angle in degrees measured counter clockwise from the positive local 3-axis to a line parallel
to the I-End of the frame object (-90 < SkewI < 90). [deg]

SkewJ

The angle in degrees measured counter clockwise from the positive local 3-axis to a line parallel
to the J-End of the frame object (-90 < SkewJ < 90). [deg]

## Remarks

This function retrieves frame object end skew assignments.

The function returns zero if the end skew data is successfully retrieved, otherwise it returns a
nonzero value.

End skew assignments are only applicable to straight frame objects. An error is returned if skew
data is requested for a curved frame object.

End skew data is only used in the program to plot the extruded view of bridge objects that have
been updated as spine models.

## VBA Example

Sub GetFrameEndSkewData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SkewI As Double
Dim SkewJ As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get end skew data
ret = SapModel.FrameObj.GetEndSkew("15", SkewI, SkewJ)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetEndSkew

# GetFireproofing_1

## Syntax

SapObject.SapModel.FrameObj.GetFireProofing_1

## VB6 Procedure

Function GetFireProofing_1(ByVal Name As String, ByRef MyType As Long, ByRef Thickness
As Double, ByRef Perimeter As Double, ByRef Density As Double, ByRef tf As Boolean, ByRef
IncludeInSelfWeight As Boolean, ByRef IncludeInGravityLoads As Boolean, ByRef
IncludeInThisLoadPattern As String) As Long

## Parameters

Name

The name of an existing frame object.

MyType

This is 1, 2 or 3, indicating the type of fireproofing assigned.

1 = Sprayed on - program calculate section perimeter

2 = Sprayed on - user provides section perimeter

3 = Concrete encased

Thickness


When MyType = 1 or MyType = 2 this is the thickness of the sprayed on fireproofing. When
MyType = 3 this is the concrete cover dimension. [L]

Perimeter

This item applies only when MyType = 2. It is the length of fireproofing applied measured around
the perimeter of the frame object cross-section. [L]

Density

This is the weight per unit volume of the fireproofing material. [F/L3]

tf

This item applies only when MyType = 1 or MyType = 3. If this item is True, the fireproofing is
assumed to be applied to the top flange of the section. If it is False, the program assumes no
fireproofing is applied to the section top flange. This flag applies for I, channel and double
channel sections.

IncludeInSelfWeight

If this item is True the fireproofing is included in the structure self weight.

IncludeInGravityLoads

If this item is True the fireproofing is included gravity loads applied in the X, Y and Z directions.

IncludeInThisLoadPattern

This item is either None or the name of an existing load pattern. If it is the name of a load pattern
then the weight of the fireproofing is applied as a distributed load in the global Z direction in the
load pattern.

## Remarks

This function gets the fireproofing assignment to an existing frame object.

The function returns zero if the fireproofing assignment is successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

```
Sub GetFireproofing()
```
```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim MyType As Long
```

```
Dim Thickness As Double
```
```
Dim Perimeter As Double
```
```
Dim Density As Double
```
```
Dim tf As Boolean
```
```
Dim IncludeInSelfWeight As Boolean
```
```
Dim IncludeInGravityLoads As Boolean
```
```
Dim IncludeInThisLoadPattern As String
```
'create Sap2000 object

```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
'add new load pattern

```
ret = SapModel.LoadPatterns.Add("Fireproofing", LTYPE_SUPERDEAD)
```
'assign fireproofing, use in self weight and in load pattern

```
ret = SapModel.FrameObj.SetFireproofing_1("ALL", 1, 2, 0, 8.68E-06, False,
True, False, "Fireproofing", Group)
```

```
'get fireproofing data for frame object 3
```
```
ret = SapModel. FrameObj.GetFireproofing_1("3", MyType, Thickness, Perimeter,
Density, tf, IncludeInSelfWeight, IncludeInGravityLoads,
IncludeInThisLoadPattern)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0. This function supersedes obsolete function GetFireProofing

## See Also

SetFireProofing_1

DeleteFireProofing

# GetGroupAssign

## Syntax

SapObject.SapModel.FrameObj.GetGroupAssign

## VB6 Procedure

Function GetGroupAssign(ByVal Name As String, ByRef NumberGroups As Long, ByRef
Groups() As String) As Long

## Parameters

Name

The name of an existing frame object.

NumberGroups

The number of group names retrieved.


Groups

The names of the groups to which the frame object is assigned.

## Remarks

This function retrieves the names of the groups to which a specified frame object is assigned.

The function returns zero if the group assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameObjectGroups()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim NumberGroups As Long
Dim Groups() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new groups
ret = SapModel.GroupDef.SetGroup("Group1")
ret = SapModel.GroupDef.SetGroup("Group2")

'add frame object to groups
ret = SapModel.FrameObj.SetGroupAssign("2", "Group1")
ret = SapModel.FrameObj.SetGroupAssign("2", "Group2")

'get frame object groups
ret = SapModel.FrameObj.GetGroupAssign("2", NumberGroups, Groups)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 20.0.0.

## See Also

SetGroupAssign

# GetGUID

## Syntax

SapObject.SapModel.FrameObj.GetGUID

## VB6 Procedure

Function GetGUID(ByVal name As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing frame object.

GUID

The GUID (Global Unique ID) for the specified frame object.

## Remarks

This function retrieves the GUID for the specified frame object.

This function returns zero if the frame object GUID is successfully retrieved; otherwise it returns
nonzero.

## VBA Example

Sub GetFrameObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim GUID As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set program created GUID
ret = SapObject.SapModel.FrameObj.SetGUID("1")

'get GUID
ret = SapObject.SapModel.FrameObj.GetGUID("1", GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetGUID

# GetHingeAssigns_2

## Syntax

SapObject.SapModel.FrameObj.GetHingeAssigns_2

## VB6 Procedure

Function GetHingeAssigns_2(ByVal Name As String, ByRef HingeDistrType As
eHingeDistributionType, ByRef NumberHinges As Long, ByRef HingeNum() As Long, ByRef
Prop() As String, ByRef MyType() As Long, ByRef Behavior() As Long, ByRef Source() As
String, ByRef LocType() As eHingeLocationType, ByRef RD() As Double, ByRef AD() As
Double, ByRef LengthOWType() as eHingeLengthOverwriteType, ByRef LengthOWRel() As
Double, ByRef LengthOWAbs() As Double) As Long


## Parameters

Name

The name of an existing frame object.

HingeDistrType

This is a value from the eHingeDistributionType enumeration, specifying the type of hinge
distribution used for the frame hinge assignment:

1= NonlinearBeamColumn

2= DistributedPlasticity

3 = EqualSpacing

4 = ContinuousSupport

5 = UserDefined

NumberHinges

The number of hinge assignments on the specified frame object.

HingeNum

An array that includes the hinge number for each hinge on the frame object.

Prop

An array that includes the name of the generated hinge property for each hinge on the frame
object.

MyType

An array that specifies the type of hinge for each hinge on the frame object. It is one of the
following:

```
1 = Axial P
2 = Shear V2
3 = Shear V3
4 = Torsion T
5 = Moment M2
6 = Moment M3
7 = Interacting P-M2
8 = Interacting P-M3
9 = Interacting M2-M3
10 = Interacting P-M2-M3
11 = Fiber P-M2-M3
```
Behavior


An array that specifies the behavior of the hinge for each hinge on the frame object. It is one of the
following:

```
1 = Force controlled
2 = Deformation controlled
```
Source

An array that indicates the source of the generated hinge property for each hinge on the frame
object. The source is either Auto or the name of a defined (not generated) hinge property.

LocType

This is a value from the eHingeLocationType enumeration, specifying the type used to define the
location of the hinge:

```
RelativeDistance = 1
OffsetFromIEnd = 2
OffsetFromJEnd = 3
```
RD

If LocType = eHingeLocationType.RelativeDistance, this is the distance of the hinge from the end
of the i-end offset, as a ratio to the clear length of the frame object.

AD

If LocType = eHingeLocationType.OffsetFromIEnd, this is the absolute distance of the hinge
from the end of the i-end offset. If LocType = eHingeLocationType.OffsetFromJEnd, this is the
absolute distance of the hinge from the end of the j-end offset.

LengthOWType

This is a value from the eHingeLengthOverwriteType enumeration, specifying the hinge length
overwrite assigned to the hinge:

None = 1

Absolute = 2

Relative = 3

LengthOWRel

If LengthOWType = eHingeLocationType.Relative, this is the length of the hinge length
overwrite, as a ratio to the clear length of the frame object.

LengthOWAbs

If LengthOWType = eHingeLocationType.Absolute, this is the absolute length of the hinge length
overwrite.


## Remarks

This function reports the hinge assignments for a specified frame object.

The function returns zero if the assignment data is successfully obtained; otherwise it returns a
nonzero value.

## VBA Example

This example assumes that a file MyHinge.sdb exists.

Sub GetFrameHingeAssigns_2()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberHinges As Long

```
Dim HingeDistrType As eHingeDistributionType
```
Dim HingeNum() As Long
Dim Prop() As String
Dim MyType() As Long
Dim Behavior() As Long
Dim Source() As String

```
Dim LocType() As eHingeLocationType
```
Dim RD() As Double

Dim AD() As Double

Dim LenOWType() As eHingeLengthOverwriteType

Dim LenOWRel() As Double

Dim LenOWAbs() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open an existing file
FileName = "C:\SapAPI\MyHinge.sdb"
ret = SapModel.File.OpenFile(FileName)


'get hinge data for the frame object named 1
ret = SapModel.FrameObj.GetHingeAssigns_2("1", NumberHinges, HingeNum, Prop,
MyType, Behavior, Source, LocType, RD, AD, LengthOWType, LengthOWRel, LenthOWAbs)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0

This function supersedes GetHingeAssigns_1.

## See Also

# GetInsertionPoint_1

## Syntax

SapObject.SapModel.FrameObj.GetInsertionPoint_1

## VB6 Procedure

Function GetInsertionPoint_1(ByVal Name As String, ByRef CardinalPoint As Long, ByRef
Mirror2, ByRef Mirror3, As Boolean, ByRef StiffTransform As Boolean, ByRef Offset1() As
Double, ByRef Offset2() As Double, ByRef CSys As String) As Long

## Parameters

Name

The name of an existing frame object.

CardinalPoint

This is a numeric value from 1 to 11 that specifies the cardinal point for the frame object. The
cardinal point specifies the relative position of the frame section on the line representing the frame
object.

```
1 = bottom left
```
```
2 = bottom center
```

```
3 = bottom right
```
```
4 = middle left
```
```
5 = middle center
```
```
6 = middle right
```
```
7 = top left
```
```
8 = top center
```
```
9 = top right
```
```
10 = centroid
```
```
11 = shear center
```
Mirror2

If this item is True, the frame object section is assumed to be mirrored (flipped) about its local 2-
axis.

Mirror3

If this item is True, the frame object section is assumed to be mirrored (flipped) about its local 3-
axis.

StiffTransform

If this item is True, the frame object stiffness is transformed for cardinal point and joint offsets
from the frame section centroid.

Offset1

This is an array of three joint offset distances, in the coordinate directions specified by CSys, at
the I-End of the frame object. [L]

```
Offset1(0) = Offset in the 1-axis or X-axis direction
```
```
Offset1(1) = Offset in the 2-axis or Y-axis direction
```
```
Offset1(2) = Offset in the 3-axis or Z-axis direction
```
Offset2

This is an array of three joint offset distances, in the coordinate directions specified by CSys, at
the J-End of the frame object. [L]

```
Offset2(0) = Offset in the 1-axis or X-axis direction
Offset2(1) = Offset in the 2-axis or Y-axis direction
Offset2(2) = Offset in the 3-axis or Z-axis direction
```
CSys


This is either Local or the name of a defined coordinate system. It is the coordinate system in
which the Offset1 and Offset2 items are specified.

## Remarks

This function retrieves frame object insertion point assignments. The assignments include the
cardinal point and end joint offsets.

The function returns zero if the insertion point data is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameInsertionPoint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim CardinalPoint As Long
Dim Mirror2 As Boolean
Dim Mirror3 As Boolean

Dim StiffTransform As Boolean
Dim Offset1() As Double
Dim Offset2() As Double
Dim CSys As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame insertion point
ReDim Offset1(2)
ReDim Offset2(2)
For i=0 To 2
Offset1(i)=10 + i
Offset2(i)=20 + i
Next i
ret = SapModel.FrameObj.SetInsertionPoint_1("15", 7, False, False, True, Offset1, Offset2)


'get frame insertion point
ReDim Offset1(2)
ReDim Offset2(2)
ret = SapModel.FrameObj.GetInsertionPoint_1("15", CardinalPoint, Mirror2, Mirror3,
StiffTransform, Offset1, Offset2, CSys)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 24.1.

This function supersedes GetInsertionPoint, adding the Mirror3 parameter.

## See Also

SetInsertionPoint_1

# GetLateralBracing

## Syntax

SapObject.SapModel.FrameObj.GetLateralBracing

## VB6 Procedure

Function GetLateralBracing(ByVal Name As String, ByRef NumberItems As Long, ByRef
FrameName() As String, ByRef MyType() As Long, ByRef Loc() As Long, ByRef RD1() As
Double, ByRef RD2() As Double, ByRef Dist1() As Double, ByRef Dist2() As Double) As Long

## Parameters

Name

The name of an existing frame object.

NumberItems

The total number of bracing assignments retrieved for the specified frame objects.

FrameName

This is an array that includes the name of the frame object associated with each bracing
assignment.


MyType

This is an array that includes 1 or 2, indicating the bracing type assigned.

```
1 = Point bracing
2 = Uniform bracing
```
Loc

This is an array that includes 1, 2 or 3; indicating the bracing location.

```
1 = Top
2 = Bottom
3 = All (top and bottom)
```
RD1

This is an array that includes the relative location of the point bracing (when MyType = 1) or the
relative location of the start of the uniform bracing (when MyType = 2).

RD2

This is an array that includes the relative location of the start of the uniform bracing (when
MyType = 2).

This item does not apply for point bracing (when MyType = 1).

Dist1

This is an array that includes the actual location of the point bracing (when MyType = 1) or the
actual location of the start of the uniform bracing (when MyType = 2). [L]

Dist2

This is an array that includes the actual location of the start of the uniform bracing (when MyType
= 2). [L]

This item does not apply for point bracing (when MyType = 1).

## Remarks

This function retrieves the lateral bracing location assignments for frame objects.

The function returns zero if the assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameLateralBracing()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim NumberItems As Long
Dim FrameName() As String
Dim MyType() As Long
Dim Loc() As Long
Dim RD1() As Double
Dim RD2() As Double
Dim Dist1() As Double
Dim Dist2() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'assign frame lateral bracing
ret = SapModel.FrameObj.SetLateralBracing("8", 1, 3, 0, 0)
ret = SapModel.FrameObj.SetLateralBracing("8", 1, 3, 0.25, 0)
ret = SapModel.FrameObj.SetLateralBracing("8", 1, 3, 1, 0)
ret = SapModel.FrameObj.SetLateralBracing("8", 2, 1, 0.5, 1)

'get frame lateral bracing
ret = SapModel.FrameObj.GetLateralBracing("8", NumberItems, FrameName, MyType, Loc,
RD1, RD2, Dist1, Dist2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.03.

## See Also

SetLateralBracing

DeleteLateralBracing


# GetLoadDeformation

## Syntax

SapObject.SapModel.FrameObj.GetLoadDeformation

## VB6 Procedure

Function GetLoadDeformation(ByVal Name As String, ByRef NumberItems As Long, ByRef
FrameName() As String, ByRef LoadPat() As String, ByRef dof1() As Boolean, ByRef dof2() As
Boolean, ByRef dof3() As Boolean, ByRef dof4() As Boolean, ByRef dof5() As Boolean, ByRef
dof6() As Boolean, ByRef U1() As Double, ByRef U2() As Double, ByRef U3() As Double,
ByRef R1() As Double, ByRef R2() As Double, ByRef R3() As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

NumberItems

The total number of deformation loads retrieved for the specified frame objects.

FrameName

This is an array that includes the name of the frame object associated with each deformation load.

LoadPat

This is an array that includes the name of the load pattern associated with each deformation load.

dof1, dof2, dof3, dof4, dof5, dof6

These are arrays of boolean values indicating if the considered degree of freedom has a
deformation load.

```
dof1 = U1
dof2 = U2
dof3 = U3
dof4 = R1
dof5 = R2
dof6 = R3
```
U1, U2, U3, R1, R2, R3

These are arrays of deformation load values. The deformations specified for a given degree of
freedom are applicable only if the corresponding DOF item for that degree of freedom is True.

```
U1 = U1 deformation [L]
```

```
U2 = U2 deformation [L]
U3 = U3 deformation [L]
R1 = R1 deformation [rad]
R2 = R2 deformation [rad]
R3 = R3 deformation [rad]
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the frame object specified by the Name
item.

If this item is Group, the assignments are retrieved for all frame objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected frame objects, and the
Name item is ignored.

## Remarks

This function retrieves the deformation load assignments to frame objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim d() As double
Dim NumberItems As Long
Dim FrameName() As String
Dim LoadPat() As String
Dim dof1() As Boolean
Dim dof2() As Boolean
Dim dof3() As Boolean
Dim dof4() As Boolean
Dim dof5() As Boolean
Dim dof6() As Boolean
Dim U1() As Double
Dim U2() As Double
Dim U3() As Double


Dim R1() As Double
Dim R2() As Double
Dim R3() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame deformation loads
ReDim DOF(5)
ReDim d(5)
DOF(0) = True
D(0) = 2
ret = SapModel.FrameObj.SetLoadDeformation("ALL", "DEAD", DOF, d, Group)

'get frame deformation loads
ret = SapModel.FrameObj.GetLoadDeformation("3", NumberItems, FrameName, LoadPat,
dof1, dof2, dof3, dof4, dof5, dof6, U1, U2, U3, R1, R2, R3)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadDeformation

DeleteLoadDeformation


# GetLoadDistributed

## Syntax

SapObject.SapModel.FrameObj.GetLoadDistributed

## VB6 Procedure

Function GetLoadDistributed(ByVal Name As String, ByRef NumberItems As Long, ByRef
FrameName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef CSys()
As String, ByRef Dir() As Long, ByRef RD1() As Double, ByRef RD2() As Double, ByRef Dist1
() As Double, ByRef Dist2() As Double, ByRef Val1() As Double, ByRef Val2() As Double,
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

NumberItems

The total number of distributed loads retrieved for the specified frame objects.

FrameName

This is an array that includes the name of the frame object associated with each distributed load.

LoadPat

This is an array that includes the name of the coordinate system in which the distributed loads are
specified.

MyType

This is an array that includes 1 or 2, indicating the type of distributed load.

```
1 = Force
2 = Moment
```
CSys

This is an array that includes the name of the coordinate system in which each distributed load is
defined. It may be Local or the name of a defined coordinate system.

Dir

This is an array that includes an integer between 1 and 11, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
```

```
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Projected Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

RD1

This is an array that includes the relative distance from the I-End of the frame object to the start of
the distributed load.

RD2

This is an array that includes the relative distance from the I-End of the frame object to the end of
the distributed load.

Dist1

This is an array that includes the actual distance from the I-End of the frame object to the start of
the distributed load. [L]

Dist2

This is an array that includes the actual distance from the I-End of the frame object to the end of
the distributed load. [L]

Val1

This is an array that includes the load value at the start of the distributed load. [F/L] when
MyType is 1 and [FL/L] when MyType is 2

Val2

This is an array that includes the load value at the end of the distributed load. [F/L] when MyType
is 1 and [FL/L] when MyType is 2

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the frame object specified by the Name
item.


If this item is Group, the assignments are retrieved for all frame objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected frame objects, and the
Name item is ignored.

## Remarks

This function retrieves the distributed load assignments to frame objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameDistributedLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim FrameName() As String
Dim LoadPat() As String
Dim MyType() As Long
Dim CSys() As String
Dim Dir() As Long
Dim RD1() As Double
Dim RD2() As Double
Dim Dist1() As Double
Dim Dist2() As Double
Dim Val1() As Double
Dim Val2() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame distributed loads
ret = SapModel.FrameObj.SetLoadDistributed("14", "DEAD", 1, 10, 0, 1, 0.08, 0.08)
ret = SapModel.FrameObj.SetLoadDistributed("15", "DEAD", 1, 10, 0, 1, 0.08, 0.08)


'get frame distributed loads
ret = SapModel.FrameObj.GetLoadDistributed("ALL", NumberItems, FrameName, LoadPat,
MyType, CSys, Dir, RD1, RD2, Dist1, Dist2, Val1, Val2, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadDistributed

DeleteLoadDistributed

# GetLoadDistributedWithGUID {Frame

# Object}

## Syntax

SapObject.SapModel.FrameObj.GetLoadDistributedWthGUID

## VB6 Procedure

Function GetLoadDistributed(ByVal Name As String, ByRef NumberItems As Long, ByRef
FrameName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef CSys()
As String, ByRef Dir() As Long, ByRef RD1() As Double, ByRef RD2() As Double, ByRef Dist1
() As Double, ByRef Dist2() As Double, ByRef Val1() As Double, ByRef Val2() As Double,
ByRef GUID() As String, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

NumberItems

The total number of distributed loads retrieved for the specified frame objects.


FrameName

This is an array that includes the name of the frame object associated with each distributed load.

LoadPat

This is an array that includes the name of the coordinate system in which the distributed loads are
specified.

MyType

This is an array that includes 1 or 2, indicating the type of distributed load.

```
1 = Force
2 = Moment
```
CSys

This is an array that includes the name of the coordinate system in which each distributed load is
defined. It may be Local or the name of a defined coordinate system.

Dir

This is an array that includes an integer between 1 and 11, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Projected Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

RD1

This is an array that includes the relative distance from the I-End of the frame object to the start of
the distributed load.

RD2

This is an array that includes the relative distance from the I-End of the frame object to the end of
the distributed load.

Dist1

This is an array that includes the actual distance from the I-End of the frame object to the start of
the distributed load. [L]


Dist2

This is an array that includes the actual distance from the I-End of the frame object to the end of
the distributed load. [L]

Val1

This is an array that includes the load value at the start of the distributed load. [F/L] when
MyType is 1 and [FL/L] when MyType is 2

Val2

This is an array that includes the load value at the end of the distributed load. [F/L] when MyType
is 1 and [FL/L] when MyType is 2

GUID

This is an array that includes the global unique ID of the distributed load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the frame object specified by the Name
item.

If this item is Group, the assignments are retrieved for all frame objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected frame objects, and the
Name item is ignored.

## Remarks

This function is identical to GetLoadDistributed but it includes an extra return parameter, which
includes the global unique IDs of the retrieved distributed loads.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## Release Notes

Initial release in version 17.2.0.

## See Also

SetLoadDistributedWithGUID


DeleteLoadDistributedWithGUID

# GetLoadGravity

## Syntax

SapObject.SapModel.FrameObj.GetLoadGravity

## VB6 Procedure

Function GetLoadGravity(ByVal Name As String, ByRef NumberItems As Long, ByRef
FrameName() As String, ByRef LoadPat() As String, ByRef CSys() As String, ByRef x() As
Double, ByRef y() As Double, ByRef z() As Double, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

NumberItems

The total number of gravity loads retrieved for the specified frame objects.

FrameName

This is an array that includes the name of the frame object associated with each gravity load.

LoadPat

This is an array that includes the name of the coordinate system in which the gravity load
multipliers are specified.

CSys

This is an array that includes the name of the coordinate system associated with each gravity load.

x, y, z

These are arrays of gravity load multipliers in the x, y and z directions of the specified coordinate
system.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the assignments are retrieved for the frame object specified by the Name
item.

If this item is Group, the assignments are retrieved for all frame objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected frame objects, and the
Name item is ignored.

## Remarks

This function retrieves the gravity load assignments to frame objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim FrameName() As String
Dim LoadPat() As String
Dim CSys() As String
Dim x() As Double
Dim y() As Double
Dim z() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame gravity loads
ret = SapModel.FrameObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'get frame gravity load
ret = SapModel.FrameObj.GetLoadGravity("3", NumberItems, FrameName, LoadPat, CSys,
x, y, z)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadGravity

DeleteLoadGravity

# GetLoadPoint

## Syntax

SapObject.SapModel.FrameObj.GetLoadPoint

## VB6 Procedure

Function GetLoadPoint(ByVal Name As String, ByRef NumberItems As Long, ByRef
FrameName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef CSys()
As String, ByRef Dir() As Long, ByRef RelDist() As Double, ByRef Dist() As Double, ByRef
Val() As Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group depending on the value of the ItemType item.

NumberItems

The total number of point loads retrieved for the specified frame objects.

FrameName

This is an array that includes the name of the frame object associated with each point load.

LoadPat


This is an array that includes the name of the coordinate system in which the point loads are
specified.

MyType

This is an array that includes 1 or 2, indicating the type of point load.

```
1 = Force
2 = Moment
```
CSys

This is an array that includes the name of the coordinate system in which each point load is
defined. It may be Local or the name of a defined coordinate system.

Dir

This is an array that includes an integer between 1 and 11 indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Not used - Projected X direction (does not apply when CSys is Local)
8 = Not used - Projected Y direction (does not apply when CSys is Local)
9 = Not used - Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Not used - Projected Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

RelDist

This is an array that includes the relative distance from the I-End of the frame object to the
location where the point load is applied.

Dist

This is an array that includes the actual distance from the I-End of the frame object to the location
where the point load is applied. [L]

Val

This is an array that includes the value of the point load. [F] when MyType is 1 and [FL] when
MyType is 2

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
```

```
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the frame object specified by the Name
item.

If this item is Group, the assignments are retrieved for all frame objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected frame objects, and the
Name item is ignored.

## Remarks

This function retrieves the point load assignments to frame objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFramePointLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim FrameName() As String
Dim LoadPat() As String
Dim MyType() As Long
Dim CSys() As String
Dim Dir() As Long
Dim RelDist() As Double
Dim Dist() As Double
Dim Val() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame point loads


ret = SapModel.FrameObj.SetLoadPoint("14", "DEAD", 1, 10, .5, 20)
ret = SapModel.FrameObj.SetLoadPoint("15", "DEAD", 1, 10, .5, 20)

'get frame point loads
ret = SapModel.FrameObj.GetLoadPoint("ALL", NumberItems, FrameName, LoadPat,
MyType, CSys, Dir, RelDist, Dist, Val, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Changed descriptions for Dir 7, 8, 9 and 11 to "Not Used" in version 25.0.0

## See Also

SetLoadPoint

DeleteLoadPoint

# GetLoadPointWithGUID

## Syntax

SapObject.SapModel.FrameObj.GetLoadPointWithGUID

## VB6 Procedure

Function GetLoadPointWithGUID(ByVal Name As String, ByRef NumberItems As Integer,
ByRef FrameName() As String, ByRef LoadPat() As String, ByRef MyType() As Integer, ByRef
CSys() As String, ByRef Dir() As Integer, ByRef RelDist() As Double, ByRef Dist() As Double,
ByRef Val() As Double, ByRef GUID() As String, Optional ByVal ItemType As eItemType =
eItemType.Objects) As Long

## Parameters

Name

The name of an existing frame object or group depending on the value of the ItemType item.

NumberItems


The total number of point loads retrieved for the specified frame objects.

FrameName

This is an array that includes the name of the frame object associated with each point load.

LoadPat

This is an array that includes the name of the coordinate system in which the point loads are
specified.

MyType

This is an array that includes 1 or 2, indicating the type of point load.

```
1 = Force
2 = Moment
```
CSys

This is an array that includes the name of the coordinate system in which each point load is
defined. It may be Local or the name of a defined coordinate system.

Dir

This is an array that includes an integer between 1 and 11 indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Projected Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

RelDist

This is an array that includes the relative distance from the I-End of the frame object to the
location where the point load is applied.

Dist

This is an array that includes the actual distance from the I-End of the frame object to the location
where the point load is applied. [L]

Val


This is an array that includes the value of the point load. [F] when MyType is 1 and [FL] when
MyType is 2

GUID

This is an array that includes the global unique ID of the point load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the frame object specified by the Name
item.

If this item is Group, the assignments are retrieved for all frame objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected frame objects, and the
Name item is ignored.

## Remarks

This function retrieves the point load assignments to frame objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## Release Notes

Initial release in version 17.2.0.

## See Also

SetLoadPointWithGUID

DeleteLoadPointWithGUID

# GetLoadStrain

## Syntax

SapObject.SapModel.FrameObj.GetLoadStrain


## VB6 Procedure

Function GetLoadStrain(ByVal Name As String, ByRef NumberItems As Long, ByRef
FrameName() As String, ByRef LoadPat() As String, ByRef DOF() As Long, ByRef Val() As
Double, ByRef PatternName() As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

NumberItems

The total number of strain loads retrieved for the specified frame objects.

FrameName

This is an array that includes the name of the frame object associated with each strain load.

LoadPat

This is an array that includes the name of the load pattern associated with each strain load.

DOF

This is an array that includes 1, 2, 3, 4, 5 or 6, indicating the degree of freedom associated with
each strain load.

```
1 = Strain11
2 = Strain12
3 = Strain13
4 = Curvature1
5 = Curvature2
6 = Curvature3
```
Val

This is an array that includes the strain value. [L/L] for DOF = 1, 2 and 3 and [1/L] for DOF = 4, 5
and 6

PatternName

This is an array that includes the joint pattern name, if any, used to specify the strain load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the assignments are retrieved for the frame object specified by the Name
item.

If this item is Group, the assignments are retrieved for all frame objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected frame objects, and the
Name item is ignored.

## Remarks

This function retrieves the strain load assignments to frame objects.

The function returns zero if the strain load assignments are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetFrameStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim FrameName() As String
Dim LoadPat() As String
Dim DOF() As Long
Dim Val() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame strain load
ret = SapModel.FrameObj.SetLoadStrain("1", "DEAD", 1, 0.001)

'get frame strain load
ret = SapModel.FrameObj.GetLoadStrain("1", NumberItems, FrameName, LoadPat, DOF,
Val, PatternName)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadStrain

DeleteLoadStrain

# GetLoadTargetForce

## Syntax

SapObject.SapModel.FrameObj.GetLoadTargetForce

## VB6 Procedure

Function GetLoadTargetForce(ByVal Name As String, ByRef NumberItems As Long, ByRef
FrameName() As String, ByRef LoadPat() As String, ByRef dof1() As Boolean, ByRef dof2() As
Boolean, ByRef dof3() As Boolean, ByRef dof4() As Boolean, ByRef dof5() As Boolean, ByRef
dof6() As Boolean, ByRef P() As Double, ByRef V2() As Double, ByRef V3() As Double, ByRef
T() As Double, ByRef M2() As Double, ByRef M3() As Double, ByRef T1() As Double, ByRef
T2() As Double, ByRef T3() As Double, ByRef T4() As Double, ByRef T5() As Double, ByRef
T6() As Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

NumberItems

The total number of deformation loads retrieved for the specified frame objects.

FrameName

This is an array that includes the name of the frame object associated with each target force.


LoadPat

This is an array that includes the name of the load pattern associated with each target force.

dof1, dof2, dof3, dof4, dof5, dof6

These are arrays of boolean values indicating if the considered degree of freedom has a target
force assignment.

```
dof1 = P
dof2 = V2
dof3 = V3
dof4 = T
dof5 = M2
dof6 = M3
```
P, V2, V3, T, M2, M3

These are arrays of target force values. The target forces specified for a given degree of freedom
are applicable only if the corresponding DOF item for that degree of freedom is True.

```
U1 = U1 deformation [L]
U2 = U2 deformation [L]
U3 = U3 deformation [L]
R1 = R1 deformation [rad]
R2 = R2 deformation [rad]
R3 = R3 deformation [rad]
```
T1, T2, T3, T4, T5, T6

These are arrays of the relative distances along the frame objects where the target force values
apply. The relative distances specified for a given degree of freedom are applicable only if the
corresponding dof _n_ item for that degree of freedom is True.

```
T1 = relative location for P target force
T2 = relative location for V2 target force
T3 = relative location for V3 target force
T4 = relative location for T target force
T5 = relative location for M2 target force
T6 = relative location for M3 target force
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the frame object specified by the Name
item.

If this item is Group, the assignments are retrieved for all frame objects in the group specified by
the Name item.


If this item is SelectedObjects, assignments are retrieved for all selected frame objects, and the
Name item is ignored.

## Remarks

This function retrieves the target force assignments to frame objects.

The function returns zero if the target force assignments are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetFrameTargetForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim f() As double
Dim RD() As double
Dim NumberItems As Long
Dim FrameName() As String
Dim LoadPat() As String
Dim dof1() As Boolean
Dim dof2() As Boolean
Dim dof3() As Boolean
Dim dof4() As Boolean
Dim dof5() As Boolean
Dim dof6() As Boolean
Dim P() As Double
Dim V2() As Double
Dim V3() As Double
Dim T() As Double
Dim M2() As Double
Dim M3() As Double
Dim T1() As Double
Dim T2() As Double
Dim T3() As Double
Dim T4() As Double
Dim T5() As Double
Dim T6() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame target force
ReDim DOF(5)
ReDim f(5)
ReDim RD(5)
DOF(0) = True
f(0) = 50
RD(0) = 0.5
ret = SapModel.FrameObj.SetLoadTargetForce("1", "DEAD", DOF, f, RD)

'get frame target force
ret = SapModel.FrameObj.GetLoadTargetForce("1", NumberItems, FrameName, LoadPat,
dof1, dof2, dof3, dof4, dof5, dof6, P, V2, V3, T, M2, M3, T1, T2, T3, T4, T5, T6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadTargetForce

DeleteLoadTargetForce

# GetLoadTemperature

## Syntax

SapObject.SapModel.FrameObj.GetLoadTemperature

## VB6 Procedure

Function GetLoadTemperature(ByVal Name As String, ByRef NumberItems As Long, ByRef
FrameName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef Val() As


Double, ByRef PatternName() As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

NumberItems

The total number of temperature loads retrieved for the specified frame objects.

FrameName

This is an array that includes the name of the frame object associated with each temperature load.

LoadPat

This is an array that includes the name of the load pattern associated with each temperature load.

MyType

This is an array that includes 1, 2 or 3, indicating the type of temperature load.

```
1 = Temperature
2 = Temperature gradient along local 2 axis
3 = Temperature gradient along local 3 axis
```
Val

This is an array that includes the temperature load value. [T] for MyType= 1 and [T/L] for
MyType= 2 and 3

PatternName

This is an array that includes the joint pattern name, if any, used to specify the temperature load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the frame object specified by the Name
item.

If this item is Group, the assignments are retrieved for all frame objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected frame objects, and the
Name item is ignored.


## Remarks

This function retrieves the temperature load assignments to frame objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim FrameName() As String
Dim LoadPat() As String
Dim MyType() As Long
Dim Val() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame temperature load
ret = SapModel.FrameObj.SetLoadTemperature("All", "DEAD", 1, 50, , , Group)

'get frame temperature load
ret = SapModel.FrameObj.GetLoadTemperature("ALL", NumberItems, FrameName,
LoadPat, MyType, Val, PatternName, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadTemperature

DeleteLoadTemperature

### GetLoadTransfer

```
Syntax
SapObject.SapModel.FrameObj.GetLoadTransfer
```
```
VB6 Procedure
Function GetLoadTransfer(ByVal Name As String, ByRef Val As Boolean) As Long
```
```
Parameters
Name
The name of an existing frame.
Val
This boolean value indicates if load is allowed to be transferred from area objects to this frame
object.
```
```
Remarks
This function returns the load transfer option for a frame object. It indicates whether the frame
receives load from an area object when the area object is loaded with a load of type uniform to
frame.
The function returns zero if the load transfer option is successfully returned, otherwise it returns a
nonzero value.
```
```
VBA Example
Sub GetLoadTransferOption()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim val As Boolean
```
```
'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
SapObject.ApplicationStart
```
```
'create SapModel object
Set SapModel = SapObject.SapModel
```
```
'initialize model
ret = SapModel.InitializeNewModel
```
```
'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
```
'get the load transfer option to False for frame object 1
```

```
ret = SapModel.FrameObj.GetLoadTransfer("1", val)
```
```
'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub
```
**Release Notes**
Initial release in version 16.0.0.

**See Also**
SetLoadTransfer

# GetLocalAxes

## Syntax

SapObject.SapModel.FrameObj.GetLocalAxes

## VB6 Procedure

Function GetLocalAxes(ByVal Name As String, ByRef Ang As Double, ByRef Advanced As
Boolean) As Long

## Parameters

Name

The name of an existing frame object.

Ang

This is the angle that the local 2 and 3 axes are rotated about the positive local 1 axis, from the
default orientation or, if the Advanced item is True, from the orientation determined by the plane
reference vector. The rotation for a positive angle appears counter clockwise when the local +1
axis is pointing toward you. [deg]

Advanced

This item is True if the line object local axes orientation was obtained using advanced local axes
parameters.

## Remarks

This function retrieves the frame local axis angle assignment for frame objects.

The function returns zero if the assignment is successfully retrieved, otherwise it returns a nonzero
value.


## VBA Example

Sub GetFrameLocalAxisAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Ang As Double
Dim Advanced As boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get frame local axis angle
ret = SapModel.FrameObj.GetLocalAxes("3", Ang, Advanced)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetLocalAxes

# GetLocalAxesAdvanced

## Syntax

SapObject.SapModel.FrameObj.GetLocalAxesAdvanced


## VB6 Procedure

Function GetLocalAxesAdvanced(ByVal Name As String, ByRef Active As Boolean, ByRef
Plane2 As Long, ByRef PlVectOpt As Long, ByRef PlCSys As String, ByRef PlDir() As Long,
ByRef PlPt() As String, ByRef PlVect() As Double) As Long

## Parameters

Name

The name of an existing frame object.

Active

This is True if advanced local axes exist.

Plane2

This is 12 or 13, indicating that the local plane determined by the plane reference vector is the 1-2
plane or the 1-3 plane. This item applies only when the Active item is True.

PlVectOpt

This is 1, 2, or 3, indicating the plane reference vector option. This item applies only when the
Active item is True.

```
1 = Coordinate direction
2 = Two joints
3 = User vector
```
PlCSys

The coordinate system used to define the plane reference vector coordinate directions and the
plane user vector. This item applies when the Active item is True and the PlVectOpt item is 1 or 3.

PlDir

This is an array dimensioned to 1 (2 integers), indicating the plane reference vector primary and
secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center in
the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the PlVectOpt item is 1. Possible coordinate direction
values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```

PlPt

This is an array dimensioned to 1 (2 strings), indicating the labels of two joints that define the
plane reference vector. Either of these joints may be specified as None to indicate the center of the
specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the PlVectOpt item is 2.

PlVect

This is an array dimensioned to 2 (3 doubles) that defines the plane reference vector. This item
applies when the Active item is True and the PlVectOpt item is 3.

## Remarks

This function retrieves the advanced local axes assignments to frame objects.

The function returns zero if the advanced local axes assignments are successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetFrameAdvancedLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyPlDir(1) As Long
Dim MyPlPt(1) As String
Dim MyPlVect(2) As Double
Dim Ang As Double
Dim Advanced As Boolean
Dim Active As Boolean
Dim Plane2 As Long
Dim PlVectOpt As Long
Dim PlCSys As String
Dim PlDir() As Long
Dim PlPt() As String
Dim PlVect() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame advanced local axes
MyPlDir(0) = 2
MyPlDir(1) = 3
ret = SapModel.FrameObj.SetLocalAxesAdvanced("3", True, 12, 1, "Global", MyPlDir,
MyPlPt, MyPlVect)

'get frame local axis angle
ret = SapModel.FrameObj.GetLocalAxes("3", Ang, Advanced)

'get frame advanced local axes data
If Advanced Then
ret = SapModel.FrameObj.GetLocalAxesAdvanced("3", Active, Plane2, PlVectOpt,
PlCSys, PlDir, PlPt, PlVect)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also

SetLocalAxesAdvanced

SetLocalAxes

GetLocalAxes

# GetMass

## Syntax

SapObject.SapModel.FrameObj.GetMass

## VB6 Procedure

Function GetMass(ByVal Name As String, ByRef MassOverL As Double) As Long

## Parameters

Name


The name of an existing frame object.

MassOverL

The mass per unit length assigned to the frame object. [M/L]

## Remarks

This function retrieves the frame mass per unit length assignment for frame objects.

The function returns zero if the mass assignment is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MassOverL As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame mass
ret = SapModel.FrameObj.SetMass("ALL", .0001, False, Group)

'get frame mass assignment
ret = SapModel.FrameObj.GetMass("3", MassOverL)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.00.

## See Also

SetMass

DeleteMass

# GetMaterialOverwrite

## Syntax

SapObject.SapModel.FrameObj.GetMaterialOverwrite

## VB6 Procedure

Function GetMaterialOverwrite(ByVal Name As String, ByRef PropName As String) As Long

## Parameters

Name

The name of a defined frame object.

PropName

This is None, indicating that no material overwrite exists for the specified frame object, or it is the
name of an existing material property.

## Remarks

This function retrieves the material overwrite assigned to a frame object, if any. It returns None if
there is no material overwrite assignment.

The function returns zero if the material overwrite assignment is successfully retrieved, otherwise
it returns a nonzero value.

## VBA Example

Sub GetFrameMaterialOverwrite()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign material overwrite
ret = SapModel.FrameObj.SetMaterialOverwrite("3", "4000Psi")

'get material overwrite assignment
ret = SapModel.FrameObj.GetMaterialOverwrite("3", PropName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetMaterialOverwrite

# GetMatTemp

## Syntax

SapObject.SapModel.FrameObj.GetMatTemp

## VB6 Procedure

Function GetMatTemp(ByVal Name As String, ByRef Temp As Double, ByRef PatternName As
String) As Long

## Parameters

Name


The name of an existing frame object.

Temp

This is the material temperature value assigned to the frame object. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
frame object is uniform along the object at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the frame object
may vary from one end to the other. The material temperature at each end of the object is equal to
the specified temperature multiplied by the pattern value at the joint at the end of the frame object.

## Remarks

This function retrieves the material temperature assignments to frame objects.

The function returns zero if the material temperature assignments are successfully retrieved,
otherwise it returns a nonzero value.

## VBA Example

Sub GetFrameMatTemp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Temp As Double
Dim PatternName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign material temperature
ret = SapModel.FrameObj.SetMatTemp("ALL", 50, , Group)

'get material temperature
ret = SapModel.FrameObj.GetMatTemp("3", Temp, PatternName)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetMatTemp

# GetModifiers

## Syntax

SapObject.SapModel.FrameObj.GetModifiers

## VB6 Procedure

Function GetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing frame object.

Value

This is an array of eight unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Shear area in local 2 direction modifier
Value(2) = Shear area in local 3 direction modifier
Value(3) = Torsional constant modifier
Value(4) = Moment of inertia about local 2 axis modifier
Value(5) = Moment of inertia about local 3 axis modifier
Value(6) = Mass modifier
Value(7) = Weight modifier
```
## Remarks

This function retrieves the frame modifier assignment for frame objects. The default value for all
modifiers is one.


The function returns zero if the modifier assignments are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetFrameModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign modifiers
ReDim Value(7)
For i = 0 To 7
Value(i) = 1
Next i
Value(5) = 100
ret = SapModel.FrameObj.SetModifiers("3", Value)

'get modifiers
ReDim Value(7)
ret = SapModel.FrameObj.GetModifiers("3", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

SetModifiers

DeleteModifiers

# GetNameList

## Syntax

SapObject.SapModel.FrameObj.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of frame object names retrieved by the program.

MyName

This is a one-dimensional array of frame object names. The MyName array is created as a
dynamic, zero-based, array by the APIuser:

Dim MyName() as String

The array is dimensioned to (NumberNames  1) inside the Sap2000 program, filled with the
names, and returned to the APIuser.

## Remarks

This function retrieves the names of all defined frame objects.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetFrameObjectNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get frame object names
ret = SapModel.FrameObj.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetNotionalSize

## Syntax

SapObject.SapModel.PropFrame.GetNotionalSize

## VB6 Procedure

Function GetNotionalSize(ByVal Name As String, ByRef stype As String, ByRef Value As
Double) As Long

## Parameters

Name

The name of an existing frame section property.


stype

The type to define the notional size of a section. It can be:

```
"Auto" = Program will determine the notional size based on the average thickness of
an area element.
```
```
"User" = The notional size is based on the user-defined value.
```
```
"None" = Notional size will not be considered. In other words, the time-dependent
effect of this section will not be considered.
```
Value

For **stype** is "Auto", the Value represents for the scale factor to the program-determined notional
size; for **stype** is User, the **Value** represents for the user-defined notional size [L]; for **stype** is
None, the **Value** will not be used and can be set to 1.

## Remarks

This function retrieves the method to determine the notional size of a frame section for the creep
and shrinkage calculations. This function is currently worked for the steel/aluminum sections -
I/Wide Flange, Channel, Tee, Angle, Double Angle, Double Channel, Pipe and Tube sections, and
all the concrete sections - Rectangular, Circular, Pipe, Tube, Precast I.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFramePropNotionalSize()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long

```
Dim stype As String
```
```
Dim Value As Double
```
```
'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
SapObject.ApplicationStart
```
```
'create SapModel object
Set SapModel = SapObject.SapModel
```
```
'initialize model
```

```
ret = SapModel.InitializeNewModel
```
```
'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)
```
```
'assign parameters
ret = SapModel.PropFrame.SetNotionalSize("FSEC1", Auto, 1.1)
```
```
'get parameters
ret = SapModel.PropFrame.SetNotionalSize("FSEC1", stype, Value)
```
```
'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.1.0

## See Also

SetNotionalSize

# GetOutputStations

## Syntax

SapObject.SapModel.FrameObj.GetOutputStations

## VB6 Procedure

Function GetOutputStations(ByVal Name As String, ByRef MyType As Long, ByRef
MaxSegSize As Double, ByRef MinSections As Long, ByRef
NoOutPutAndDesignAtElementEnds As Boolean, ByRef NoOutPutAndDesignAtPointLoads As
Boolean) As Long

## Parameters

Name

The name of an existing frame object.

MyType

This is either 1 or 2 indicating how the output stations are specified.


```
1 = maximum segment size, that is, maximum station spacing
2 = minimum number of stations
```
MaxSegSize

The maximum segment size, that is, the maximum station spacing. This item applies only when
MyType = 1. [L]

MinSections

The minimum number of stations. This item applies only when MyType = 2.

NoOutPutAndDesignAtElementEnds

If this item is True, no additional output stations are added at the ends of line elements when the
frame object is internally meshed.

NoOutPutAndDesignAtPointLoads

If this item is True, no additional output stations are added at point load locations.

## Remarks

This function retrieves frame object output station data.

The function returns zero if the data is successfully retrieved, otherwise it returns a nonzero value.

## VBA Example

Sub GetFrameOutputStationData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As Long
Dim MaxSegSize As Double
Dim MinSections As Long
Dim NoOutPutAndDesignAtElementEnds As Boolean
Dim NoOutPutAndDesignAtPointLoads As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get frame output station data
ret = SapModel.FrameObj.GetOutputStations("15", MyType, MaxSegSize, MinSections,
NoOutPutAndDesignAtElementEnds, NoOutPutAndDesignAtPointLoads)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetOutputStations

# GetPDeltaForce

## Syntax

SapObject.SapModel.FrameObj.GetPDeltaForce

## VB6 Procedure

Function GetPDeltaForce(ByVal Name As String, ByRef NumberForces As Long, ByRef
PDeltaForce() As Double, ByRef Dir() As Long, ByRef CSys() As String) As Long

## Parameters

Name

The name of an existing straight frame object.

NumberForces

The number of P-Delta forces assigned to the frame object.

PDeltaForce

This is an array of the P-Delta force values assigned to the frame object. [F]

Dir

This is an array that contains 0, 1, 2 or 3, indicating the direction of each P-Delta force
assignment.


```
0 = Frame object local 1-axis direction
1 = Projected X direction in CSys coordinate system
2 = Projected Y direction in CSys coordinate system
3 = Projected Z direction in CSys coordinate system
```
CSys

This is an array that contains the name of the coordinate system in which each projected P-Delta
force is defined. This item is blank when the Dir item is zero, that is, when the P-Delta force is
defined in the frame object local 1-axis direction.

## Remarks

This function retrieves the P-Delta force assignments to frame objects. P-Delta forces do not apply
to curved frame objects. If you request data for a curved frame, an error is returned.

The function returns zero if the assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFramePDeltaForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberForces As Long
Dim PDeltaForce() As Double
Dim Dir() As Long
Dim CSys() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign P-Delta force
ret = SapModel.FrameObj.SetPDeltaForce("ALL", 100, 0, True, , Group)

'get P-Delta force
ret = SapModel.FrameObj.GetPDeltaForce("3", NumberForces, PDeltaForce, Dir, CSys)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetPDeltaForce

DeletePDeltaForce

# GetPoints

## Syntax

SapObject.SapModel.FrameObj.GetPoints

## VB6 Procedure

Function GetPoints(ByVal Name As String, ByRef Point1 As String, ByRef Point2 As String) As
Long

## Parameters

Name

The name of a defined frame object.

Point1

The name of the point object at the I-End of the specified frame object.

Point2

The name of the point object at the J-End of the specified frame object.

## Remarks

This function retrieves the names of the point objects at each end of a specified frame object.

The function returns zero if the point names are successfully retrieved, otherwise it returns a
nonzero value.


## VBA Example

Sub GetFrameObjPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Point1 As String
Dim Point2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get names of points
ret = SapModel.FrameObj.GetPoints("3", Point1, Point2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetReleases

## Syntax

SapObject.SapModel.FrameObj.GetReleases

## VB6 Procedure


Function GetReleases(ByVal Name As String, ByRef ii() As Boolean, ByRef jj() As Boolean,
ByRef StartValue() As Double, ByRef EndValue() As Double) As Long

## Parameters

Name

The name of an existing frame object.

ii, jj

These are arrays of six booleans indicating the I-End and J-End releases for the frame object.

```
ii(0) and jj(0) = U1 release
ii(1) and jj(1) = U2 release
ii(2) and jj(2) = U3 release
ii(3) and jj(3) = R1 release
ii(4) and jj(4) = R2 release
ii(5) and jj(5) = R3 release
```
StartValue, EndValue

These are arrays of six values indicating the I-End and J-End partial fixity springs for the frame
object.

```
StartValue(0) and EndValue(0) = U1 partial fixity [F/L]
StartValue(1) and EndValue(1) = U2 partial fixity [F/L]
StartValue(2) and EndValue(2) = U3 partial fixity [F/L]
StartValue(3) and EndValue(3) = R1 partial fixity [FL/rad]
StartValue(4) and EndValue(4) = R2 partial fixity [FL/rad]
StartValue(5) and EndValue(5) = R3 partial fixity [FL/rad]
```
## Remarks

This function retrieves the frame object end release and partial fixity assignments.

The function returns zero if the assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameEndReleases()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ii() As Boolean
Dim jj() As Boolean
Dim StartValue() As Double
Dim EndValue() As Double


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign end releases
ReDim ii(5)
ReDim jj(5)
ReDim StartValue(5)
ReDim EndValue(5)
ii(5) = True
jj(5) = True
ret = SapModel.FrameObj.SetReleases("13", ii, jj, StartValue, EndValue)

'get end releases
ReDim ii(5)
ReDim jj(5)
ReDim StartValue(5)
ReDim EndValue(5)
ret = SapModel.FrameObj.GetReleases("13", ii, jj, StartValue, EndValue)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetReleases

# GetSection

## Syntax


SapObject.SapModel.FrameObj.GetSection

## VB6 Procedure

Function GetSection(ByVal Name As String, ByRef PropName As String, ByRef SAuto As
String) As Long

## Parameters

Name

The name of a defined frame object.

PropName

If no auto select list is assigned to the frame object, this is the name of the frame section property
assigned to the frame object. If an auto select list is assigned to the frame object, this is the name
of the frame section property, within the auto select list, which is currently being used as the
analysis property for the frame object. If this item is None, no frame section property is assigned
to the frame object.

SAuto

This is the name of the auto select list assigned to the frame object, if any. If this item is returned
as a blank string, no auto select list is assigned to the frame object.

## Remarks

This function retrieves the frame section property assigned to a frame object.

The function returns zero if the frame object property is successfully retrieved, otherwise it returns
a nonzero value.

## VBA Example

Sub GetFrameSectionProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropName As String
Dim SAuto As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get frame section property
ret = SapModel.FrameObj.GetSection("3", PropName, SAuto)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSectionNonPrismatic

SetSection

# GetSectionNonPrismatic

## Syntax

SapObject.SapModel.FrameObj.GetSectionNonPrismatic

## VB6 Procedure

Function GetSectionNonPrismatic(ByVal Name As String, ByRef PropName As String, ByRef
sVarTotalLength As Double, ByRef sVarRelStartLoc As Double) As Long

## Parameters

Name

The name of a defined frame object.

PropName

The name of the nonprismatic frame section property assigned to the frame object.

sVarTotalLength


This is the total assumed length of the nonprismatic section. Enter 0 for this item to indicate that
the section length is the same as the frame object length.

sVarRelStartLoc

This is the relative distance along the nonprismatic section to the I-End (start) of the frame object.
This item is ignored when the sVarTotalLengthitem is 0.

## Remarks

This function retrieves the nonprismatic frame section property data assigned to a frame object.

The function returns zero if the nonprismatic frame object property data is successfully retrieved,
otherwise it returns a nonzero value.

The function returns an error if the section property assigned to the frame object is not a
nonprismatic property.

## VBA Example

Sub GetFrameSectionNonPrismatic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim StartSec() As String
Dim EndSec() As String
Dim MyLength() As Double
Dim MyType() As Long
Dim EI33() As Long
Dim EI22() As Long
Dim Color As Long
Dim Notes As String
Dim GUID As String
Dim PropName As String
Dim sVarTotalLength As Double
Dim sVarRelStartLoc As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC1", "A992Fy50", 24, 8, 0.5, 0.3, 8, 0.5)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC2", "A992Fy50", 20, 8, 0.5, 0.3, 8, 0.5)

'set new nonprismatic frame section property
ReDim StartSec(2)
ReDim EndSec(2)
ReDim MyLength(2)
ReDim MyType(2)
ReDim EI33(2)
ReDim EI22(2)
StartSec(0) = "ISEC2"
EndSec(0) = "ISEC1"
MyLength(0) = 60
MyType(0) = 2
EI33(0)= 2
EI22(0)= 1

StartSec(1) = "ISEC1"
EndSec(1) = "ISEC1"
MyLength(1) = 1
MyType(1) = 1
EI33(1)= 2
EI22(1)= 1

StartSec(2) = "ISEC1"
EndSec(2) = "ISEC2"
MyLength(2) = 60
MyType(2) = 2
EI33(2)= 2
EI22(2)= 1

ret = SapModel.PropFrame.SetNonPrismatic("NP1", 3, StartSec, EndSec, MyLength,
MyType, EI33, EI22)

'set frame section property
ret = SapModel.FrameObj.SetSection("8", "NP1", Object, 0.1, 360)

'get nonprismatic frame section property
ret = SapModel.FrameObj.GetSectionNonPrismatic("8", PropName, sVarTotalLength,
sVarRelStartLoc)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetSection

SetSection

# GetSelected

## Syntax

Sap2000.FrameObj.GetSelected

## VB6 Procedure

Function GetSelected(ByVal Name As String, ByRef Selected As Boolean) As Long

## Parameters

Name

The name of an existing frame object.

Selected

This item returns True if the specified frame object is selected, otherwise it returns False.

## Remarks

This function retrieves the selected status for a frame object.

The function returns zero if the selected status is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameObjectSelectedStatus()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Selected As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set all frames selected
ret = SapModel.FrameObj.SetSelected("All", True, Group)

'get frame object selected status
ret = SapModel.FrameObj.GetSelected("8", Selected)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSelected

# GetSpring

## Syntax

SapObject.SapModel.FrameObj.GetSpring

## VB6 Procedure

Function GetSpring(ByVal Name As String, ByRef NumberSprings As Long, ByRef MyType()
As Long, ByRef s() As Double, ByRef SimpleSpringType() As Long, ByRef LinkProp() As
String, ByRef SpringLocalOneType() As Long, ByRef Dir() As Long, ByRef Plane23Angle() As
Double, ByRef VecX() As Double, ByRef VecY() As Double, ByRef VecZ() As Double, ByRef
CSys() As String, ByRef Ang() As Double) As Long


## Parameters

Name

The name of an existing frame object.

NumberSprings

The number of springs assignments made to the specified frame object.

MyType

Each value in this array is either 1 or 2, indicating the spring property type.

```
1 = Simple spring
2 = Link property
```
s

Each value in this array is the simple spring stiffness per unit length of the frame object. This item

applies only when the corresponding MyType = 1. [F/L^2 ]

SimpleSpringType

Each value in this array is 1, 2 or 3, indicating the simple spring type. This item applies only when
the corresponding MyType = 1.

```
1 = Spring resists tension and compression
2 = Spring resists compression only
3 = Spring resists tension only
```
LinkProp

Each value in this array is the name of the link property assigned to the spring. This item applies
only when the corresponding MyType = 2.

SpringLocalOneType

Each value in this array is 1, 2 or 3, indicating the method used to specify the spring positive local
1-axis orientation.

```
1 = Parallel to frame object local axis
2 = In the frame object 2-3 plane
3 = User specified direction vector
```
Dir

Each value in this array is 1, 2, 3, -1, -2 or -3, indicating the frame object local axis that
corresponds to the positive local 1-axis of the spring. This item applies only when the
corresponding SpringLocalOneType = 1.

Plane23Angle


Each value in this array is the angle in the frame object 2-3 plane measured counter clockwise
from the frame positive 2-axis to the spring positive 1-axis. This item applies only when the
corresponding SpringLocalOneType = 2. [deg]

VecX

Each value in this array is the X-axis or frame local 1-axis component (depending on the CSys
specified) of the user specified direction vector for the spring local 1-axis. The direction vector is
in the coordinate system specified by the CSys item. This item applies only when the
corresponding SpringLocalOneType = 3.

VecY

Each value in this array is the Y-axis or frame local 2-axis component (depending on the CSys
specified) of the user specified direction vector for the spring local 1-axis. The direction vector is
in the coordinate system specified by the CSys item. This item applies only when the
corresponding SpringLocalOneType = 3.

VecZ

Each value in this array is the X-axis or frame local 3-axis component (depending on the CSys
specified) of the user specified direction vector for the spring local 1-axis. The direction vector is
in the coordinate system specified by the CSys item. This item applies only when the
corresponding SpringLocalOneType = 3.

CSys

Each value in this array is Local (meaning the frame object local coordinate system) or the name
of a defined coordinate system. This item is the coordinate system in which the user specified
direction vector, Vec, is specified. This item applies only when the corresponding
SpringLocalOneType = 3.

Ang

Each value in this array is the angle that the link local 2-axis is rotated from its default orientation.
This item applies only when the corresponding MyType = 2. [deg]

## Remarks

This function retrieves the spring assignments to a frame object.

The function returns zero if the assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSprings()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Vec() As Double
Dim NumberSprings As Long


Dim MyType() As Long
Dim s() As Double
Dim SimpleSpringType() As Long
Dim LinkProp() As String
Dim SpringLocalOneType() As Long
Dim Dir() As Long
Dim Plane23Angle() As Double
Dim VecX() As Double
Dim VecY() As Double
Dim VecZ() As Double
Dim CSys() As String
Dim Ang() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign springs to frame
ReDim Vec(2)
ret = SapModel.FrameObj.SetSpring("ALL", 1, 1, 1, "", 1, 2, 0, Vec, 0, False, "Local",
Group)

'get spring assignments to frames
ret = SapModel.FrameObj.GetSpring("1", numbersprings, MyType, s, SimpleSpringType,
LinkProp, SpringLocalOneType, Dir, Plane23Angle, VecX, VecY, VecZ, CSys, Ang)

'close Sap2000}
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSpring


DeleteSpring

# GetTCLimits

## Syntax

SapObject.SapModel.FrameObj.GetTCLimits

## VB6 Procedure

Function GetTCLimits(ByVal Name As String, ByRef LimitCompressionExists As Boolean,
ByRef LimitCompression As Double, ByRef LimitTensionExists As Boolean, ByRef
LimitTension As Double) As Long

## Parameters

Name

The name of an existing frame object.

LimitCompressionExists

This item is True if a compression force limit exists for the frame object.

LimitCompression

The compression force limit for the frame object. [F]

LimitTensionExists

This item is True if a tension force limit exists for the frame object.

LimitTension

The tension force limit for the frame object. [F]

## Remarks

This function retrieves the tension/compression force limit assignments to frame objects.

The function returns zero if the assignments are successfully retrieved, otherwise it returns a
nonzero value.

Note that the tension and compression limits are used only in nonlinear analyses.

## VBA Example

Sub GetFrameTCLimits()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim LimitCompressionExists As Boolean
Dim LimitCompression As Double
Dim LimitTensionExists As Boolean
Dim LimitTension As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign tension/compression limits
ret = SapModel.FrameObj.SetTCLimits("1", False, 0, True, 100)

'get tension/compression limits
ret = SapModel.FrameObj.GetTCLimits("1", LimitCompressionExists, LimitCompression,
LimitTensionExists, LimitTension)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetTCLimits

# GetTransformationMatrix

## Syntax

Sap2000.FrameObj.GetTransformationMatrix


## VB6 Procedure

Function GetTransformationMatrix(ByVal Name As String, ByRef Value() As Double,Optional
ByVal IsGlobal As Boolean = True) As Long

## Parameters

Name

The name of an existing frame object.

Value

Value is an array of nine direction cosines that define the transformation matrix.

The following matrix equation shows how the transformation matrix is used to convert items from
the frame object local coordinate system to the global coordinate system.

In the equation, c0 through c8 are the nine values from the transformation array, (Local1, Local2,
Local3) are an item (such as a load) in the object local coordinate system, and (GlobalX, GlobalY,
GlobalZ) are the same item in the global coordinate system.

The transformation from the local coordinate system to the present coordinate system is the same
as that shown above for the global system if you substitute the present system for the global
system.

IsGlobal

If this item is True, the transformation matrix is between the Global coordinate system and the
frame object local coordinate system.

If this item is False, the transformation maxtrix is between the present coordinate system and the
frame object local coordinate system.

## Remarks

The function returns zero if the frame object transformation matrix is successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetFrameObjectMatrix()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'assign frame object local axis angle
ret = SapModel.FrameObj.SetLocalAxes("3", 30)

'get frame object transformation matrix
ReDim Value(8)
ret = SapModel.FrameObj.GetTransformationMatrix("3", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetTrapezoidal

## Syntax

SapObject.SapModel.PropFrame.GetTrapezoidal

## VB6 Procedure


Function GetTrapezoidal(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef t2b As Double, ByRef Color As Long,
ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing trapezoidal frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section top width. [L]

t2b

The section bottom width. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a trapezoidal frame section.

The function returns zero if the section property is successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetFramePropTrapezoidal()

'dimension variables

Dim SapObject as cOAPI

Dim SapModel As cSapModel

Dim ret As Long

Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim t2b As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application

SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetTrapezoidal("R1", "4000Psi", 20, 20, 12)

'get frame section property data

ret = SapModel.PropFrame.SetTrapezoidal("R1", FileName, MatProp, t3, t2, t2b, Color,
Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing


End Sub

## Release Notes

Initial release in version 17.2.0

## See Also

SetTrapezoidal

SetRebarBeam

SetRebarColumn

GetRebarBeam

GetRebarColumn

# GetTypeOAPI

## Syntax

SapObject.SapModel.FrameObj.GetTypeOAPI

## VB6 Procedure

Function GetTypeOAPI(ByVal Name As String, ByRef MyType As String) As Long

## Parameters

Name

The name of a defined frame object.

MyType

This is Straight or Curved, indicating the type of frame object.

## Remarks

This function retrieves the type of frame object (straight or curved).

The function returns zero if the frame object type is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example


Sub GetFrameType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get frame type
ret = SapModel.FrameObj.GetTypeOAPI("3", MyType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed function name to GetTypeOAPI in v17.0.0.

## See Also

SetStraight

SetCurved

GetCurved

# SetAutoMesh

## Syntax

SapObject.SapModel.FrameObj.SetAutoMesh


## VB6 Procedure

Function SetAutoMesh(ByVal Name As String, ByVal AutoMesh As Boolean, ByVal
AutoMeshAtPoints As Boolean, ByVal AutoMeshAtLines As Boolean, ByVal NumSegs As
Long, ByVal AutoMeshMaxLength As Double, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

AutoMesh

This item is True if the frame object is to be automatically meshed by the program when the
analysis model is created.

AutoMeshAtPoints

This item is applicable only when the AutoMesh item is True. If this item is True, the frame object
is automatically meshed at intermediate joints along its length.

AutoMeshAtLines

This item is applicable only when the AutoMesh item is True. If this item is True, the frame object
is automatically meshed at intersections with other frames, area object edges and solid object
edges.

NumSegs

This item is applicable only when the AutoMesh item is True. It is the minimum number of
elements into which the frame object is automatically meshed. If this item is zero, the number of
elements is not checked when the automatic meshing is done.

AutoMeshMaxLength

This item is applicable only when the AutoMesh item is True. It is the maximum length of auto
meshed frame elements. If this item is zero, the element length is not checked when the automatic
meshing is done. [L]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.


If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function makes automatic meshing assignments to frame objects.

The function returns zero if the meshing options are successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignFrameAutoMesh()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign automesh options
ret = SapModel.FrameObj.SetAutoMesh("ALL", True, True, True, 0, 0, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetAutoMesh


# SetCurved

## Syntax

SapObject.SapModel.FrameObj.SetCurved

## VB6 Procedure

Function SetCurved(ByVal Name As String, ByVal MyType As Long, ByVal x As Double,
ByVal y As Double, ByVal z As Double, ByVal PointName As String, ByVal Radius As Double,
ByVal NumSegs As Long, Optional ByVal CSys As String = "Global") As Long

## Parameters

Name

The name of a defined curved frame object.

MyType

This is 1, 2, 3, 4, or 5, indicating the curved frame type.

```
1 = Circular Arc Specified by a Third Point Name
2 = Circular Arc Specified by Third Point Coordinates
3 = Circular Arc Specified by Planar Point Coordinates and Radius
4 = Parabolic Arc Specified by a Third Point Name
5 = Parabolic Arc Specified by Third Point Coordinates
```
MyTypes 1, 2, 4, and 5 all define the curve by three points. The three points are the two end point
of the frame object and a third point defined by naming an existing point object or specifying
point coordinates.

MyType 3 defines a circular curved frame by it end points, the coordinates of another point that
lies in the plane of the curve but not necessarily on the curved frame, and a curve radius.

x, y, z

These are point coordinates in the coordinate system specified by CSys. [L]

For MyType 1 and 4 these items do not apply.

For MyType 2 and 5 these are the coordinates of the third point on the curved frame.

For MyType 3 these are the coordinates of the planar point that lies in the plane of the curved
frame.

PointName

This is the name of the point object that is the third point on the curved frame. This item applies
for MyType 1 and 4. It does not apply for MyType 2, 3 and 5.


Radius

The radius of the circular curved frame. This item only applies for MyType 3. [L]

NumSegs

This is the number of segments into which the program internally divides the curved frame.

CSys

This is the coordinate system in which the coordinates x, y and z are defined.

## Remarks

This function changes the curve data for a curved frame object and sets straight frame objects to
be curved.

The function returns zero if the frame object type is successfully set, otherwise it returns a nonzero
value.

## VBA Example

Sub SetFrameCurved()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set frame curved
ret = SapModel.FrameObj.SetCurved("13", 1, 0, 0, 0, "1", 0, 16)
ret = SapModel.FrameObj.SetCurved("14", 2, -200, 0, 176, "", 0, 16)
ret = SapModel.FrameObj.SetCurved("15", 3, 0, 0, 0, "", 100, 16)
ret = SapModel.FrameObj.SetCurved("16", 4, 0, 0, 0, "3", 0, 16)
ret = SapModel.FrameObj.SetCurved("17", 5, 0, 0, 176, "", 0, 16)

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Modified optional argument CSys to be ByVal in version 12.0.1.

## See Also

SetStraight

GetCurved

GetType

# SetDesignProcedure

## Syntax

SapObject.SapModel.FrameObj.SetDesignProcedure

## VB6 Procedure

Function SetDesignProcedure(ByVal Name As String, ByVal MyType As Long, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

MyType

This is 1 or 2, indicating the design procedure type desired for the specified frame object.

```
1 = Default from material
2 = No design
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
Selection = 2
```

If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is Selection, assignment is made to all selected frame objects and the Name item is
ignored.

## Remarks

This function sets the design procedure for frame objects.

The function returns zero if the design procedure is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetFrameObjDesignProcedure()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set design procedure
ret = SapModel.FrameObj.SetDesignProcedure("8", 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.02.

## See Also

GetDesignProcedure

# SetEndLengthOffset

## Syntax

SapObject.SapModel.FrameObj.SetEndLengthOffset

## VB6 Procedure

Function SetEndLengthOffset(ByVal Name As String, ByVal AutoOffset As Boolean, ByVal
Length1 As Double, ByVal Length2 As Double, ByVal rz As Double, Optional ByVal ItemType
As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

AutoOffset

If this item is True, the end length offsets are automatically determined by the program from
object connectivity, and the Length1, Length2 and rz items are ignored.

Length1

The offset length along the 1-axis of the frame object at the I-End of the frame object. [L]

Length2

The offset along the 1-axis of the frame object at the J-End of the frame object. [L]

rz

The rigid zone factor. This is the fraction of the end offset length assumed to be rigid for bending
and shear deformations.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function assigns frame object end offsets along the 1-axis of the object.

The function returns zero if the offsets are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignFrameEndOffsets()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign offsets
ret = SapModel.FrameObj.SetEndLengthOffset("15", False, 12, 12, 0.5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

GetEndLengthOffset

# SetEndSkew

## Syntax

SapObject.SapModel.FrameObj.SetEndSkew

## VB6 Procedure

Function SetEndSkew(ByVal Name As String, ByVal SkewI As Double, ByVal SkewJ As
Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

SkewI

The angle in degrees measured counter clockwise from the positive local 3-axis to a line parallel
to the I-End of the frame object (-90 < SkewI < 90). [deg]

SkewJ

The angle in degrees measured counter clockwise from the positive local 3-axis to a line parallel
to the J-End of the frame object (-90 < SkewJ < 90). [deg]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks


This function assigns frame object end skew data. End skew data is used in the program to plot the
extruded view of bridge objects that have been updated as spine models only.

The function returns zero if the end skew data is successfully assigned, otherwise it returns a
nonzero value.

End skew assignments are applicable only to straight frame objects.

## VBA Example

Sub AssignFrameEndSkewData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame end skew data
ret = SapModel.FrameObj.SetEndSkew("15", 10, 20)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetEndSkew

# SetFireproofing_1


## Syntax

SapObject.SapModel.FrameObj.SetFireProofing_1

## VB6 Procedure

Function SetFireProofing_1(ByVal Name As String, ByVal MyType As Long, ByVal Thickness
As Double, ByVal Perimeter As Double, ByVal Density As Double, ByVal tf As Boolean, ByVal
IncludeInSelfWeightAs Boolean, ByVal IncludeInGravityLoads As Boolean, Optional ByVal
IncludeInThisLoadPattern As String = "None", Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing frame object.

MyType

This is 1, 2 or 3, indicating the type of fireproofing assigned.

```
1 = Sprayed on - program calculate section perimeter
```
```
2 = Sprayed on - user provides section perimeter
```
```
3 = Concrete encased
```
Thickness

When MyType = 1 or MyType = 2 this is the thickness of the sprayed on fireproofing. When
MyType = 3 this is the concrete cover dimension. [L]

Perimeter

This item applies only when MyType = 2. It is the length of fireproofing applied measured around
the perimeter of the frame object cross-section. [L]

Density

This is the weight per unit volume of the fireproofing material. [F/L3]

tf

This item applies only when MyType = 1 or MyType = 3. If this item is True, the fireproofing is
assumed to be applied to the top flange of the section. If it is False, the program assumes no
fireproofing is applied to the section top flange. This flag applies for I, channel and double
channel sections.

IncludeInSelfWeight


If this item is True the fireproofing is included in the structure self weight.

IncludeInGravityLoads

If this item is True the fireproofing is included gravity loads applied in the X, Y and Z directions.

IncludeInThisLoadPattern

This item is either None or the name of an existing load pattern. If it is the name of a load pattern
then the weight of the fireproofing is applied as a distributed load in the global Z direction in the
load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

Object = 0

Group = 1

SelectedObjects = 2

If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function sets the fireproofing assignments to existing frame objects.

The function returns zero if the fireproofing assignments are successfully set, otherwise it returns
a nonzero value.

## VBA Example

```
Sub SetFireproofing()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
'create Sap2000 object
```

```
Set SapObject = CreateObject
("CSI.SAP2000.API.SapObject")
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144,
2, 288)
```
```
'add new load pattern
```
```
ret = SapModel.LoadPatterns.Add("Fireproofing",
LTYPE_SUPERDEAD)
```
```
'assign fireproofing, use in self weight and in load pattern
```
```
ret = SapModel.FrameObj.SetFireproofing_1("ALL", 1,
2, 0, 8.68E-06, False, True, False, "Fireproofing",
Group)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0. This function supersedes obsolete function SetFireProofing

## See Also

GetFireProofing_1

DeleteFireProofing


# SetGroupAssign

## Syntax

SapObject.SapModel.FrameObj.SetGroupAssign

## VB6 Procedure

Function SetGroupAssign(ByVal Name As String, ByVal GroupName As String, Optional By Val
Remove As Boolean = False, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

GroupName

The name of an existing group to which the assignment is made.

Remove

If this item is False, the specified frame objects are added to the group specified by the
GroupName item. If it is True, the frame objects are removed from the group.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the frame object specified by the Name item is added or removed from the
group specified by the GroupName item.

If this item is Group, all frame objects in the group specified by the Name item are added or
removed from the group specified by the GroupName item.

If this item is SelectedObjects, all selected frame objects are added or removed from the group
specified by the GroupName item, and the Name item is ignored.

## Remarks

This function adds or removes frame objects from a specified group.

The function returns zero if the group assignment is successful, otherwise it returns a nonzero
value.


## VBA Example

Sub AddFrameObjectsToGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'add frame objects to group
ret = SapModel.FrameObj.SetGroupAssign("8", "Group1")
ret = SapModel.FrameObj.SetGroupAssign("10", "Group1")

'select objects in group
ret = SapModel.SelectObj.Group("Group1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetGroupAssign

# SetGUID


## Syntax

SapObject.SapModel.FrameObj.SetGUID

## VB6 Procedure

Function SetGUID(ByVal Name As String, Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing frame object.

GUID

The GUID (Global Unique ID) for the specified frame object.

## Remarks

This function sets the GUID for the specified frame object. If the GUID is passed in as a blank
string, the program automatically creates a GUID for the object.

This function returns zero if the frame object GUID is successfully set; otherwise it returns
nonzero.

## VBA Example

Sub SetFrameObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'set program created GUID
ret = SapObject.SapModel.FrameObj.SetGUID("1")

'get GUID
ret = SapObject.SapModel.FrameObj.GetGUID("1", GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetGUID

# SetInsertionPoint_1

## Syntax

SapObject.SapModel.FrameObj.SetInsertionPoint_1

## VB6 Procedure

Function SetInsertionPoint_1(ByVal Name As String, ByVal CardinalPoint As Long, ByVal
Mirror2, ByVal Mirror3, As Boolean, ByVal StiffTransform As Boolean, ByRef Offset1() As
Double, ByRef Offset2() As Double, Optional ByVal CSys As String = "Local", Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

CardinalPoint

This is a numeric value from 1 to 11 that specifies the cardinal point for the frame object. The
cardinal point specifies the relative position of the frame section on the line representing the frame
object.

```
1 = bottom left
2 = bottom center
3 = bottom right
4 = middle left
```

```
5 = middle center
6 = middle right
7 = top left
8 = top center
9 = top right
10 = centroid
11 = shear center
```
Mirror2

If this item is True, the frame object section is assumed to be mirrored (flipped) about its local 2-
axis.

Mirror3

If this item is True, the frame object section is assumed to be mirrored (flipped) about its local 3-
axis.

StiffTransform

If this item is True, the frame object stiffness is transformed for cardinal point and joint offsets
from the frame section centroid.

Offset1

This is an array of three joint offset distances, in the coordinate directions specified by CSys, at
the I-End of the frame object. [L]

```
Offset1(0) = Offset in the 1-axis or X-axis direction
Offset1(1) = Offset in the 2-axis or Y-axis direction
Offset1(2) = Offset in the 3-axis or Z-axis direction
```
Offset2

This is an array of three joint offset distances, in the coordinate directions specified by CSys, at
the J-End of the frame object. [L]

```
Offset2(0) = Offset in the 1-axis or X-axis direction
Offset2(1) = Offset in the 2-axis or Y-axis direction
Offset2(2) = Offset in the 3-axis or Z-axis direction
```
CSys

This is Local or the name of a defined coordinate system. It is the coordinate system in which the
Offset1 and Offset2 items are specified.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function assigns frame object insertion point data. The assignments include the cardinal point
and end joint offsets.

The function returns zero if the insertion point data is successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignFrameInsertionPoint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Offset1() As Double
Dim Offset2() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame insertion point
ReDim Offset1(2)
ReDim Offset2(2)
For i=0 To 2
Offset1(i)=10 + i
Offset2(i)=20 + i
Next i
ret = SapModel.FrameObj.SetInsertionPoint_1("15", 7, False, False, True, Offset1, Offset2)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 24.1.

This function supersedes SetInsertionPoint, adding the Mirror3 parameter.

## See Also

GetInsertionPoint_1

# SetLateralBracing

## Syntax

SapObject.SapModel.FrameObj.SetLateralBracing

## VB6 Procedure

Function SetLateralBracing(ByVal Name As String, ByVal MyType As Long, ByVal Loc As
Long, ByVal MyDist1 As Double, ByVal MyDist2 As Double, Optional ByVal RelDist As
Boolean = True, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

MyType

This is 1 or 2, indicating the bracing type assigned.

```
1 = Point bracing
2 = Uniform bracing
```
Loc

This is 1, 2 or 3, indicating the bracing location.

```
1 = Top
2 = Bottom
3 = All (top and bottom)
```
MyDist1


When MyType = 1 this is the location of the point bracing.

When MyType = 2 this is the location of the start of the uniform bracing. [L] when RelDist =
False

MyDist2

This item is not used when MyType = 1.

When MyType = 2 this is the location of the end of the uniform bracing. [L] when RelDist = False

RelDist

If this item is True, MyDist1 and MyDist2 are relative distances; otherwise they are actual
distances.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function assigns a lateral bracing location to frame objects.

The function returns zero if the location is successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignFrameLateralBracing()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'assign frame lateral bracing
ret = SapModel.FrameObj.SetLateralBracing("8", 1, 3, 0, 0)
ret = SapModel.FrameObj.SetLateralBracing("8", 1, 3, 0.25, 0)
ret = SapModel.FrameObj.SetLateralBracing("8", 1, 3, 1, 0)
ret = SapModel.FrameObj.SetLateralBracing("8", 2, 1, 0.5, 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.03.

## See Also

GetLateralBracing

DeleteLateralBracing

# SetLoadDeformation

## Syntax

SapObject.SapModel.FrameObj.SetLoadDeformation

## VB6 Procedure

Function SetLoadDeformation(ByVal Name As String, ByVal LoadPat As String, ByRef DOF()
As Boolean, ByRef d() As Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.


LoadPat

The name of a defined load pattern.

DOF

This is a array of boolean values indicating if the considered degree of freedom has a deformation
load.

```
DOF(1) = U1
DOF(2) = U2
DOF(3) = U3
DOF(4) = R1
DOF(5) = R2
DOF(6) = R3
```
d

This is a array of deformation load values. The deformations specified for a given degree of
freedom are applied only if the corresponding DOF item for that degree of freedom is True.

```
d(1) = U1 deformation [L]
d(2) = U2 deformation [L]
d(3) = U3 deformation [L]
d(4) = R1 deformation [rad]
d(5) = R2 deformation [rad]
d(6) = R3 deformation [rad]
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects and the Name
item is ignored.

## Remarks

This function assigns deformation loads to frame objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.


## VBA Example

Sub AssignFrameDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim d() As double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame deformation loads
ReDim DOF(5)
ReDim d(5)
DOF(0) = True
D(0) = 2
ret = SapModel.FrameObj.SetLoadDeformation("ALL", "DEAD", DOF, d, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDeformation

DeleteLoadDeformation


# SetLoadDistributed

## Syntax

SapObject.SapModel.FrameObj.SetLoadDistributed

## VB6 Procedure

Function SetLoadDistributed(ByVal Name As String, ByVal LoadPat As String, ByVal MyType
As Long, ByVal Dir As Long, ByVal Dist1 As Double, ByVal Dist2 As Double, ByVal Val1 As
Double, ByVal Val2 As Double, Optional ByVal CSys As String = "Global", Optional ByVal
RelDist As Boolean = True, Optional ByVal Replace As Boolean = True, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

MyType

This is 1 or 2, indicating the type of distributed load.

```
1 = Force per unit length
2 = Moment per unit length
```
Dir

This is an integer between 1 and 11, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Projected Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

Dist1


This is the distance from the I-End of the frame object to the start of the distributed load. This may
be a relative distance (0 <= Dist1 <= 1) or an actual distance, depending on the value of the
RelDist item. [L] when RelDist is False

Dist2

This is the distance from the I-End of the frame object to the end of the distributed load. This may
be a relative distance (0 <= Dist2 <= 1) or an actual distance, depending on the value of the
RelDist item. [L] when RelDist is False

Val1

This is the load value at the start of the distributed load. [F/L] when MyType is 1 and [FL/L] when
MyType is 2

Val2

This is the load value at the end of the distributed load. [F/L] when MyType is 1 and [FL/L] when
MyType is 2

CSys

This is Local or the name of a defined coordinate system. It is the coordinate system in which the
loads are specified.

RelDist

If this item is True, the specified Dist item is a relative distance, otherwise it is an actual distance.

Replace

If this item is True, all previous distributed loads, if any, assigned to the specified frame object(s),
in the specified load pattern, are deleted before making the new assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function assigns distributed loads to frame objects.


The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignFrameDistributedLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame distributed loads
ret = SapModel.FrameObj.SetLoadDistributed("15", "DEAD", 1, 10, 0, 1, 0.08, 0.08)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDistributed

DeleteLoadDistributed


# SetLoadDistributedWithGUID {Frame

# Object}

## Syntax

SapObject.SapModel.FrameObj.SetLoadDistributedWithGUID

## VB6 Procedure

Function SetLoadDistributedWithGUID(ByVal Name As String, ByVal LoadPat As String,
ByVal MyType As Long, ByVal Dir As Long, ByVal Dist1 As Double, ByVal Dist2 As Double,
ByVal Val1 As Double, ByVal Val2 As Double, ByRef GUID As String, Optional ByVal CSys
As String = "Global", Optional ByVal RelDist As Boolean = True, Optional ByVal Replace As
Boolean = True) As Long

## Parameters

Name

The name of an existing frame object.

LoadPat

The name of a defined load pattern.

MyType

This is 1 or 2, indicating the type of distributed load.

```
1 = Force per unit length
2 = Moment per unit length
```
Dir

This is an integer between 1 and 11, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Projected Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.


Dist1

This is the distance from the I-End of the frame object to the start of the distributed load. This may
be a relative distance (0 <= Dist1 <= 1) or an actual distance, depending on the value of the
RelDist item. [L] when RelDist is False

Dist2

This is the distance from the I-End of the frame object to the end of the distributed load. This may
be a relative distance (0 <= Dist2 <= 1) or an actual distance, depending on the value of the
RelDist item. [L] when RelDist is False

Val1

This is the load value at the start of the distributed load. [F/L] when MyType is 1 and [FL/L] when
MyType is 2

Val2

This is the load value at the end of the distributed load. [F/L] when MyType is 1 and [FL/L] when
MyType is 2

GUID

This is the global unique ID of a distributed load assigned to the frame object or if it is not the
global unique id of a distributed load assigned to the frame object and it is not blank, the global
unique ID which is assigned to the newly assigned load. If left blank, a new load is assigned to the
frame object and the value of this parameter is set to the global unique ID of the newly assigned
load.

CSys

This is Local or the name of a defined coordinate system. It is the coordinate system in which the
loads are specified.

RelDist

If this item is True, the specified Dist item is a relative distance, otherwise it is an actual distance.

Replace

If this item is True and the input GUID is not the GUID of any distributed load assigned to the
frame object, all previous distributed loads, if any, assigned to the specified frame object, in the
specified load pattern, are deleted before making the new assignment. If the input GUID is the
GUID of a distributed load already assigned to the frame object, the parameters of the distributed
load are updated with the values provided and this item is ignored

## Remarks

If the frame object is already assigned a distributed load with a global unique ID matching the
specified global unique ID, this function modifies that distributed load. Otherwise, this function
assigns a new distributed load to the frame object and sets its global unique ID to the specified
global unique ID.


The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## Release Notes

Initial release in version 17.2.0.

## See Also

GetLoadDistributedWithGUID

DeleteLoadDistributedWithGUID

# SetLoadGravity

## Syntax

SapObject.SapModel.FrameObj.SetLoadGravity

## VB6 Procedure

Function SetLoadGravity(ByVal Name As String, ByVal LoadPat As String, ByVal x As Double,
ByVal y As Double, ByVal z As Double, Optional ByVal Replace As Boolean = True, Optional
ByVal CSys As String = "Global", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

x, y, z

These are the gravity load multipliers in the x, y and z directions of the specified coordinate
system.

Replace

If this item is True, all previous gravity loads, if any, assigned to the specified frame object(s), in
the specified load pattern, are deleted before making the new assignment.

CSys

The coordinate system in which the x, y and z multipliers are specified.

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function assigns gravity load multipliers to frame objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignFrameGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame gravity loads
ret = SapModel.FrameObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

DeleteLoadGravity

# SetLoadPoint

## Syntax

SapObject.SapModel.FrameObj.SetLoadPoint

## VB6 Procedure

Function SetLoadPoint(ByVal Name As String, ByVal LoadPat As String, ByVal MyType As
Long, ByVal Dir As Long, ByVal Dist As Double, ByVal Val As Double, Optional ByVal CSys
As String = "Global", Optional ByVal RelDist As Boolean = True, Optional ByVal Replace As
Boolean = True, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

MyType

This is 1 or 2, indicating the type of point load.

```
1 = Force
2 = Moment
```
Dir

This is an integer between 1 and 11, indicating the direction of the load.


```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Not Used - Projected X direction (does not apply when CSys is Local)
8 = Not Used - Projected Y direction (does not apply when CSys is Local)
9 = Not Used - Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Not Used - Projected Gravity direction (only applies when CSys is Global)
```
The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

Dist

This is the distance from the I-End of the frame object to the load location. This may be a relative
distance (0 <= Dist <= 1) or an actual distance, depending on the value of the RelDist item. [L]
when RelDist is False

Val

This is the value of the point load. [F] when MyType is 1 and [FL] when MyType is 2

CSys

This is Local or the name of a defined coordinate system. It is the coordinate system in which the
loads are specified.

RelDist

If this item is True, the specified Dist item is a relative distance, otherwise it is an actual distance.

Replace

If this item is True, all previous loads, if any, assigned to the specified frame object(s), in the
specified load pattern, are deleted before making the new assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.


## Remarks

This function assigns point loads to frame objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignFramePointLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame point loads
ret = SapModel.FrameObj.SetLoadPoint("15", "DEAD", 1, 10, .5, 20)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Changed descriptions for Dir 7, 8, 9 and 11 to "Not Used" in version 25.0.0

## See Also


GetLoadPoint

DeleteLoadPoint

# SetLoadPointWithGUID {Frame Object}

## Syntax

SapObject.SapModel.FrameObj.SetLoadPointWithGUID

## VB6 Procedure

Function SetLoadPointWithGUID(ByVal Name As String, ByVal LoadPat As String, ByVal
MyType As Integer, ByVal dir As Integer, ByVal dist As Double, ByVal val As Double, ByRef
GUID As String, Optional ByVal csys As String = "Global", Optional ByVal RelDist As Boolean
= True, Optional ByVal Replace As Boolean = True) As Long

## Parameters

Name

The name of an existing frame object.

LoadPat

The name of a defined load pattern.

MyType

This is 1 or 2, indicating the type of point load.

```
1 = Force
2 = Moment
```
Dir

This is an integer between 1 and 11, indicating the direction of the load.

```
1 = Local 1 axis (only applies when CSys is Local)
2 = Local 2 axis (only applies when CSys is Local)
3 = Local 3 axis (only applies when CSys is Local)
4 = X direction (does not apply when CSys is Local)
5 = Y direction (does not apply when CSys is Local)
6 = Z direction (does not apply when CSys is Local)
7 = Projected X direction (does not apply when CSys is Local)
8 = Projected Y direction (does not apply when CSys is Local)
9 = Projected Z direction (does not apply when CSys is Local)
10 = Gravity direction (only applies when CSys is Global)
11 = Projected Gravity direction (only applies when CSys is Global)
```

The positive gravity direction (see Dir = 10 and 11) is in the negative Global Z direction.

Dist

This is the distance from the I-End of the frame object to the load location. This may be a relative
distance (0 <= Dist <= 1) or an actual distance, depending on the value of the RelDist item. [L]
when RelDist is False

Val

This is the value of the point load. [F] when MyType is 1 and [FL] when MyType is 2

GUID

This is the global unique ID of a point load assigned to the frame object or if it is not the global
unique id of a point load assigned to the frame object and it is not blank, the global unique ID
which is assigned to the newly assigned load. If left blank, a new load is assigned to the frame
object and the value of this parameter is set to the global unique ID of the newly assigned load

CSys

This is Local or the name of a defined coordinate system. It is the coordinate system in which the
loads are specified.

RelDist

If this item is True, the specified Dist item is a relative distance, otherwise it is an actual distance.

Replace

If this item is True and the input GUID is not the GUID of any point load assigned to the frame
object, all previous point loads, if any, assigned to the specified frame object, in the specified load
pattern, are deleted before making the new assignment. If the input GUID is the GUID of a point
load already assigned to the frame object, the parameters of the point load are updated with the
values provided and this item is ignored.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## Remarks

This function assigns point loads to frame objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## Release Notes

Initial release in version 17.2.0.

## See Also

GetLoadPointWithGUID


DeleteLoadPointWithGUID

# SetLoadStrain

## Syntax

SapObject.SapModel.FrameObj.SetLoadStrain

## VB6 Procedure

Function SetLoadStrain(ByVal Name As String, ByVal LoadPat As String, ByVal DOF As Long,
ByVal Val As Double, Optional ByVal Replace As Boolean = True, Optional ByVal PatternName
As String = "", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

DOF

This is 1, 2, 3, 4, 5 or 6, indicating the degree of freedom to which the strain load is applied.

```
1 = Strain11
2 = Strain12
3 = Strain13
4 = Curvature1
5 = Curvature2
6 = Curvature3
```
Val

This is the strain load value. [L/L] for DOF = 1, 2 and 3 and [1/L] for DOF = 4, 5 and 6

Replace

If this item is True, all previous strain loads, if any, assigned to the specified frame object(s), in
the specified load pattern, for the specified degree of freedom, are deleted before making the new
assignment.

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the strain load for the frame
object is uniform along the object at the value specified by Val.


If PatternName is the name of a defined joint pattern, the strain load for the frame object is based
on the specified strain value multiplied by the pattern value at the joints at each end of the frame
object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function assigns strain loads to frame objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignFrameStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame strain load


ret = SapModel.FrameObj.SetLoadStrain("1", "DEAD", 1, 0.001)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadStrain

DeleteLoadStrain

# SetLoadTargetForce

## Syntax

SapObject.SapModel.FrameObj.SetLoadTargetForce

## VB6 Procedure

Function SetLoadTargetForce(ByVal Name As String, ByVal LoadPat As String, ByRef DOF()
As Boolean, ByRef f() As Double, ByRef RD() As Double, Optional ByVal ItemType As
eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

DOF

This is a array of boolean values indicating if the considered degree of freedom has a target force.

```
DOF(1) = P
DOF(2) = V2
```

#### DOF(3) = V3

#### DOF(4) = T

#### DOF(5) = M2

#### DOF(6) = M3

f

This is a array of target force values. The target forces specified for a given degree of freedom are
applied only if the corresponding DOF item for that degree of freedom is True.

```
f(1) = P [F]
f(2) = V2 [F]
f(3) = V3 [F]
f(4) = T [FL]
f(5) = M2 [FL]
f(6) = M3 [FL]
```
RD

This is a array of relative distances along the frame objects where the target force values apply.
The relative distances specified for a given degree of freedom are applicable only if the
corresponding DOF item for that degree of freedom is True. The relative distance must be
between 0 and 1, 0 <= RD <=1.

```
RD(1) = relative location for P target force
RD(2) = relative location for V2 target force
RD(3) = relative location for V3 target force
RD(4) = relative location for T target force
RD(5) = relative location for M2 target force
RD(6) = relative location for M3 target force
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function assigns target forces to frame objects.

The function returns zero if the target forces are successfully assigned, otherwise it returns a
nonzero value.


## VBA Example

Sub AssignFrameTargetForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim f() As double
Dim RD() As double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame target force
ReDim DOF(5)
ReDim f(5)
ReDim RD(5)
DOF(0) = True
f(0) = 50
RD(0) = 0.5
ret = SapModel.FrameObj.SetLoadTargetForce("1", "DEAD", DOF, f, RD)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTargetForce


DeleteLoadTargetForce

# SetLoadTemperature

## Syntax

SapObject.SapModel.FrameObj.SetLoadTemperature

## VB6 Procedure

Function SetLoadTemperature(ByVal Name As String, ByVal LoadPat As String, ByVal MyType
As Long, ByVal Val As Double, Optional ByVal PatternName As String = "", Optional ByVal
Replace As Boolean = True, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

MyType

This is 1, 2 or 3, indicating the type of temperature load.

```
1 = Temperature
2 = Temperature gradient along local 2 axis
3 = Temperature gradient along local 3 axis
```
Val

This is the temperature change value. [T] for MyType = 1 and [T/L] for MyType = 2 and 3

PatternName

This is blank or the name of a defined joint pattern. If it is blank the temperature load for the
frame object is uniform along the object at the value specified by Val.

If PatternName is the name of a defined joint pattern, the temperature load for the frame object is
based on the specified temperature value multiplied by the pattern value at the joints at each end
of the frame object.

Replace

If this item is True, all previous temperature loads, if any, assigned to the specified frame object
(s), in the specified load case, are deleted before making the new assignment.

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function assigns temperature loads to frame objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignFrameTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame temperature load
ret = SapModel.FrameObj.SetLoadTemperature("All", "DEAD", 1, 50, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTemperature

DeleteLoadTemperature

### SetLoadTransfer

```
Syntax
SapObject.SapModel.FrameObj.SetLoadTransfer
```
```
VB6 Procedure
Function SetLoadTransfer(ByVal Name As String, ByVal Val As Boolean, Optional ByVal ItemType
As eItemType = Object) As Long
```
```
Parameters
```
```
Name
The name of an existing frame object or group, depending on the value of the ItemType item.
Val
This boolean value indicates if load is allowed to be transferred from area objects to this frame
object.
```
```
ItemType
This is one of the following items in the eItemType enumeration:
```
```
Object = 0
Group = 1
SelectedObjects = 2
```
```
If this item is Object, the assignment is made to the frame object specified by the Name item.
```
```
If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.
```
```
If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.
```
```
Remarks
This function returns the load transfer option for frame objects. It indicates whether the frame
receives load from an area object when the area object is loaded with a load of type uniform to
frame.
```
```
The function returns zero if the load transfer option is successfully returned, otherwise it returns a
nonzero value.
```

```
VBA Example
Sub GetLoadTransferOption()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
```
```
'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
SapObject.ApplicationStart
```
```
'create SapModel object
Set SapModel = SapObject.SapModel
```
```
'initialize model
ret = SapModel.InitializeNewModel
```
```
'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
```
'set the load transfer option to False for frame object 1
ret = SapModel.FrameObj.SetLoadTransfer("1", False)
```
```
'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub
```
**Release Notes**
Initial release in version 16.0.0.

**See Also**
GetLoadTransfer

# SetLocalAxes

## Syntax

SapObject.SapModel.FrameObj.SetLocalAxes

## VB6 Procedure

Function SetLocalAxes(ByVal Name As String, ByVal Ang As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

Ang


This is the angle that the local 2 and 3 axes are rotated about the positive local 1 axis, from the
default orientation or, if the Advanced item is True, from the orientation determined by the plane
reference vector. The rotation for a positive angle appears counter clockwise when the local +1
axis is pointing toward you. [deg]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function assigns a local axis angle to frame objects.

The function returns zero if the local axis angle is successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignFrameLocalAxisAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)


'assign frame local axis angle
ret = SapModel.FrameObj.SetLocalAxes("3", 30)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetLocalAxes

# SetLocalAxesAdvanced

## Syntax

SapObject.SapModel.FrameObj.SetLocalAxesAdvanced

## VB6 Procedure

Function SetLocalAxesAdvanced(ByVal Name As String, ByVal Active As Boolean, ByVal
Plane2 As Long, ByVal PlVectOpt As Long, ByVal PlCSys As String, ByRef PlDir() As Long,
ByRef PlPt() As String, ByRef PlVect() As Double, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing frame object or group depending on the value of the ItemType item.

Active

This is True if advanced local axes exist.

Plane2

This is 12 or 13, indicating that the local plane determined by the plane reference vector is the 1-2
plane or the 1-3 plane. This item applies only when the Active item is True.

PlVectOpt

This is 1, 2, or 3, indicating the plane reference vector option. This item applies only when the
Active item is True.


```
1 = Coordinate direction
2 = Two joints
3 = User vector
```
PlCSys

The coordinate system used to define the plane reference vector coordinate directions and the
plane user vector. This item applies when the Active item is True and the PlVectOpt item is 1 or 3.

PlDir

This is an array dimensioned to 1 (2 integers), indicating the plane reference vector primary and
secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center in
the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the PlVectOpt item is 1. Possible coordinate direction
values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
PlPt

This is an array dimensioned to 1 (2 strings), indicating the labels of two joints that define the
plane reference vector. Either of these joints may be specified as None to indicate the center of the
specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the PlVectOpt item is 2.

PlVect

This is an array dimensioned to 2 (3 doubles) that defines the plane reference vector. This item
applies when the Active item is True and the PlVectOpt item is 3.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
Selection = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is Selection, assignment is made to all selected frame objects and the Name item is
ignored.


## Remarks

This function assigns advanced local axes to frame objects.

The function returns zero if the advanced local axes assignments are assigned successfully;
otherwise it returns a nonzero value.

## VBA Example

Sub AssignFrameAdvancedLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyPlDir(1) As Long
Dim MyPlPt(1) As String
Dim MyPlVect(2) As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame advanced local axes
MyPlDir(0) = 2
MyPlDir(1) = 3
ret = SapModel.FrameObj.SetLocalAxesAdvanced("3", True, 12, 1, "Global", MyPlDir,
MyPlPt, MyPlVect)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.


## See Also

GetLocalAxesAdvanced

GetLocalAxes

# SetMass

## Syntax

SapObject.SapModel.FrameObj.SetMass

## VB6 Procedure

Function SetMass(ByVal Name As String, ByVal MassOverL As Double, Optional ByVal
Replace As Boolean = False, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

MassOverL

The mass per unit length assigned to the frame object. [M/L]

Replace

If this item is True, all existing mass assignments to the frame object are removed before
assigning the specified mas. If it is False, the specified mass is added to any existing mass already
assigned to the frame object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects and the Name
item is ignored.


## Remarks

This function assigns mass per unit length to frame objects.

The function returns zero if the mass is successfully assigned, otherwise it returns a nonzero value.

## VBA Example

Sub AssignFrameMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame mass
ret = SapModel.FrameObj.SetMass("ALL", .0001, False, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMass

DeleteMass


# SetMaterialOverwrite

## Syntax

SapObject.SapModel.FrameObj.SetMaterialOverwrite

## VB6 Procedure

Function SetMaterialOverwrite(ByVal Name As String, ByVal PropName As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

PropName

This is None or a blank string, indicating that any existing material overwrites assigned to the
specified frame objects are to be removed, or it is the name of an existing material property.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function sets the material overwrite assignment for frame objects.

The function returns zero if the material overwrite assignment is successfully assigned, otherwise
it returns a nonzero value.

## VBA Example

Sub AssignFrameMaterialOverwrite()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign material overwrite
ret = SapModel.FrameObj.SetMaterialOverwrite("3", "4000Psi")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMaterialOverwrite

# SetMatTemp

## Syntax

SapObject.SapModel.FrameObj.SetMatTemp

## VB6 Procedure

Function SetMatTemp(ByVal Name As String, ByVal Temp As Double, Optional ByVal
PatternName As String = "", Optional ByVal ItemType As eItemType = Object) As Long


## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

Temp

This is the material temperature value assigned to the frame object. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
frame object is uniform along the object at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the frame object
may vary from one end to the other. The material temperature at each end of the object is equal to
the specified temperature multiplied by the pattern value at the joint at the end of the frame object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects and the Name
item is ignored.

## Remarks

This function assigns material temperatures to frame objects.

The function returns zero if the material temperatures are successfully assigned, otherwise it
returns a nonzero value.

## VBA Example

Sub AssignFrameMatTemp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign material temperature
ret = SapModel.FrameObj.SetMatTemp("ALL", 50, , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMatTemp

# SetModifiers

## Syntax

SapObject.SapModel.FrameObj.SetModifiers

## VB6 Procedure

Function SetModifiers(ByVal Name As String, ByRef Value() As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.


Value

This is an array of eight unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Shear area in local 2 direction modifier
Value(2) = Shear area in local 3 direction modifier
Value(3) = Torsional constant modifier
Value(4) = Moment of inertia about local 2 axis modifier
Value(5) = Moment of inertia about local 3 axis modifier
Value(6) = Mass modifier
Value(7) = Weight modifier
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function sets the frame modifier assignment for frame objects. The default value for all
modifiers is one.

The function returns zero if the modifier assignments are successfully assigned, otherwise it
returns a nonzero value.

## VBA Example

Sub AssignFrameModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign modifiers
ReDim Value(7)
For i = 0 To 7
Value(i) = 1
Next i
Value(5) = 100
ret = SapModel.FrameObj.SetModifiers("3", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetModifiers

DeleteModifiers

# SetNotionalSize

## Syntax

SapObject.SapModel.PropFrame.SetNotionalSize

## VB6 Procedure

Function SetNotionalSize(ByVal Name As String, ByVal stype As String, ByVal Value As
Double) As Long

## Parameters


Name

The name of an existing frame section property.

stype

The type to define the notional size of a section. It can be:

```
"Auto" = Program will determine the notional size based on the average thickness of
an area element.
```
```
"User" = The notional size is based on the user-defined value.
```
```
"None" = Notional size will not be considered. In other words, the time-dependent
effect of this section will not be considered.
```
Value

For **stype** is "Auto", the Value represents for the scale factor to the program-determined notional
size; for **stype** is User, the **Value** represents for the user-defined notional size [L]; for **stype** is
None, the **Value** will not be used and can be set to 1.

## Remarks

This function assigns the method to determine the notional size of a frame section for the creep
and shrinkage calculations. This function is currently worked for the steel/aluminum sections -
I/Wide Flange, Channel, Tee, Angle, Double Angle, Double Channel, Pipe and Tube sections, and
all the concrete sections - Rectangular, Circular, Pipe, Tube, Precast I.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignFramePropNotionalSize()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long

```
Dim stype As String
```
```
Dim Value As Double
```
```
'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
```

```
SapObject.ApplicationStart
```
```
'create SapModel object
Set SapModel = SapObject.SapModel
```
```
'initialize model
ret = SapModel.InitializeNewModel
```
```
'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)
```
```
'assign parameters
stype = Auto
Value = 1.1
ret = SapModel.PropFrame.SetNotionalSize("FSEC1", stype, Value)
```
```
'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.1.0

## See Also

GetNotionalSize

# SetOutputStations

## Syntax

SapObject.SapModel.FrameObj.SetOutputStations

## VB6 Procedure

Function SetOutputStations(ByVal Name As String, ByVal MyType As Long, ByVal
MaxSegSize As Double, ByVal MinSections As Long, Optional ByVal
NoOutPutAndDesignAtElementEnds As Boolean = False, Optional ByVal
NoOutPutAndDesignAtPointLoads As Boolean = False, Optional ByVal ItemType As eItemType
= eItemType_Objects) As Long

## Parameters

Name


The name of an existing frame object or group, depending on the value of the ItemType item.

MyType

This is 1 or 2, indicating how the output stations are specified.

```
1 = maximum segment size, that is, maximum station spacing
2 = minimum number of stations
```
MaxSegSize

The maximum segment size, that is, the maximum station spacing. This item applies only when
MyType = 1. [L]

MinSections

The minimum number of stations. This item applies only when MyType = 2.

NoOutPutAndDesignAtElementEnds

If this item is True, no additional output stations are added at the ends of line elements when the
frame object is internally meshed.

NoOutPutAndDesignAtPointLoads

If this item is True, no additional output stations are added at point load locations.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects and the Name
item is ignored.

## Remarks

This function assigns frame object output station data.

The function returns zero if the data is successfully assigned, otherwise it returns a nonzero value.

## VBA Example

Sub AssignFrameOutputStationData()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign frame output station data
ret = SapModel.FrameObj.SetOutputStations("15", 1, 18, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetOutputStations

# SetPDeltaForce

## Syntax

SapObject.SapModel.FrameObj.SetPDeltaForce

## VB6 Procedure

Function SetPDeltaForce(ByVal Name As String, ByVal PDeltaForce As Double, ByVal Dir As
Long, ByVal Replace As Boolean, Optional ByVal CSys As String = "Global", Optional ByVal
ItemType As eItemType = Object) As Long


## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

PDeltaForce

The P-Delta force assigned to the frame object. [F]

Dir

This is 0, 1, 2 or 3, indicating the direction of the P-Delta force assignment.

```
0 = Frame object local 1-axis direction
1 = Projected X direction in CSys coordinate system
2 = Projected Y direction in CSys coordinate system
3 = Projected Z direction in CSys coordinate system
```
Replace

If this item is True, all existing P-Delta force assignments to the frame object are removed before
assigning the specified P-Delta force. If it is False, the specified P-Delta force is added to any
existing P-Delta forces already assigned to the frame object.

CSys

This is the name of the coordinate system in which the projected X, Y or Z direction P-Delta
forces are defined. This item does not apply if the Dir item is zero (frame object local 1-axis
direction).

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function assigns P-Delta forces to straight frame objects. P-Delta force assignments do not
apply to curved frames.


The function returns zero if the assignments are successfully applied, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignFramePDeltaForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign P-Delta force
ret = SapModel.FrameObj.SetPDeltaForce("ALL", 100, 0, True, , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetPDeltaForce

DeletePDeltaForce

# SetReleases

## Syntax


SapObject.SapModel.FrameObj.SetReleases

## VB6 Procedure

Function SetReleases(ByVal Name As String, ByRef ii() As Boolean, ByRef jj() As Boolean,
ByRef StartValue() As Double, ByRef EndValue() As Double, Optional ByVal ItemType As
eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

ii, jj

These are arrays of six booleans indicating the I-End and J-End releases for the frame object.

```
ii(0) and jj(0) = U1 release
ii(1) and jj(1) = U2 release
ii(2) and jj(2) = U3 release
ii(3) and jj(3) = R1 release
ii(4) and jj(4) = R2 release
ii(5) and jj(5) = R3 release
```
StartValue, EndValue

These are arrays of six values indicating the I-End and J-End partial fixity springs for the frame
object.

```
StartValue(0) and EndValue(0) = U1 partial fixity [F/L]
StartValue(1) and EndValue(1) = U2 partial fixity [F/L]
StartValue(2) and EndValue(2) = U3 partial fixity [F/L]
StartValue(3) and EndValue(3) = R1 partial fixity [FL/rad]
StartValue(4) and EndValue(4) = R2 partial fixity [FL/rad]
StartValue(5) and EndValue(5) = R3 partial fixity [FL/rad]
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.


If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function makes end release and partial fixity assignments to frame objects.

The function returns zero if the assignments are successfully retrieved, otherwise it returns a
nonzero value.

Partial fixity assignments are made to degrees of freedom that have been released only.

Some release assignments would cause instability in the model. An error is returned if this type of
assignment is made. Unstable release assignments include the following:

```
U1 released at both ends
U2 released at both ends
U3 released at both ends
R1 released at both ends
R2 released at both ends and U3 at either end
R3 released at both ends and U2 at either end
```
## VBA Example

Sub SetFrameEndReleases()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ii() As Boolean
Dim jj() As Boolean
Dim StartValue() As Double
Dim EndValue() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign end releases
ReDim ii(5)
ReDim jj(5)


ReDim StartValue(5)
ReDim EndValue(5)
ii(5) = True
jj(5) = True
ret = SapModel.FrameObj.SetReleases("13", ii, jj, StartValue, EndValue)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetReleases

# SetSection

## Syntax

SapObject.SapModel.FrameObj.SetSection

## VB6 Procedure

Function SetSection(ByVal name As String, ByVal PropName As String, Optional ByVal
ItemType As eItemType = object, Optional ByVal sVarRelStartLoc As Double = 0, Optional
ByVal sVarTotalLength As Double = 0) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

PropName

This is None or the name of a frame section property to be assigned to the specified frame object
(s).

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
```

```
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

sVarTotalLength

This is the total assumed length of the nonprismatic section. Enter 0 for this item to indicate that
the section length is the same as the frame object length.

This item is applicable only when the assigned frame section property is a nonprismatic section.

sVarRelStartLoc

This is the relative distance along the nonprismatic section to the I-End (start) of the frame object.
This item is ignored when the sVarTotalLengthitem is 0.

This item is applicable only when the assigned frame section property is a nonprismatic section,
and the sVarTotalLengthitem is greater than zero.

## Remarks

This function assigns a frame section property to a frame object.

The function returns zero if the frame section property data is successfully assigned, otherwise it
returns a nonzero value.

## VBA Example

Sub SetFrameSectionProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'open an existing file
FileName = "C:\SapAPI\Example 1-022.sdb"
ret = SapModel.File.OpenFile(FileName)

'unlock model
ret = SapModel.SetModelIsLocked(False)

'set frame section property
ret = SapModel.FrameObj.SetSection("28", "W24X160")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSection

GetSectionNonPrismatic

# SetSelected

## Syntax

Sap2000.FrameObj.SetSelected

## VB6 Procedure

Function SetSelected(ByVal Name As String, ByVal Selected As Boolean, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

Selected

This item is True if the specified frame object is selected, otherwise it is False.

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the selected status is set for the frame object specified by the Name item.

If this item is Group, the selected status is set for all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, the selected status is set for all selected frame objects, and the
Name item is ignored.

## Remarks

This function sets the selected status for a frame object.

The function returns zero if the selected status is successfully set, otherwise it returns a nonzero
value.

## VBA Example

Sub SetFrameObjectSelected()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set frame object selected
ret = SapModel.FrameObj.SetSelected("8", True)

'update view
ret = SapModel.View.RefreshView

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSelected

# SetSpring

## Syntax

SapObject.SapModel.FrameObj.SetSpring

## VB6 Procedure

Function SetSpring(ByVal Name As String, ByVal MyType As Long, ByVal s As Double, ByVal
SimpleSpringType As Long, ByVal LinkProp As String, ByVal SpringLocalOneType As Long,
ByVal Dir As Long, ByVal Plane23Angle As Double, ByRef Vec() As Double, ByVal Ang As
Double, ByVal Replace As Boolean, Optional ByVal CSys As String = "Local", Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

MyType

This is 1 or 2, indicating the spring property type.

```
1 = Simple spring
2 = Link property
```
s

The simple spring stiffness per unit length of the frame object. This item applies only when

MyType = 1. [F/L^2 ]

SimpleSpringType

This is 1, 2 or 3, indicating the simple spring type. This item applies only when MyType = 1.


```
1 = Spring resists tension and compression
2 = Spring resists compression only
3 = Spring resists tension only
```
LinkProp

The name of the link property assigned to the spring. This item applies only when MyType = 2.

SpringLocalOneType

This is 1, 2 or 3, indicating the method used to specify the spring positive local 1-axis orientation.

```
1 = Parallel to frame object local axis
2 = In the frame object 2-3 plane
3 = User specified direction vector
```
Dir

This is 1, 2, 3, -1, -2 or -3, indicating the frame object local axis that corresponds to the positive
local 1-axis of the spring. This item applies only when SpringLocalOneType = 1.

Plane23Angle

This is the angle in the frame object 2-3 plane measured counter clockwise from the frame
positive 2-axis to the spring positive 1-axis. This item applies only when SpringLocalOneType =

2. [deg]

Vec

This is an array of three values that define the direction vector of the spring positive local 1-axis.
The direction vector is in the coordinate system specified by the CSys item. This item applies only
when SpringLocalOneType = 3.

Ang

This is the angle that the link local 2-axis is rotated from its default orientation. This item applies
only when MyType = 2. [deg]

Replace

If this item is True, all existing spring assignments to the frame object are removed before
assigning the specified spring. If it is False, the specified spring is added to any existing springs
already assigned to the frame object.

CSys

This is Local (meaning the frame object local coordinate system) or the name of a defined
coordinate system. This item is the coordinate system in which the user specified direction vector,
Vec, is specified. This item applies only when SpringLocalOneType = 3.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
```

```
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function makes spring assignments to frame objects.

The function returns zero if the assignments are successfully applied, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignFrameSprings()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Vec() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign springs to frame
ReDim Vec(2)
ret = SapModel.FrameObj.SetSpring("ALL", 1, 1, 1, "", 1, 2, 0, Vec, 0, False, "Local",
Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

DeleteSpring

# SetStraight

## Syntax

SapObject.SapModel.FrameObj.SetStraight

## VB6 Procedure

Function SetStraight(ByVal Name As String) As Long

## Parameters

Name

The name of a defined curved frame object.

## Remarks

This function sets a curved frame object straight.

The function returns zero if the frame object type is successfully set, otherwise it returns a nonzero
value.

## VBA Example

Sub SetFrameStraight()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set frame curved
ret = SapModel.FrameObj.SetCurved("15", 2, -200, 0, 300, "", 0, 16)

'set frame straight
ret = SapModel.FrameObj.SetStraight("15")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetCurved

GetCurved

GetType

# SetTCLimits

## Syntax

SapObject.SapModel.FrameObj.SetTCLimits

## VB6 Procedure

Function SetTCLimits(ByVal Name As String, ByVal LimitCompressionExists As Boolean,
ByVal LimitCompression As Double, ByVal LimitTensionExists As Boolean, ByVal
LimitTension As Double, Optional ByVal ItemType As eItemType = Object) As Long


## Parameters

Name

The name of an existing frame object or group, depending on the value of the ItemType item.

LimitCompressionExists

This item is True if a compression force limit exists for the frame object.

LimitCompression

The compression force limit for the frame object. [F]

LimitTensionExists

This item is True if a tension force limit exists for the frame object.

LimitTension

The tension force limit for the frame object. [F]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the frame object specified by the Name item.

If this item is Group, the assignment is made to all frame objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name
item is ignored.

## Remarks

This function makes tension/compression force limit assignments to frame objects.

The function returns zero if the assignments are successfully applied, otherwise it returns a
nonzero value.

Note that the tension and compression limits are only used in nonlinear analyses.

## VBA Example

Sub AssignFrameTCLimits()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign tension/compression limits
ret = SapModel.FrameObj.SetTCLimits("1", False, 0, True, 100)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetTCLimits

# SetTrapezoidal

## Syntax

SapObject.SapModel.PropFrame.SetTrapezoidal

## VB6 Procedure

Function SetTrapezoidal(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal t2b As Double, Optional ByVal Color As Long = -1, Optional ByVal
Notes As String = "", Optional ByVal GUID As String = "") As Long


## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section top width. [L]

t2b

The section bottom width. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a solid trapezoidal frame section property. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropTrapezoidal()

'dimension variables

Dim SapObject as cOAPI


Dim SapModel As cSapModel

Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application

SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetTrapezoidal("R1", "4000Psi", 20, 20, 12)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing

End Sub

## Release Notes

Initial release in version 17.2.0

## See Also

GetTrapezoidal

SetRebarBeam

SetRebarColumn

GetRebarBeam

GetRebarColumn


# AddByCoord

## Syntax

SapObject.SapModel.LinkObj.AddByCoord

## VB6 Procedure

Function AddByCoord(ByVal xi As Double, ByVal yi As Double, ByVal zi As Double, ByVal xj
As Double, ByVal yj As Double, ByVal zj As Double, ByRef Name As String, Optional
IsSingleJoint As Boolean = False, Optional ByVal PropName As String = "Default", Optional
ByVal UserName As String = "", Optional ByVal CSys As String = "Global") As Long

## Parameters

xi, yi, zi

The coordinates of the I-End of the added link object. The coordinates are in the coordinate
system defined by the CSys item.

xj, yj, zj

The coordinates of the J-End of the added link object. The coordinates are in the coordinate
system defined by the CSys item.

These coordinates are ignored if the IsSingleJoint item is True.

Name

This is the name that the program ultimately assigns for the link object. If no UserName is
specified, the program assigns a default name to the link object. If a UserName is specified and
that name is not used for another link object, the UserName is assigned to the link object;
otherwise a default name is assigned to the link object.

IsSingleJoint

This item is True if a one-joint link is added and False if a two-joint link is added.

PropName

This is either Default or the name of a defined link property.

If it is Default the program assigns a default link property to the link object. If it is the name of a
defined link property, that property is assigned to the link object.

UserName

This is an optional user specified name for the link object. If a UserName is specified and that
name is already used for another link object, the program ignores the UserName.

CSys


The name of the coordinate system in which the link object end point coordinates are defined.

## Remarks

This function adds a new link object whose end points are at the specified coordinates.

The function returns zero if the link object is successfully added; otherwise it returns a nonzero
value.

## VBA Example

Sub AddLinkObjByCoord()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = New Sap200015.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by coordinates
ret = SapModel.LinkObj.AddByCoord(-288, 0, 288, 0, 0, 0, Name1, True)
ret = SapModel.LinkObj.AddByCoord(-288, 0, 0, 0, 0, 144, Name2)

'refresh view
ret = SapModel.View.RefreshView

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

AddByPoint

# AddByPoint

## Syntax

SapObject.SapModel.LinkObj.AddByPoint

## VB6 Procedure

Function AddByPoint(ByVal Point1 as String, ByVal Point2 as String, ByRef Name As String,
Optional IsSingleJoint As Boolean = False, Optional ByVal PropName As String = "Default",
Optional ByVal UserName As String = "") As Long

## Parameters

Point1

The name of a defined point object at the I-End of the added link object.

Point2

The name of a defined point object at the J-End of the added link object.

This item is ignored if the IsSingleJoint item is True.

Name

This is the name that the program ultimately assigns for the link object. If no UserName is
specified, the program assigns a default name to the link object. If a UserName is specified and
that name is not used for another link object, the UserName is assigned to the link object;
otherwise a default name is assigned to the link object.

IsSingleJoint

This item is True if a one-joint link is added and False if a two-joint link is added.

PropName

This is either Default or the name of a defined link property.

If it is Default the program assigns a default link property to the link object. If it is the name of a
defined link property, that property is assigned to the link object.

UserName

This is an optional user specified name for the link object. If a UserName is specified and that
name is already used for another link object, the program ignores the UserName.


## Remarks

This function adds a new link object whose end points are specified by name.

The function returns zero if the link object is successfully added; otherwise it returns a nonzero
value.

## VBA Example

Sub AddLinkObjByPoint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("3", "", Name1, True)
ret = SapModel.LinkObj.AddByPoint("1", "5", Name2)

'refresh view
ret = SapModel.View.RefreshView

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

AddByCoord

# Count

## Syntax

SapObject.SapModel.LinkObj.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns a count of the link objects in the model.

## VBA Example

Sub CountLinkObjects()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add link object by points
ret = SapModel.LinkObj.AddByPoint("3", "", Name1, True)
ret = SapModel.LinkObj.AddByPoint("1", "5", Name2)

'refresh view
ret = SapModel.View.RefreshView

'get number of link objects
Count = SapModel.LinkObj.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# ChangeName

## Syntax

SapObject.SapModel.LinkObj.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined link object.

NewName

The new name for the link object.

## Remarks

This function applies a new name to an link object.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.


## VBA Example

Sub ChangeLinkObjName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'refresh view
ret = SapModel.View.RefreshView

'change name
ret = SapModel.LinkObj.ChangeName(Name, "MyLink")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Delete

## Syntax


SapObject.SapModel.LinkObj.Delete

## VB6 Procedure

Function Delete(ByVal Name As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the link object specified by the Name item is deleted.

If this item is Group, the all link objects in the group specified by the Name item are deleted.

If this item is SelectedObjects, all selected link objects are deleted, and the Name item is ignored.

## Remarks

The function deletes link objects.

The function returns zero if the link objects are successfully deleted; otherwise it returns a nonzero
value.

## VBA Example

Sub DeleteLinkObj()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("3", "", Name1, True)
ret = SapModel.LinkObj.AddByPoint("1", "5", Name2)

'delete area object
ret = SapModel.LinkObj.Delete(Name1)

'refresh view
ret = SapModel.View.RefreshView

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

AddByPoint

# DeleteLoadDeformation

## Syntax

SapObject.SapModel.LinkObj.DeleteLoadDeformation

## VB6 Procedure

Function DeleteLoadDeformation(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters


Name

The name of an existing link object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the link object specified by the Name
item.

If this item is Group, the load assignments are deleted for all link objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected link objects, and
the Name item is ignored.

## Remarks

This function deletes the deformation load assignments to the specified link objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteLinkDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim d() As double
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name1)
ret = SapModel.LinkObj.AddByPoint("2", "6", Name2)

'assign link deformation loads
ReDim DOF(5)
ReDim d(5)
DOF(0) = True
D(0) = 2
ret = SapModel.LinkObj.SetLoadDeformation("ALL", "DEAD", DOF, d, Group)

'delete link deformation load
ret = SapModel.LinkObj.DeleteLoadDeformation(Name1, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDeformation

SetLoadDeformation

# DeleteLoadGravity

## Syntax

SapObject.SapModel.LinkObj.DeleteLoadGravity

## VB6 Procedure


Function DeleteLoadGravity(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the link object specified by the Name
item.

If this item is Group, the load assignments are deleted for all link objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected link objects, and
the Name item is ignored.

## Remarks

This function deletes the gravity load assignments to the specified link objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteLinkGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name1)
ret = SapModel.LinkObj.AddByPoint("2", "6", Name2)

'assign link gravity loads
ret = SapModel.LinkObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'delete link gravity load
ret = SapModel.LinkObj.DeleteLoadGravity(Name1, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

SetLoadGravity

# DeleteLoadTargetForce

## Syntax

SapObject.SapModel.LinkObj.DeleteLoadTargetForce

## VB6 Procedure


Function DeleteLoadTargetForce(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the link object specified by the Name
item.

If this item is Group, the load assignments are deleted for all link objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected link objects, and
the Name item is ignored.

## Remarks

This function deletes the target force assignments to the specified link objects for the specified
load pattern.

The function returns zero if the target force assignments are successfully deleted; otherwise it
returns a nonzero value.

## VBA Example

Sub DeleteLinkTargetForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim f() As double
Dim RD() As double
Dim Name1 As String
Dim Name2 As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name1)
ret = SapModel.LinkObj.AddByPoint("2", "6", Name2)

'assign link target force
ReDim DOF(5)
ReDim f(5)
ReDim RD(5)
DOF(0) = True
f(0) = 50
RD(0) = 1
ret = SapModel.LinkObj.SetLoadTargetForce("ALL", "DEAD", DOF, f, RD, Group)

'delete link target force
ret = SapModel.LinkObj.DeleteLoadTargetForce(Name1, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTargetForce

SetLoadTargetForce


# GetElm

## Syntax

SapObject.SapModel.LinkObj.GetElm

## VB6 Procedure

Function GetElm(ByVal Name As String, ByRef Elm as String) As Long

## Parameters

Name

The name of an existing link object.

Elm

The name of the link element created from the specified link object.

## Remarks

This function retrieves the name of the link element (analysis model link) associated with a
specified link object in the object-based model.

This function returns zero if the link element name is successfully retrieved; otherwise it returns
nonzero. An error occurs if the analysis model does not exist.

## VBA Example

Sub GetLinkElementNameForLinkObject()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim Elm As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'create the analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get link element name
ret = SapModel.LinkObj.GetElm(Name, Elm)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetGroupAssign

## Syntax

SapObject.SapModel.LinkObj.GetGroupAssign

## VB6 Procedure

Function GetGroupAssign(ByVal Name As String, ByRef NumberGroups As Long, ByRef
Groups() As String) As Long

## Parameters

Name

The name of an existing link object.

NumberGroups

The number of group names retrieved.

Groups

The names of the groups to which the link object is assigned.


## Remarks

This function retrieves the names of the groups to which a specified link object is assigned.

The function returns zero if the group assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkObjectGroups()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim Name As String
Dim NumberGroups As Long
Dim Groups() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'define new groups
ret = SapModel.GroupDef.SetGroup("Group1")
ret = SapModel.GroupDef.SetGroup("Group2")

'add link object to groups
ret = SapModel.LinkObj.SetGroupAssign(Name, "Group1")
ret = SapModel.LinkObj.SetGroupAssign(Name, "Group2")

'get link object groups
ret = SapModel.LinkObj.GetGroupAssign(Name, NumberGroups, Groups)

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 20.0.0.

## See Also

SetGroupAssign

# GetGUID

## Syntax

SapObject.SapModel.LinkObj.GetGUID

## VB6 Procedure

Function GetGUID(ByVal name As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing link object.

GUID

The GUID (Global Unique ID) for the specified link object.

## Remarks

This function retrieves the GUID for the specified link object.

This function returns zero if the link object GUID is successfully retrieved; otherwise it returns
nonzero.

## VBA Example

Sub GetLinkObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String


Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'set program created GUID
ret = SapObject.SapModel.LinkObj.SetGUID("1")

'get GUID
ret = SapObject.SapModel.LinkObj.GetGUID("1", GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetGUID

# GetLoadDeformation

## Syntax

SapObject.SapModel.LinkObj.GetLoadDeformation

## VB6 Procedure


Function GetLoadDeformation(ByVal Name As String, ByRef NumberItems As Long, ByRef
LinkName() As String, ByRef LoadPat() As String, ByRef dof1() As Boolean, ByRef dof2() As
Boolean, ByRef dof3() As Boolean, ByRef dof4() As Boolean, ByRef dof5() As Boolean, ByRef
dof6() As Boolean, ByRef U1() As Double, ByRef U2() As Double, ByRef U3() As Double,
ByRef R1() As Double, ByRef R2() As Double, ByRef R3() As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

NumberItems

The total number of deformation loads retrieved for the specified link objects.

LinkName

This is an array that includes the name of the link object associated with each deformation load.

LoadPat

This is an array that includes the name of the load pattern associated with each deformation load.

dof1, dof2, dof3, dof4, dof5, dof6

These are arrays of boolean values, indicating if the considered degree of freedom has a
deformation load.

```
dof1 = U1
dof2 = U2
dof3 = U3
dof4 = R1
dof5 = R2
dof6 = R3
```
U1, U2, U3, R1, R2, R3

These are arrays of deformation load values. The deformations specified for a given degree of
freedom are applicable only if the corresponding DOF item for that degree of freedom is True.

```
U1 = U1 deformation [L]
U2 = U2 deformation [L]
U3 = U3 deformation [L]
R1 = R1 deformation [rad]
R2 = R2 deformation [rad]
R3 = R3 deformation [rad]
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
```

```
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the link object specified by the Name item.

If this item is Group, the assignments are retrieved for all link objects in the group specified by the
Name item.

If this item is SelectedObjects, assignments are retrieved for all selected link objects, and the
Name item is ignored.

## Remarks

This function retrieves the deformation load assignments to link objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim d() As double
Dim NumberItems As Long
Dim LinkName() As String
Dim LoadPat() As String
Dim dof1() As Boolean
Dim dof2() As Boolean
Dim dof3() As Boolean
Dim dof4() As Boolean
Dim dof5() As Boolean
Dim dof6() As Boolean
Dim U1() As Double
Dim U2() As Double
Dim U3() As Double
Dim R1() As Double
Dim R2() As Double
Dim R3() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'assign link deformation loads
ReDim DOF(5)
ReDim d(5)
DOF(0) = True
D(0) = 2
ret = SapModel.LinkObj.SetLoadDeformation("ALL", "DEAD", DOF, d, Group)

'get link deformation loads
ret = SapModel.LinkObj.GetLoadDeformation(Name, NumberItems, LinkName, LoadPat,
dof1, dof2, dof3, dof4, dof5, dof6, U1, U2, U3, R1, R2, R3)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadDeformation

DeleteLoadDeformation

# GetLoadGravity

## Syntax

SapObject.SapModel.LinkObj.GetLoadGravity

## VB6 Procedure


Function GetLoadGravity(ByVal Name As String, ByRef NumberItems As Long, ByRef
LinkName() As String, ByRef LoadPat() As String, ByRef CSys() As String, ByRef x() As
Double, ByRef y() As Double, ByRef z() As Double, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

NumberItems

The total number of gravity loads retrieved for the specified link objects.

LinkName

This is an array that includes the name of the link object associated with each gravity load.

LoadPat

This is an array that includes the name of the coordinate system in which the gravity load
multipliers are specified.

CSys

This is an array that includes the name of the coordinate system associated with each gravity load.

x, y, z

These are arrays of gravity load multipliers in the x, y and z directions of the specified coordinate
system.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the link object specified by the Name item.

If this item is Group, the assignments are retrieved for all link objects in the group specified by the
Name item.

If this item is SelectedObjects, assignments are retrieved for all selected link objects, and the
Name item is ignored.

## Remarks

This function retrieves the gravity load assignments to link objects.


The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim LinkName() As String
Dim LoadPat() As String
Dim CSys() As String
Dim x() As Double
Dim y() As Double
Dim z() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'assign link gravity loads
ret = SapModel.LinkObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'get link gravity load
ret = SapModel.LinkObj.GetLoadGravity(Name, NumberItems, LinkName, LoadPat, CSys,
x, y, z)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadGravity

DeleteLoadGravity

# GetLoadTargetForce

## Syntax

SapObject.SapModel.LinkObj.GetLoadTargetForce

## VB6 Procedure

Function GetLoadTargetForce(ByVal Name As String, ByRef NumberItems As Long, ByRef
LinkName() As String, ByRef LoadPat() As String, ByRef dof1() As Boolean, ByRef dof2() As
Boolean, ByRef dof3() As Boolean, ByRef dof4() As Boolean, ByRef dof5() As Boolean, ByRef
dof6() As Boolean, ByRef P() As Double, ByRef V2() As Double, ByRef V3() As Double, ByRef
T() As Double, ByRef M2() As Double, ByRef M3() As Double, ByRef T1() As Double, ByRef
T2() As Double, ByRef T3() As Double, ByRef T4() As Double, ByRef T5() As Double, ByRef
T6() As Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

NumberItems

The total number of deformation loads retrieved for the specified link objects.

LinkName

This is an array that includes the name of the link object associated with each target force.

LoadPat

This is an array that includes the name of the load pattern associated with each target force.

dof1, dof2, dof3, dof4, dof5, dof6


These are arrays of boolean values indicating if the considered degree of freedom has a target
force assignment.

```
dof1 = P
dof2 = V2
dof3 = V3
dof4 = T
dof5 = M2
dof6 = M3
```
P, V2, V3, T, M2, M3

These are arrays of target force values. The target forces specified for a given degree of freedom
are applicable only if the corresponding DOF item for that degree of freedom is True.

```
U1 = U1 deformation [L]
U2 = U2 deformation [L]
U3 = U3 deformation [L]
R1 = R1 deformation [rad]
R2 = R2 deformation [rad]
R3 = R3 deformation [rad]
```
T1, T2, T3, T4, T5, T6

These are arrays of the relative distances along the link objects where the target force values
apply. The relative distances specified for a given degree of freedom are applicable only if the
corresponding dofn item for that degree of freedom is True.

```
T1 = relative location for P target force
T2 = relative location for V2 target force
T3 = relative location for V3 target force
T4 = relative location for T target force
T5 = relative location for M2 target force
T6 = relative location for M3 target force
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the link object specified by the Name item.

If this item is Group, the assignments are retrieved for all link objects in the group specified by the
Name item.

If this item is SelectedObjects, assignments are retrieved for all selected link objects, and the
Name item is ignored.

## Remarks


This function retrieves the target force assignments to link objects.

The function returns zero if the target force assignments are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetLinkTargetForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim DOF() As Boolean
Dim f() As double
Dim RD() As double
Dim NumberItems As Long
Dim LinkName() As String
Dim LoadPat() As String
Dim dof1() As Boolean
Dim dof2() As Boolean
Dim dof3() As Boolean
Dim dof4() As Boolean
Dim dof5() As Boolean
Dim dof6() As Boolean
Dim P() As Double
Dim V2() As Double
Dim V3() As Double
Dim T() As Double
Dim M2() As Double
Dim M3() As Double
Dim T1() As Double
Dim T2() As Double
Dim T3() As Double
Dim T4() As Double
Dim T5() As Double
Dim T6() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'assign link target force
ReDim DOF(5)
ReDim f(5)
ReDim RD(5)
DOF(0) = True
f(0) = 50
RD(0) = 1
ret = SapModel.LinkObj.SetLoadTargetForce(Name, "DEAD", DOF, f, RD)

'get link target force
ret = SapModel.LinkObj.GetLoadTargetForce(Name, NumberItems, LinkName, LoadPat,
dof1, dof2, dof3, dof4, dof5, dof6, P, V2, V3, T, M2, M3, T1, T2, T3, T4, T5, T6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadTargetForce

DeleteLoadTargetForce

# GetLocalAxes

## Syntax

SapObject.SapModel.LinkObj.GetLocalAxes

## VB6 Procedure

Function GetLocalAxes(ByVal Name As String, ByRef Ang As Double, ByRef Advanced As
Boolean) As Long


## Parameters

Name

The name of an existing link object.

Ang

This is the angle that the local 2 and 3 axes are rotated about the positive local 1 axis, from the
default orientation or, if the Advanced item is True, from the orientation determined by the plane
reference vector. The rotation for a positive angle appears counter clockwise when the local +1
axis is pointing toward you. [deg]

Advanced

This item is True if the link object local axes orientation was obtained using advanced local axes
parameters.

## Remarks

This function retrieves the local axis angle assignment for link objects.

The function returns zero if the assignment is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetLinkLocalAxisAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim Ang As Double
Dim Advanced As boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points


ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'assign link local axis angle
ret = SapModel.LinkObj.SetLocalAxes(Name, 30)

'get link local axis angle
ret = SapModel.LinkObj.GetLocalAxes(Name, Ang, Advanced)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetLocalAxes

# GetLocalAxesAdvanced

## Syntax

SapObject.SapModel.LinkObj.GetLocalAxesAdvanced

## VB6 Procedure

Function GetLocalAxesAdvanced(ByVal Name As String, ByRef Active As Boolean, ByRef
AxVectOpt As Long, ByRef AxCSys As String, ByRef AxDir() As Long, ByRef AxPt() As
String, ByRef AxVect() As Double, ByRef Plane2 As Long, ByRef PlVectOpt As Long, ByRef
PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double)
As Long

## Parameters

Name

The name of an existing link object.

Active

This is True if advanced local axes exist.

AxVectOpt, PlVectOpt


This is 1, 2, or 3, indicating the axis/plane reference vector option. This item applies only when
the Active item is True.

```
1 = Coordinate direction
2 = Two joints
3 = User vector
```
AxCSys, PlCSys

The coordinate system used to define the axis/plane reference vector coordinate directions and the
axis/plane user vector. This item applies when the Active item is True and the
AxVectOpt/PlVectOpt item is 1 or 3.

AxDir, PlDir

This is an array dimensioned to 1 (2 integers), indicating the axis/plane reference vector primary
and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center
in the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1. Possible coordinate
direction values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
AxPt, PlPt

This is an array dimensioned to 1 (2 strings), indicating the labels of two joints that define the
axis/plane reference vector. Either of these joints may be specified as None to indicate the center
of the specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt
item is 2.

AxVect, PlVect

This is an array dimensioned to 2 (3 doubles) that defines the axis/plane reference vector. This
item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 3.

Plane2

This is 12 or 13, indicating that the local plane determined by the plane reference vector is the 1-2
or 1-3 plane. This item applies only when the Active item is True.

## Remarks

This function assigns advanced local axes to link objects.


The function returns zero if the advanced local axes assignments are assigned successfully;
otherwise it returns a nonzero value.

## VBA Example

Sub GetLinkAdvancedLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyName As String
Dim MyAxDir(1) As Long
Dim MyAxPt(1) As String
Dim MyAxVect(2) As Double
Dim MyPlDir(1) As Long
Dim MyPlPt(1) As String
Dim MyPlVect(2) As Double
Dim Ang As Double
Dim Advanced As Boolean
Dim Active As Boolean
Dim AxVectOpt As Long
Dim AxCSys As String
Dim AxDir() As Long
Dim AxPt() As String
Dim AxVect() As Double
Dim Plane2 As Long
Dim PlVectOpt As Long
Dim PlCSys As String
Dim PlDir() As Long
Dim PlPt() As String
Dim PlVect() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "1", MyName)

'assign link advanced local axes
MyAxVect(0)=0.707


MyAxVect(1)=0.707
MyAxVect(2)=0
MyPlDir(0) = 2
MyPlDir(1) = 3
ret = SapModel.LinkObj.SetLocalAxesAdvanced(MyName, True, 3, "Global", MyAxDir,
MyAxPt, MyAxVect, 12, 1, "Global", MyPlDir, MyPlPt, MyPlVect)

'get link local axis angle
ret = SapModel.LinkObj.GetLocalAxes(MyName, Ang, Advanced)

'get link advanced local axes data
If Advanced Then
ret = SapModel.LinkObj.GetLocalAxesAdvanced(MyName, Active, AxVectOpt, AxCSys,
AxDir, AxPt, AxVect, Plane2, PlVectOpt, PlCSys, PlDir, PlPt, PlVect)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also

SetLocalAxesAdvanced

SetLocalAxes

# GetNameList

## Syntax

SapObject.SapModel.LinkObj.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of link object names retrieved by the program.


MyName

This is a one-dimensional array of link object names. The MyName array is created as a dynamic,
zero-based, array by the APIuser:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames  1) inside the SAP2000 program, filled with the
names, and returned to the APIuser.

## Remarks

This function retrieves the names of all defined link objects.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetLinkObjectNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("3", "", Name, True)
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'get link object names
ret = SapModel.LinkObj.GetNameList(NumberNames, MyName)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetPoints

## Syntax

SapObject.SapModel.LinkObj.GetPoints

## VB6 Procedure

Function GetPoints(ByVal Name As String, ByRef Point1 As String, ByRef Point2 As String) As
Long

## Parameters

Name

The name of a defined link object.

Point1

The name of the point object at the I-End of the specified link object.

Point2

The name of the point object at the J-End of the specified link object.

## Remarks

This function retrieves the names of the point objects at each end of a specified link object. If
names of the two point objects are the same, the specified link object is a one-joint link object.

The function returns zero if the point names are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkObjPoints()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim Point1 As String
Dim Point2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by coordinates
ret = SapModel.LinkObj.AddByCoord(-288, 0, 0, 0, 0, 144, Name)

'get names of points
ret = SapModel.LinkObj.GetPoints(Name, Point1, Point2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetProperty

## Syntax

SapObject.SapModel.LinkObj.GetProperty

## VB6 Procedure

Function GetProperty(ByVal Name As String, ByRef PropName As String) As Long


## Parameters

Name

The name of a defined link object.

PropName

The name of the link property assigned to the link object.

## Remarks

This function retrieves the link property assigned to a link object.

The function returns zero if the property is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetLinkObjectProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim PropName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'get link property
ret = SapModel.LinkObj.GetProperty(Name, PropName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetProperty

GetPropertyFD

SetPropertyFD

# GetPropertyFD

## Syntax

SapObject.SapModel.LinkObj.GetPropertyFD

## VB6 Procedure

Function GetProperty(ByVal Name As String, ByRef PropName As String) As Long

## Parameters

Name

The name of a defined link object.

PropName

The name of the frequency dependent link property assigned to the link object. This item is None
if there is no frequency dependent link property assigned to the link object.

## Remarks

This function retrieves the frequency dependent link property assigned to a link object.

The function returns zero if the property is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example


Sub GetLinkObjectFDProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 6-012.sdb")

'get link frequency dependent property
ret = SapModel.LinkObj.GetPropertyFD("1", PropName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetProperty

GetProperty

SetPropertyFD

# GetSelected

## Syntax

Sap2000.LinkObj.GetSelected


## VB6 Procedure

Function GetSelected(ByVal Name As String, ByRef Selected As Boolean) As Long

## Parameters

Name

The name of an existing link object.

Selected

This item is True if the specified link object is selected; otherwise it is False.

## Remarks

This function retrieves the selected status for a link object.

The function returns zero if the selected status is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkObjectSelectedStatus()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim Selected As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'set link object selected
ret = SapModel.LinkObj.SetSelected("ALL", True, Group)


'get link object selected status
ret = SapModel.LinkObj.GetSelected(Name, Selected)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSelected

# GetTransformationMatrix

## Syntax

Sap2000.LinkObj.GetTransformationMatrix

## VB6 Procedure

Function GetTransformationMatrix(ByVal Name As String, ByRef Value() As Double,Optional
ByVal IsGlobal As Boolean = True) As Long

## Parameters

Name

The name of an existing link object.

Value

Value is an array of nine direction cosines that define the transformation matrix.

The following matrix equation shows how the transformation matrix is used to convert items from
the link object local coordinate system to the global coordinate system.


In the equation, c0 through c8 are the nine values from the transformation array, (Local1, Local2,
Local3) are an item (such as a load) in the object local coordinate system, and (GlobalX, GlobalY,
GlobalZ) are the same item in the global coordinate system.

The transformation from the local coordinate system to the present coordinate system is the same
as that shown above for the global system if you substitute the present system for the global
system.

IsGlobal

If this item is True, the transformation matrix is between the Global coordinate system and the
link object local coordinate system.

If this item is False, the transformation matrix is between the present coordinate system, and the
link object local coordinate system.

## Remarks

The function returns zero if the link object transformation matrix is successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetLinkObjectMatrix()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'assign link object local axis angle
ret = SapModel.LinkObj.SetLocalAxes(Name, 30)

'get link object transformation matrix
ReDim Value(8)
ret = SapModel.LinkObj.GetTransformationMatrix(Name, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# SetGroupAssign

## Syntax

SapObject.SapModel.LinkObj.SetGroupAssign

## VB6 Procedure

Function SetGroupAssign(ByVal Name As String, ByVal GroupName As String, Optional By Val
Remove As Boolean = False, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

GroupName

The name of an existing group to which the assignment is made.

Remove

If this item is False, the specified link objects are added to the group specified by the GroupName
item. If it is True, the link objects are removed from the group.


ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the link object specified by the Name item is added or removed from the
group specified by the GroupName item.

If this item is Group, all link objects in the group specified by the Name item are added or
removed from the group specified by the GroupName item.

If this item is SelectedObjects, all selected link objects are added or removed from the group
specified by the GroupName item, and the Name item is ignored.

## Remarks

This function adds or removes link objects from a specified group.

The function returns zero if the group assignment is successful; otherwise it returns a nonzero
value.

## VBA Example

Sub AddLinkObjectsToGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)


'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'add link object to group
ret = SapModel.LinkObj.SetGroupAssign(Name, "Group1")

'select objects in group
ret = SapModel.SelectObj.Group("Group1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetGroupAssign

# SetGUID

## Syntax

SapObject.SapModel.LinkObj.SetGUID

## VB6 Procedure

Function SetGUID(ByVal Name As String, Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing link object.

GUID

The GUID (Global Unique ID) for the specified link object.

## Remarks

This function sets the GUID for the specified link object. If the GUID is passed in as a blank
string, the program automatically creates a GUID for the object.


This function returns zero if the link object GUID is successfully set; otherwise it returns nonzero.

## VBA Example

Sub SetLinkObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'set program created GUID
ret = SapObject.SapModel.LinkObj.SetGUID("1")

'get GUID
ret = SapObject.SapModel.LinkObj.GetGUID("1", GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetGUID


# SetLoadDeformation

## Syntax

SapObject.SapModel.LinkObj.SetLoadDeformation

## VB6 Procedure

Function SetLoadDeformation(ByVal Name As String, ByVal LoadPat As String, ByRef DOF()
As Boolean, ByRef d() As Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

DOF

This is a array of boolean values indicating if the considered degree of freedom has a deformation
load.

```
DOF(1) = U1
DOF(2) = U2
DOF(3) = U3
DOF(4) = R1
DOF(5) = R2
DOF(6) = R3
```
d

This is a array of deformation load values. The deformations specified for a given degree of
freedom are applied only if the corresponding DOF item for that degree of freedom is True.

```
d(1) = U1 deformation [L]
d(2) = U2 deformation [L]
d(3) = U3 deformation [L]
d(4) = R1 deformation [rad]
d(5) = R2 deformation [rad]
d(6) = R3 deformation [rad]
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
```

```
SelectedObjects = 2
```
If this item is Object, the assignment is made to the link object specified by the Name item.

If this item is Group, the assignment is made to all link objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected link objects, and the Name item
is ignored.

## Remarks

This function assigns deformation loads to link objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignLinkDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim d() As double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'assign link deformation loads
ReDim DOF(5)
ReDim d(5)
DOF(0) = True
D(0) = 2


ret = SapModel.LinkObj.SetLoadDeformation("ALL", "DEAD", DOF, d, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDeformation

DeleteLoadDeformation

# SetLoadGravity

## Syntax

SapObject.SapModel.LinkObj.SetLoadGravity

## VB6 Procedure

Function SetLoadGravity(ByVal Name As String, ByVal LoadPat As String, ByVal x As Double,
ByVal y As Double, ByVal z As Double, Optional ByVal Replace As Boolean = True, Optional
ByVal CSys As String = "Global", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

x, y, z

These are the gravity load multipliers in the x, y and z directions of the specified coordinate
system.

Replace


If this item is True, all previous gravity loads, if any, assigned to the specified link object(s), in the
specified load pattern, are deleted before making the new assignment.

CSys

The coordinate system in which the x, y and z multipliers are specified.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the link object specified by the Name item.

If this item is Group, the assignment is made to all link objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected link objects, and the Name item
is ignored.

## Remarks

This function assigns gravity load multipliers to link objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignLinkGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'assign link gravity loads
ret = SapModel.LinkObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

DeleteLoadGravity

# SetLoadTargetForce

## Syntax

SapObject.SapModel.LinkObj.SetLoadTargetForce

## VB6 Procedure

Function SetLoadTargetForce(ByVal Name As String, ByVal LoadPat As String, ByRef DOF()
As Boolean, ByRef f() As Double, ByRef RD() As Double, Optional ByVal ItemType As
eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.


#### DOF

This is a array of boolean values indicating if the considered degree of freedom has a target force.

```
DOF(1) = P
DOF(2) = V2
DOF(3) = V3
DOF(4) = T
DOF(5) = M2
DOF(6) = M3
```
f

This is a array of target force values. The target forces specified for a given degree of freedom are
applied only if the corresponding DOF item for that degree of freedom is True.

```
f(1) = P [F]
f(2) = V2 [F]
f(3) = V3 [F]
f(4) = T [FL]
f(5) = M2 [FL]
f(6) = M3 [FL]
```
RD

This is a array of relative distances along the link objects where the target force values apply. The
relative distances specified for a given degree of freedom are applicable only if the corresponding
DOF item for that degree of freedom is True. The relative distance must be between 0 and 1, 0 <=
RD <=1.

```
RD(1) = relative location for P target force
RD(2) = relative location for V2 target force
RD(3) = relative location for V3 target force
RD(4) = relative location for T target force
RD(5) = relative location for M2 target force
RD(6) = relative location for M3 target force
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the link object specified by the Name item.

If this item is Group, the assignment is made to all link objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected link objects, and the Name item
is ignored.


## Remarks

This function assigns target forces to frame objects.

The function returns zero if the target forces are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignLinkTargetForce()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim f() As double
Dim RD() As double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'assign link target force
ReDim DOF(5)
ReDim f(5)
ReDim RD(5)
DOF(0) = True
f(0) = 50
RD(0) = 1
ret = SapModel.LinkObj.SetLoadTargetForce(Name, "DEAD", DOF, f, RD)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTargetForce

DeleteLoadTargetForce

# SetLocalAxes

## Syntax

SapObject.SapModel.LinkObj.SetLocalAxes

## VB6 Procedure

Function SetLocalAxes(ByVal Name As String, ByVal Ang As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

Ang

This is the angle that the local 2 and 3 axes are rotated about the positive local 1 axis, from the
default orientation or, if the Advanced item is True, from the orientation determined by the plane
reference vector. The rotation for a positive angle appears counter clockwise when the local +1
axis is pointing toward you. [deg]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the link object specified by the Name item.


If this item is Group, the assignment is made to all link objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected link objects, and the Name item
is ignored.

## Remarks

This function assigns a local axis angle to link objects.

The function returns zero if the local axis angle is successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignLinkLocalAxisAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'assign link local axis angle
ret = SapModel.LinkObj.SetLocalAxes(Name, 30)

'refresh view
ret = SapModel.View.RefreshView

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetLocalAxes

# SetLocalAxesAdvanced

## Syntax

SapObject.SapModel.LinkObj.SetLocalAxesAdvanced

## VB6 Procedure

Function SetLocalAxesAdvanced(ByVal Name As String, ByVal Active As Boolean, ByVal
AxVectOpt As Long, ByVal AxCSys As String, ByRef AxDir() As Long, ByRef AxPt() As
String, ByRef AxVect() As Double, ByVal Plane2 As Long, ByVal PlVectOpt As Long, ByVal
PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double,
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group depending on the value of the ItemType item.

Active

This is True if advanced local axes exist.

AxVectOpt, PlVectOpt

This is 1, 2, or 3, indicating the axis/plane reference vector option. This item applies only when
the Active item is True.

```
1 = Coordinate direction
2 = Two joints
3 = User vector
```
AxCSys, PlCSys

The coordinate system used to define the axis/plane reference vector coordinate directions and the
axis/plane user vector. This item applies when the Active item is True and the
AxVectOpt/PlVectOpt item is 1 or 3.

AxDir, PlDir


This is an array dimensioned to 1 (2 integers), indicating the axis/plane reference vector primary
and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center
in the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1. Possible coordinate
direction values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
AxPt, PlPt

This is an array dimensioned to 1 (2 strings), indicating the labels of two joints that define the
axis/plane reference vector. Either of these joints may be specified as None to indicate the center
of the specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt
item is 2.

AxVect, PlVect

This is an array dimensioned to 2 (3 doubles) that defines the axis/plane reference vector. This
item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 3.

Plane2

This is 12 or 13, indicating that the local plane determined by the plane reference vector is the 1-2
or 1-3 plane. This item applies only when the Active item is True.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
Selection = 2
```
If this item is Object, the assignment is made to the link object specified by the Name item.

If this item is Group, the assignment is made to all link objects in the group specified by the Name
item.

If this item is Selection, assignment is made to all selected link objects and the Name item is
ignored.

## Remarks

This function assigns advanced local axes to link objects.


The function returns zero if the advanced local axes assignments are assigned successfully;
otherwise, it returns a nonzero value.

## VBA Example

Sub AssignLinkAdvancedLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyName As String
Dim MyAxDir(1) As Long
Dim MyAxPt(1) As String
Dim MyAxVect(2) As Double
Dim MyPlDir(1) As Long
Dim MyPlPt(1) As String
Dim MyPlVect(2) As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "1", MyName)

'assign link advanced local axes
MyAxVect(0)=0.707
MyAxVect(1)=0.707
MyAxVect(2)=0
MyPlDir(0) = 2
MyPlDir(1) = 3
ret = SapModel.LinkObj.SetLocalAxesAdvanced(MyName, True, 3, "Global", MyAxDir,
MyAxPt, MyAxVect, 12, 1, "Global", MyPlDir, MyPlPt, MyPlVect)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 14.00.

## See Also

GetLocalAxesAdvanced

GetLocalAxes

# SetProperty

## Syntax

SapObject.SapModel.LinkObj.SetProperty

## VB6 Procedure

Function SetProperty(ByVal name As String, ByVal PropName As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

PropName

This is the name of a link property to be assigned to the specified link object(s).

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the link object specified by the Name item.

If this item is Group, the assignment is made to all link objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected link objects, and the Name item
is ignored.


## Remarks

This function assigns a link property to link objects.

The function returns zero if the property is successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkObjectProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'set link property
ret = SapModel.LinkObj.SetProperty(Name, "Link1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetProperty


GetPropertyFD

SetPropertyFD

# SetPropertyFD

## Syntax

SapObject.SapModel.LinkObj.SetPropertyFD

## VB6 Procedure

Function SetPropertyFD(ByVal name As String, ByVal PropName As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

PropName

This is either None or the name of a frequency dependent link property to be assigned to the
specified link object(s). None means that no frequency dependent link property is assigned to the
link object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the link object specified by the Name item.

If this item is Group, the assignment is made to all link objects in the group specified by the Name
item.

If this item is SelectedObjects, assignment is made to all selected link objects, and the Name item
is ignored.

## Remarks

This function assigns a frequency dependent link property to link objects.

The function returns zero if the property is successfully assigned; otherwise it returns a nonzero
value.


## VBA Example

Sub SetLinkObjectFDProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
ret = SapModel.File.OpenFile("C:\SapAPI\Example 6-012.sdb")

'set link frequency dependent property
ret = SapModel.LinkObj.SetPropertyFD("1", "None")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetProperty

GetProperty

GetPropertyFD

# SetSelected

## Syntax

Sap2000.LinkObj.SetSelected


## VB6 Procedure

Function SetSelected(ByVal Name As String, ByVal Selected As Boolean, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing link object or group, depending on the value of the ItemType item.

Selected

This item is True if the specified link object is selected; otherwise it is False.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the selected status is set for the link object specified by the Name item.

If this item is Group, the selected status is set for all link objects in the group specified by the
Name item.

If this item is SelectedObjects, the selected status is set for all selected link objects, and the Name
item is ignored.

## Remarks

This function sets the selected status for link objects.

The function returns zero if the selected status is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkObjectSelected()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link object by points
ret = SapModel.LinkObj.AddByPoint("1", "5", Name)

'set link object selected
ret = SapModel.LinkObj.SetSelected("ALL", True, Group)

'update view
ret = SapModel.View.RefreshView

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSelected

# AddCartesian

## Syntax

SapObject.SapModel.PointObj.AddCartesian

## VB6 Procedure

Function AddCartesian(ByVal x As Double, ByVal y As Double, ByVal z As Double, ByRef
Name As String, Optional ByVal userName As String = "", Optional ByVal csys As String =
"Global", Optional ByVal MergeOff As Boolean = False, Optional ByVal MergeNumber As Long
= 0) As Long


## Parameters

x

The X-coordinate of the added point object in the specified coordinate system. [L]

y

The Y-coordinate of the added point object in the specified coordinate system. [L]

z

The Z-coordinate of the added point object in the specified coordinate system. [L]

Name

This is the name that the program ultimately assigns for the point object. If no UserName is
specified, the program assigns a default name to the point object. If a UserName is specified and
that name is not used for another point, the UserName is assigned to the point; otherwise a default
name is assigned to the point.

If a point is merged with another point, this will be the name of the point object with which it was
merged.

UserName

This is an optional user specified name for the point object. If a UserName is specified and that
name is already used for another point object, the program ignores the UserName.

CSys

The name of the coordinate system in which the joint coordinates are defined.

MergeOff

If this item is False, a new point object that is added at the same location as an existing point
object will be merged with the existing point object (assuming the two point objects have the same
MergeNumber) and thus only one point object will exist at the location.

If this item is True, the points will not merge and two point objects will exist at the same location.

MergeNumber

Two points objects in the same location will merge only if their merge number assignments are the
same. By default all pointobjects have a merge number of zero.

## Remarks

This function adds a point object to a model. The added point object will be tagged as a Special
Point except if it was merged with another point object. Special points are allowed to exist in the
model with no objects connected to them.

The function returns zero if the point object is successfully added or merged, otherwise it returns a
nonzero value.


## VBA Example

Sub AddPointCartesian()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim x As Double, y As Double, z As Double
Dim Name as String
Dim MyName as String
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model blank from template
ret = SapModel.File.NewBlank

'add point object to model
x = 12
y = 37
z = 0
MyName = "A1"
ret = SapModel.PointObj.AddCartesian(x, y, z, Name, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddCylindrical

AddSpherical


GetCoordCartesian

GetSpecialPoint

SetSpecialPoint

# AddCylindrical

## Syntax

SapObject.SapModel.PointObj.AddCylindrical

## VB6 Procedure

Function AddCylindrical(ByVal r As Double, ByVal Theta As Double, ByVal z As Double,
ByRef Name As String, Optional ByVal userName As String = "", Optional ByVal csys As String
= "Global", Optional ByVal MergeOff As Boolean = False, Optional ByVal MergeNumber As
Long = 0) As Long

## Parameters

r

The radius for the added point object in the specified coordinate system. [L]

Theta

The angle for the added point object in the specified coordinate system. The angle is measured in
the XY plane from the positive global X axis. When looking in the XY plane with the positive Z
axis pointing toward you, a positive Theta angle is counter clockwise. [deg]

z

The Z-coordinate of the added point object in the specified coordinate system. [L]

Name

This is the name that the program ultimately assigns for the point object. If no UserName is
specified, the program assigns a default name to the point object. If a UserName is specified and
that name is not used for another point, the UserName is assigned to the point; otherwise a default
name is assigned to the point.

If a point is merged with another point, this will be the name of the point object with which it was
merged.

UserName

This is an optional user specified name for the point object. If a UserName is specified and that
name is already used for another point object, the program ignores the UserName.

CSys


The name of the coordinate system in which the joint coordinates are defined.

MergeOff

If this item is False, a new point object that is added at the same location as an existing point
object will be merged with the existing point object (assuming the two point objects have the same
MergeNumber) and thus only one point object will exist at the location.

If this item is True, the points will not merge and two point objects will exist at the same location.

MergeNumber

Two points objects in the same location will merge only if their merge number assignments are the
same. By default all pointobjects have a merge number of zero.

## Remarks

This function adds a point object to a model. The added point object will be tagged as a Special
Point except if it was merged with another point object. Special points are allowed to exist in the
model with no objects connected to them

The function returns zero if the point object is successfully added or merged, otherwise it returns a
nonzero value.

## VBA Example

Sub AddPointCylindrical()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim r As Double, Theta As Double, z As Double
Dim Name as String
Dim MyName as String
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model blank from template
ret = SapModel.File.NewBlank

'add point object to model
r = 12


Theta = 37
z = 0
MyName = "A1"
ret = SapModel.PointObj.AddCartesian(r, Theta, z, Name, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddCartesian

AddSpherical

GetCoordCylindrical

GetSpecialPoint

SetSpecialPoint

# AddSpherical

## Syntax

SapObject.SapModel.PointObj.AddSpherical

## VB6 Procedure

Function AddSpherical(ByVal r As Double, ByVal a As Double, ByVal b As Double, ByRef
Name As String, Optional ByVal userName As String = "", Optional ByVal csys As String =
"Global", Optional ByVal MergeOff As Boolean = False, Optional ByVal MergeNumber As Long
= 0) As Long

## Parameters

r

The radius for the added point object in the specified coordinate system. [L]

a


The plan angle for the added point object in the specified coordinate system. This angle is
measured in the XY plane from the positive global X axis. When looking in the XY plane with the
positive Z axis pointing toward you, a positive a angle is counterclockwise. [deg]

b

The elevation angle for the added point object in the specified coordinate system. This angle is
measured in an X'Z plane that is perpendicular to the XY plane with the positive X' axis oriented
at angle a from the positive global X axis. Angle b is measured from the positive global Z axis.
When looking in the XZ plane with the positive Y' axis pointing toward you, a positive b angle is
counter clockwise. [deg]

Name

This is the name that the program ultimately assigns for the point object. If no UserName is
specified, the program assigns a default name to the point object. If a UserName is specified and
that name is not used for another point, the UserName is assigned to the point; otherwise a default
name is assigned to the point.

If a point is merged with another point, this will be the name of the point object with which it was
merged.

UserName

This is an optional user specified name for the point object. If a UserName is specified and that
name is already used for another point object, the program ignores the UserName.

CSys

The name of the coordinate system in which the joint coordinates are defined.

MergeOff

If this item is False, a new point object that is added at the same location as an existing point
object will be merged with the existing point object (assuming the two point objects have the same
MergeNumber) and thus only one point object will exist at the location.

If this item is True, the points will not merge and two point objects will exist at the same location.

MergeNumber

Two points objects in the same location will merge only if their merge number assignments are the
same. By default all pointobjects have a merge number of zero.

## Remarks

This function adds a point object to a model. The added point object will be tagged as a Special
Point except if it was merged with another point object. Special points are allowed to exist in the
model with no objects connected to them

The function returns zero if the point object is successfully added or merged, otherwise it returns a
nonzero value.


## VBA Example

Sub AddPointSpherical()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim r As Double, a As Double, b As Double
Dim Name as String
Dim MyName as String
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model blank from template
ret = SapModel.File.NewBlank

'add point object to model
r = 12
a = 37
b = 23
MyName = "A1"
ret = SapModel.PointObj.AddSpherical(r, a, b, Name, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddCartesian

AddCylindrical

GetCoordSpherical


GetSpecialPoint

SetSpecialPoint

# ChangeName

## Syntax

SapObject.SapModel.PointObj.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a point object.

NewName

The new name for the point object.

## Remarks

The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

## VBA Example

Sub ChangePointName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'change name of point object
ret = SapModel.PointObj.ChangeName("1", "A1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Count

## Syntax

SapObject.SapModel.PointObj.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns the total number of point objects in the model.

## VBA Example

Sub CountPointObjects()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim Count as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'return number of point objects
Count = SapModel.PointObj.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# CountConstraint

## Syntax

SapObject.SapModel.PointObj.CountConstraint

## VB6 Procedure

Function CountConstraint(ByRef Count As Long, Optional ByVal Name As String = "") As Long

## Parameters

Count

The number of counted constraints.

Name

This optional item is the name of an existing point object.


## Remarks

If the Name item is provided, the Count item returns the total number of constraint assignments
made to the specified point object. If the Name item is not specified, or is specified as an empty
string, the Count item returns the total number of constraint assignments to all point objects in the
model. If the Name item is specified but it is not recognized by the program as a valid point
object, an error is returned.

This function returns zero if the count is successfully completed, otherwise it returns a nonzero
value.

## VBA Example

Sub CountConstraintAssignments()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim Count as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add constraint definition
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1")

'make constraint assignment
ret = SapModel.PointObj.SetConstraint("3", "Diaph1")

'get number of constraint assignments
ret = SapModel.PointObj.CountConstraint(Count)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetConstraint

SetConstraint

DeleteConstraint

# CountLoadDispl

## Syntax

SapObject.SapModel.PointObj.CountLoadDispl

## VB6 Procedure

Function CountLoadDispl(ByRef Count As Long, Optional ByVal Name As String = "", Optional
ByVal LoadPat As String = "") As Long

## Parameters

Count

The number of counted ground displacement loads.

Name

This optional item is the name of an existing point object.

LoadPat

This optional item is the name of an existing load pattern.

## Remarks

If neither the Name item nor the LoadPat item is provided, the Count item returns the total number
of ground displacement load assignments in the model.

If the Name item is provided but not the LoadPat item, the Count item returns the total number of
ground displacement load assignments made for the specified point object.

If the Name item is not provided but the LoadPat item is specified, the Count item returns the total
number of ground displacement load assignments made to all point objects for the specified load
pattern.


If both the Name item and the LoadPat item are provided, the Count item returns the total number
of ground displacement load assignments made to the specified point object for the specified load
pattern.

If the Name item or the LoadPat item is provided but is not recognized by the program as valid, an
error is returned.

This function returns zero if the count is successfully completed, otherwise it returns a nonzero
value.

## VBA Example

Sub CountGroundDisplacementLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value() As Double
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add ground displacement load
Redim Value(5)
Value(0) = 10
ret = SapModel.PointObj.SetLoadDispl("1", "DEAD", Value)

'get number of ground displacement loads
ret = SapModel.PointObj.CountLoadDispl(Count)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDispl

SetLoadDispl

DeleteLoadDispl

# CountLoadForce

## Syntax

SapObject.SapModel.PointObj.CountLoadForce

## VB6 Procedure

Function CountLoadForce(ByRef Count As Long, Optional ByVal Name As String = "", Optional
ByVal LoadPat As String = "") As Long

## Parameters

Count

The number of counted point loads.

Name

This optional item is the name of an existing point object.

LoadPat

This optional item is the name of an existing load pattern.

## Remarks

If neither the Name item nor the LoadPat item is provided, the Count item returns the total number
of point load assignments in the model.

If the Name item is provided but not the LoadPat item, the Count item returns the total number of
point load assignments made for the specified point object.

If the Name item is not provided but the LoadPat item is specified, the Count item returns the total
number of point load assignments made to all point objects for the specified load pattern.

If both the Name item and the LoadPat item are provided,n the Count item returns the total
number of point load assignments made to the specified point object for the specified load pattern.


If the Name item or the LoadPat item is provided but is not recognized by the program as valid, an
error is returned.

This function returns zero if the count is successfully completed, otherwise it returns a nonzero
value.

## VBA Example

Sub CountPointLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value() As Double
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add point load
Redim Value(5)
Value(0) = 10
ret = SapModel.PointObj.SetLoadForce("3", "DEAD", Value)

'get number of point loads
ret = SapModel.PointObj.CountLoadForce(Count)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetLoadForce

SetLoadForce

DeleteLoadForce

# CountPanelZone

## Syntax

SapObject.SapModel.PointObj.CountPanelZone

## VB6 Procedure

Function CountPanelZone() As Long

## Parameters

None

## Remarks

This function returns the total number of panel zone assignments to point objects in the model.

## VBA Example

Sub CountPanelZones()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim Count as Long
Dim PropType as Long
Dim Thickness As Double
Dim Connectivity As Long
Dim LocalAxisFrom As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add panel zone assignment
PropType = 1 'elastic from column and doubler plate
Thickness = 2
Connectivity = 0 'beams to other objects
LocalAxisFrom = 0 'column
ret = SapModel.PointObj.SetPanelZone("3", PropType, Thickness, 0, 0, "", Connectivity,
LocalAxisFrom, 0)

'get number of panel zone assignments
Count = SapModel.PointObj.CountPanelZone

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetPanelZone

SetPanelZone

DeletePanelZone

# CountRestraint

## Syntax

SapObject.SapModel.PointObj.CountRestraint

## VB6 Procedure

Function CountRestraint() As Long

## Parameters

None


## Remarks

This function returns the total number of point objects in the model with restraint assignments.

## VBA Example

Sub CountRestrainedPointObjects()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim Count as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get number of restrained point objects
Count = SapModel.PointObj.CountRestraint

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetRestraint

SetRestraint

DeleteRestraint


# CountSpring

## Syntax

SapObject.SapModel.PointObj.CountSpring

## VB6 Procedure

Function CountSpring() As Long

## Parameters

None

## Remarks

This function returns the total number of point objects in the model with spring assignments.

## VBA Example

Sub CountSpringSupportedPointObjects()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long
Dim i As Long
Dim k() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add joint spring assignment
redim k(5)
For i = 0 to 5
k(i) = i + 1


Next i
ret = SapModel.PointObj.SetSpring("3", k)

'get number of point objects with spring assignments
Count = SapModel.PointObj.CountSpring

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

SetSpring

DeleteSpring

# DeleteConstraint

## Syntax

SapObject.SapModel.PointObj.DeleteConstraint

## VB6 Procedure

Function DeleteConstraint(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of a point object or a group depending on the value selected for ItemType item.

ItemType

This is one of the following items from the eItemType enumeration.

```
Object = 0
Group = 1
SelectedObjects = 2
```

If Object is selected, the Name item refers to a point object and the constraint assignments to that
point object are removed.

If Group is selected, the Name item refers to a group and the constraint assignments to all point
objects in the group are removed.

If SelectedObjects is selected, the Name item is ignored and the constraint assignments to all
selected point objects are removed.

## Remarks

This function deletes all constraint assignments from the specified point object(s).

The function returns zero if the constraint assignments are successfully deleted, otherwise it
returns a nonzero value.

## VBA Example

Sub DeletePointConstraints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add constraint definition
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1")

'make constraint assignment
ret = SapModel.PointObj.SetConstraint("3", "Diaph1")

'delete constraint assignment
ret = SapModel.PointObj.DeleteConstraint("3")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetConstraint

SetConstraint

# DeleteLoadDispl

## Syntax

SapObject.SapModel.PointObj.DeleteLoadDispl

## VB6 Procedure

Function DeleteLoadDispl(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of a point object or a group depending on the value selected for ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items from the eItemType enumeration.

```
Object = 0
Group = 1
SelectedObjects = 2
```
If Object is selected, the Name item refers to a point object. The ground displacement load
assignments, for the specified load case, made to that point object, are removed.

If Group is selected, the Name item refers to a group. The ground displacement load assignments,
for the specified load pattern, made to all point objects in the group, are removed.


If SelectedObjects is selected, the Name item is ignored. The ground displacement load
assignments, for the specified load pattern, made to all selected point objects, are removed.

## Remarks

This function deletes all ground displacement load assignments, for the specified load pattern,
from the specified point object(s).

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeletePointDisplLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add ground displacement load
Redim Value(5)
Value(0) = 10
ret = SapModel.PointObj.SetLoadDispl("1", "DEAD", Value)

'delete ground displacement load
ret = SapModel.PointObj.DeleteLoadDispl("1", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDispl

SetLoadDispl

# DeleteLoadForce

## Syntax

SapObject.SapModel.PointObj.DeleteLoadForce

## VB6 Procedure

Function DeleteLoadForce(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of a point object or a group depending on the value selected for ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items from the eItemType enumeration.

```
Object = 0
Group = 1
SelectedObjects = 2
```
If Object is selected, the Name item refers to a point object. The point load assignments, for the
specified load pattern, made to that point object, are removed.

If Group is selected, the Name item refers to a group. The point load assignments, for the specified
load pattern, made to all point objects in the group, are removed.

If SelectedObjects is selected, the Name item is ignored. The point load assignments, for the
specified load pattern, made to all selected point objects, are removed.


## Remarks

This function deletes all point load assignments, for the specified load pattern, from the specified
point object(s).

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeletePointForceLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add point load
Redim Value(5)
Value(0) = 10
ret = SapModel.PointObj.SetLoadForce("1", "DEAD", Value)

'delete point load
ret = SapModel.PointObj.DeleteLoadForce("1", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadForce

SetLoadForce

# DeleteLoadForceWithGUID {Point Object}

## Syntax

SapObject.SapModel.PointObj.DeleteLoadForceWithGUID

## VB6 Procedure

Function DeleteLoadForceWithGUID(ByVal Name As String, ByVal GUID As String) As Long

## Parameters

Name

The name of an existing point object.

GUID

The global unique ID of one of the point loads on that point object.

## Remarks

This function deletes the point load assignment with the specified global unique ID for the
specified point object.

The function returns zero if the load assignment is successfully deleted, otherwise it returns a
nonzero value.

## Release Notes

Initial release in version 17.2.0.

## See Also

GetLoadForceWithGUID

SetLoadForceWithGUID


# DeleteMass

## Syntax

SapObject.SapModel.PointObj.DeleteMass

## VB6 Procedure

Function DeleteMass(ByVal Name As String, Optional ByVal ItemType As eItemType = Object)
As Long

## Parameters

Name

The name of a point object or a group depending on the value selected for ItemType item.

ItemType

This is one of the following items from the eItemType enumeration.

```
Object = 0
Group = 1
SelectedObjects = 2
```
If Object is selected, the Name item refers to a point object. The mass assignments for that point
object are removed.

If Group is selected, the Name item refers to a group. The mass assignments for all point objects
in the group are removed.

If SelectedObjects is selected, the Name item is ignored. The mass assignments for all selected
point objects are removed.

## Remarks

This function deletes all mass assignments from the specified point object(s).

The function returns zero if the mass assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeletePointMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long


Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add point mass
Redim Value(5)
Value(0) = 1
ret = SapModel.PointObj.SetMass("3", Value)

'delete point mass
ret = SapModel.PointObj.DeleteMass("3")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMass

SetMass

SetMassByVolume

SetMassByWeight

# DeletePanelZone

## Syntax

SapObject.SapModel.PointObj.DeletePanelZone


## VB6 Procedure

Function DeletePanelZone(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of a point object or a group depending on the value selected for ItemType item.

ItemType

This is one of the following items from the eItemType enumeration.

```
Object = 0
Group = 1
SelectedObjects = 2
```
If Object is selected, the Name item refers to a point object. The panel zone assignments for that
point object are removed.

If Group is selected, the Name item refers to a group. The panel zone assignments for all point
objects in the group are removed.

If SelectedObjects is selected, the Name item is ignored. The panel zone assignments for all
selected point objects are removed.

## Remarks

This function deletes all panel zone assignments from the specified point object(s).

The function returns zero if the panel zone assignments are successfully deleted, otherwise it
returns a nonzero value.

## VBA Example

Sub DeletePanelZone()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim PropType as Long
Dim Thickness As Double
Dim Connectivity As Long
Dim LocalAxisFrom As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add panel zone assignment
PropType = 1 'elastic from column and doubler plate
Thickness = 2
Connectivity = 0 'beams to other objects
LocalAxisFrom = 0 'column
ret = SapModel.PointObj.SetPanelZone("3", PropType, Thickness, 0, 0, "", Connectivity,
LocalAxisFrom, 0)

'delete panel zone
ret = SapModel.PointObj.DeletePanelZone("3")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetPanelZone

SetPanelZone

# DeletePatternValue

## Syntax

SapObject.SapModel.PointObj.DeletePatternValue

## VB6 Procedure

Function DeletePatternValue(ByVal Name As String, ByVal PatternName As String, Optional
ByVal ItemType As eItemType = Object) As Long


## Parameters

Name

The name of a point object or a group depending on the value selected for ItemType item.

PatternName

The name of a defined joint pattern.

ItemType

This is one of the following items from the eItemType enumeration.

```
Object = 0
Group = 1
SelectedObjects = 2
```
If Object is selected, the Name item refers to a point object. The joint pattern assignments,
associated with the specified joint pattern, for that point object are removed.

If Group is selected, the Name item refers to a group. The joint pattern assignments, associated
with the specified joint pattern, for all point objects in the group, are removed.

If SelectedObjects is selected, the Name item is ignored. The joint pattern assignments, associated
with the specified joint pattern, for all selected point objects, are removed.

## Remarks

This function deletes all joint pattern assignments, associated with the specified joint pattern, from
the specified point object(s).

The function returns zero if the joint pattern assignments are successfully deleted, otherwise it
returns a nonzero value.

## VBA Example

Sub DeletePointPatternAssigns()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add joint pattern assignment
ret = SapModel.PointObj.SetPatternByXYZ("3", "Default", 0, 0, 10, 0)

'delete joint pattern assignment
ret = SapModel.PointObj.DeletePatternValue("3", "Default")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetPatternValue

SetPatternByPressure

SetPatternByXYZ

# DeleteRestraint

## Syntax

SapObject.SapModel.PointObj.DeleteRestraint

## VB6 Procedure

Function DeleteRestraint(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of a point object or a group depending on the value selected for ItemType item.

ItemType


This is one of the following items from the eItemType enumeration.

```
Object = 0
Group = 1
SelectedObjects = 2
```
If Object is selected, the Name item refers to a point object. The restraint assignments for that
point object are removed.

If Group is selected, the Name item refers to a group. The restraint assignments for all point
objects in the group are removed.

If SelectedObjects is selected, the Name item is ignored. The restraint assignments for all selected
point objects are removed.

## Remarks

This function deletes all restraint assignments from the specified point object(s).

The function returns zero if the restraint assignments are successfully deleted, otherwise it returns
a nonzero value.

## VBA Example

Sub DeletePointRestraints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'delete joint restraint assignment
ret = SapModel.PointObj.DeleteRestraint("1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetRestraint

SetRestraint

# DeleteSpecialPoint

## Syntax

SapObject.SapModel.PointObj.DeleteSpecialPoint

## VB6 Procedure

Function DeleteSpecialPoint(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the deletion applies to the point object specified by the Name item.

If this item is Group, the deletion applies to all point objects in the group specified by the Name
item.

If this item is SelectedObjects, the deletion applies to all selected point objects, and the Name item
is ignored.


## Remarks

The function deletes special point objects that have no other objects connected to them.

The function returns zero if the function completes successfully, otherwise it returns a nonzero
value.

Point objects can be deleted only if they have no other objects (e.g., frame, cable, tendon, area,
solid link) connected to them. If a point object is not specified to be a Special Point, the program
automatically deletes that point object when it has no other objects connected to it. If a point
object is specified to be a Special Point, to delete it, first delete all other objects connected to the
point and then call this function to delete the point.

## VBA Example

Sub DeleteSpecialPointObj()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set as special point
ret = SapModel.PointObj.SetSpecialPoint("3", True)

'delete frame objects
ret = SapModel.FrameObj.Delete("2")
ret = SapModel.FrameObj.Delete("8")

'delete special point object
ret = SapModel.PointObj.DeleteSpecialPoint("3")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.03.

## See Also

SetSpecialPoint

GetSpecialPoint

# DeleteSpring

## Syntax

SapObject.SapModel.PointObj.DeleteSpring

## VB6 Procedure

Function DeleteSpring(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of a point object or a group depending on the value selected for ItemType item.

ItemType

This is one of the following items from the eItemType enumeration.

```
Object = 0
Group = 1
SelectedObjects = 2
```
If Object is selected, the Name item refers to a point object. The point spring assignments for that
point object are removed.

If Group is selected, the Name item refers to a group. The point spring assignments for all point
objects in the group are removed.

If SelectedObjects is selected, the Name item is ignored. The point spring assignments for all
selected point objects are removed.

## Remarks

This function deletes all point spring assignments from the specified point object(s).


The function returns zero if the restraint assignments are successfully deleted, otherwise it returns
a nonzero value.

## VBA Example

Sub DeletePointSprings()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim i as Long
Dim ret As Long
Dim k() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add joint spring assignment
redim k(5)
For i = 0 to 5
k(i) = i + 1
Next i
ret = SapModel.PointObj.SetSpring("3", k)

'delete joint spring assignment
ret = SapModel.PointObj.DeleteSpring("3")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring


GetSpringCoupled

SetSpring

SetSpringCoupled

# GetCommonTo

## Syntax

SapObject.SapModel.PointObj.GetCommonTo

## VB6 Procedure

Function GetCommonTo(ByVal Name As String, ByRef CommonTo As Long) As Long

## Parameters

Name

The name of a point object or a group depending on the value selected for ItemType item.

CommonTo

The total number of objects (line, area, solid and link) that connect to the specified point object.

## Remarks

This function returns the total number of objects (line, area, solid and link) that connect to the
specified point object.

The function returns zero if the CommonTo is successfully calculated, otherwise it returns a
nonzero value.

## VBA Example

Sub GetPointCommonTo()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim CommonTo as long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get CommonTo
ret = SapModel.PointObj.GetCommonTo("6", CommonTo)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetConnectivity

## Syntax

SapObject.SapModel.PointObj.GetConnectivity

## VB6 Procedure

Function GetConnectivity(ByVal Name As String, ByRef NumberItems As Long, ByRef
ObjectType() As Long, ByRef ObjectName() As String, ByRef PointNumber() As Long) As Long

## Parameters

Name

The name of an existing point object.

NumberItems

This is the total number of objects connected to the specified point object.

ObjectType

This is an array that includes the object type of each object connected to the specified point object.


```
2 = Frame object
3 = Cable object
4 = Tendon object
5 = Area object
6 = Solid object
```
```
7 = Link object
```
ObjectName

This is an array that includes the object name of each object connected to the specified point
object.

PointNumber

This is an array that includes the point number within the considered object that corresponds to the
specified point object.

## Remarks

This function returns a list of objects connected to a specified point object.

The function returns zero if the list is successfully filled; otherwise it returns nonzero.

## VBA Example

Sub GetPointObjectConnectivity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems as Long
Dim ObjectType() As Long
Dim ObjectName() As String
Dim PointNumber() As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get objects connected to point object 11


ret = SapModel.PointObj.GetConnectivity("11", NumberItems, ObjectType, ObjectName,
PointNumber)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# GetConstraint

## Syntax

SapObject.SapModel.PointObj.GetConstraint

## VB6 Procedure

Function GetConstraint(ByVal Name As String, ByRef NumberItems As Long, ByRef PointName
() As String, ByRef ConstraintName() As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing point object or group, depending on the value of the ItemType item.

NumberItems

This is the total number of constraint assignments returned.

PointName

This is an array that includes the name of the point object to which the specified constraint
assignment applies.

ConstraintName

This is an array that includes the name of the constraint that is assigned to the point object
specified by the PointName item.

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the constraint assignments are retrieved for the point object specified by the
Name item.

If this item is Group, the constraint assignments are retrieved for all point objects in the group
specified by the Name item.

If this item is SelectedObjects, the constraint assignments are retrieved for all selected point
objects and the Name item is ignored.

## Remarks

This function returns a list of constraint assignments made to one or more specified point objects.

The function returns zero if the constraint name list is successfully filled, otherwise it returns
nonzero.

The PointName and ConstraintName items are returned in one-dimensional arrays. Each array is
created as a dynamic array by the API user. In VBA a dynamic string array is defined by:

Dim PointName() as String

The arrays are dimensioned to (NumberItems  1) inside the Sap2000 program, filled with values,
and returned to the API user.

The arrays are zero-based. Thus the first item is at array index 0, and the last item is at array index
(NumberItems - 1).

## VBA Example

Sub GetConstraintAssignments()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
dim NumberItems as Long
Dim PointName() As String
Dim ConstraintName() As String
Dim i As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define a new constraint
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1")

'define new constraint assignments
For i = 4 To 16 Step 4
ret = SapModel.PointObj.SetConstraint(Format(i), "Diaph1")
Next i

'get constraint assignments
ret = SapModel.PointObj.GetConstraint("ALL", NumberItems, PointName, ConstraintName,
Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetConstraint

DeleteConstraint

# GetCoordCartesian

## Syntax

SapObject.SapModel.PointObj.GetCoordCartesian

## VB6 Procedure

Function GetCoordCartesian(ByVal Name As String, ByRef x As Double, ByRef y As Double,
ByRef z As Double, Optional ByVal Csys As String = "Global") As Long


## Parameters

```
Name
```
The name of a defined point object.

x

The X-coordinate of the specified point object in the specified coordinate system. [L]

y

The Y-coordinate of the specified point object in the specified coordinate system. [L]

z

The Z-coordinate of the specified point object in the specified coordinate system. [L]

Csys

The name of a defined coordinate system. If Csys is not specified, the Global coordinate system is
assumed.

## Remarks

The function returns zero if the coordinates are successfully returned; otherwise it returns nonzero.
If successful, the function returns the x, y and z coordinates of the specified point object in the
Present Units. The coordinates are reported in the coordinate system specified by Csys.

## VBA Example

Sub GetPointCoordCartesian
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim x As Double, y As Double, z As Double
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'start a new template model
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)


'get point coordinates of the point named "1" and display in a message box
ret = SapModel.PointObj.GetCoordCartesian("1", x, y, z)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetCoordCylindrical

GetCoordSpherical

GetNameList

# GetCoordCylindrical

## Syntax

SapObject.SapModel.PointObj.GetCoordCylindrical

## VB6 Procedure

Function GetCoordCylindrical(ByVal Aame As String, ByRef r As Double, ByRef Theta As
Double, ByRef z As Double, Optional ByVal Csys As String = "Global") As Long

## Parameters

```
Name
```
The name of a defined point object.

r

The radius for the specified point object in the specified coordinate system. [L]

Theta


The angle for the specified point object in the specified coordinate system. The angle is measured
in the XY plane from the positive X axis. When looking in the XY plane with the positive Z axis
pointing toward you, a positive Theta angle is counter clockwise [deg]

z

The Z-coordinate of the specified point object in the specified coordinate system. [L]

Csys

The name of a defined coordinate system. If Csys is not specified, the Global coordinate system is
assumed.

## Remarks

The function returns zero if the coordinates are successfully returned; otherwise it returns nonzero.
If successful, the function returns the r, theta and z coordinates of the specified point object in the
Present Units. The coordinates are reported in the coordinate system specified by CSys.

## VBA Example

Sub GetPointCoordCylindrical
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim r As Double, Theta As Double, z As Double
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'start a new template model
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get point coordinates of the point named "1" and display in a message box
ret = SapModel.PointObj.GetCoordCylindrical("1", r, Theta, z)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetCoordCartesian

GetCoordSpherical

GetNameList

# GetCoordSpherical

## Syntax

SapObject.SapModel.PointObj.GetCoordSpherical

## VB6 Procedure

Function GetCoordSpherical(ByVal Name As String, ByRef r As Double, ByRef a As Double,
ByRef b As Double, Optional ByVal CSys As String = "Global") As Long

## Parameters

Name

The name of an existing point object.

r

The radius for the point object in the specified coordinate system. [L]

a

The plan angle for the point object in the specified coordinate system. This angle is measured in
the XY plane from the positive global X axis. When looking in the XY plane with the positive Z
axis pointing toward you, a positive a angle is counter clockwise. [deg]

b

The elevation angle for the point object in the specified coordinate system. This angle is measured
in an X'Z plane that is perpendicular to the XY plane with the positive X' axis oriented at angle a
from the positive global X axis. Angle b is measured from the positive global Z axis. When
looking in the XZ plane with the positive Y' axis pointing toward you, a positive b angle is
counter clockwise. [deg]

CSys

The name of the coordinate system in which the joint coordinates are returned.


## Remarks

The function returns zero if the coordinates are successfully returned; otherwise it returns nonzero.
If successful, the function returns the r, a and b coordinates of the specified point object in the
Present Units. The coordinates are reported in the coordinate system specified by CSys.

## VBA Example

Sub GetPointCoordSpherical()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim r As Double, a As Double, b As Double
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get spherical point coordinates
ret = SapModel.PointObj.GetCoordSpherical("5", r, a, b)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetCoordCartesian

GetCoordCylindrical

GetNameList


# GetElm

## Syntax

SapObject.SapModel.PointObj.GetElm

## VB6 Procedure

Function GetElm(ByVal Name As String, ByRef Elm as String) As Long

## Parameters

Name

The name of an existing point object.

Elm

The name of the point element associated with the specified point object.

## Remarks

This function retrieves the name of the point element (analysis model point) associated with a
specified point object in the object-based model.

This function returns zero if the point element name is successfully returned; otherwise it returns
nonzero. An error occurs if the analysis model does not currently exist.

## VBA Example

Sub GetPointElementName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Elm As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'create the analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get point element name
ret = SapModel.PointObj.GetElm("5", Elm)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetGroupAssign

## Syntax

SapObject.SapModel.PointObj.GetGroupAssign

## VB6 Procedure

Function GetGroupAssign(ByVal Name As String, ByRef NumberGroups As Long, ByRef
Groups() As String) As Long

## Parameters

Name

The name of an existing point object.

NumberGroups

The number of group names retrieved.

Groups

The names of the groups to which the point object is assigned.


## Remarks

This function retrieves the names of the groups to which a specified point object is assigned.

The function returns zero if the group assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetPointObjectGroups()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberGroups As Long
Dim Groups() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new groups
ret = SapModel.GroupDef.SetGroup("Group1")
ret = SapModel.GroupDef.SetGroup("Group2")

'add point object to groups
ret = SapModel.PointObj.SetGroupAssign("3", "Group1")
ret = SapModel.PointObj.SetGroupAssign("3", "Group2")

'get point object groups
ret = SapModel.PointObj.GetGroupAssign("3", NumberGroups, Groups)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 20.0.0.

## See Also

SetGroupAssign

# GetGUID

## Syntax

SapObject.SapModel.PointObj.GetGUID

## VB6 Procedure

Function GetGUID(ByVal name As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing point object.

GUID

The GUID (Global Unique ID) for the specified point object.

## Remarks

This function retrieves the GUID for specified point object.

This function returns zero if the point object GUID is successfully retrieved; otherwise it returns
nonzero.

## VBA Example

Sub GetPointGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set program created GUID
ret = SapModel.PointObj.SetGUID("1")

'get GUID
ret = SapModel.PointObj.GetGUID("1", GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetGUID

# GetLoadDispl

## Syntax

SapObject.SapModel.PointObj.GetLoadDispl

## VB6 Procedure

Function GetLoadDispl(ByVal Name As String, ByRef NumberItems As Long, ByRef PointName
() As String, ByRef LoadPat() As String, ByRef LCStep() As Long, ByRef CSys() As String,
ByRef U1() As Double, ByRef U2() As Double, ByRef U3() As Double, ByRef R1() As Double,
ByRef R2() As Double, ByRef R3() As Double, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name


The name of an existing point object or group, depending on the value of the ItemType item.

NumberItems

This is the total number of joint ground displacement assignments returned.

PointName

This is an array that includes the name of the point object to which the specified ground
displacement assignment applies.

LoadPat

This is an array that includes the name of the load pattern for the ground displacement load.

LCStep

This is an array that includes the load pattern step for the ground displacement load. In most cases,
this item does not apply and will be returned as 0.

CSys

This is an array that includes the name of the coordinate system for the ground displacement load.
This is Local or the name of a defined coordinate system.

U1

This is an array that includes the assigned translational ground displacement in the local 1-axis or
coordinate system X-axis direction, depending on the specified CSys. [L]

U2

This is an array that includes the assigned translational ground displacement in the local 2-axis or
coordinate system Y-axis direction, depending on the specified CSys. [L]

U3

This is an array that includes the assigned translational ground displacement in the local 3-axis or
coordinate system Z-axis direction, depending on the specified CSys. [L]

R1

This is an array that includes the assigned rotational ground displacement about the local 1-axis or
coordinate system X-axis, depending on the specified CSys. [rad]

R2

This is an array that includes the assigned rotational ground displacement about the local 2-axis or
coordinate system Y-axis, depending on the specified CSys. [rad]

R3

This is an array that includes the assigned rotational ground displacement about the local 3-axis or
coordinate system Z-axis, depending on the specified CSys. [rad]

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are retrieved for the point object specified by the Name
item.

If this item is Group, the assignments are retrieved for all point objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are retrieved for all selected point objects,
and the Name item is ignored.

## Remarks

This function retrieves the ground displacement load assignments to point objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetPointDisplLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim PointName() As String
Dim LoadPat() As String
Dim LCStep() As Long
Dim CSys() As String
Dim U1() As Double
Dim U2() As Double
Dim U3() As Double
Dim R1() As Double
Dim R2() As Double
Dim R3() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add ground displacement load
Redim Value(5)
Value(0) = 10
ret = SapModel.PointObj.SetLoadDispl("1", "DEAD", Value)

'get ground displacement load
ret = SapModel.PointObj.GetLoadDispl("ALL", NumberItems, PointName, LoadPat, LCStep,
CSys, U1, U2, U3, R1, R2, R3, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadDispl

DeleteLoadDispl

# GetLoadForce

## Syntax

SapObject.SapModel.PointObj.GetLoadForce

## VB6 Procedure

Function GetLoadForce(ByVal Name As String, ByRef NumberItems As Long, ByRef
PointName() As String, ByRef LoadPat() As String, ByRef LCStep() As Long, ByRef CSys() As
String, ByRef F1() As Double, ByRef F2() As Double, ByRef F3() As Double, ByRef M1() As
Double, ByRef M2() As Double, ByRef M3() As Double, Optional ByVal ItemType As
eItemType = Object) As Long


## Parameters

Name

The name of an existing point object or group, depending on the value of the ItemType item.

NumberItems

This is the total number of joint force load assignments returned.

PointName

This is an array that includes the name of the point object to which the specified load assignment
applies.

LoadPat

This is an array that includes the name of the load pattern for the load.

LCStep

This is an array that includes the load pattern step for the load. In most cases, this item does not
apply and will be returned as 0.

CSys

This is an array that includes the name of the coordinate system for the load. This is Local or the
name of a defined coordinate system.

F1

This is an array that includes the assigned translational force in the local 1-axis or coordinate
system X-axis direction, depending on the specified CSys. [F]

F2

This is an array that includes the assigned translational force in the local 2-axis or coordinate
system Y-axis direction, depending on the specified CSys. [F]

F3

This is an array that includes the assigned translational force in the local 3-axis or coordinate
system Z-axis direction, depending on the specified CSys. [F]

M1

This is an array that includes the assigned moment about the local 1-axis or coordinate system X-
axis, depending on the specified CSys. [FL]

M2

This is an array that includes the assigned moment about the local 2-axis or coordinate system Y-
axis, depending on the specified CSys. [FL]

M3


This is an array that includes the assigned moment about the local 3-axis or coordinate system Z-
axis, depending on the specified CSys. [FL]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are retrieved for the point object specified by the Name
item.

If this item is Group, the assignments are retrieved for all point objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are retrieved for all selected point objects,
and the Name item is ignored.

## Remarks

This function retrieves the joint force load assignments to point objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetPointForceLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim PointName() As String
Dim LoadPat() As String
Dim LCStep() As Long
Dim CSys() As String
Dim F1() As Double
Dim F2() As Double
Dim F3() As Double
Dim M1() As Double
Dim M2() As Double
Dim M3() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add joint force load
Redim Value(5)
Value(0) = 10
ret = SapModel.PointObj.SetLoadForce("1", "DEAD", Value)

'get joint force load
ret = SapModel.PointObj.GetLoadForce("ALL", NumberItems, PointName, LoadPat,
LCStep, CSys, F1, F2, F3, M1, M2, M3, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadForce

DeleteLoadForce

# GetLoadForceWithGUID {Point Object}

## Syntax

SapObject.SapModel.PointObj.GetLoadForceWithGUID

## VB6 Procedure


Function GetLoadForceWithGUID(ByVal Name As String, ByRef NumberItems As Integer,
ByRef PointName() As String, ByRef LoadPat() As String, ByRef LcStep() As Integer, ByRef
CSys() As String, ByRef F1() As Double, ByRef F2() As Double, ByRef F3() As Double, ByRef
M1() As Double, ByRef M2() As Double, ByRef M3() As Double, ByRef GUID() As String,
Optional ByVal ItemType As eItemType = eItemType.Objects) As Long

## Parameters

Name

The name of an existing point object or group, depending on the value of the ItemType item.

NumberItems

This is the total number of joint force load assignments returned.

PointName

This is an array that includes the name of the point object to which the specified load assignment
applies.

LoadPat

This is an array that includes the name of the load pattern for the load.

LCStep

This is an array that includes the load pattern step for the load. In most cases, this item does not
apply and will be returned as 0.

CSys

This is an array that includes the name of the coordinate system for the load. This is Local or the
name of a defined coordinate system.

F1

This is an array that includes the assigned translational force in the local 1-axis or coordinate
system X-axis direction, depending on the specified CSys. [F]

F2

This is an array that includes the assigned translational force in the local 2-axis or coordinate
system Y-axis direction, depending on the specified CSys. [F]

F3

This is an array that includes the assigned translational force in the local 3-axis or coordinate
system Z-axis direction, depending on the specified CSys. [F]

M1

This is an array that includes the assigned moment about the local 1-axis or coordinate system X-
axis, depending on the specified CSys. [FL]


#### M2

This is an array that includes the assigned moment about the local 2-axis or coordinate system Y-
axis, depending on the specified CSys. [FL]

M3

This is an array that includes the assigned moment about the local 3-axis or coordinate system Z-
axis, depending on the specified CSys. [FL]

GUID

This is an array that includes the global unique ID of the distributed load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are retrieved for the point object specified by the Name
item.

If this item is Group, the assignments are retrieved for all point objects in the group specified by
the Name item.

If this item is SelectedObjects, the load assignments are retrieved for all selected point objects,
and the Name item is ignored.

## Remarks

This function retrieves the joint force load assignments to point objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## Release Notes

Initial release in version 17.2.0.

## See Also

SetLoadForceWithGUID

DeleteLoadForceWithGUID

# GetLocalAxes


## Syntax

SapObject.SapModel.PointObj.GetLocalAxes

## VB6 Procedure

Function GetLocalAxes(ByVal Name As String, ByRef a As Double, ByRef b As Double, ByRef
c As Double, ByRef Advanced As Boolean) As Long

## Parameters

Name

The name of an existing point object.

a, b, c

The local axes of the point are defined by first setting the positive local 1, 2 and 3 axes the same as
the positive global X, Y and Z axes and then doing the following: [deg]

1. Rotate about the 3 axis by angle a.
2. Rotate about the resulting 2 axis by angle b.
3. Rotate about the resulting 1 axis by angle c.

Advanced

This item is True if the point object local axes orientation was obtained using advanced local axes
parameters.

## Remarks

This function retrieves the local axes angles for a point object.

The function returns zero if the local axes angles are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetPointLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim a As Double, b As Double, c As Double
Dim Advanced As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get local axes assignments
ret = SapModel.PointObj.GetLocalAxes("1", a, b, c, Advanced)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetLocalAxes

# GetLocalAxesAdvanced

## Syntax

SapObject.SapModel.PointObj.GetLocalAxesAdvanced

## VB6 Procedure

Function GetLocalAxesAdvanced(ByVal Name As String, ByRef Active As Boolean, ByRef
AxVectOpt As Long, ByRef AxCSys As String, ByRef AxDir() As Long, ByRef AxPt() As
String, ByRef AxVect() As Double, ByRef Plane2 As Long, ByRef PlVectOpt As Long, ByRef
PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double)
As Long

## Parameters

Name

The name of an existing point object.


Active

This is True if advanced local axes exist.

AxVectOpt, PlVectOpt

This is 1, 2, or 3, indicating the axis/plane reference vector option. This item applies only when
the Active item is True.

```
1 = Coordinate direction
2 = Two joints
3 = User vector
```
AxCSys, PlCSys

The coordinate system used to define the axis/plane reference vector coordinate directions and the
axis/plane user vector. This item applies when the Active item is True and the
AxVectOpt/PlVectOpt item is 1 or 3.

AxDir, PlDir

This is an array dimensioned to 1 (2 integers), indicating the axis/plane reference vector primary
and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center
in the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1. Possible coordinate
direction values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
AxPt, PlPt

This is an array dimensioned to 1 (2 strings), indicating the labels of two joints that define the
axis/plane reference vector. Either of these joints may be specified as None to indicate the center
of the specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt
item is 2.

AxVect, PlVect

This is an array dimensioned to 2 (3 doubles) that defines the axis/plane reference vector. This
item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 3.

Plane2

This is 12, 13, 21, 23, 31 or 32, indicating that the local plane determined by the plane reference
vector is the 1-2, 1-3, 2-1, 2-3, 3-1, or 3-2 plane. This item applies only when the Active item is
True.


## Remarks

This function assigns advanced local axes to point objects.

The function returns zero if the advanced local axes assignments are assigned successfully;
otherwise it returns a nonzero value.

## VBA Example

Sub GetPointAdvancedLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyAxDir(1) As Long
Dim MyAxPt(1) As String
Dim MyAxVect(2) As Double
Dim MyPlDir(1) As Long
Dim MyPlPt(1) As String
Dim MyPlVect(2) As Double
Dim a As Double, b As Double, c As Double
Dim Advanced As Boolean
Dim Active As Boolean
Dim AxVectOpt As Long
Dim AxCSys As String
Dim AxDir() As Long
Dim AxPt() As String
Dim AxVect() As Double
Dim Plane2 As Long
Dim PlVectOpt As Long
Dim PlCSys As String
Dim PlDir() As Long
Dim PlPt() As String
Dim PlVect() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign point advanced local axes
MyAxVect(0)=0.707


MyAxVect(1)=0.707
MyAxVect(2)=0
MyPlDir(0) = 2
MyPlDir(1) = 3
ret = SapModel.PointObj.SetLocalAxesAdvanced("ALL", True, 3, "Global", MyAxDir,
MyAxPt, MyAxVect, 12, 1, "Global", MyPlDir, MyPlPt, MyPlVect, Group)

'get point local axes angles
ret = SapModel.PointObj.GetLocalAxes("1", a, b, c, Advanced)

'get point advanced local axes data
If Advanced Then
ret = SapModel.PointObj.GetLocalAxesAdvanced("3", Active, AxVectOpt, AxCSys,
AxDir, AxPt, AxVect, Plane2, PlVectOpt, PlCSys, PlDir, PlPt, PlVect)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also

SetLocalAxesAdvanced

SetLocalAxes

# GetMass

## Syntax

SapObject.SapModel.PointObj.GetMass

## VB6 Procedure

Function GetMass(ByVal Name As String, ByRef m() As Double) As Long

## Parameters

Name

The name of an existing point object.


m

This is an array of six mass assignment values.

```
Value(0) = U1 [M]
Value(1) = U2 [M]
Value(2) = U3 [M]
Value(3) = R1 [ML^2 ]
Value(4) = R2 [ML^2 ]
Value(5) = R3 [ML^2 ]
```
## Remarks

This function retrieves the point mass assignment values for a point object. The masses are always
returned in the point local coordinate system.

The function returns zero if the mass is successfully retrieved, otherwise it returns a nonzero
value.

## VBA Example

Sub GetPointMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i as long
Dim m() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign point mass
Redim m(5)
For i = 0 to 5
m(i) = (i+1) / 10
Next i
ret = SapModel.PointObj.SetMass("3", m)


'get point mass
Redim m(5)
ret = SapModel.PointObj.GetMass("3", m)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetMass

DeleteMass

SetMassByVolume

SetMassByWeight

# GetMergeNumber

## Syntax

SapObject.SapModel.PointObj.GetMergeNumber

## VB6 Procedure

Function GetMergeNumber(ByVal Name As String, ByRef MergeNumber As Long) As Long

## Parameters

Name

The name of an existing point object.

MergeNumber

The merge number assigned to the specified point object.

## Remarks

This function retrieves the merge number for a point object. By default the merge number for a
point is zero. Points with different merge numbers are not automatically merged by the program.


The function returns zero if the merge number is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetPointMergeNumber()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim m As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set merge number
ret = SapModel.PointObj.SetMergeNumber("3", 2)

'get merge number
ret = SapModel.PointObj.GetMergeNumber("3", m)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetMergeNumber

# GetNameList


## Syntax

SapObject.SapModel.PointObj.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of point object names retrieved by the program.

MyName

This is a one-dimensional array of point object names. The MyName array is created as a
dynamic, zero-based, array by the API user:

Dim MyName() as String

The array is dimensioned to (NumberNames  1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined point objects.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetPointObjectNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get point object names
ret = SapModel.PointObj.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetCoordCartesian

GetCoordCylindrical

# GetPanelZone

## Syntax

SapObject.SapModel.PointObj.GetPanelZone

## VB6 Procedure

Function GetPanelZone(ByVal Name As String, ByRef PropType As Long, ByRef Thickness As
Double, ByRef K1 As Double, ByRef K2 As Double, ByRef LinkProp As String, ByRef
Connectivity As Long, ByRef LocalAxisFrom As Long, ByRef LocalAxisAngle As Double) As
Long

## Parameters

Name

The name of an existing point object.

PropType


This is 0, 1, 2, or 3.

```
0 = Properties are elastic from column
1 = Properties are elastic from column and doubler plate
2 = Properties are from specified spring stiffnesses
3 = Properties are from a specified link property
```
Thickness

The thickness of the doubler plate. This item applies only when PropType = 1. [L]

K1

The spring stiffness for major axis bending (about the local 3 axis of the column and panel zone).
This item applies only when PropType = 2. [FL/rad]

K2

The spring stiffness for minor axis bending (about the local 2 axis of the column and panel zone).
This item applies only when PropType = 2. [FL/rad]

LinkProp

The name of the link property used to define the panel zone. This item applies only when
PropType = 3.

Connectivity

This is 0 or 1.

```
0 = Panel zone connects beams to other objects
1 = Panel zone connects braces to other objects
```
LocalAxisFrom

This is 0 or 1.

```
0 = Panel zone local axis angle is from column
1 = Panel zone local axis angle is user defined
```
The LocalAxisFrom item can be 1 only when the PropType item is 3.

LocalAxisAngle

This item applies only when PropType = 3 and LocalAxisFrom = 1. It is the angle measured
counter clockwise from the positive global X-axis to the local 2-axis of the panel zone. [deg]

## Remarks

This function retrieves the panel zone assignment data for a point object.

The function returns zero if the panel zone data is successfully retrieved, otherwise it returns a
nonzero value.


If no panel zone assignment is made to the point object, an error is returned.

## VBA Example

Sub GetPanelZoneData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropType As Long
Dim Thickness As Double
Dim K1 As Double
Dim K2 As Double
Dim LinkProp As String
Dim Connectivity As Long
Dim LocalAxisFrom As Long
Dim LocalAxisAngle As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign panel zone
ret = SapModel.PointObj.SetPanelZone("3", 1, 2, 0, 0, "", 0, 0, 0)

'get panel zone data
ret = SapModel.PointObj.GetPanelZone("3", PropType, Thickness, K1, K2, LinkProp,
Connectivity, LocalAxisFrom, LocalAxisAngle)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

SetPanelZone

# GetPatternValue

## Syntax

SapObject.SapModel.PointObj.GetPatternValue

## VB6 Procedure

Function GetPatternValue(ByVal Name As String, ByVal PatternName As String, ByRef Value
As Double) As Long

## Parameters

Name

The name of an existing point object.

PatternName

The name of a defined joint pattern.

Value

The value that the specified point object has for the specified joint pattern.

## Remarks

This function retrieves the joint pattern value for a specific point object and joint pattern.

The function returns zero if the value is successfully retrieved, otherwise it returns a nonzero
value.

Joint pattern values are unitless.

## VBA Example

Sub GetJointPatternData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value As Double

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add joint pattern assignment
ret = SapModel.PointObj.SetPatternByXYZ("ALL", "Default", 0, 0, 10, 0, Group)

'get joint pattern assignment
ret = SapModel.PointObj.GetPatternValue("3", "Default", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetPatternByPressure

SetPatternByXYZ

DeletePatternValue

# GetRestraint

## Syntax

SapObject.SapModel.PointObj.GetRestraint

## VB6 Procedure

Function GetRestraint(ByVal Name As String, ByRef Value() As Boolean) As Long


## Parameters

Name

The name of an existing point object.

Value

This is an array of six restraint values.

```
Value(0) = U1
Value(1) = U2
Value(2) = U3
Value(3) = R1
Value(4) = R2
Value(5) = R3
```
## Remarks

This function retrieves the restraint assignments for a point object. The restraint assignments are
always returned in the point local coordinate system.

The function returns zero if the restraint assignments are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetPointRestraints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value() As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get point object restraints
Redim Value(5)


ret = SapModel.PointObj.GetRestraint("5", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetRestraint

DeleteRestraint

# GetSelected

## Syntax

SapObject.SapModel.PointObj.GetSelected

## VB6 Procedure

Function GetSelected(ByVal Name As String, ByRef Selected As Boolean) As Long

## Parameters

Name

The name of an existing point object.

Selected

This item returns True if the specified point object is selected, otherwise it returns False.

## Remarks

This function retrieves the selected status for a point object.

The function returns zero if the selected status is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example


Sub GetPointSelectedStatus()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Selected As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set point selected
ret = SapModel.PointObj.SetSelected("3", True)

'get point selected status
ret = SapModel.PointObj.GetSelected("3", Selected)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSelected

# GetSpecialPoint

## Syntax

SapObject.SapModel.PointObj.GetSpecialPoint


## VB6 Procedure

Function GetSpecialPoint(ByVal Name As String, ByVal SpecialPoint As Boolean) As Long

## Parameters

Name

The name of an existing point object.

SpecialPoint

This item is True if the point object is specified as a special point, otherwise it is False.

## Remarks

This function retrieves the special point status for a point object.

The function returns zero if the special point status is successfully retrieved, otherwise it returns a
nonzero value.

Special points are allowed to exist in the model even if no objects (line, area, solid, link) are
connected to them. Points that are not special are automatically deleted if no objects connect to
them.

## VBA Example

Sub GetSpecialPointStatus()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SpecialPoint As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set as special point
ret = SapModel.PointObj.SetSpecialPoint("3", True)


'get special point status
ret = SapModel.PointObj.GetSpecialPoint("3", SpecialPoint)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSpecialPoint

DeleteSpecialPoint

# GetSpring

## Syntax

SapObject.SapModel.PointObj.GetSpring

## VB6 Procedure

Function GetSpring(ByVal Name As String, ByRef k() As Double) As Long

## Parameters

Name

The name of an existing point object.

k

This is an array of six spring stiffness values.

```
Value(0) = U1 [F/L]
Value(1) = U2 [F/L]
Value(2) = U3 [F/L]
Value(3) = R1 [FL/rad]
Value(4) = R2 [FL/rad]
Value(5) = R3 [FL/rad]
```

## Remarks

This function retrieves uncoupled spring stiffness assignments for a point object, that is, it
retrieves the diagonal terms in the 6x6 spring matrix for the point object.

The spring stiffnesses reported are the sum of all springs assigned to the point object. The spring
stiffness values are reported in the point local coordinate system.

The function returns zero if the stiffnesses are successfully retrieved, otherwise it returns a
nonzero value. If no springs exist at the point object, the function returns a nonzero value.

## VBA Example

Sub GetSpring()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim k() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign spring to a point
ReDim k(5)
k(2) = 10
ret = SapModel.PointObj.SetSpring("3", k)

'get spring values
ReDim k(5)
ret = SapModel.PointObj.GetSpring("3", k)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetSpringCoupled

SetSpring

SetSpringCoupled

DeleteSpring

IsSpringCoupled

# GetSpringCoupled

## Syntax

SapObject.SapModel.PointObj.GetSpringCoupled

## VB6 Procedure

Function GetSpringCoupled(ByVal Name As String, ByRef k() As Double) As Long

## Parameters

Name

The name of an existing point object.

k

This is an array of twenty one spring stiffness values.

```
Value(0) = U1U1 [F/L]
Value(1) = U1U2 [F/L]
Value(2) = U2U2 [F/L]
Value(3) = U1U3 [F/L]
Value(4) = U2U3 [F/L]
Value(5) = U3U3 [F/L]
Value(6) = U1R1 [F/rad]
Value(7) = U2R1 [F/rad]
Value(8) = U3R1 [F/rad]
Value(9) = R1R1 [FL/rad]
Value(10) = U1R2 [F/rad]
Value(11) = U2R2 [F/rad]
Value(12) = U3R2 [F/rad]
```

```
Value(13) = R1R2 [FL/rad]
Value(14) = R2R2 [FL/rad]
Value(15) = U1R3 [F/rad]
Value(16) = U2R3 [F/rad]
Value(17) = U3R3 [F/rad]
Value(18) = R1R3 [FL/rad]
Value(19) = R2R3 [FL/rad]
Value(20) = R3R3 [FL/rad]
```
## Remarks

This function retrieves coupled spring stiffness assignments for a point object.

The spring stiffnesses reported are the sum of all springs assigned to the point object. The spring
stiffness values are reported in the point local coordinate system.

The function returns zero if the stiffnesses are successfully retrieved, otherwise it returns a
nonzero value. If no springs exist at the point object, the function returns a nonzero value.

## VBA Example

Sub GetSpringCoupled()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim k() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign coupled spring to a point
ReDim k(20)
k(2) = 10
k(17) = 4
ret = SapModel.PointObj.SetSpringCoupled("3", k)

'get coupled spring values
ReDim k(20)
ret = SapModel.PointObj.GetSpringCoupled("3", k)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

SetSpring

SetSpringCoupled

DeleteSpring

IsSpringCoupled

# GetTransformationMatrix

## Syntax

SapObject.SapModel.PointObj.GetTransformationMatrix

## VB6 Procedure

Function GetTransformationMatrix(ByVal Name As String, ByRef Value() As Double,Optional
ByVal IsGlobal As Boolean = True) As Long

## Parameters

Name

The name of an existing point object.

Value

Value is an array of nine direction cosines that define the transformation matrix.

The following matrix equation shows how the transformation matrix is used to convert items from
the point object local coordinate system to the global coordinate system.


In the equation, c0 through c8 are the nine values from the transformation array; (Local1, Local2,
Local3) are an item (such as a point load) in the point object local coordinate system; and
(GlobalX, GlobalY, GlobalZ) are the same item in the global coordinate system.

The transformation from the local coordinate system to the present coordinate system is the same
as that shown above for the global system if you substitute the present system for the global
system.

IsGlobal

If this item is True, the transformation matrix is between the Global coordinate system and the
point object local coordinate system.

If this item is False, the transformation matrix is between the present coordinate system and the
point object local coordinate system.

## Remarks

The function returns zero if the point object transformation matrix is successfully retrieved,
otherwise it returns a nonzero value.

## VBA Example

Sub GetPointObjectMatrix()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim Value() as double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)


'set local axes
ret = SapModel.PointObj.SetLocalAxes("3", 33, 14, 12)

'get point object transformation matrix
redim Value(8)
ret = SapModel.PointObj.GetTransformationMatrix("3", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# IsSpringCoupled

## Syntax

SapObject.SapModel.PointObj.IsSpringCoupled

## VB6 Procedure

Function IsSpringCoupled(ByVal Name As String, ByVal IsCoupled As Boolean) As Long

## Parameters

Name

The name of an existing point object.

IsCoupled

This item is True if the spring assigned to the specified point object is coupled, otherwise it is
False.

## Remarks

This function indicates if the spring assignments to a point object are coupled, that is, if they have
off-diagonal terms in the 6x6 spring matrix for the point object.

The function returns zero if the coupled status is successfully retrieved, otherwise it returns a
nonzero value. If no springs exist at the point object,n the function returns a nonzero value.


## VBA Example

Sub CheckIsSpringCoupled()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim k() As Double
Dim IsCoupled As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign spring to a point
ReDim k(5)
k(2) = 10
ret = SapModel.PointObj.SetSpring("3", k)

'determine if spring is coupled
ret = SapModel.PointObj.IsSpringCoupled("3", IsCoupled)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

GetSpringCoupled

SetSpring


SetSpringCoupled

DeleteSpring

# SetConstraint

## Syntax

SapObject.SapModel.PointObj.SetConstraint

## VB6 Procedure

Function SetConstraint(ByVal Name As String, ConstraintName As String, Optional ByVal
ItemType As eItemType = Object, Optional ByVal Replace As Boolean = True) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

ConstraintName

The name of an existing joint constraint.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the constraint assignment is made to the point object specified by the Name
item.

If this item is Group, the constraint assignment is made to all point objects in the group specified
by the Name item.

If this item is SelectedObjects, the constraint assignment is made to all selected point objects and
the Name item is ignored.

Replace

If this item is True, all previous joint constraints, if any, assigned to the specified point object(s)
are deleted before making the new assignment.

## Remarks


This function makes joint constraint assignments to point objects.

The function returns 0 if the assignment is successfully made, otherwise it returns nonzero.

## VBA Example

Sub SetConstraintAssignment()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define a new constraint
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1")

'define new constraint assignments
For i = 4 To 16 Step 4
ret = SapModel.PointObj.SetConstraint(Format(i), "Diaph1")
Next i

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Modified optional argument Replace to be ByVal in version 12.0.1.

## See Also

GetConstraint


DeleteConstraint

# SetGroupAssign

## Syntax

SapObject.SapModel.PointObj.SetGroupAssign

## VB6 Procedure

Function SetGroupAssign(ByVal Name As String, ByVal GroupName As String, Optional ByVal
Remove As Boolean = False, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

GroupName

The name of an existing group to which the assignment is made.

Remove

If this item is False, the specified point objects are added to the group specified by the
GroupName item. If it is True, the point objects are removed from the group.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the point object specified by the Name item is added or removed from the
group specified by the GroupName item.

If this item is Group, all point objects in the group specified by the Name item are added or
removed from the group specified by the GroupName item.

If this item is SelectedObjects, all selected point objects are added or removed from the group
specified by the GroupName item and the Name item is ignored.

## Remarks

This function adds or removes point objects from a specified group.


The function returns zero if the group assignment is successful, otherwise it returns a nonzero
value.

## VBA Example

Sub AddPointObjectsToGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'add point objects to group
ret = SapModel.PointObj.SetGroupAssign("3", "Group1")
ret = SapModel.PointObj.SetGroupAssign("6", "Group1")
ret = SapModel.PointObj.SetGroupAssign("9", "Group1")

'select objects in group
ret = SapModel.SelectObj.Group("Group1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Modified optional argument Remove to be ByVal in version 12.0.1.

## See Also


GetGroupAssign

# SetGUID

## Syntax

SapObject.SapModel.PointObj.SetGUID

## VB6 Procedure

Function SetGUID(ByVal Name As String, Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing point object.

GUID

The GUID (Global Unique ID) for the specified point object.

## Remarks

This function sets the GUID for specified point object. If the GUID is passed in as a blank string,
the program automatically creates a GUID for the object.

This function returns zero if the point object GUID is successfully set; otherwise it returns
nonzero.

## VBA Example

Sub SetPointGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set program created GUID
ret = SapModel.PointObj.SetGUID("1")

'get GUID
ret = SapModel.PointObj.GetGUID("1", GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetGUID

# SetLoadDispl

## Syntax

SapObject.SapModel.PointObj.SetLoadDispl

## VB6 Procedure

Function SetLoadDispl(ByVal Name As String, ByVal LoadPat As String, ByRef Value() As
Double, Optional ByVal Replace As Boolean = False, Optional ByVal CSys As String = "Global",
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

LoadPat

The name of the load pattern for the ground displacement load.

Value


This is an array of six ground displacement load values.

```
Value(0) = U1 [L]
Value(1) = U2 [L]
Value(2) = U3 [L]
Value(3) = R1 [rad]
Value(4) = R2 [rad]
Value(5) = R3 [rad]
```
Replace

If this item is True, all previous ground displacement loads, if any, assigned to the specified point
object(s) in the specified load pattern are deleted before making the new assignment.

CSys

The name of the coordinate system for the considered ground displacement load. This is Local or
the name of a defined coordinate system.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignment is made to the point object specified by the Name item.

If this item is Group, the load assignment is made to all point objects in the group specified by the
Name item.

If this item is SelectedObjects, the load assignment is made to all selected point objects and the
Name item is ignored.

## Remarks

This function makes ground displacement load assignments to point objects.

The function returns zero if the load assignments are successfully made, otherwise it returns a
nonzero value.

## VBA Example

Sub SetPointDisplLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value() As Double

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add ground displacement load
Redim Value(5)
Value(0) = 10
ret = SapModel.PointObj.SetLoadDispl("1", "DEAD", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDispl

DeleteLoadDispl

# SetLoadForce

## Syntax

SapObject.SapModel.PointObj.SetLoadForce

## VB6 Procedure

Function SetLoadForce(ByVal Name As String, ByVal LoadPat As String, ByRef Value() As
Double, Optional ByVal Replace As Boolean = False, Optional ByVal CSys As String = "Global",
Optional ByVal ItemType As eItemType = Object) As Long


## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

LoadPat

The name of the load pattern for the point load.

Value

This is an array of six point load values.

```
Value(0) = F1 [F]
Value(1) = F2 [F]
Value(2) = F3 [F]
Value(3) = M1 [FL]
Value(4) = M2 [FL]
Value(5) = M3 [FL]
```
Replace

If this item is True, all previous point loads, if any, assigned to the specified point object(s) in the
specified load pattern are deleted before making the new assignment.

CSys

The name of the coordinate system for the considered point load. This is Local or the name of a
defined coordinate system.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignment is made to the point object specified by the Name item.

If this item is Group, the load assignment is made to all point objects in the group specified by the
Name item.

If this item is SelectedObjects, the load assignment is made to all selected point objects and the
Name item is ignored.

## Remarks

This function makes point load assignments to point objects.

The function returns zero if the load assignments are successfully made, otherwise it returns a
nonzero value.


## VBA Example

Sub SetPointForceLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value() As Double
Dim LoadPat As String
Dim LCStep As Long
Dim CSys As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add point load
Redim Value(5)
Value(0) = 10
ret = SapModel.PointObj.SetLoadForce("1", "DEAD", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadForce

DeleteLoadForce


# SetLoadForceWithGUID {Point Object}

## Syntax

SapObject.SapModel.PointObj.SetLoadForceWithGUID

## VB6 Procedure

Function SetLoadForceWithGUID(ByVal Name As String, ByVal LoadPat As String, ByRef
Value() As Double, ByRef GUID As String, Optional ByVal Replace As Boolean = False,
Optional ByVal CSys As String = "Global") As Long

## Parameters

Name

The name of an existing point object.

LoadPat

The name of the load pattern for the point load.

Value

This is an array of six point load values.

```
Value(0) = F1 [F]
Value(1) = F2 [F]
Value(2) = F3 [F]
Value(3) = M1 [FL]
Value(4) = M2 [FL]
Value(5) = M3 [FL]
```
GUID

This is the global unique ID of a load force assigned to the point object or if it is not the global
unique id of a load force assigned to the point object and it is not blank, the global unique ID
which is assigned to the newly assigned load. If left blank, a new load is assigned to the point
object and the value of this parameter is set to the global unique ID of the newly assigned load.

Replace

If this item is True and the input GUID is not the GUID of any load force assigned to the point
object, all previous loads force, if any, assigned to the specified point object, in the specified load
pattern, are deleted before making the new assignment. If the input GUID is the GUID of a load
force already assigned to the point object, the parameters of the distributed load are updated with
the values provided and this item is ignored.

CSys


The name of the coordinate system for the considered point load. This is Local or the name of a
defined coordinate system.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignment is made to the point object specified by the Name item.

If this item is Group, the load assignment is made to all point objects in the group specified by the
Name item.

If this item is SelectedObjects, the load assignment is made to all selected point objects and the
Name item is ignored.

## Remarks

This function makes point load assignments to point objects.

The function returns zero if the load assignments are successfully made, otherwise it returns a
nonzero value.

## Release Notes

Initial release in version 17.2.0.

## See Also

GetLoadForceWithGUID

DeleteLoadForceWithGUID

# SetLocalAxes

## Syntax

SapObject.SapModel.PointObj.SetLocalAxes

## VB6 Procedure

Function SetLocalAxes(ByVal Name As String, ByVal a As Double, ByVal b As Double, ByVal
c As Double, Optional ByVal ItemType As eItemType = Object) As Long


## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

a, b, c

The local axes of the point are defined by first setting the positive local 1, 2 and 3 axes the same as
the positive global X, Y and Z axes and then doing the following: [deg]

1. Rotate about the 3 axis by angle a.
2. Rotate about the resulting 2 axis by angle b.
3. Rotate about the resulting 1 axis by angle c.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the local axes assignment is made to the point object specified by the Name
item.

If this item is Group, the local axes assignment is made to all point objects in the group specified
by the Name item.

If this item is SelectedObjects, the local axes assignment is made to all selected point objects and
the Name item is ignored.

## Remarks

This function sets the local axes angles for point objects.

The function returns zero if the local axes angles are successfully set, otherwise it returns a
nonzero value.

## VBA Example

Sub SetPointLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set local axes
ret = SapModel.PointObj.SetLocalAxes("ALL", 90, 0, 0, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetLocalAxes

# SetLocalAxesAdvanced

## Syntax

SapObject.SapModel.PointObj.SetLocalAxesAdvanced

## VB6 Procedure

Function SetLocalAxesAdvanced(ByVal Name As String, ByVal Active As Boolean, ByVal
AxVectOpt As Long, ByVal AxCSys As String, ByRef AxDir() As Long, ByRef AxPt() As
String, ByRef AxVect() As Double, ByVal Plane2 As Long, ByVal PlVectOpt As Long, ByVal
PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double,
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing point object or group, depending on the value of the ItemType item.


Active

This is True if advanced local axes exist.

AxVectOpt, PlVectOpt

This is 1, 2 or 3, indicating the axis/plane reference vector option. This item applies only when the
Active item is True.

```
1 = Coordinate direction
2 = Two joints
3 = User vector
```
AxCSys, PlCSys

The coordinate system used to define the axis/plane reference vector coordinate directions and the
axis/plane user vector. This item applies when the Active item is True and the
AxVectOpt/PlVectOpt item is 1 or 3.

AxDir, PlDir

This is an array dimensioned to 1 (2 integers), indicating the axis/plane reference vector primary
and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center
in the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1. Possible coordinate
direction values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
AxPt, PlPt

This is an array dimensioned to 1 (2 strings), indicating the labels of two joints that define the
axis/plane reference vector. Either of these joints may be specified as None to indicate the center
of the specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt
item is 2.

AxVect, PlVect

This is an array dimensioned to 2 (3 doubles) that defines the axis/plane reference vector. This
item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 3.

Plane2

This is 12, 13, 21, 23, 31 or 32, indicating that the local plane determined by the plane reference
vector is the 1-2, 1-3, 2-1, 2-3, 3-1, 0r 3-2 plane. This item applies only when the Active item is
True.


ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
Selection = 2
```
If this item is Object, the assignment is made to the point object specified by the Name item.

If this item is Group, the assignment is made to all point objects in the group specified by the
Name item.

If this item is Selection, assignment is made to all selected point objects and the Name item is
ignored.

## Remarks

This function assigns advanced local axes to point objects.

The function returns zero if the advanced local axes assignments are assigned successfully;
otherwise it returns a nonzero value.

## VBA Example

Sub AssignPointAdvancedLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyAxDir(1) As Long
Dim MyAxPt(1) As String
Dim MyAxVect(2) As Double
Dim MyPlDir(1) As Long
Dim MyPlPt(1) As String
Dim MyPlVect(2) As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)


'assign point advanced local axes
MyAxVect(0)=0.707
MyAxVect(1)=0.707
MyAxVect(2)=0
MyPlDir(0) = 2
MyPlDir(1) = 3
ret = SapModel.PointObj.SetLocalAxesAdvanced("ALL", True, 3, "Global", MyAxDir,
MyAxPt, MyAxVect, 12, 1, "Global", MyPlDir, MyPlPt, MyPlVect, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also

GetLocalAxesAdvanced

GetLocalAxes

# SetMass

## Syntax

SapObject.SapModel.PointObj.SetMass

## VB6 Procedure

Function SetMass(ByVal Name As String, ByRef m() As Double, Optional ByVal ItemType As
eItemType = object, Optional ByVal IsLocalCSys As Boolean = True, Optional ByVal Replace
As Boolean = False) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

m

This is an array of six mass assignment values.

```
Value(0) = U1 [M]
```

```
Value(1) = U2 [M]
Value(2) = U3 [M]
Value(3) = R1 [ML^2 ]
Value(4) = R2 [ML^2 ]
Value(5) = R3 [ML^2 ]
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the mass assignment is made to the point object specified by the Name item.

If this item is Group, the mass assignment is made to all point objects in the group specified by the
Name item.

If this item is SelectedObjects, the mass assignment is made to all selected point objects and the
Name item is ignored.

IsLocalCSys

If this item is True, the specified mass assignments are in the point object local coordinate system.
If it is False, the assignments are in the Global coordinate system.

Replace

If this item is True, all existing point mass assignments to the specified point object(s) are deleted
prior to making the assignment. If it is False, the mass assignments are added to any existing
assignments.

## Remarks

This function assigns point mass to a point object.

The function returns zero if the mass is successfully assigned, otherwise it returns a nonzero value.

## VBA Example

Sub AssignPointMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
dim i as long
Dim m() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign point mass
Redim m(5)
For i = 0 to 5
m(i) = (i+1) / 10
Next i
ret = SapModel.PointObj.SetMass("3", m)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMass

DeleteMass

SetMassByVolume

SetMassByWeight

# SetMassByVolume

## Syntax

Sap2000.PointObj.SetMassByVolume

## VB6 Procedure


Function SetMassByVolume(ByVal Name As String, ByVal MatProp As String, ByRef m() As
Double, Optional ByVal ItemType As eItemType = Object, Optional ByVal IsLocalCSys As
Boolean = True, Optional ByVal Replace As Boolean = False) As Long

## Parameters

Name

The name of an existing point object or group, depending on the value of the ItemType item.

MatProp

The name of an existing material property.

m

This is an array of six mass assignment values.

```
Value(0) = U1 [L^3 ]
```
```
Value(1) = U2 [L^3 ]
```
```
Value(2) = U3 [L^3 ]
```
```
Value(3) = R1 [L^5 ]
```
```
Value(4) = R2 [L^5 ]
```
```
Value(5) = R3 [L^5 ]
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
```
```
Group = 1
```
```
SelectedObjects = 2
```
If this item is Object, the mass assignment is made to the point object specified by the Name item.

If this item is Group, the mass assignment is made to all point objects in the group specified by the
Name item.

If this item is SelectedObjects, the mass assignment is made to all selected point objects and the
Name item is ignored.

IsLocalCSys

If this item is True, the specified mass assignments are in the point object local coordinate system.
If it is False, the assignments are in the Global coordinate system.

Replace


If this item is True, all existing point mass assignments to the specified point object(s) are deleted
prior to making the assignment. If it is False, the mass assignments are added to any previously
existing assignments.

## Remarks

This function assigns point mass to a point object. The program calculates the mass by multiplying
the specified values by the mass per unit volume of the specified material property.

The function returns zero if the mass is successfully assigned; otherwise, it returns a nonzero
value.

## VBA Example

Sub AssignPointMassByVolume()
'dimension variables
Dim SapObject as cOAPI
Dim ret As Long
Dim i as long
Dim m() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign point mass
Redim m(5)
For i = 0 to 5
m(i) = 20000 * (i+1)
Next i
ret = SapModel.PointObj.SetMassByVolume("3", "4000psi", m)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel= Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 12.00.

## See Also

SetMass

SetMassByWeight

GetMass

DeleteMass

# SetMassByWeight

## Syntax

Sap2000.PointObj.SetMassByWeight

## VB6 Procedure

Function SetMassByWeight(ByVal Name As String, ByRef m() As Double, Optional ByVal
ItemType As eItemType = Object, Optional ByVal IsLocalCSys As Boolean = True, Optional
ByVal Replace As Boolean = False) As Long

## Parameters

Name

The name of an existing point object or group, depending on the value of the ItemType item.

m

This is an array of six mass assignment values.

```
Value(0) = U1 [F]
```
```
Value(1) = U2 [F]
```
```
Value(2) = U3 [F]
```
```
Value(3) = R1 [FL^2 ]
```
```
Value(4) = R2 [FL^2 ]
```
```
Value(5) = R3 [FL^2 ]
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
```

```
Group = 1
```
```
SelectedObjects = 2
```
If this item is Object, the mass assignment is made to the point object specified by the Name item.

If this item is Group, the mass assignment is made to all point objects in the group specified by the
Name item.

If this item is SelectedObjects, the mass assignment is made to all selected point objects and the
Name item is ignored.

IsLocalCSys

If this item is True, the specified mass assignments are in the point object local coordinate system.
If it is False, the assignments are in the Global coordinate system.

Replace

If this item is True, all existing point mass assignments to the specified point object(s) are deleted
prior to making the assignment. If it is False, the mass assignments are added to any previously
existing assignments.

## Remarks

This function assigns point mass to a point object. The program calculates the mass by dividing
the specified values by the acceleration of gravity.

The function returns zero if the mass is successfully assigned; otherwise. it returns a nonzero
value.

## VBA Example

Sub AssignPointMassByWeight()
'dimension variables
Dim SapObject as cOAPI
Dim ret As Long
Dim i as long
Dim m() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign point mass
Redim m(5)
For i = 0 to 2
m(i) = i+1
Next i
ret = SapModel.PointObj.SetMassByWeight("3", m)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel= Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetMass

SetMassByVolume

GetMass

DeleteMass

# SetMergeNumber

## Syntax

SapObject.SapModel.PointObj.SetMergeNumber

## VB6 Procedure

Function SetMergeNumber(ByVal Name As String, ByVal MergeNumber As Long, Optional
ByVal ItemType As eItemType = object) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

MergeNumber

The merge number for the specified point object.


ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the merge number assignment is made to the point object specified by the
Name item.

If this item is Group, the merge number assignment is made to all point objects in the group
specified by the Name item.

If this item is SelectedObjects, the merge number assignment is made to all selected point objects
and the Name item is ignored.

## Remarks

This function assigns a merge number to a point object. By default the merge number for a point is
zero. Points with different merge numbers are not automatically merged by the program.

The function returns zero if the merge number is successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignPointMergeNumber()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set merge number
ret = SapModel.PointObj.SetMergeNumber("3", 2)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMergeNumber

# SetPanelZone

## Syntax

SapObject.SapMdel.PointObj.SetPanelZone

## VB6 Procedure

Function SetPanelZone(ByVal Name As String, ByVal PropType As Long, ByVal Thickness As
Double, ByVal K1 As Double, ByVal K2 As Double, ByVal LinkProp As String, ByVal
Connectivity As Long, ByVal LocalAxisFrom As Long, ByVal LocalAxisAngle As Double,
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing point object.

PropType

This is 0, 1, 2, or 3.

```
0 = Properties are elastic from column
1 = Properties are elastic from column and doubler plate
2 = Properties are from specified spring stiffnesses
3 = Properties are from a specified link property
```
Thickness

The thickness of the doubler plate. This item applies only when PropType = 1. [L]

K1


The spring stiffness for major axis bending (about the local 3 axis of the column and panel zone).
This item applies only when PropType = 2. [FL/rad]

K2

The spring stiffness for minor axis bending (about the local 2 axis of the column and panel zone).
This item applies only when PropType = 2. [FL/rad]

LinkProp

The name of the link property used to define the panel zone. This item applies only when
PropType = 3.

Connectivity

This is 0 or 1.

```
0 = Panel zone connects beams to other objects
1 = Panel zone connects braces to other objects
```
LocalAxisFrom

This is 0 or 1.

```
0 = Panel zone local axis angle is from column
1 = Panel zone local axis angle is user defined
```
The LocalAxisFrom item can be 1 only when the PropType item is 3.

LocalAxisAngle

This item applies only when PropType = 3 and LocalAxisFrom = 1. It is the angle measured
counter clockwise from the positive global X-axis to the local 2-axis of the panel zone. [deg]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the panel zone assignment is made to the point object specified by the Name
item.

If this item is Group, the panel zone assignment is made to all point objects in the group specified
by the Name item.

If this item is SelectedObjects, the panel zone assignment is made to all selected point objects and
the Name item is ignored.


## Remarks

This function makes panel zone assignments to point objects. Any existing panel zone
assignments are replaced by the new assignments.

The function returns zero if the panel zone data is successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignPanelZoneData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign panel zone
ret = SapModel.PointObj.SetPanelZone("3", 1, 2, 0, 0, "", 0, 0, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetPanelZone


# SetPatternByPressure

## Syntax

SapObject.SapModel.PointObj.SetPatternByPressure

## VB6 Procedure

Function SetPatternByPressure(ByVal Name As String, ByVal PatternName As String, ByVal Z
As Double, ByVal w As Double, u As Double, r As Long, Optional ByVal ItemType As
eItemType = Object, Optional ByVal Restriction As Long = 0, Optional ByVal Replace As
Boolean = False) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

PatternName

The name of a defined joint pattern.

z

The Z coordinate at zero pressure in the present coordinate system. [L]

w

A weight per unit volume. [F/L^3 ]

u

An added uniform force per unit area. [F/L^2 ]

r

This is 0, 1, or 2.

```
0 = All values are used
```
```
1 = Negative values are set to zero
```
```
2 = Positive values are set to zero
```
This restriction applies **_before_** the pattern value has been added to any existing pattern value
assigned to the point object.

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
```
```
Group = 1
```
```
SelectedObjects = 2
```
If this item is Object, the joint pattern assignment is made to the point object specified by the
Name item.

If this item is Group, the joint pattern assignment is made to all point objects in the group
specified by the Name item.

If this item is SelectedObjects, the joint pattern assignment is made to all selected point objects
and the Name item is ignored.

Restriction

This is 0, 1, or 2.

```
0 = All values are used
1 = Negative values are set to zero
2 = Positive values are set to zero
```
This restriction applies **_after_** the pattern value has been added to any existing pattern value
assigned to the point object. This restriction applies even if there was no existing joint pattern
value on the point object.

Replace

If this item is True, the joint pattern value calculated as shown in the Remarks section replaces any
previous joint pattern value for the point object.

If this item is False, the joint pattern value calculated as shown in the Remarks section is added to
any previous joint pattern value for the point object and then the Restriction items are checked.

## Remarks

This function sets the joint pattern value for a specified point object and joint pattern.

The joint pattern value is calculated as:

```
Value = [(z  zpoint) * w] + u
```
where z, w and u are described in the Parameters section and zpoint is the Z coordinate of the
considered point object in the present coordinate system. All appropriate unit conversions are used
to calculate the value in the database units, but thereafter it is assumed to be unitless.

The function returns zero if the pattern value is successfully assigned, otherwise it returns a
nonzero value.


## VBA Example

Sub SetJointPatternByPressure()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add joint pattern assignment
ret = SapModel.PointObj.SetPatternByPressure("ALL", "Default", 0, 20, 1, 0, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetPatternValue

SetPatternByXYZ

DeletePatternValue

GetPresentCoordSystem

SetPresentCoordSystem

# SetPatternByXYZ


## Syntax

SapObject.Sap2000.PointObj.SetPatternByXYZ

## VB6 Procedure

Function SetPatternByXYZ(ByVal Name As String, ByVal PatternName As String, ByVal a As
Double, ByVal b As Double, ByVal c As Double, ByVal d As Double, Optional ByVal ItemType
As eItemType = object, Optional ByVal Restriction As Long = 0, Optional ByVal Replace As
Boolean = False) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

PatternName

The name of a defined joint pattern.

a

The value a in the equation shown in the Remarks section. [1/L]

b

The value b in the equation shown in the Remarks section. [1/L]

c

The value c in the equation shown in the Remarks section. [1/L]

d

The value d in the equation shown in the Remarks section. This item is unitless.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
```
```
Group = 1
```
```
SelectedObjects = 2
```
If this item is Object, the joint pattern assignment is made to the point object specified by the
Name item.


If this item is Group, the joint pattern assignment is made to all point objects in the group
specified by the Name item.

If this item is SelectedObjects, the joint pattern assignment is made to all selected point objects
and the Name item is ignored.

Restriction

This is either 0, 1, or 2.

```
0 = All values are used
```
```
1 = Negative values are set to zero
```
```
2 = Positive values are set to zero
```
Replace

If this item is True, the joint pattern value calculated as shown in the Remarks section replaces any
previous joint pattern value for the point object.

If this item is False, the joint pattern value calculated as shown in the Remarks section is added to
any previous joint pattern value for the point object and then the Restriction items are checked.

## Remarks

This function sets the joint pattern value for a specified point object and joint pattern.

The joint pattern value is calculated as:

```
Value = ax + by + cz + d
```
where a, b, c and d are function input parameters and x, y and z are the coordinates of the
considered point object in the present coordinate system

The function returns zero if the pattern value is successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub SetJointPatternByXYZ()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add joint pattern assignment
ret = SapModel.PointObj.SetPatternByXYZ("ALL", "Default", 0, 0, 10, 0, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetPatternValue

SetPatternByPressure

DeletePatternValue

GetPresentCoordSystem

SetPresentCoordSystem

# SetRestraint

## Syntax

SapObject.SapModel.PointObj.SetRestraint

## VB6 Procedure

Function SetRestraint(ByVal Name As String, ByRef Value() As Boolean, Optional ByVal
ItemType As eItemType = object) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.


Value

This is an array of six restraint values.

```
Value(0) = U1
Value(1) = U2
Value(2) = U3
Value(3) = R1
Value(4) = R2
Value(5) = R3
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the restraint assignment is made to the point object specified by the Name
item.

If this item is Group, the restraint assignment is made to all point objects in the group specified by
the Name item.

If this item is SelectedObjects, the restraint assignment is made to all selected point objects and
the Name item is ignored.

## Remarks

This function assigns the restraint assignments for a point object. The restraint assignments are
always set in the point local coordinate system.

The function returns zero if the restraint assignments are successfully assigned, otherwise it
returns a nonzero value.

## VBA Example

Sub AssignPointRestraints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign point object restraints
Redim Value(5)
For i = 0 to 5
Value(i) = True
Next i
ret = SapModel.PointObj.setRestraint("1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetRestraint

DeleteRestraint

# SetSelected

## Syntax

SapObject.SapModel.PointObj.SetSelected

## VB6 Procedure

Function SetSelected(ByVal Name As String, ByVal Selected As Boolean, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.


Selected

This item is True if the specified point object is selected, otherwise it is False.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the selected status is set for the point object specified by the Name item.

If this item is Group, the selected status is set for all point objects in the group specified by the
Name item.

If this item is SelectedObjects, the selected status is set for all selected point objects and the Name
item is ignored.

## Remarks

This function sets the selected status for a point object.

The function returns zero if the selected status is successfully set, otherwise it returns a nonzero
value.

## VBA Example

Sub SetPointSelected()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set point selected


ret = SapModel.PointObj.SetSelected("3", True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSelected

# SetSpecialPoint

## Syntax

SapObject.SapModel.PointObj.SetSpecialPoint

## VB6 Procedure

Function SetSpecialPoint(ByVal Name As String, ByVal SpecialPoint As Boolean, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

SpecialPoint

This item is True if the point object is specified as a special point, otherwise it is False.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the special point status is set for the point object specified by the Name item.


If this item is Group, the special point status is set for all point objects in the group specified by
the Name item.

If this item is SelectedObjects, the special point status is set for all selected point objects and the
Name item is ignored.

## Remarks

This function sets the special point status for a point object.

The function returns zero if the special point status is successfully set, otherwise it returns a
nonzero value.

Special points are allowed to exist in the model even if no objects (line, area, solid, link) are
connected to them. Points that are not special are automatically deleted if no objects connect to
them.

## VBA Example

Sub SetSpecialPoint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set as special point
ret = SapModel.PointObj.SetSpecialPoint("3", True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.00.

## See Also

GetSpecialPoint

DeleteSpecialPoint

# SetSpring

## Syntax

SapObject.SapModel.PointObj.SetSpring

## VB6 Procedure

Function SetSpring(ByVal Name As String, ByRef k() As Double, Optional ByVal ItemType As
eItemType = object, Optional ByVal IsLocalCSys As Boolean = False, Optional ByVal Replace
As Boolean = False) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

k

This is an array of six spring stiffness values.

```
Value(0) = U1 [F/L]
Value(1) = U2 [F/L]
Value(2) = U3 [F/L]
Value(3) = R1 [FL/rad]
Value(4) = R2 [FL/rad]
Value(5) = R3 [FL/rad]
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the spring assignment is made to the point object specified by the Name
item.


If this item is Group, the spring assignment is made to all point objects in the group specified by
the Name item.

If this item is SelectedObjects, the spring assignment is made to all selected point objects and the
Name item is ignored.

IsLocalCSys

If this item is True, the specified spring assignments are in the point object local coordinate
system. If it is False, the assignments are in the Global coordinate system.

Replace

If this item is True, all existing point spring assignments to the specified point object(s) are
deleted prior to making the assignment. If it is False, the spring assignments are added to any
existing assignments.

## Remarks

This function assigns coupled springs to a point object.

The function returns zero if the stiffnesses are successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignPointSpring()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim k() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign spring to a point
ReDim k(5)
k(2) = 10
ret = SapModel.PointObj.SetSpring("3", k)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

GetSpringCoupled

SetSpringCoupled

DeleteSpring

IsSpringCoupled

# SetSpringCoupled

## Syntax

SapObject.SapModel.PointObj.SetSpringCoupled

## VB6 Procedure

Function SetSpringCoupled(ByVal Name As String, ByRef k() As Double, Optional ByVal
ItemType As eItemType = object, Optional ByVal IsLocalCSys As Boolean = False, Optional
ByVal Replace As Boolean = False) As Long

## Parameters

Name

The name of an existing point object or group depending on the value of the ItemType item.

k

This is an array of twenty one spring stiffness values.

```
Value(0) = U1U1 [F/L]
Value(1) = U1U2 [F/L]
Value(2) = U2U2 [F/L]
Value(3) = U1U3 [F/L]
```

```
Value(4) = U2U3 [F/L]
Value(5) = U3U3 [F/L]
Value(6) = U1R1 [F/rad]
Value(7) = U2R1 [F/rad]
Value(8) = U3R1 [F/rad]
Value(9) = R1R1 [FL/rad]
Value(10) = U1R2 [F/rad]
Value(11) = U2R2 [F/rad]
Value(12) = U3R2 [F/rad]
Value(13) = R1R2 [FL/rad]
Value(14) = R2R2 [FL/rad]
Value(15) = U1R3 [F/rad]
Value(16) = U2R3 [F/rad]
Value(17) = U3R3 [F/rad]
Value(18) = R1R3 [FL/rad]
Value(19) = R2R3 [FL/rad]
Value(20) = R3R3 [FL/rad]
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the spring assignment is made to the point object specified by the Name
item.

If this item is Group, the spring assignment is made to all point objects in the group specified by
the Name item.

If this item is SelectedObjects, the spring assignment is made to all selected point objects and the
Name item is ignored.

IsLocalCSys

If this item is True, the specified spring assignments are in the point object local coordinate
system. If it is False, the assignments are in the Global coordinate system.

Replace

If this item is True, all existing point spring assignments to the specified point object(s) are
deleted prior to making the assignment. If it is False, the spring assignments are added to any
existing assignments.

## Remarks

This function assigns coupled springs to a point object.

The function returns zero if the stiffnesses are successfully assigned, otherwise it returns a
nonzero value.


## VBA Example

Sub AssignCoupledSpring()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim k() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign coupled spring to a point
ReDim k(20)
k(2) = 10
k(17) = 4
ret = SapModel.PointObj.SetSpringCoupled("3", k)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

GetSpringCoupled

SetSpring

DeleteSpring

IsSpringCoupled


# AddByCoord

## Syntax

SapObject.SapModel.SolidObj.AddByCoord

## VB6 Procedure

Function AddByCoord(ByRef x() As Double, ByRef y() As Double, ByRef z() As Double, ByRef
Name As String, Optional ByVal PropName As String = "Default", Optional ByVal UserName As
String = "", Optional ByVal CSys As String = "Global") As Long

## Parameters

x, y, z

These are arrays of x, y and z coordinates, respectively, for the corner points of the solid object.
The coordinates are in the coordinate system defined by the CSys item.

Name

This is the name that the program ultimately assigns for the solid object. If no UserName is
specified, the program assigns a default name to the solid object. If a UserName is specified and
that name is not used for another solid object, the UserName is assigned to the solid object;
otherwise a default name is assigned to the solid object.

PropName

This is either Default or the name of a defined solid property.

If it is Default, the program assigns a default solid property to the solid object. If it is the name of
a defined solid property, that property is assigned to the solid object.

UserName

This is an optional user specified name for the solid object. If a UserName is specified and that
name is already used for another solid object, the program ignores the UserName.

CSys

The name of the coordinate system in which the solid object point coordinates are defined.

## Remarks

This function adds a new solid object whose corner points are at the specified coordinates. Note
that solid objects always are defined with eight corner points.

The function returns zero if the solid object is successfully added; otherwise it returns a nonzero
value.


## VBA Example

Sub AddSolidObjByCoord()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim x() As Double
Dim y() As Double
Dim z() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewBlank

'add solid object by coordinates
ReDim x(7)
ReDim y(7)
ReDim z(7)
x(0) = 0: y(0) = 0: z(0) = 0
x(1) = 100: y(1) = 0: z(1) = 0
x(2) = 0: y(2) = 100: z(2) = 0
x(3) = 100: y(3) = 100: z(3) = 0
x(4) = 0: y(4) = 0: z(4) = 100
x(5) = 100: y(5) = 0: z(5) = 100
x(6) = 0: y(6) = 100: z(6) = 100
x(7) = 100: y(7) = 100: z(7) = 100
ret = SapModel.SolidObj.AddByCoord(x, y, z, Name)

'refresh view
ret = SapModel.View.RefreshView(0, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

AddByPoint

# AddByPoint

## Syntax

SapObject.SapModel.SolidObj.AddByPoint

## VB6 Procedure

Function AddByPoint(ByRef Point() as String, ByRef Name As String, Optional ByVal
PropName As String = "Default", Optional ByVal UserName As String = "") As Long

## Parameters

Point

This is an array containing the names of the eight point objects that define the corner points of the
added solid object.

Name

This is the name that the program ultimately assigns for the solid object. If no UserName is
specified, the program assigns a default name to the solid object. If a UserName is specified and
that name is not used for another solid object, the UserName is assigned to the solid object;
otherwise a default name is assigned to the solid object.

PropName

This is either Default or the name of a defined solid property.

If it is Default, the program assigns a default solid property to the solid object. If it is the name of
a defined solid property, that property is assigned to the solid object.

UserName

This is an optional user specified name for the solid object. If a UserName is specified and that
name is already used for another solid object, the program ignores the UserName.

## Remarks

This function adds a new solid object whose corner points are specified by name.


The function returns zero if the solid object is successfully added; otherwise it returns a nonzero
value.

## VBA Example

Sub AddSolidObjByPoint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Point() As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(Openframe, 2, 144, 3, 288, 2, 288)

'add solid object by points
Redim Point(7)
Point(0) = "1"
Point(1) = "10"
Point(2) = "4"
Point(3) = "13"
Point(4) = "2"
Point(5) = "11"
Point(6) = "5"
Point(7) = "14"
ret = SapModel.SolidObj.AddByPoint(Point, Name)

'refresh view
ret = SapModel.View.RefreshView(0, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.00.

## See Also

AddByCoord

# ChangeName

## Syntax

SapObject.SapModel.SolidObj.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined solid object.

NewName

The new name for the solid object.

## Remarks

This function applies a new name to a solid object.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeSolidObjName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'change name
ret = SapModel.SolidObj.ChangeName("1", "MySolid")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Count

## Syntax

SapObject.SapModel.SolidObj.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns a count of the solid objects in the model.

## VBA Example

Sub CountSolidObjects()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'return number of solid objects
Count = SapModel.SolidObj.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.SolidObj.Delete

## VB6 Procedure

Function Delete(ByVal Name As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters

Name


The name of an existing solid object or group, depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the solid object specified by the Name item is deleted.

If this item is Group, the all solid objects in the group specified by the Name item are deleted.

If this item is SelectedObjects, all selected solid objects are deleted, and the Name item is ignored.

## Remarks

The function deletes solid objects.

The function returns zero if the solid objects are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteSolidObj()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'delete solid object
ret = SapModel.SolidObj.Delete("2")

'update view
ret = SapModel.View.RefreshView(0, True)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

AddByPoint

# DeleteLoadGravity

## Syntax

SapObject.SapModel.SolidObj.DeleteLoadGravity

## VB6 Procedure

Function DeleteLoadGravity(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the solid object specified by the Name
item.


If this item is Group, the load assignments are deleted for all solid objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected solid objects, and
the Name item is ignored.

## Remarks

This function deletes the gravity load assignments to the specified solid objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteSolidObjectGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object gravity loads
ret = SapModel.SolidObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'delete solid object gravity load
ret = SapModel.SolidObj.DeleteLoadGravity("1", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

SetLoadGravity

# DeleteLoadPorePressure

## Syntax

SapObject.SapModel.SolidObj.DeleteLoadPorePressure

## VB6 Procedure

Function DeleteLoadPorePressure(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the solid object specified by the Name
item.

If this item is Group, the load assignments are deleted for all solid objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected solid objects, and
the Name item is ignored.


## Remarks

This function deletes the pore pressure load assignments to the specified solid objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteSolidObjectPorePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object pore pressure load
ret = SapModel.SolidObj.SetLoadPorePressure("ALL", "DEAD", .1, , , Group)

'delete solid object pore pressure load
ret = SapModel.SolidObj.DeleteLoadPorePressure("1", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetLoadPorePressure

SetLoadPorePressure

# DeleteLoadStrain

## Syntax

SapObject.SapModel.SolidObj.DeleteLoadStrain

## VB6 Procedure

Function DeleteLoadStrain(ByVal Name As String, ByVal LoadPat As String, ByVal Component
As Long, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Component

This is 1, 2, 3, 4, 5 or 6, indicating the component for which the strain load is to be deleted.

```
1 = Strain11
2 = Strain22
3 = Strain33
4 = Strain12
5 = Strain13
6 = Strain23
```
ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the solid object specified by the Name
item.


If this item is Group, the load assignments are deleted for all solid objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected solid objects, and
the Name item is ignored.

## Remarks

This function deletes the strain load assignments to the specified solid objects, for the specified
load pattern, for the specified components.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteSolidObjectStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object strain load
ret = SapModel.SolidObj.SetLoadStrain("ALL", "DEAD", 1, 0.001, , , Group)

'delete solid object strain load
ret = SapModel.SolidObj.DeleteLoadStrain("1", "DEAD", 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadStrain

SetLoadStrain

# DeleteLoadSurfacePressure

## Syntax

SapObject.SapModel.SolidObj.DeleteLoadSurfacePressure

## VB6 Procedure

Function DeleteLoadSurfacePressure(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the solid object specified by the Name
item.

If this item is Group, the load assignments are deleted for all solid objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected solid objects, and
the Name item is ignored.


## Remarks

This function deletes the surface pressure load assignments to the specified solid objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteSolidObjectSurfacePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object surface pressure load
ret = SapModel.SolidObj.SetLoadSurfacePressure("ALL", "DEAD", 1, .1, , , Group)

'delete solid object surface pressure load
ret = SapModel.SolidObj.DeleteLoadSurfacePressure("1", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetLoadSurfacePressure

SetLoadSurfacePressure

# DeleteLoadTemperature

## Syntax

SapObject.SapModel.SolidObj.DeleteLoadTemperature

## VB6 Procedure

Function DeleteLoadTemperature(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the solid object specified by the Name
item.

If this item is Group, the load assignments are deleted for all solid objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected solid objects, and
the Name item is ignored.

## Remarks

This function deletes the temperature load assignments to the specified solid objects for the
specified load pattern.


The function returns zero if the load assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteSolidObjectTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object temperature load
ret = SapModel.SolidObj.SetLoadTemperature("All", "DEAD", 50, , , Group)

'delete solid object temperature load
ret = SapModel.SolidObj.DeleteLoadTemperature("1", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTemperature

SetLoadTemperature


# DeleteSpring

## Syntax

SapObject.SapModel.SolidObj.DeleteSpring

## VB6 Procedure

Function DeleteSpring(ByVal Name As String, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the spring assignments are deleted for the solid object specified by the Name
item.

If this item is Group, the spring assignments are deleted for all solid objects in the group specified
by the Name item.

If this item is SelectedObjects, the spring assignments are deleted for all selected solid objects,
and the Name item is ignored.

## Remarks

This function deletes all spring assignments for the specified solid objects.

The function returns zero if the assignments are successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteSolidObjectSprings()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim Vec() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign springs to solid objects
ReDim Vec(2)
ret = SapModel.SolidObj.SetSpring("1", 1, 1, 1, "", 1, 1, 3, True, Vec, 0, False, "Local")
ret = SapModel.SolidObj.SetSpring("5", 1, 1, 1, "", 1, 1, 3, True, Vec, 0, False, "Local")

'delete springs
ret = SapModel.SolidObj.DeleteSpring("1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

SetSpring

# GetAutoMesh

## Syntax

SapObject.SapModel.SolidObj.GetAutoMesh

## VB6 Procedure


Function GetAutoMesh(ByVal Name As String, ByRef MeshType As Long, ByRef n1 As Long,
ByRef n2 As Long, ByRef MaxSize1 As Double, ByRef MaxSize2 As Double, ByRef
RestraintsOnEdge As Boolean, ByRef RestraintsOnFace As Boolean) As Long

## Parameters

Name

The name of an existing solid object.

MeshType

This item is 0, 1 or 2, indicating the automatic mesh type for the solid object.

```
0 = No automatic meshing
1 = Mesh solid into a specified number of objects
2 = Mesh solid into objects of a specified maximum size
```
n1

This item applies when MeshType = 1. It is the number of objects created along the edge of the
meshed solid object that runs from point 1 to point 2.

n2

This item applies when MeshType = 1. It is the number of objects created along the edge of the
meshed solid object that runs from point 1 to point 3.

n3

This item applies when MeshType = 1. It is the number of objects created along the edge of the
meshed solid object that runs from point 1 to point 5.

MaxSize1

This item applies when MeshType = 2. It is the maximum size of objects created along the edge of
the meshed solid object that runs from point 1 to point 2. [L]

If this item is input as 0, the default value is used. The default value is 48 inches if the database
units are English or 120 centimeters if the database units are metric.

MaxSize2

This item applies when MeshType = 2. It is the maximum size of objects created along the edge of
the meshed solid object that runs from point 1 to point 3. [L]

If this item is input as 0, the default value is used. The default value is 48 inches if the database
units are English or 120 centimeters if the database units are metric.

MaxSize3

This item applies when MeshType = 2. It is the maximum size of objects created along the edge of
the meshed solid object that runs from point 1 to point 5. [L]


If this item is input as 0, the default value is used. The default value is 48 inches if the database
units are English or 120 centimeters if the database units are metric.

RestraintsOnEdge

If this item is True, and if both points along an edge of the original solid object have the same
restraint/constraint, then, if the an added point on that edge and the original corner points have the
same local axes definition, the program assigns the restraint/constraint to the added point.

RestraintsOnFace

If this item is True, and if all corner points on an solid object face have the same
restraint/constraint, then, if an added point on that face and the original corner points for the face
have the same local axes definition, the program assigns the restraint/constraint to the added point.

## Remarks

This function retrieves the automatic meshing assignments to solid objects.

The function returns zero if the meshing assignments are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetSolidObjAutoMesh()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MeshType As Long
Dim n1 As Long
Dim n2 As Long
Dim n3 As Long
Dim MaxSize1 As Double
Dim MaxSize2 As Double
Dim MaxSize3 As Double
Dim RestraintsOnEdge As Boolean
Dim RestraintsOnFace As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign auto mesh options
ret = SapModel.SolidObj.SetAutoMesh("ALL", 1, 3, 3,3, , , , , , Group)

'get auto mesh options for solid object
ret = SapModel.SolidObj.GetAutoMesh("1", MeshType, n1, n2, n3, MaxSize1, MaxSize2,
MaxSize3, RestraintsOnEdge, RestraintsOnFace)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetAutoMesh

# GetEdgeConstraint

## Syntax

SapObject.SapModel.SolidObj.GetEdgeConstraint

## VB6 Procedure

Function GetEdgeConstraint(ByVal Name As String, ByRef ConstraintExists As Boolean) As
Long

## Parameters

Name

The name of an existing solid object.

ConstraintExists

This item is True if an automatic edge constraint is generated by the program for the solid object
in the analysis model.

## Remarks

This function retrieves the generated edge constraint assignments to solid objects.


The function returns zero if the assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSolidObjEdgeConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ConstraintExists As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign auto edge constraint option
ret = SapModel.SolidObj.SetEdgeConstraint("ALL", True, Group)

'get auto edge constraint option
ret = SapModel.SolidObj.GetEdgeConstraint("1", ConstraintExists)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetEdgeConstraint

# GetElm


## Syntax

SapObject.SapModel.SolidObj.GetElm

## VB6 Procedure

Function GetElm(ByVal Name As String, ByRef nelm As Long, ByRef Elm() as String) As Long

## Parameters

Name

The name of an existing solid object.

nelm

The number of solid elements created from the specified solid object.

Elm

An array that includes the name of a solid element created from the specified solid object.

## Remarks

This function retrieves the names of the solid elements (analysis model solid) associated with a
specified solid object in the object-based model.

This function returns zero if the solid element information is successfully returned; otherwise it
returns nonzero. An error occurs if the analysis model does not exist.

## VBA Example

Sub GetSolidElementInfoForSolidObject()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim nelm As Long
Dim Elm() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'create the analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get solid element information
ret = SapModel.SolidObj.GetElm("1", nelm, Elm)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetGroupAssign

## Syntax

SapObject.SapModel.SolidObj.GetGroupAssign

## VB6 Procedure

Function GetGroupAssign(ByVal Name As String, ByRef NumberGroups As Long, ByRef
Groups() As String) As Long

## Parameters

Name

The name of an existing solid object.

NumberGroups

The number of group names retrieved.

Groups

The names of the groups to which the solid object is assigned.


## Remarks

This function retrieves the names of the groups to which a specified solid object is assigned.

The function returns zero if the group assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetSolidObjectGroups()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberGroups As Long
Dim Groups() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'define new groups
ret = SapModel.GroupDef.SetGroup("Group1")
ret = SapModel.GroupDef.SetGroup("Group2")

'add solid object to groups
ret = SapModel.SolidObj.SetGroupAssign("2", "Group1")
ret = SapModel.SolidObj.SetGroupAssign("2", "Group2")

'get solid object groups
ret = SapModel.SolidObj.GetGroupAssign("2", NumberGroups, Groups)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 20.0.0.

## See Also

SetGroupAssign

# GetGUID

## Syntax

SapObject.SapModel.SolidObj.GetGUID

## VB6 Procedure

Function GetGUID(ByVal name As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing solid object.

GUID

The GUID (Global Unique ID) for the specified solid object.

## Remarks

This function retrieves the GUID for the specified solid object.

This function returns zero if the solid object GUID is successfully retrieved; otherwise it returns
nonzero.

## VBA Example

Sub GetSolidObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'set program created GUID
ret = SapObject.SapModel.SolidObj.SetGUID("1")

'get GUID
ret = SapObject.SapModel.SolidObj.GetGUID("1", GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetGUID

# GetLoadGravity

## Syntax

SapObject.SapModel.SolidObj.GetLoadGravity

## VB6 Procedure

Function GetLoadGravity(ByVal Name As String, ByRef NumberItems As Long, ByRef
SolidName() As String, ByRef LoadPat() As String, ByRef CSys() As String, ByRef x() As
Double, ByRef y() As Double, ByRef z() As Double, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.


NumberItems

The total number of gravity loads retrieved for the specified solid objects.

SolidName

This is an array that includes the name of the solid object associated with each gravity load.

LoadPat

This is an array that includes the name of the coordinate system in which the gravity load
multipliers are specified.

CSys

This is an array that includes the name of the coordinate system associated with each gravity load.

x, y, z

These are arrays of gravity load multipliers in the x, y and z directions of the specified coordinate
system.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the solid object specified by the Name
item.

If this item is Group, the assignments are retrieved for all solid objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected solid objects, and the
Name item is ignored.

## Remarks

This function retrieves the gravity load assignments to solid objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSolidObjectGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim NumberItems As Long
Dim SolidName() As String
Dim LoadPat() As String
Dim CSys() As String
Dim x() As Double
Dim y() As Double
Dim z() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object gravity loads
ret = SapModel.SolidObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'get solid object gravity load
ret = SapModel.SolidObj.GetLoadGravity("1", NumberItems, SolidName, LoadPat, CSys, x,
y, z)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadGravity

DeleteLoadGravity


# GetLoadPorePressure

## Syntax

SapObject.SapModel.SolidObj.GetLoadPorePressure

## VB6 Procedure

Function GetLoadPorePressure(ByVal Name As String, ByRef NumberItems As Long, ByRef
SolidName() As String, ByRef LoadPat() As String, ByRef Value() As Double, ByRef
PatternName() As String, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

NumberItems

The total number of pore pressure loads retrieved for the specified solid objects.

SolidName

This is an array that includes the name of the solid object associated with each pore pressure load.

LoadPat

This is an array that includes the name of the load pattern associated with each pore pressure load.

Value

This is an array that includes the pore pressure load value. [F/L^2 ]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the pore pressure load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the solid object specified by the Name
item.

If this item is Group, the assignments are retrieved for all solid objects in the group specified by
the Name item.


If this item is SelectedObjects, assignments are retrieved for all selected solid objects, and the
Name item is ignored.

## Remarks

This function retrieves the pore pressure load assignments to solid objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSolidObjectPorePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim SolidName() As String
Dim LoadPat() As String
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object pore pressure load
ret = SapModel.SolidObj.SetLoadPorePressure("ALL", "DEAD", .1, , , Group)

'get solid object pore pressure load
ret = SapModel.SolidObj.GetLoadPorePressure("ALL", NumberItems, SolidName, LoadPat,
Value, PatternName, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadPorePressure

DeleteLoadPorePressure

# GetLoadStrain

## Syntax

SapObject.SapModel.SolidObj.GetLoadStrain

## VB6 Procedure

Function GetLoadStrain(ByVal Name As String, ByRef NumberItems As Long, ByRef
SolidName() As String, ByRef LoadPat() As String, ByRef Component() As Long, ByRef Value()
As Double, ByRef PatternName() As String, Optional ByVal ItemType As eItemType = Object)
As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

NumberItems

The total number of strain loads retrieved for the specified solid objects.

SolidName

This is an array that includes the name of the solid object associated with each strain load.

LoadPat

This is an array that includes the name of the load pattern associated with each strain load.

Component

This is 1, 2, 3, 4, 5 or 6, indicating the component to which the strain load is applied.

```
1 = Strain11
2 = Strain22
```

```
3 = Strain33
4 = Strain12
5 = Strain13
6 = Strain23
```
Value

This is an array that includes the strain value. [L/L]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the strain load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the solid object specified by the Name
item.

If this item is Group, the assignments are retrieved for all solid objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected solid objects, and the
Name item is ignored.

## Remarks

This function retrieves the strain load assignments to solid objects.

The function returns zero if the strain load assignments are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetSolidObjectStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim SolidName() As String
Dim LoadPat() As String
Dim Component() As Long
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object strain load
ret = SapModel.SolidObj.SetLoadStrain("ALL", "DEAD", 1, 0.001, , , Group)

'get solid object strain load
ret = SapModel.SolidObj.GetLoadStrain("1", NumberItems, SolidName, LoadPat,
Component, Value, PatternName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadStrain

DeleteLoadStrain

# GetLoadSurfacePressure

## Syntax

SapObject.SapModel.SolidObj.GetLoadSurfacePressure

## VB6 Procedure


Function GetLoadSurfacePressure(ByVal Name As String, ByRef NumberItems As Long, ByRef
SolidName() As String, ByRef LoadPat() As String, ByRef Face() As Long, ByRef Value() As
Double, ByRef PatternName() As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

NumberItems

The total number of surface pressure loads retrieved for the specified solid objects.

SolidName

This is an array that includes the name of the solid object associated with each surface pressure
load.

LoadPat

This is an array that includes the name of the load pattern associated with each surface pressure
load.

Face

This is an array that includes 1, 2, 3, 4, 5 or 6, indicating the solid object face to which the
specified load assignment applies.

Value

This is an array that includes the surface pressure load value. [F/L^2 ]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the surface pressure
load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the solid object specified by the Name
item.

If this item is Group, the assignments are retrieved for all solid objects in the group specified by
the Name item.


If this item is SelectedObjects, assignments are retrieved for all selected solid objects, and the
Name item is ignored.

## Remarks

This function retrieves the surface pressure load assignments to solid objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSolidObjectSurfacePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim SolidName() As String
Dim LoadPat() As String
Dim Face() As Long
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object surface pressure load
ret = SapModel.SolidObj.SetLoadSurfacePressure("ALL", "DEAD", 1, .1, , , Group)

'get solid object surface pressure load
ret = SapModel.SolidObj.GetLoadSurfacePressure("ALL", NumberItems, SolidName,
LoadPat, Face, Value, PatternName, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadSurfacePressure

DeleteLoadSurfacePressure

# GetLoadTemperature

## Syntax

SapObject.SapModel.SolidObj.GetLoadTemperature

## VB6 Procedure

Function GetLoadTemperature(ByVal Name As String, ByRef NumberItems As Long, ByRef
SolidName() As String, ByRef LoadPat() As String, ByRef Value() As Double, ByRef
PatternName() As String, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

NumberItems

The total number of temperature loads retrieved for the specified solid objects.

SolidName

This is an array that includes the name of the solid object associated with each temperature load.

LoadPat

This is an array that includes the name of the load pattern associated with each temperature load.

Value

This is an array that includes the temperature load value. [T]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the temperature load.


ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the solid object specified by the Name
item.

If this item is Group, the assignments are retrieved for all solid objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected solid objects, and the
Name item is ignored.

## Remarks

This function retrieves the temperature load assignments to solid objects.

The function returns zero if the load assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSolidObjectTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim SolidName() As String
Dim LoadPat() As String
Dim Value() As Double
Dim PatternName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)


'assign solid object temperature load
ret = SapModel.SolidObj.SetLoadTemperature("All", "DEAD", 50, , , Group)

'get solid object temperature load
ret = SapModel.SolidObj.GetLoadTemperature("ALL", NumberItems, SolidName, LoadPat,
Value, PatternName, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadTemperature

DeleteLoadTemperature

# GetLocalAxes

## Syntax

SapObject.SapModel.SolidObj.GetLocalAxes

## VB6 Procedure

Function GetLocalAxes(ByVal Name As String, ByRef a As Double, ByRef b As Double, ByRef
c As Double, ByRef Advanced As Boolean) As Long

## Parameters

Name

The name of an existing solid object.

a, b, c

The local axes of the solid object are defined by first setting the positive local 1, 2 and 3 axes the
same as the positive global X, Y and Z axes and then doing the following: [deg]


1. Rotate about the 3 axis by angle a.
2. Rotate about the resulting 2 axis by angle b.
3. Rotate about the resulting 1 axis by angle c.

Advanced

This item is True if the solid object local axes orientation was obtained using advanced local axes
parameters.

## Remarks

This function retrieves the local axes angles for a solid object.

The function returns zero if the local axes angles are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSolidLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim a As Double, b As Double, c As Double
Dim Advanced As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign local axes angles
ret = SapModel.SolidObj.SetLocalAxes("ALL", 30, 40, 50, Group)

'get local axes assignments
ret = SapModel.SolidObj.GetLocalAxes("1", a, b, c, Advanced)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

SetLocalAxes

# GetLocalAxesAdvanced

## Syntax

SapObject.SapModel.SolidObj.GetLocalAxesAdvanced

## VB6 Procedure

Function GetLocalAxesAdvanced(ByVal Name As String, ByRef Active As Boolean, ByRef
AxVectOpt As Long, ByRef AxCSys As String, ByRef AxDir() As Long, ByRef AxPt() As
String, ByRef AxVect() As Double, ByRef Plane2 As Long, ByRef PlVectOpt As Long, ByRef
PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double)
As Long

## Parameters

Name

The name of an existing solid object.

Active

This is True if advanced local axes exist.

AxVectOpt, PlVectOpt

This is 1, 2 or 3, indicating the axis/plane reference vector option. This item applies only when the
Active item is True.

```
1 = Coordinate direction
2 = Two joints
3 = User vector
```
AxCSys, PlCSys

The coordinate system used to define the axis/plane reference vector coordinate directions and the
axis/plane user vector. This item applies when the Active item is True and the
AxVectOpt/PlVectOpt item is 1 or 3.

AxDir, PlDir


This is an array dimensioned to 1 (2 integers) indicating the axis/plane reference vector primary
and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center
in the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1. Possible coordinate
direction values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
AxPt, PlPt

This is an array dimensioned to 1 (2 strings), indicating the labels of two joints that define the
axis/plane reference vector. Either of these joints may be specified as None to indicate the center
of the specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt
item is 2.

AxVect, PlVect

This is an array dimensioned to 2 (3 doubles) that defines the axis/plane reference vector. This
item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 3.

Plane2

This is 12, 13, 21, 23, 31 or 32, indicating that the local plane determined by the plane reference
vector is the 1-2, 1-3, 2-1, 2-3, 3-1, 0r 3-2 plane. This item applies only when the Active item is
True.

## Remarks

This function assigns advanced local axes to solid objects.

The function returns zero if the advanced local axes assignments are assigned successfully;
otherwise it returns a nonzero value.

## VBA Example

Sub GetSolidAdvancedLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyAxDir(1) As Long
Dim MyAxPt(1) As String
Dim MyAxVect(2) As Double


Dim MyPlDir(1) As Long
Dim MyPlPt(1) As String
Dim MyPlVect(2) As Double
Dim a As Double, b As Double, c As Double
Dim Advanced As Boolean
Dim Active As Boolean
Dim AxVectOpt As Long
Dim AxCSys As String
Dim AxDir() As Long
Dim AxPt() As String
Dim AxVect() As Double
Dim Plane2 As Long
Dim PlVectOpt As Long
Dim PlCSys As String
Dim PlDir() As Long
Dim PlPt() As String
Dim PlVect() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid advanced local axes
MyAxVect(0)=0.707
MyAxVect(1)=0.707
MyAxVect(2)=0
MyPlDir(0) = 2
MyPlDir(1) = 3
ret = SapModel.SolidObj.SetLocalAxesAdvanced("ALL", True, 3, "Global", MyAxDir,
MyAxPt, MyAxVect, 12, 1, "Global", MyPlDir, MyPlPt, MyPlVect, Group)

'get local axes assignments
ret = SapModel.SolidObj.GetLocalAxes("1", a, b, c, Advanced)

'get solid advanced local axes data
If Advanced Then
ret = SapModel.SolidObj.GetLocalAxesAdvanced("3", Active, AxVectOpt, AxCSys,
AxDir, AxPt, AxVect, Plane2, PlVectOpt, PlCSys, PlDir, PlPt, PlVect)
End If

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also

SetLocalAxesAdvanced

SetLocalAxes

# GetMatTemp

## Syntax

SapObject.SapModel.SolidObj.GetMatTemp

## VB6 Procedure

Function GetMatTemp(ByVal Name As String, ByRef Temp As Double, ByRef PatternName As
String) As Long

## Parameters

Name

The name of an existing solid object.

Temp

This is the material temperature value assigned to the solid object. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
solid object is uniform over the object at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the solid object
may vary. The material temperature at each corner point of the solid object is equal to the
specified temperature multiplied by the pattern value at the associated point object. The material
temperature at other points in the solid object is calculated by interpolation from the corner points.

## Remarks

This function retrieves the material temperature assignments to solid objects.


The function returns zero if the material temperature assignments are successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetSolidObjectMatTemp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Temp As Double
Dim PatternName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign material temperature
ret = SapModel.SolidObj.SetMatTemp("ALL", 50, , Group)

'get material temperature
ret = SapModel.SolidObj.GetMatTemp("3", Temp, PatternName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetMatTemp


# GetNameList

## Syntax

SapObject.SapModel.SolidObj.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of solid object names retrieved by the program.

MyName

This is a one-dimensional array of solid object names. The MyName array is created as a dynamic,
zero-based, array by the APIuser:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames  1) inside the SAP2000 program, filled with the
names, and returned to the APIuser.

## Remarks

This function retrieves the names of all defined solid objects.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetSolidObjectNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'get solid object names
ret = SapModel.SolidObj.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetPoints

## Syntax

SapObject.SapModel.SolidObj.GetPoints

## VB6 Procedure

Function GetPoints(ByVal Name As String, ByRef Point() As String) As Long

## Parameters

Name

The name of a defined solid object.

Point

This is an array containing the names of the corner point objects of the solid object.

## Remarks

This function retrieves the names of the corner point objects of a solid object.


The function returns zero if the point object names are successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetSolidObjPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberPoints As Long
Dim Point() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'get names of points
ReDim Point(7)
ret = SapModel.SolidObj.GetPoints("1", Point)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetProperty

## Syntax

SapObject.SapModel.SolidObj.GetProperty


## VB6 Procedure

Function GetProperty(ByVal Name As String, ByRef PropName As String) As Long

## Parameters

Name

The name of a defined solid object.

PropName

The name of the solid property assigned to the solid object.

## Remarks

This function retrieves the solid property assigned to a solid object.

The function returns zero if the property is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetSolidObjectProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'get solid property
ret = SapModel.SolidObj.GetProperty("1", PropName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetProperty

# GetSelected

## Syntax

Sap2000.SolidObj.GetSelected

## VB6 Procedure

Function GetSelected(ByVal Name As String, ByRef Selected As Boolean) As Long

## Parameters

Name

The name of an existing solid object.

Selected

This item is True if the specified solid object is selected; otherwise it is False.

## Remarks

This function retrieves the selected status for a solid object.

The function returns zero if the selected status is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSolidObjectSelectedStatus()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Selected As Boolean


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'set all solid objects selected
ret = SapModel.SolidObj.SetSelected("ALL", True, Group)

'get solid object selected status
ret = SapModel.SolidObj.GetSelected("1", Selected)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSelected

# GetSpring

## Syntax

SapObject.SapModel.SolidObj.GetSpring

## VB6 Procedure

Function GetSpring(ByVal Name As String, ByRef NumberSprings As Long, ByRef MyType()
As Long, ByRef s() As Double, ByRef SimpleSpringType() As Long, ByRef LinkProp() As
String, ByRef Face() As Long, ByRef SpringLocalOneType() As Long, ByRef Dir() As Long,
ByRef Outward() As Boolean, ByRef VecX() As Double, ByRef VecY() As Double, ByRef VecZ
() As Double, ByRef CSys() As String, ByRef Ang() As Double) As Long


## Parameters

Name

The name of an existing solid object.

NumberSprings

The number of springs assignments made to the specified solid object.

MyType

Each value in this array is either 1 or 2, indicating the spring property type.

```
1 = Simple spring
2 = Link property
```
s

Each value in this array is the simple spring stiffness per unit area of the specified solid object
face. This item applies only when the corresponding MyType = 1. [F/L^3 ]

SimpleSpringType

Each value in this array is 1, 2 or 3, indicating the simple spring type. This item applies only when
the corresponding MyType = 1.

```
1 = Spring resists tension and compression
2 = Spring resists compression only
3 = Spring resists tension only
```
LinkProp

Each value in this array is the name of the link property assigned to the spring. This item applies
only when the corresponding MyType = 2.

Face

This is 1, 2, 3, 4, 5 or 6, indicating the solid object face to which the specified spring assignment
applies.

SpringLocalOneType

Each value in this array is 1, 2 or 3, indicating the method used to specify the spring positive local
1-axis orientation.

```
1 = Parallel to solid object local axis
2 = Normal to specified solid object face
3 = User specified direction vector
```
Dir

Each value in this array is 1, 2, 3, -1, -2 or -3, indicating the solid object local axis that
corresponds to the positive local 1-axis of the spring. This item applies only when the
corresponding SpringLocalOneType = 1.


Outward

Each value in this array is True if the spring positive local 1 axis is outward from the specified
solid object face. This item applies only when SpringLocalOneType = 2.

VecX

Each value in this array is the X-axis or solid object local 1-axis component (depending on the
CSys specified) of the user specified direction vector for the spring local 1-axis. The direction
vector is in the coordinate system specified by the CSys item. This item applies only when the
corresponding SpringLocalOneType = 3.

VecY

Each value in this array is the Y-axis or solid object local 2-axis component (depending on the
CSys specified) of the user specified direction vector for the spring local 1-axis. The direction
vector is in the coordinate system specified by the CSys item. This item applies only when the
corresponding SpringLocalOneType = 3.

VecZ

Each value in this array is the X-axis or solid object local 3-axis component (depending on the
CSys specified) of the user specified direction vector for the spring local 1-axis. The direction
vector is in the coordinate system specified by the CSys item. This item applies only when the
corresponding SpringLocalOneType = 3.

CSys

Each value in this array is Local (meaning the solid object local coordinate system) or the name of
a defined coordinate system. This item is the coordinate system in which the user specified
direction vector, Vec, is specified. This item applies only when the corresponding
SpringLocalOneType = 3.

Ang

Each value in this array is the angle that the link local 2-axis is rotated from its default orientation.
This item applies only when the corresponding MyType = 2. [deg]

## Remarks

This function retrieves the spring assignments to a solid object face.

The function returns zero if the assignments are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSolidObjectSprings()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Vec() As Double


Dim NumberSprings As Long
Dim MyType() As Long
Dim s() As Double
Dim SimpleSpringType() As Long
Dim LinkProp() As String
Dim Face() As Long
Dim SpringLocalOneType() As Long
Dim Dir() As Long
Dim Outward() As Boolean
Dim VecX() As Double
Dim VecY() As Double
Dim VecZ() As Double
Dim CSys() As String
Dim Ang() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign springs to solid objects
ReDim Vec(2)
ret = SapModel.SolidObj.SetSpring("1", 1, 1, 1, "", 1, 1, 3, True, Vec, 0, False, "Local")

'get spring assignments to solid objects
ret = SapModel.SolidObj.GetSpring("1", NumberSprings, MyType, s, SimpleSpringType,
LinkProp, Face, SpringLocalOneType, Dir, Outward, VecX, VecY, VecZ, CSys, Ang)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSpring


DeleteSpring

# GetTransformationMatrix

## Syntax

Sap2000.SolidObj.GetTransformationMatrix

## VB6 Procedure

Function GetTransformationMatrix(ByVal Name As String, ByRef Value() As Double,Optional
ByVal IsGlobal As Boolean = True) As Long

## Parameters

Name

The name of an existing solid object.

Value

Value is an array of nine direction cosines that define the transformation matrix.

The following matrix equation shows how the transformation matrix is used to convert items from
the solid object local coordinate system to the global coordinate system.

In the equation, c0 through c8 are the nine values from the transformation array, (Local1, Local2,
Local3) are an item (such as a load) in the object local coordinate system, and (GlobalX, GlobalY,
GlobalZ) are the same item in the global coordinate system.

The transformation from the local coordinate system to the present coordinate system is the same
as that shown above for the global system if you substitute the present system for the global
system.

IsGlobal

If this item is True, the transformation matrix is between the Global coordinate system and the
solid object local coordinate system.

If this item is False, the transformation matrix is between the present coordinate system and the
solid object local coordinate system.


## Remarks

The function returns zero if the solid object transformation matrix is successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetSolidObjectMatrix()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'get solid object transformation matrix
ReDim Value(8)
ret = SapModel.SolidObj.GetTransformationMatrix("3", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

# SetAutoMesh

## Syntax

SapObject.SapModel.SolidObj.SetAutoMesh

## VB6 Procedure

Function SetAutoMesh(ByVal Name As String, ByVal MeshType As Long, Optional ByVal n1
As Long = 2, Optional ByVal n2 As Long = 2, Optional ByVal n3 As Long = 2, Optional ByVal
MaxSize1 As Double = 0, Optional ByVal MaxSize2 As Double = 0, Optional ByVal MaxSize3
As Double = 0, Optional ByVal RestraintsOnEdge As Boolean = False, Optional ByVal
RestraintsOnFace As Boolean = False) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

MeshType

This item is 0, 1 or 2, indicating the automatic mesh type for the solid object.

```
0 = No automatic meshing
1 = Mesh solid into a specified number of objects
2 = Mesh solid into objects of a specified maximum size
```
n1

This item applies when MeshType = 1. It is the number of objects created along the edge of the
meshed solid object that runs from point 1 to point 2.

n2

This item applies when MeshType = 1. It is the number of objects created along the edge of the
meshed solid object that runs from point 1 to point 3.

n3

This item applies when MeshType = 1. It is the number of objects created along the edge of the
meshed solid object that runs from point 1 to point 5.

MaxSize1

This item applies when MeshType = 2. It is the maximum size of objects created along the edge of
the meshed solid object that runs from point 1 to point 2. [L]


If this item is input as 0, the default value is used. The default value is 48 inches if the database
units are English or 120 centimeters if the database units are metric.

MaxSize2

This item applies when MeshType = 2. It is the maximum size of objects created along the edge of
the meshed solid object that runs from point 1 to point 3. [L]

If this item is input as 0, the default value is used. The default value is 48 inches if the database
units are English or 120 centimeters if the database units are metric.

MaxSize3

This item applies when MeshType = 2. It is the maximum size of objects created along the edge of
the meshed solid object that runs from point 1 to point 5. [L]

If this item is input as 0, the default value is used. The default value is 48 inches if the database
units are English or 120 centimeters if the database units are metric.

RestraintsOnEdge

If this item is True, and if both points along an edge of the original solid object have the same
restraint/constraint, then, if the an added point on that edge and the original corner points have the
same local axes definition, the program assigns the restraint/constraint to the added point.

RestraintsOnFace

If this item is True, and if all corner points on an solid object face have the same
restraint/constraint, then, if an added point on that face and the original corner points for the face
have the same local axes definition, the program assigns the restraint/constraint to the added point.

## Remarks

This function makes automatic meshing assignments to solid objects.

The function returns zero if the meshing options are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSolidObjAutoMesh()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign auto mesh options
ret = SapModel.SolidObj.SetAutoMesh("ALL", 1, 3, 3,3, , , , , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetAutoMesh

# SetEdgeConstraint

## Syntax

SapObject.SapModel.SolidObj.SetEdgeConstraint

## VB6 Procedure

Function SetEdgeConstraint(ByVal Name As String, ByVal ConstraintExists As Boolean,
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

ConstraintExists

This item is True if an automatic edge constraint is generated by the program for the solid object
in the analysis model.

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the solid object specified by the Name item.

If this item is Group, the assignment is made to all solid objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected solid objects, and the Name item
is ignored.

## Remarks

This function makes generated edge constraint assignments to solid objects.

The function returns zero if the edge constraint option is successfully assigned; otherwise it
returns a nonzero value.

## VBA Example

Sub AssignSolidObjAutoEdgeConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign auto edge constraint option
ret = SapModel.SolidObj.SetEdgeConstraint("ALL", True, Group)
ret = SapModel.SolidObj.SetEdgeConstraint("1", False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetEdgeConstraint

# SetGroupAssign

## Syntax

SapObject.SapModel.SolidObj.SetGroupAssign

## VB6 Procedure

Function SetGroupAssign(ByVal Name As String, ByVal GroupName As String, Optional By Val
Remove As Boolean = False, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

GroupName

The name of an existing group to which the assignment is made.

Remove

If this item is False, the specified solid objects are added to the group specified by the GroupName
item. If it is True, the solid objects are removed from the group.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the solid object specified by the Name item is added or removed from the
group specified by the GroupName item.


If this item is Group, all solid objects in the group specified by the Name item are added or
removed from the group specified by the GroupName item.

If this item is SelectedObjects, all selected solid objects are added or removed from the group
specified by the GroupName item, and the Name item is ignored.

## Remarks

This function adds or removes solid objects from a specified group.

The function returns zero if the group assignment is successful; otherwise it returns a nonzero
value.

## VBA Example

Sub AddSolidObjectsToGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'add solid objects to group
ret = SapModel.SolidObj.SetGroupAssign("1", "Group1")
ret = SapModel.SolidObj.SetGroupAssign("2", "Group1")
ret = SapModel.SolidObj.SetGroupAssign("3", "Group1")

'select objects in group
ret = SapModel.SelectObj.Group("Group1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

```
GetGroupAssign
```
# SetGUID

## Syntax

SapObject.SapModel.SolidObj.SetGUID

## VB6 Procedure

Function SetGUID(ByVal Name As String, Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing solid object.

GUID

The GUID (Global Unique ID) for the specified solid object.

## Remarks

This function sets the GUID for the specified solid object. If the GUID is passed in as a blank
string, the program automatically creates a GUID for the object.

This function returns zero if the solid object GUID is successfully set; otherwise it returns
nonzero.

## VBA Example

Sub SetSolidObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim GUID As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'set program created GUID
ret = SapObject.SapModel.SolidObj.SetGUID("1")

'get GUID
ret = SapObject.SapModel.SolidObj.GetGUID("1", GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetGUID

# SetLoadGravity

## Syntax

SapObject.SapModel.SolidObj.SetLoadGravity

## VB6 Procedure

Function SetLoadGravity(ByVal Name As String, ByVal LoadPat As String, ByVal x As Double,
ByVal y As Double, ByVal z As Double, Optional ByVal Replace As Boolean = True, Optional
ByVal CSys As String = "Global", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters


Name

The name of an existing solid object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

x, y, z

These are the gravity load multipliers in the x, y and z directions of the specified coordinate
system.

Replace

If this item is True, all previous gravity loads, if any, assigned to the specified solid object(s), in
the specified load pattern, are deleted before making the new assignment.

CSys

The coordinate system in which the x, y and z multipliers are specified.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the solid object specified by the Name item.

If this item is Group, the assignment is made to all solid objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected solid objects, and the Name item
is ignored.

## Remarks

This function assigns gravity load multipliers to solid objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignSolidObjectGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object gravity loads
ret = SapModel.SolidObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

DeleteLoadGravity

# SetLoadPorePressure

## Syntax

SapObject.SapModel.SolidObj.SetLoadPorePressure

## VB6 Procedure

Function SetLoadPorePressure(ByVal Name As String, ByVal LoadPat As String, ByVal Value
As Double, Optional ByVal PatternName As String = "", Optional ByVal Replace As Boolean =
True, Optional ByVal ItemType As eItemType = Object) As Long


## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Value

This is the pore pressure value. [F/L^2 ]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the pore pressure load for the
solid object is uniform over the object at the value specified by Value.

If PatternName is the name of a defined joint pattern, the pore pressure load for the solid object is
based on the specified pore pressure value multiplied by the pattern value at the corner point
objects of the solid object.

Replace

If this item is True, all previous pore pressure loads, if any, assigned to the specified solid object
(s), in the specified load case, are deleted before making the new assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the solid object specified by the Name item.

If this item is Group, the assignment is made to all solid objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected solid objects, and the Name item
is ignored.

## Remarks

This function assigns pore pressure loads to solid objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.


## VBA Example

Sub AssignSolidObjectPorePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object pore pressure load
ret = SapModel.SolidObj.SetLoadPorePressure("ALL", "DEAD", .1, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadPorePressure

DeleteLoadPorePressure

# SetLoadStrain

## Syntax


SapObject.SapModel.SolidObj.SetLoadStrain

## VB6 Procedure

Function SetLoadStrain(ByVal Name As String, ByVal LoadPat As String, ByVal Component As
Long, ByVal Value As Double, Optional ByVal Replace As Boolean = True, Optional ByVal
PatternName As String = "", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Component

This is 1, 2, 3, 4, 5 or 6, indicating the component to which the strain load is applied.

```
1 = Strain11
2 = Strain22
3 = Strain33
4 = Strain12
5 = Strain13
6 = Strain23
```
Value

This is the strain load value. [L/L]

Replace

If this item is True, all previous strain loads, if any, assigned to the specified solid object(s), in the
specified load pattern, for the specified degree of freedom, are deleted before making the new
assignment.

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the strain load for the solid
object is uniform over the object at the value specified by Value.

If PatternName is the name of a defined joint pattern, the strain load for the solid object is based
on the specified strain value multiplied by the pattern value at the corner point objects of the solid
object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
```

```
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the solid object specified by the Name item.

If this item is Group, the assignment is made to all solid objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected solid objects, and the Name item
is ignored.

## Remarks

This function assigns strain loads to solid objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignSolidObjectStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object strain load
ret = SapModel.SolidObj.SetLoadStrain("ALL", "DEAD", 1, 0.001, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadStrain

DeleteLoadStrain

# SetLoadSurfacePressure

## Syntax

SapObject.SapModel.SolidObj.SetLoadSurfacePressure

## VB6 Procedure

Function SetLoadSurfacePressure(ByVal Name As String, ByVal LoadPat As String, ByVal Face
As Long, ByVal Value As Double, Optional ByVal PatternName As String = "", Optional ByVal
Replace As Boolean = True, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Face

This is 1, 2, 3, 4, 5 or 6, indicating the solid object face to which the specified load assignment
applies.

Value

This is the surface pressure value. [F/L^2 ]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the surface pressure load for the
solid object is uniform over the object at the value specified by Value.


If PatternName is the name of a defined joint pattern, the surface pressure load for the solid object
is based on the specified surface pressure value multiplied by the pattern value at the corner point
objects of the solid object.

Replace

If this item is True, all previous surface pressure loads, if any, assigned to the specified solid
object(s), on the specified face, in the specified load pattern, are deleted before making the new
assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the solid object specified by the Name item.

If this item is Group, the assignment is made to all solid objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected solid objects, and the Name item
is ignored.

## Remarks

This function assigns surface pressure loads to solid objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignSolidObjectSurfacePressureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object surface pressure load
ret = SapModel.SolidObj.SetLoadSurfacePressure("ALL", "DEAD", 1, .1, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadSurfacePressure

DeleteLoadSurfacePressure

# SetLoadTemperature

## Syntax

SapObject.SapModel.SolidObj.SetLoadTemperature

## VB6 Procedure

Function SetLoadTemperature(ByVal Name As String, ByVal LoadPat As String, ByVal Value
As Double, Optional ByVal PatternName As String = "", Optional ByVal Replace As Boolean =
True, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Value


This is the temperature change value. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the temperature load for the solid
object is uniform over the object at the value specified by Value.

If PatternName is the name of a defined joint pattern, the temperature load for the solid object is
based on the specified temperature value multiplied by the pattern value at the corner point objects
of the solid object.

Replace

If this item is True, all previous temperature loads, if any, assigned to the specified solid object(s),
in the specified load case, are deleted before making the new assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the solid object specified by the Name item.

If this item is Group, the assignment is made to all solid objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected solid objects, and the Name item
is ignored.

## Remarks

This function assigns temperature loads to solid objects.

The function returns zero if the loads are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignSolidObjectTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid object temperature load
ret = SapModel.SolidObj.SetLoadTemperature("All", "DEAD", 50, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTemperature

DeleteLoadTemperature

# SetLocalAxes

## Syntax

SapObject.SapModel.SolidObj.SetLocalAxes

## VB6 Procedure

Function SetLocalAxes(ByVal Name As String, ByVal a As Double, ByVal b As Double, ByVal
c As Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.


a, b, c

The local axes of the solid object are defined by first setting the positive local 1, 2 and 3 axes the
same as the positive global X, Y and Z axes and then doing the following: [deg]

1. Rotate about the 3 axis by angle a.
2. Rotate about the resulting 2 axis by angle b.
3. Rotate about the resulting 1 axis by angle c.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the local axes assignment is made to the solid object specified by the Name
item.

If this item is Group, the local axes assignment is made to all solid objects in the group specified
by the Name item.

If this item is SelectedObjects, the local axes assignment is made to all selected solid objects, and
the Name item is ignored.

## Remarks

This function sets the local axes angles for solid objects.

The function returns zero if the local axes angles are successfully set; otherwise it returns a
nonzero value.

## VBA Example

Sub SetSolidLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign local axes angles
ret = SapModel.SolidObj.SetLocalAxes("1", 30, 40, 50)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetLocalAxes

# SetLocalAxesAdvanced

## Syntax

SapObject.SapModel.SolidObj.SetLocalAxesAdvanced

## VB6 Procedure

Function SetLocalAxesAdvanced(ByVal Name As String, ByVal Active As Boolean, ByVal
AxVectOpt As Long, ByVal AxCSys As String, ByRef AxDir() As Long, ByRef AxPt() As
String, ByRef AxVect() As Double, ByVal Plane2 As Long, ByVal PlVectOpt As Long, ByVal
PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double,
Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

Active

This is True if advanced local axes exist.

AxVectOpt, PlVectOpt

This is 1, 2, or 3, indicating the axis/plane reference vector option. This item applies only when
the Active item is True.


```
1 = Coordinate direction
2 = Two joints
3 = User vector
```
AxCSys, PlCSys

The coordinate system used to define the axis/plane reference vector coordinate directions and the
axis/plane user vector. This item applies when the Active item is True and the
AxVectOpt/PlVectOpt item is 1 or 3.

AxDir, PlDir

This is an array dimensioned to 1 (2 integers) indicating the axis/plane reference vector primary
and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center
in the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1. Possible coordinate
direction values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
AxPt, PlPt

This is an array dimensioned to 1 (2 strings) indicating the labels of two joints that define the
axis/plane reference vector. Either of these joints may be specified as None to indicate the center
of the specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt
item is 2.

AxVect, PlVect

This is an array dimensioned to 2 (3 doubles) that defines the axis/plane reference vector. This
item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 3.

Plane2

This is 12, 13, 21, 23, 31 or 32, indicating that the local plane determined by the plane reference
vector is the 1-2, 1-3, 2-1, 2-3, 3-1, or 3-2 plane. This item applies only when the Active item is
True.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
Selection = 2
```

If this item is Object, the assignment is made to the solid object specified by the Name item.

If this item is Group, the assignment is made to all solid objects in the group specified by the
Name item.

If this item is Selection, assignment is made to all selected solid objects and the Name item is
ignored.

## Remarks

This function assigns advanced local axes to solid objects.

The function returns zero if the advanced local axes assignments are assigned successfully;
otherwise it returns a nonzero value.

## VBA Example

Sub AssignSolidAdvancedLocalAxes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyAxDir(1) As Long
Dim MyAxPt(1) As String
Dim MyAxVect(2) As Double
Dim MyPlDir(1) As Long
Dim MyPlPt(1) As String
Dim MyPlVect(2) As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign solid advanced local axes
MyAxVect(0)=0.707
MyAxVect(1)=0.707
MyAxVect(2)=0
MyPlDir(0) = 2
MyPlDir(1) = 3
ret = SapModel.SolidObj.SetLocalAxesAdvanced("ALL", True, 3, "Global", MyAxDir,
MyAxPt, MyAxVect, 12, 1, "Global", MyPlDir, MyPlPt, MyPlVect, Group)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also

GetLocalAxesAdvanced

GetLocalAxes

# SetMatTemp

## Syntax

SapObject.SapModel.SolidObj.SetMatTemp

## VB6 Procedure

Function SetMatTemp(ByVal Name As String, ByVal Temp As Double, Optional ByVal
PatternName As String = "", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

Temp

This is the material temperature value assigned to the solid object. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
solid object is uniform over the object at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the solid object
may vary. The material temperature at each corner point of the solid object is equal to the
specified temperature multiplied by the pattern value at the associated point object. The material
temperature at other points in the solid object is calculated by interpolation from the corner points.

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the solid object specified by the Name item.

If this item is Group, the assignment is made to all solid objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected solid objects, and the Name item
is ignored.

## Remarks

This function assigns material temperatures to solid objects.

The function returns zero if the material temperatures are successfully assigned; otherwise it
returns a nonzero value.

## VBA Example

Sub AssignSolidObjectMatTemp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign material temperature
ret = SapModel.SolidObj.SetMatTemp("ALL", 50, , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMatTemp

# SetProperty

## Syntax

SapObject.SapModel.SolidObj.SetProperty

## VB6 Procedure

Function SetProperty(ByVal name As String, ByVal PropName As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

PropName

This is the name of a solid property to be assigned to the specified solid object(s).

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the solid object specified by the Name item.

If this item is Group, the assignment is made to all solid objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected solid objects, and the Name item
is ignored.


## Remarks

This function assigns a solid property to solid objects.

The function returns zero if the property is successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub SetSolidObjectProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'set solid property
ret = SapModel.SolidObj.SetProperty("1", "Solid1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetProperty

# SetSelected


## Syntax

Sap2000.SolidObj.SetSelected

## VB6 Procedure

Function SetSelected(ByVal Name As String, ByVal Selected As Boolean, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

Selected

This item is True if the specified solid object is selected, otherwise it is False.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the selected status is set for the solid object specified by the Name item.

If this item is Group, the selected status is set for all solid objects in the group specified by the
Name item.

If this item is SelectedObjects, the selected status is set for all selected solid objects, and the Name
item is ignored.

## Remarks

This function sets the selected status for solid objects.

The function returns zero if the selected status is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetSolidObjectSelected()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'set solid objects selected
ret = SapModel.SolidObj.SetSelected("ALL", True, Group)

'update window
ret = SapModel.View.RefreshWindow

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSelected

# SetSpring

## Syntax

SapObject.SapModel.SolidObj.SetSpring

## VB6 Procedure

Function SetSpring(ByVal Name As String, ByVal MyType As Long, ByVal s As Double, ByVal
SimpleSpringType As Long, ByVal LinkProp As String, ByVal Face as Long, ByVal
SpringLocalOneType As Long, ByVal Dir As Long, ByVal Outward As Boolean, ByRef Vec()
As Double, ByVal Ang As Double, ByVal Replace As Boolean, Optional ByVal CSys As String =
"Local", Optional ByVal ItemType As eItemType = Object) As Long


## Parameters

Name

The name of an existing solid object or group, depending on the value of the ItemType item.

MyType

This is either 1 or 2, indicating the spring property type.

```
1 = Simple spring
2 = Link property
```
s

The simple spring stiffness per unit area of the specified solid object face. This item applies only
when MyType = 1. [F/L^3 ]

SimpleSpringType

This is 1, 2 or 3, indicating the simple spring type. This item applies only when MyType = 1.

```
1 = Spring resists tension and compression
2 = Spring resists compression only
3 = Spring resists tension only
```
LinkProp

The name of the link property assigned to the spring. This item applies only when MyType = 2.

Face

This is 1, 2, 3, 4, 5 or 6, indicating the solid object face to which the specified spring assignment
applies.

SpringLocalOneType

This is 1, 2 or 3, indicating the method used to specify the spring positive local 1-axis orientation.

```
1 = Parallel to solid object local axis
2 = Normal to specified solid object face
3 = User specified direction vector
```
Dir

This is 1, 2, 3, -1, -2 or -3, indicating the solid object local axis that corresponds to the positive
local 1-axis of the spring. This item applies only when SpringLocalOneType = 1.

Outward

This item is True if the spring positive local 1 axis is outward from the specified solid object face.
This item applies only when SpringLocalOneType = 2.

Vec


This is an array of three values that define the direction vector of the spring positive local 1-axis.
The direction vector is in the coordinate system specified by the CSys item. This item applies only
when SpringLocalOneType = 3.

Ang

This is the angle that the link local 2-axis is rotated from its default orientation. This item applies
only when MyType = 2. [deg]

Replace

If this item is True, all existing spring assignments to the solid object are removed before
assigning the specified spring. If it is False, the specified spring is added to any existing springs
already assigned to the solid object.

CSys

This is Local (meaning the solid object local coordinate system) or the name of a defined
coordinate system. This item is the coordinate system in which the user specified direction vector,
Vec, is specified. This item applies only when SpringLocalOneType = 3.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the solid object specified by the Name item.

If this item is Group, the assignment is made to all solid objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected solid objects, and the Name item
is ignored.

## Remarks

This function makes spring assignments to solid objects. The springs are assigned to a specified
solid object face.

The function returns zero if the assignments are successfully applied; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSolidObjectSprings()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim Vec() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)

'assign springs to solid objects
ReDim Vec(2)
ret = SapModel.SolidObj.SetSpring("1", 1, 1, 1, "", 1, 1, 3, True, Vec, 0, False, "Local")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSpring

DeleteSpring

# AddByCoord

## Syntax

SapObject.SapModel.TendonObj.AddByCoord

## VB6 Procedure

Function AddByCoord(ByVal xi As Double, ByVal yi As Double, ByVal zi As Double, ByVal xj
As Double, ByVal yj As Double, ByVal zj As Double, ByRef Name As String, Optional ByVal
PropName As String = "Default", Optional ByVal UserName As String = "", Optional ByVal
CSys As String = "Global") As Long


## Parameters

xi, yi, zi

The coordinates of the I-End of the added tendon object. The coordinates are in the coordinate
system defined by the CSys item.

xj, yj, zj

The coordinates of the J-End of the added tendon object. The coordinates are in the coordinate
system defined by the CSys item.

Name

This is the name that the program ultimately assigns for the tendon object. If no UserName is
specified, the program assigns a default name to the tendon object. If a UserName is specified and
that name is not used for another frame, cable or tendon object, the UserName is assigned to the
tendon object; otherwise a default name is assigned to the tendon object.

PropName

This is Default, None or the name of a defined tendon property.

If it is Default, the program assigns a default tendon property to the tendon object. If it is None, no
tendon property is assigned to the tendon object. If it is the name of a defined tendon property, that
property is assigned to the tendon object.

UserName

This is an optional user specified name for the tendon object. If a UserName is specified and that
name is already used for another tendon object, the program ignores the UserName.

CSys

The name of the coordinate system in which the tendon object end point coordinates are defined.

## Remarks

This function adds a new tendon object whose end points are at the specified coordinates.

The function returns zero if the tendon object is successfully added, otherwise it returns a nonzero
value.

## VBA Example

Sub AddTendonObjByCoord()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by coordinates
ret = SapModel.TendonObj.AddByCoord(-288, 0, 288, 288, 0, 288, Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByPoint

SetTendonData

# AddByPoint

## Syntax

SapObject.SapModel.TendonObj.AddByPoint

## VB6 Procedure

Function AddByPoint(ByVal Point1 as String, ByVal Point2 as String, ByRef Name As String,
Optional ByVal PropName As String = "Default", Optional ByVal UserName As String = "") As
Long

## Parameters


Point1

The name of a defined point object at the I-End of the added tendon object.

Point2

The name of a defined point object at the J-End of the added tendon object.

Name

This is the name that the program ultimately assigns for the tendon object. If no UserName is
specified, the program assigns a default name to the tendon object. If a UserName is specified and
that name is not used for another frame, cable or tendon object, the UserName is assigned to the
tendon object; otherwise a default name is assigned to the tendon object.

PropName

This is Default, None or the name of a defined tendon property.

If it is Default, the program assigns a default tendon property to the tendon object. If it is None, no
tendon property is assigned to the tendon object. If it is the name of a defined tendon property, that
property is assigned to the tendon object.

UserName

This is an optional user specified name for the tendon object. If a UserName is specified and that
name is already used for another tendon object, the program ignores the UserName.

## Remarks

This function adds a new tendon object whose end points are specified by name.

The function returns zero if the tendon object is successfully added, otherwise it returns a nonzero
value.

## VBA Example

Sub AddTendonObjByPoint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

SetTendonData

# ChangeName

## Syntax

SapObject.SapModel.TendonObj.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined tendon object.

NewName

The new name for the tendon object.

## Remarks


The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeTendonObjName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'change name
ret = SapModel.TendonObj.ChangeName(Name, "MyTendon")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Count

## Syntax


SapObject.SapModel.TendonObj.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns a count of the tendon objects in the model.

## VBA Example

Sub CountTendonObjects()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'return number of tendon objects
Count = SapModel.TendonObj.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.TendonObj.Delete

## VB6 Procedure

Function Delete(ByVal Name As String, Optional ByVal ItemType As eItemType = Object) As
Long

## Parameters

Name

The name of an existing tendon object or group depending on the value of the ItemType item.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the tendon object specified by the Name item is deleted.

If this item is Group, all of the tendon objects in the group specified by the Name item are deleted.

If this item is SelectedObjects, all selected tendon objects are deleted, and the Name item is
ignored.

## Remarks

The function deletes tendon objects.

The function returns zero if the tendon objects are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example


Sub DeleteTendonObj()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon objects by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name1)
ret = SapModel.TendonObj.AddByPoint("2", "8", Name2)

'update view
ret = SapModel.View.RefreshView(0, False)

'delete tendon object
ret = SapModel.TendonObj.Delete(Name1)

'update view
ret = SapModel.View.RefreshView(0, True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

AddByPoint


# DeleteLoadDeformation

## Syntax

SapObject.SapModel.TendonObj.DeleteLoadDeformation

## VB6 Procedure

Function DeleteLoadDeformation(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the tendon object specified by the Name
item.

If this item is Group, the load assignments are deleted for all tendon objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected tendon objects and
the Name item is ignored.

## Remarks

This function deletes the deformation load assignments to the specified tendon objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example


Sub DeleteTendonDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon deformation loads
ret = SapModel.TendonObj.SetLoadDeformation("ALL", "DEAD", 2, Group)

'delete tendon deformation load
ret = SapModel.TendonObj.DeleteLoadDeformation(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDeformation

SetLoadDeformation


# DeleteLoadForceStress

## Syntax

SapObject.SapModel.TendonObj.DeleteLoadForceStress

## VB6 Procedure

Function DeleteLoadForceStress(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the tendon object specified by the Name
item.

If this item is Group, the load assignments are deleted for all tendon objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected tendon objects,
and the Name item is ignored.

## Remarks

This function deletes the tendon force/stress load assignments to the specified tendon objects for
the specified load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example


Sub DeleteTendonForceLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon force load
ret = SapModel.TendonObj.SetLoadForceStress("ALL", "DEAD", 1, 0, 100, 0.15, 8.333E-05,
0.25, 3, 5, 7, 5, , Group)

'delete tendon force load
ret = SapModel.TendonObj.DeleteLoadForceStress(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadForceStress

SetLoadForceStress


# DeleteLoadGravity

## Syntax

SapObject.SapModel.TendonObj.DeleteLoadGravity

## VB6 Procedure

Function DeleteLoadGravity(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the tendon object specified by the Name
item.

If this item is Group, the load assignments are deleted for all tendon objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected tendon objects,
and the Name item is ignored.

## Remarks

This function deletes the gravity load assignments to the specified tendon objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example


Sub DeleteTendonGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon gravity loads
ret = SapModel.TendonObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'delete tendon gravity load
ret = SapModel.TendonObj.DeleteLoadGravity(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadGravity

SetLoadGravity


# DeleteLoadStrain

## Syntax

SapObject.SapModel.TendonObj.DeleteLoadStrain

## VB6 Procedure

Function DeleteLoadStrain(ByVal Name As String, ByVal LoadPat As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the tendon object specified by the Name
item.

If this item is Group, the load assignments are deleted for all tendon objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected tendon objects,
and the Name item is ignored.

## Remarks

This function deletes the strain load assignments to the specified tendon objects for the specified
load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example


Sub DeleteTendonStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon strain load
ret = SapModel.TendonObj.SetLoadStrain(Name, "DEAD", 0.001)

'delete tendon strain load
ret = SapModel.TendonObj.DeleteLoadStrain(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadStrain

SetLoadStrain


# DeleteLoadTemperature

## Syntax

SapObject.SapModel.TendonObj.DeleteLoadTemperature

## VB6 Procedure

Function DeleteLoadTemperature(ByVal Name As String, ByVal LoadPat As String, Optional
ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the load assignments are deleted for the tendon object specified by the Name
item.

If this item is Group, the load assignments are deleted for all tendon objects in the group specified
by the Name item.

If this item is SelectedObjects, the load assignments are deleted for all selected tendon objects,
and the Name item is ignored.

## Remarks

This function deletes the temperature load assignments to the specified tendon objects for the
specified load pattern.

The function returns zero if the load assignments are successfully deleted, otherwise it returns a
nonzero value.

## VBA Example


Sub DeleteTendonTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon temperature load
ret = SapModel.TendonObj.SetLoadTemperature("ALL", "DEAD", 50, , , Group)

'delete tendon temperature load
ret = SapModel.TendonObj.DeleteLoadTemperature(Name, "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTemperature

SetLoadTemperature


# GetDiscretization

## Syntax

SapObject.SapModel.TendonObj.GetDiscretization

## VB6 Procedure

Function GetDiscretization(ByVal Name As String, ByRef Value As Double) As Long

## Parameters

Name

The name of an existing tendon object.

Value

The maximum discretization length for the tendon. [L]

## Remarks

This function retrieves the maximum discretization length assignment for tendon objects.

The function returns zero if the assignment is successfully retrieved, otherwise it returns a nonzero
value.

## VBA Example

Sub GetTendonMaxDiscretizationLength()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Value As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'get tendon maximum discretization length
ret = SapModel.TendonObj.GetDiscretization(Name, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetDiscretization

# GetElm

## Syntax

SapObject.SapModel.TendonObj.GetElm

## VB6 Procedure

Function GetElm(ByVal Name As String, ByRef nelm As Long, ByRef Elm() as String, ByRef
RDI() As Double, ByRef RDJ() As Double) As Long

## Parameters

Name

The name of an existing tendon object.

nelm

The number of line elements created from the specified tendon object.

Elm

An array that includes the name of a line element created from the specified tendon object.

RDI


An array that includes the relative distance along the tendon object to the I-End of the line
element.

RDJ

An array that includes the relative distance along the tendon object to the J-End of the line
element.

## Remarks

This function retrieves the names of the line elements (analysis model lines) associated with a
specified tendon object in the object-based model. It also retrieves information about the location
of the line elements along the tendon object.

This function returns zero if the line element information is successfully returned; otherwise it
returns nonzero. An error occurs if the analysis model does not currently exist.

## VBA Example

Sub GetLineElementInfoForTendonObject()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim nelm As Long
Dim Elm() As String
Dim RDI() As Double
Dim RDJ() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon force load
ret = SapModel.TendonObj.SetLoadForceStress("ALL", "DEAD", 1, 0, 100, 0.15, 8.333E-05,
0.25, 3, 5, 7, 5, , Group)


'create the analysis model
ret = SapModel.Analyze.CreateAnalysisModel

'get line element information
ret = SapModel.TendonObj.GetElm(Name, nelm, Elm, RDI, RDJ)

'Note: The above returns 0 elements because the tendon is specified to be modelled using loads,
not elements

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetGroupAssign

## Syntax

SapObject.SapModel.TendonObj.GetGroupAssign

## VB6 Procedure

Function GetGroupAssign(ByVal Name As String, ByRef NumberGroups As Long, ByRef
Groups() As String) ) As Long

## Parameters

Name

The name of an existing tendon object.

NumberGroups

The number of group names retrieved.

Groups

The names of the groups to which the tendon object is assigned.

## Remarks


This function retrieves the names of the groups to which a specified tendon object is assigned.

The function returns zero if the group assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetTendonObjectGroups()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name1 As String
Dim Name2 As String
Dim NumberPoints As Long
Dim MyType() As Long
Dim x() As Double
Dim y() As Double
Dim z() As Double
Dim NumberGroups As Long
Dim Groups() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name1)
ret = SapModel.TendonObj.AddByPoint("2", "8", Name2)

'set tendon geometry
NumberPoints = 3
ReDim MyType(NumberPoints - 1)
ReDim x(NumberPoints - 1)
ReDim y(NumberPoints - 1)
ReDim z(NumberPoints - 1)
MyType(0) = 1
MyType(1) = 7
MyType(2) = 6
x(0) = 0: y(0) = 0
x(1) = 288: y(1) = -12


x(2) = 576: y(2) = 0
ret = SapModel.TendonObj.SetTendonData(Name1, NumberPoints, MyType, x, y, z,
"Local")
ret = SapModel.TendonObj.SetTendonData(Name2, NumberPoints, MyType, x, y, z,
"Local")

'define new groups
ret = SapModel.GroupDef.SetGroup("Group1")

ret = SapModel.GroupDef.SetGroup("Group2")

'add tendon object to groups
ret = SapModel.TendonObj.SetGroupAssign(Name2, "Group1")
ret = SapModel.TendonObj.SetGroupAssign(Name2, "Group2")

'get tendon object groups
ret = SapModel.TendonObj.GetGroupAssign(Name2, NumberGroups, Groups)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v. 20.0.0.

## See Also

SetGroupAssign

# GetGUID

## Syntax

SapObject.SapModel.TendonObj.GetGUID

## VB6 Procedure

Function GetGUID(ByVal name As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing tendon object.


#### GUID

The GUID (Global Unique ID) for the specified tendon object.

## Remarks

This function retrieves the GUID for the specified tendon object.

This function returns zero if the tendon object GUID is successfully retrieved; otherwise it returns
nonzero.

## VBA Example

Sub GetTendonObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'set program created GUID
ret = SapObject.SapModel.TendonObj.SetGUID(Name)

'get GUID
ret = SapObject.SapModel.TendonObj.GetGUID(Name, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

## See Also

SetGUID

# GetLoadDeformation

## Syntax

SapObject.SapModel.TendonObj.GetLoadDeformation

## VB6 Procedure

Function GetLoadDeformation(ByVal Name As String, ByRef NumberItems As Long, ByRef
TendonName() As String, ByRef LoadPat() As String, ByRef U1() As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

NumberItems

The total number of deformation loads retrieved for the specified tendon objects.

TendonName

This is an array that includes the name of the tendon object associated with each deformation load.

LoadPat

This is an array that includes the name of the load pattern associated with each deformation load.

U1

This is an array of axial deformation load values. [L]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the assignments are retrieved for the tendon object specified by the Name
item.

If this item is Group, the assignments are retrieved for all tendon objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected tendon objects, and the
Name item is ignored.

## Remarks

This function retrieves the deformation load assignments to tendon objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetTendonDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim TendonName() As String
Dim LoadPat() As String
Dim U1() As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon deformation loads
ret = SapModel.TendonObj.SetLoadDeformation("ALL", "DEAD", 2, Group)

'get tendon deformation loads
ret = SapModel.TendonObj.GetLoadDeformation(Name, NumberItems, TendonName,


LoadPat, U1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadDeformation

DeleteLoadDeformation

# GetLoadedGroup

## Syntax

SapObject.SapModel.TendonObj.GetLoadedGroup

## VB6 Procedure

Function GetLoadedGroup(ByVal Name As String, ByRef GroupName As String) As Long

## Parameters

Name

The name of an existing tendon object.

GroupName

This is the name of an existing group. All objects in the specified group can be loaded by the
tendon.

## Remarks

This function retrieves the loaded group for tendon objects. A tendon object transfers its load to
any object that is in the specified group.


The function returns zero if the assignment is successfully retrieved, otherwise it returns a nonzero
value.

## VBA Example

Sub GetTendonLoadedGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim GroupName As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'get tendon loaded group
ret = SapModel.TendonObj.GetLoadedGroup(Name, GroupName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetLoadedGroup


# GetLoadForceStress

## Syntax

SapObject.SapModel.TendonObj.GetLoadForceStress

## VB6 Procedure

Function GetLoadForceStress(ByVal Name As String, ByRef NumberItems As Long, ByRef
TendonName() As String, ByRef LoadPat() As String, ByRef JackFrom() As Long, ByRef
LoadType() As Long, ByRef Value() As Double, ByRef CurvatureCoeff() As Double, ByRef
WobbleCoeff() As Double, ByRef LossAnchorage() As Double, ByRef LossShortening() As
Double, ByRef LossCreep() As Double, ByRef LossShrinkage() As Double, ByRef
LossSteelRelax() As Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

NumberItems

The total number of temperature loads retrieved for the specified tendon objects.

TendonName

This is an array that includes the name of the tendon object associated with each temperature load.

LoadPat

This is an array that includes the name of the load pattern associated with each temperature load.

JackFrom

This is an array that includes 1, 2 or 3, indicating how the tendon is jacked.

```
1 = Tendon jacked from I-End
2 = Tendon jacked from J-End
3 = Tendon jacked from both ends
```
LoadType

This is an array that includes either 0 or 1, indicating how the type of load.

```
0 = Force
1 = Stress
```
Value


This is an array that includes the load value. [F] when LoadType is 0, and [F/L^2 ] when Loadtype is
1

CurvatureCoeff

This is an array that includes the curvature coefficient used when calculating friction losses.

WobbleCoeff

This is an array that includes the wobble coefficient used when calculating friction losses. [1/L]

LossAnchorage

This is an array that includes the anchorage set slip. [L]

LossShortening

This is an array that includes the tendon stress loss due to elastic shortening. [F/L^2 ]

LossCreep

This is an array that includes the tendon stress loss due to creep. [F/L^2 ]

LossShrinkage

This is an array that includes the tendon stress loss due to shrinkage. [F/L^2 ]

LossSteelRelax

This is an array that includes the tendon stress loss due to tendon steel relaxation. [F/L^2 ]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the tendon object specified by the Name
item.

If this item is Group, the assignments are retrieved for all tendon objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected tendon objects, and the
Name item is ignored.

## Remarks

This function retrieves the force/stress load assignments to tendon objects.


The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetTendonForceLoad()
'dimensionvariables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberItems As Long
Dim TendonName() As String
Dim LoadPat() As String
Dim JackFrom() As Long
Dim LoadType() As Long
Dim Value() As Double
Dim CurvatureCoeff() As Double
Dim WobbleCoeff() As Double
Dim LossAnchorage() As Double
Dim LossShortening() As Double
Dim LossCreep() As Double
Dim LossShrinkage() As Double
Dim LossSteelRelax() As Double

'createSap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'startSap2000 application
SapObject.ApplicationStart

'createSapModel object
Set SapModel = SapObject.SapModel

'initializemodel
ret = SapModel.InitializeNewModel

'createmodel from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon force load
ret = SapModel.TendonObj.SetLoadForceStress("ALL", "DEAD", 1, 0, 100, 0.15, 8.333E-05,
0.25, 3, 5, 7, 5, , Group)

'get tendon force load
ret = SapModel.TendonObj.GetLoadForceStress(Name, NumberItems, TendonName,
LoadPat, JackFrom, LoadType, Value, CurvatureCoeff, WobbleCoeff, LossAnchorage,
LossShortening, LossCreep, LossShrinkage, LossSteelRelax)


'closeSap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadForceStress

DeleteLoadForceStress

# GetLoadGravity

## Syntax

SapObject.SapModel.TendonObj.GetLoadGravity

## VB6 Procedure

Function GetLoadGravity(ByVal Name As String, ByRef NumberItems As Long, ByRef
TendonName() As String, ByRef LoadPat() As String, ByRef CSys() As String, ByRef x() As
Double, ByRef y() As Double, ByRef z() As Double, Optional ByVal ItemType As eItemType =
Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

NumberItems

The total number of gravity loads retrieved for the specified tendon objects.

TendonName

This is an array that includes the name of the tendon object associated with each gravity load.

LoadPat


This is an array that includes the name of the coordinate system in which the gravity load
multipliers are specified.

CSys

This is an array that includes the name of the coordinate system associated with each gravity load.

x, y, z

These are arrays of gravity load multipliers in the x, y and z directions of the specified coordinate
system.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the tendon object specified by the Name
item.

If this item is Group, the assignments are retrieved for all tendon objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected tendon objects, and the
Name item is ignored.

## Remarks

This function retrieves the gravity load assignments to tendon objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetTendonGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim TendonName() As String
Dim LoadPat() As String
Dim CSys() As String
Dim x() As Double
Dim y() As Double
Dim z() As Double
Dim Name As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon gravity loads
ret = SapModel.TendonObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'get tendon gravity load
ret = SapModel.TendonObj.GetLoadGravity(Name, NumberItems, TendonName, LoadPat,
CSys, x, y, z)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadGravity

DeleteLoadGravity

# GetLoadStrain

## Syntax

SapObject.SapModel.TendonObj.GetLoadStrain


## VB6 Procedure

Function GetLoadStrain(ByVal Name As String, ByRef NumberItems As Long, ByRef
TendonName() As String, ByRef LoadPat() As String, ByRef Strain() As Double, ByRef
PatternName() As String, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

NumberItems

The total number of strain loads retrieved for the specified tendon objects.

TendonName

This is an array that includes the name of the tendon object associated with each strain load.

LoadPat

This is an array that includes the name of the load pattern associated with each strain load.

Strain

This is an array that includes the axial strain value. [L/L]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the strain load.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the tendon object specified by the Name
item.

If this item is Group, the assignments are retrieved for all tendon objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected tendon objects, and the
Name item is ignored.

## Remarks

This function retrieves the strain load assignments to tendon objects.


The function returns zero if the strain load assignments are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetTendonStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim TendonName() As String
Dim LoadPat() As String
Dim Strain() As Double
Dim PatternName() As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon strain load
ret = SapModel.TendonObj.SetLoadStrain(Name, "DEAD", 0.001)

'get tendon strain load
ret = SapModel.TendonObj.GetLoadStrain(Name, NumberItems, TendonName, LoadPat,
Strain, PatternName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadStrain

DeleteLoadStrain

# GetLoadTemperature

## Syntax

SapObject.SapModel.TendonObj.GetLoadTemperature

## VB6 Procedure

Function GetLoadTemperature(ByVal Name As String, ByRef NumberItems As Long, ByRef
TendonName() As String, ByRef LoadPat() As String, ByRef MyType() As Long, ByRef Val()
As Double, ByRef PatternName() As String, Optional ByVal ItemType As eItemType = Object)
As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

NumberItems

The total number of temperature loads retrieved for the specified tendon objects.

TendonName

This is an array that includes the name of the tendon object associated with each temperature load.

LoadPat

This is an array that includes the name of the load pattern associated with each temperature load.

Val

This is an array that includes the temperature load value. [T]

PatternName

This is an array that includes the joint pattern name, if any, used to specify the temperature load.

ItemType

This is one of the following items in the eItemType enumeration:


```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignments are retrieved for the tendon object specified by the Name
item.

If this item is Group, the assignments are retrieved for all tendon objects in the group specified by
the Name item.

If this item is SelectedObjects, assignments are retrieved for all selected tendon objects, and the
Name item is ignored.

## Remarks

This function retrieves the temperature load assignments to tendon objects.

The function returns zero if the load assignments are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetTendonTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim TendonName() As String
Dim LoadPat() As String
Dim Val() As Double
Dim PatternName() As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points


ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon temperature load
ret = SapModel.TendonObj.SetLoadTemperature("ALL", "DEAD", 50, , , Group)

'get tendon temperature load
ret = SapModel.TendonObj.GetLoadTemperature("ALL", NumberItems, TendonName,
LoadPat, Val, PatternName, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadTemperature

DeleteLoadTemperature

# GetLocalAxes

## Syntax

SapObject.SapModel.TendonObj.GetLocalAxes

## VB6 Procedure

Function GetLocalAxes(ByVal Name As String, ByRef Ang As Double) As Long

## Parameters

Name

The name of an existing tendon object.

Ang

This is the angle that the local 2 and 3 axes are rotated about the positive local 1 axis, from the
default orientation. The rotation for a positive angle appears counter clockwise when the local +1
axis is pointing toward you. [deg]


## Remarks

This function retrieves the tendon local axis angle assignment for tendon objects.

The function returns zero if the assignment is successfully retrieved, otherwise it returns a nonzero
value.

## VBA Example

Sub GetTendonLocalAxisAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Ang As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon local axis angle
ret = SapModel.TendonObj.SetLocalAxes(Name, 30)

'get tendon local axis angle
ret = SapModel.TendonObj.GetLocalAxes(Name, Ang)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

SetLocalAxes

# GetMatTemp

## Syntax

SapObject.SapModel.TendonObj.GetMatTemp

## VB6 Procedure

Function GetMatTemp(ByVal Name As String, ByRef Temp As Double, ByRef PatternName As
String) As Long

## Parameters

Name

The name of an existing tendon object.

Temp

This is the material temperature value assigned to the tendon object. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
tendon object is uniform along the object at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the tendon
object may vary from one end to the other. The material temperature at each end of the object is
equal to the specified temperature multiplied by the pattern value at the joint at the end of the
tendon object.

## Remarks

This function retrieves the material temperature assignments to tendon objects.

The function returns zero if the material temperature assignments are successfully retrieved,
otherwise it returns a nonzero value.

## VBA Example

Sub GetTendonMatTemp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim Temp As Double
Dim PatternName As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign material temperature
ret = SapModel.TendonObj.SetMatTemp("ALL", 50, , Group)

'get material temperature
ret = SapModel.TendonObj.GetMatTemp(Name, Temp, PatternName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetMatTemp

# GetNameList

## Syntax

SapObject.SapModel.TendonObj.GetNameList


## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of tendon object names retrieved by the program.

MyName

This is a one-dimensional array of tendon object names. The MyName array is created as a
dynamic, zero-based, array by the APIuser:

Dim MyName() as String

The array is dimensioned to (NumberNames  1) inside the Sap2000 program, filled with the
names, and returned to the APIuser.

## Remarks

This function retrieves the names of all defined tendon objects.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetTendonObjectNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String
Dim NumberPoints As Long
Dim MyType() As Long
Dim x() As Double
Dim y() As Double
Dim z() As Double
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name1)
ret = SapModel.TendonObj.AddByPoint("2", "8", Name2)

'set tendon geometry
NumberPoints = 3
ReDim MyType(NumberPoints - 1)
ReDim x(NumberPoints - 1)
ReDim y(NumberPoints - 1)
ReDim z(NumberPoints - 1)
MyType(0) = 1
MyType(1) = 7
MyType(2) = 6
x(0) = 0: y(0) = 0
x(1) = 288: y(1) = -12
x(2) = 576: y(2) = 0
ret = SapModel.TendonObj.SetTendonData(Name1, NumberPoints, MyType, x, y, z,
"Local")
ret = SapModel.TendonObj.SetTendonData(Name2, NumberPoints, MyType, x, y, z,
"Local")

'get tendon object names
ret = SapModel.TendonObj.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetPoints

## Syntax

SapObject.SapModel.TendonObj.GetPoints


## VB6 Procedure

Function GetPoints(ByVal Name As String, ByRef Point1 As String, ByRef Point2 As String) As
Long

## Parameters

Name

The name of a defined tendon object.

Point1

The name of the point object at the I-End of the specified tendon object.

Point2

The name of the point object at the J-End of the specified tendon object.

## Remarks

This function retrieves the names of the point objects at each end of a specified tendon object.

The function returns zero if the point names are successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetTendonObjPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Point1 As String
Dim Point2 As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add tendon object by coordinates
ret = SapModel.TendonObj.AddByCoord(-288, 0, 288, 288, 0, 288, Name)

'get names of points
ret = SapModel.TendonObj.GetPoints(Name, Point1, Point2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetProperty

## Syntax

SapObject.SapModel.TendonObj.GetProperty

## VB6 Procedure

Function GetProperty(ByVal Name As String, ByRef PropName As String) As Long

## Parameters

Name

The name of a defined tendon object.

PropName

The name of the tendon property assigned to the tendon object.

## Remarks

This function retrieves the tendon property assigned to a tendon object.

The function returns zero if the tendon object property is successfully retrieved, otherwise it
returns a nonzero value.


## VBA Example

Sub GetTendonProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropName As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'get tendon section property
ret = SapModel.TendonObj.GetProperty(Name, PropName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetProperty

# GetSelected

## Syntax


Sap2000.TendonObj.GetSelected

## VB6 Procedure

Function GetSelected(ByVal Name As String, ByRef Selected As Boolean) As Long

## Parameters

Name

The name of an existing tendon object.

Selected

This item returns True if the specified tendon object is selected, otherwise it returns False.

## Remarks

This function retrieves the selected status for a tendon object.

The function returns zero if the selected status is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetTendonObjectSelectedStatus()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Selected As Boolean
Dim Name1 As String
Dim Name2 As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name1)


ret = SapModel.TendonObj.AddByPoint("2", "8", Name2)

'set all tendons selected
ret = SapModel.TendonObj.SetSelected("All", True, Group)

'get tendon object selected status
ret = SapModel.TendonObj.GetSelected(Name1, Selected)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetSelected

# GetTCLimits

## Syntax

SapObject.SapModel.TendonObj.GetTCLimits

## VB6 Procedure

Function GetTCLimits(ByVal Name As String, ByRef LimitCompressionExists As Boolean,
ByRef LimitCompression As Double, ByRef LimitTensionExists As Boolean, ByRef
LimitTension As Double) As Long

## Parameters

Name

The name of an existing tendon object.

LimitCompressionExists

This item is True if a compression force limit exists for the tendon object.

LimitCompression

The compression force limit for the tendon object. [F]

LimitTensionExists


This item is True if a tension force limit exists for the tendon object.

LimitTension

The tension force limit for the tendon object. [F]

## Remarks

This function retrieves the tension/compression force limit assignments to tendon objects.

The function returns zero if the assignments are successfully retrieved, otherwise it returns a
nonzero value.

Note that the tension and compression limits are used in nonlinear analyses only.

## VBA Example

Sub GetTendonTCLimits()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim LimitCompressionExists As Boolean
Dim LimitCompression As Double
Dim LimitTensionExists As Boolean
Dim LimitTension As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tension/compression limits
ret = SapModel.TendonObj.SetTCLimits(Name, True, 0, True, 100)

'get tension/compression limits
ret = SapModel.TendonObj.GetTCLimits(Name, LimitCompressionExists,
LimitCompression, LimitTensionExists, LimitTension)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetTCLimits

# GetTendonData

## Syntax

SapObject.SapModel.TendonObj.GetTendonData

## VB6 Procedure

Function GetTendonData(ByVal Name As String, ByRef NumberPoints As Long, ByRef MyType
() As Long, ByRef x() As Double, ByRef y() As Double, ByRef z() As Double, Optional ByVal
CSys As String = "Global") As Long

## Parameters

Name

The name of a defined tendon object.

NumberPoints

The number of items used to define the tendon geometry.

MyType

This is an array of values that are 1, 3, 6, 7, 8, or 9, indicating the tendon geometry definition
parameter for the specified point.

```
1 = Start of tendon
2 = The segment preceding the point is linear
6 = The specified point is the end of a parabola
7 = The specified point is an intermediate point on a parabola
8 = The specified point is the end of a circle
9 = The specified point is an intermediate point on a parabola
```

The first point always has a MyType value of 1.

MyType of 6 through 9 is based on using three points to calculate a parabolic or circular arc.
MyType 6 and 8 use the specified point and the two previous points as the three points. MyType 7
and 9 use the specified point and the points just before and after the specified point as the three
points.

x

This is an array of the X (or local 1) coordinate of each point in the coordinate system specified by
CSys. [L]

y

This is an array of the Y (or local 2) coordinate of each point in the coordinate system specified by
CSys. [L]

z

This is an array of the Z (or local 3) coordinate of each point in the coordinate system specified by
CSys. [L]

CSys

This is the coordinate system in which the x, y and z coordinate parameters are defined. It is Local
or the name of a defined coordinate system.

Local means that the point coordinates are in the local system of the specified tendon object with
the origin assumed to be at the I-End of the tendon.

## Remarks

This function retrieves the tendon geometric definition parameters for a tendon object.

The function returns zero if the tendon object parameters are successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetTendonGeometryDefinitionData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberPoints As Long
Dim MyType() As Long
Dim x() As Double
Dim y() As Double
Dim z() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by coordinates
ret = SapModel.TendonObj.AddByCoord(-288, 0, 288, 288, 0, 288, Name)

'set tendon geometry
NumberPoints = 3
ReDim MyType(NumberPoints  1)
ReDim x(NumberPoints - 1)
ReDim y(NumberPoints - 1)
ReDim z(NumberPoints - 1)
MyType(0) = 1
MyType(1) = 7
MyType(2) = 6
x(0) = 0: y(0) = 0
x(1) = 288: y(1) = -12
x(2) = 576: y(2) = 0
ret = SapModel.TendonObj.SetTendonData(Name, NumberPoints, MyType, x, y, z, "Local")

'update view
ret = SapModel.View.RefreshView(0, False)

'get tendon geometry definition data
ReDim MyType(0)
ReDim x(0)
ReDim y(0)
ReDim z(0)
ret = SapModel.TendonObj.GetTendonData(Name, NumberPoints, MyType, x, y, z,
"Global")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

SetTendonData

GetTendonGeometry

# GetTendonGeometry

## Syntax

SapObject.SapModel.TendonObj.GetTendonGeometry

## VB6 Procedure

Function GetTendonGeometry(ByVal Name As String, ByRef NumberPoints As Long, ByRef x()
As Double, ByRef y() As Double, ByRef z() As Double, Optional ByVal CSys As String =
"Global") As Long

## Parameters

Name

The name of a defined tendon object.

NumberPoints

The number of items used to define the discretized tendon geometry.

x

This is an array of the X (or local 1) coordinate of each point in the coordinate system specified by
CSys. [L]

y

This is an array of the Y (or local 2) coordinate of each point in the coordinate system specified by
CSys. [L]

z

This is an array of the Z (or local 3) coordinate of each point in the coordinate system specified by
CSys. [L]

CSys

This is the coordinate system in which the x, y and z coordinate parameters are defined. It is Local
or the name of a defined coordinate system.

Local means that the point coordinates are in the local system of the specified tendon object with
the origin assumed to be at the I-End of the tendon.


## Remarks

This function retrieves tendon object discretized geometry, that is, it retrieves the coordinates of
the points along the discretized tendon.

The function returns zero if the tendon object discretized geometry is successfully retrieved,
otherwise it returns a nonzero value.

## VBA Example

Sub GetTendonDiscretizedGeometry()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberPoints As Long
Dim MyType() As Long
Dim x() As Double
Dim y() As Double
Dim z() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by coordinates
ret = SapModel.TendonObj.AddByCoord(-288, 0, 288, 288, 0, 288, Name)

'set tendon geometry
NumberPoints = 3
ReDim MyType(NumberPoints  1)
ReDim x(NumberPoints  1)
ReDim y(NumberPoints  1)
ReDim z(NumberPoints  1)
MyType(0) = 1
MyType(1) = 7
MyType(2) = 6
x(0) = 0: y(0) = 0
x(1) = 288: y(1) = -12
x(2) = 576: y(2) = 0


ret = SapModel.TendonObj.SetTendonData(Name, NumberPoints, MyType, x, y, z, "Local")

'update view
ret = SapModel.View.RefreshView(0, False)

'get tendon discretized geometry
ReDim x(0)
ReDim y(0)
ReDim z(0)
ret = SapModel.TendonObj.GetTendonGeometry(Name, NumberPoints, x, y, z, "Global")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetTendonData

SetTendonData

# GetTransformationMatrix

## Syntax

Sap2000.TendonObj.GetTransformationMatrix

## VB6 Procedure

Function GetTransformationMatrix(ByVal Name As String, ByRef Value() As Double,Optional
ByVal IsGlobal As Boolean = True) As Long

## Parameters

Name

The name of an existing tendon object.

Value

Value is an array of nine direction cosines that define the transformation matrix.


The following matrix equation shows how the transformation matrix is used to convert items from
the tendon object local coordinate system to the global coordinate system.

In the equation, c0 through c8 are the nine values from the transformation array, (Local1, Local2,
Local3) are an item (such as a load) in the object local coordinate system, and (GlobalX, GlobalY,
GlobalZ) are the same item in the global coordinate system.

The transformation from the local coordinate system to the present coordinate system is the same
as that shown above for the global system if you substitute the present system for the global
system.

IsGlobal

If this item is True, the transformation matrix is between the Global coordinate system and the
tendon object local coordinate system.

If this item is False, the transformation matrix is between the present coordinate system and the
tendon object local coordinate system.

## Remarks

The function returns zero if the tendon object transformation matrix is successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetTendonObjectMatrix()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon local axis angle
ret = SapModel.TendonObj.SetLocalAxes(Name, 30)

'get tendon object transformation matrix
ReDim Value(8)
ret = SapModel.TendonObj.GetTransformationMatrix(Name, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# SetDiscretization

## Syntax

SapObject.SapModel.TendonObj.SetDiscretization

## VB6 Procedure

Function SetDiscretization(ByVal Name As String, ByVal Ang As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

Value

The maximum discretization length for the tendon. [L]

ItemType


This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected tendon objects, and the Name
item is ignored.

## Remarks

This function assigns a maximum discretization length to tendon objects.

The function returns zero if the discretization length is successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignTendonMaxDiscretizationLength()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon maximum discretization length
ret = SapModel.TendonObj.SetDiscretization(Name, 12)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetDiscretization

# SetGroupAssign

## Syntax

SapObject.SapModel.TendonObj.SetGroupAssign

## VB6 Procedure

Function SetGroupAssign(ByVal Name As String, ByVal GroupName As String, Optional By Val
Remove As Boolean = False, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

GroupName

The name of an existing group to which the assignment is made.

Remove

If this item is False, the specified tendon objects are added to the group specified by the
GroupName item. If it is True, the tendon objects are removed from the group.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the tendon object specified by the Name item is added or removed from the
group specified by the GroupName item.

If this item is Group, all tendon objects in the group specified by the Name item are added or
removed from the group specified by the GroupName item.

If this item is SelectedObjects, all selected tendon objects are added or removed from the group
specified by the GroupName item, and the Name item is ignored.

## Remarks

This function adds or removes tendon objects from a specified group.

The function returns zero if the group assignment is successful, otherwise it returns a nonzero
value.

## VBA Example

Sub AddTendonObjectsToGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name1 As String
Dim Name2 As String
Dim NumberPoints As Long
Dim MyType() As Long
Dim x() As Double
Dim y() As Double
Dim z() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name1)
ret = SapModel.TendonObj.AddByPoint("2", "8", Name2)

'set tendon geometry
NumberPoints = 3


ReDim MyType(NumberPoints - 1)
ReDim x(NumberPoints - 1)
ReDim y(NumberPoints - 1)
ReDim z(NumberPoints - 1)
MyType(0) = 1
MyType(1) = 7
MyType(2) = 6
x(0) = 0: y(0) = 0
x(1) = 288: y(1) = -12
x(2) = 576: y(2) = 0
ret = SapModel.TendonObj.SetTendonData(Name1, NumberPoints, MyType, x, y, z,
"Local")
ret = SapModel.TendonObj.SetTendonData(Name2, NumberPoints, MyType, x, y, z,
"Local")

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'add tendon objects to group
ret = SapModel.TendonObj.SetGroupAssign(Name1, "Group1")
ret = SapModel.TendonObj.SetGroupAssign(Name2, "Group1")

'select objects in group
ret = SapModel.SelectObj.Group("Group1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

```
GetGroupAssign
```
# SetGUID

## Syntax

SapObject.SapModel.TendonObj.SetGUID

## VB6 Procedure

Function SetGUID(ByVal Name As String, Optional ByVal GUID As String = "") As Long


## Parameters

Name

The name of an existing tendon object.

GUID

The GUID (Global Unique ID) for the specified tendon object.

## Remarks

This function sets the GUID for the specified tendon object. If the GUID is passed in as a blank
string, the program automatically creates a GUID for the object.

This function returns zero if the tendon object GUID is successfully set; otherwise it returns
nonzero.

## VBA Example

Sub SetTendonObjGUID()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'set program created GUID
ret = SapObject.SapModel.TendonObj.SetGUID(Name)

'get GUID
ret = SapObject.SapModel.TendonObj.GetGUID(Name, GUID)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetGUID

# SetLoadDeformation

## Syntax

SapObject.SapModel.TendonObj.SetLoadDeformation

## VB6 Procedure

Function SetLoadDeformation(ByVal Name As String, ByVal LoadPat As String, ByRef d As
Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

d

This is the axial deformation load value. [L]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected tendon objects and the Name
item is ignored.

## Remarks

This function assigns deformation loads to tendon objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignTendonDeformationLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon deformation loads
ret = SapModel.TendonObj.SetLoadDeformation("ALL", "DEAD", 2, Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadDeformation

DeleteLoadDeformation

# SetLoadedGroup

## Syntax

SapObject.SapModel.TendonObj.SetLoadedGroup

## VB6 Procedure

Function SetLoadedGroup(ByVal Name As String, ByVal GroupName As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

GroupName

This is the name of an existing group. All objects in the specified group can be loaded by the
tendon.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.


If this item is SelectedObjects, assignment is made to all selected tendon objects, and the Name
item is ignored.

## Remarks

This function makes the loaded group assignment to tendon objects. A tendon object transfers its
load to any object that is in the specified group.

The function returns zero if the group is successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignTendonLoadedGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon loaded group
ret = SapModel.TendonObj.SetLoadedGroup(Name, "ALL")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

GetLoadedGroup

# SetLoadForceStress

## Syntax

SapObject.SapModel.TendonObj.SetLoadForceStress

## VB6 Procedure

Function SetLoadForceStress(ByVal Name As String, ByVal LoadPat As String, ByVal JackFrom
As Long, ByVal LoadType As Long, ByVal Value As Double, ByVal CurvatureCoeff As Double,
ByVal WobbleCoeff As Double, ByVal LossAnchorage As Double, ByVal LossShortening As
Double, ByVal LossCreep As Double, ByVal LossShrinkage As Double, ByVal LossSteelRelax
As Double, Optional ByVal Replace As Boolean = True, Optional ByVal ItemType As eItemType
= Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

JackFrom

This is 1, 2 or 3, indicating how the tendon is jacked.

```
1 = Tendon jacked from I-End
2 = Tendon jacked from J-End
3 = Tendon jacked from both ends
```
LoadType

This is either 0 or 1, indicating how the type of load.

```
0 = Force
1 = Stress
```
Value

This is the load value. [F] whenLoadType is 0, and [F/L^2 ] when Loadtype is 1

CurvatureCoeff


The curvature coefficient used when calculating friction losses.

WobbleCoeff

The wobble coefficient used when calculating friction losses. [1/L]

LossAnchorage

The anchorage set slip. [L]

LossShortening

The tendon stress loss due to elastic shortening. [F/L^2 ]

LossCreep

The tendon stress loss due to creep. [F/L^2 ]

LossShrinkage

The tendon stress loss due to shrinkage. [F/L^2 ]

LossSteelRelax

The tendon stress loss due to tendon steel relaxation. [F/L^2 ]

Replace

If this item is True, all previous force/stress loads, if any, assigned to the specified tendon object
(s), in the specified load case, are deleted before making the new assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected tendon objects, and the Name
item is ignored.

## Remarks

This function assigns force/stress loads to tendon objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.


## VBA Example

Sub AssignTendonForceLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'createSap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon force load
ret = SapModel.TendonObj.SetLoadForceStress("ALL", "DEAD", 1, 0, 100, 0.15, 8.333E-05,
0.25, 3, 5, 7, 5, , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadForceStress

DeleteLoadForceStress


# SetLoadGravity

## Syntax

SapObject.SapModel.TendonObj.SetLoadGravity

## VB6 Procedure

Function SetLoadGravity(ByVal Name As String, ByVal LoadPat As String, ByVal x As Double,
ByVal y As Double, ByVal z As Double, Optional ByVal Replace As Boolean = True, Optional
ByVal CSys As String = "Global", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

x, y, z

These are the gravity load multipliers in the x, y and z directions of the specified coordinate
system.

Replace

If this item is True, all previous gravity loads, if any, assigned to the specified tendon object(s), in
the specified load pattern, are deleted before making the new assignment.

CSys

The coordinate system in which the x, y and z multipliers are specified.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected tendon objects and the Name
item is ignored.


## Remarks

This function assigns gravity load multipliers to tendon objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignTendonGravityLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon gravity loads
ret = SapModel.TendonObj.SetLoadGravity("ALL", "DEAD", 0, 0, -1, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetLoadGravity

DeleteLoadGravity

# SetLoadStrain

## Syntax

SapObject.SapModel.TendonObj.SetLoadStrain

## VB6 Procedure

Function SetLoadStrain(ByVal Name As String, ByVal LoadPat As String, ByVal Strain As
Double, Optional ByVal Replace As Boolean = True, Optional ByVal PatternName As String =
"", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Strain

This is the axial strain load value. [L/L]

Replace

If this item is True, all previous strain loads, if any, assigned to the specified tendon object(s), in
the specified load pattern, are deleted before making the new assignment.

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the strain load for the tendon
object is uniform along the object at the value specified by Strain.

If PatternName is the name of a defined joint pattern, the strain load for the tendon object is based
on the specified strain value multiplied by the pattern value at the joints at each end of the tendon
object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
```

```
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected tendon objects, and the Name
item is ignored.

## Remarks

This function assigns strain loads to tendon objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignTendonStrainLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret= SapModel.InitializeNewModel

'create model from template
ret= SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret= SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon strain load
ret= SapModel.TendonObj.SetLoadStrain(Name, "DEAD", 0.001)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadStrain

DeleteLoadStrain

# SetLoadTemperature

## Syntax

SapObject.SapModel.TendonObj.SetLoadTemperature

## VB6 Procedure

Function SetLoadTemperature(ByVal Name As String, ByVal LoadPat As String, ByVal Val As
Double, Optional ByVal PatternName As String = "", Optional ByVal Replace As Boolean =
True, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group depending on the value of the ItemType item.

LoadPat

The name of a defined load pattern.

Val

This is the temperature change value. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the temperature load for the
tendon object is uniform along the object at the value specified by Val.


If PatternName is the name of a defined joint pattern, the temperature load for the tendon object is
based on the specified temperature value multiplied by the pattern value at the joints at each end
of the tendon object.

Replace

If this item is True, all previous temperature loads, if any, assigned to the specified tendon object
(s), in the specified load case, are deleted before making the new assignment.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected tendon objects, and the Name
item is ignored.

## Remarks

This function assigns temperature loads to tendon objects.

The function returns zero if the loads are successfully assigned, otherwise it returns a nonzero
value.

## VBA Example

Sub AssignTendonTemperatureLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon temperature load
ret = SapModel.TendonObj.SetLoadTemperature("ALL", "DEAD", 50, , , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadTemperature

DeleteLoadTemperature

# SetLocalAxes

## Syntax

SapObject.SapModel.TendonObj.SetLocalAxes

## VB6 Procedure

Function SetLocalAxes(ByVal Name As String, ByVal Ang As Double, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

Ang


This is the angle that the local 2 and 3 axes are rotated about the positive local 1 axis, from the
default orientation. The rotation for a positive angle appears counter clockwise when the local +1
axis is pointing toward you. [deg]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected tendon objects, and the Name
item is ignored.

## Remarks

This function assigns a local axis angle to tendon objects.

The function returns zero if the local axis angle is successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub AssignTendonLocalAxisAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tendon local axis angle
ret = SapModel.TendonObj.SetLocalAxes(Name, 30)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetLocalAxes

# SetMatTemp

## Syntax

SapObject.SapModel.TendonObj.SetMatTemp

## VB6 Procedure

Function SetMatTemp(ByVal Name As String, ByVal Temp As Double, Optional ByVal
PatternName As String = "", Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

Temp

This is the material temperature value assigned to the tendon object. [T]

PatternName

This is blank or the name of a defined joint pattern. If it is blank, the material temperature for the
tendon object is uniform along the object at the value specified by Temp.

If PatternName is the name of a defined joint pattern, the material temperature for the tendon
object may vary from one end to the other. The material temperature at each end of the object is


equal to the specified temperature multiplied by the pattern value at the joint at the end of the
tendon object.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected tendon objects, and the Name
item is ignored.

## Remarks

This function assigns material temperatures to tendon objects.

The function returns zero if the material temperatures are successfully assigned, otherwise it
returns a nonzero value.

## VBA Example

Sub AssignTendonMatTemp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points


ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign material temperature
ret = SapModel.TendonObj.SetMatTemp("ALL", 50, , Group)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetMatTemp

# SetProperty

## Syntax

SapObject.SapModel.TendonObj.SetProperty

## VB6 Procedure

Function SetProperty(ByVal name As String, ByVal PropName As String, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

PropName

This is None or the name of a tendon property to be assigned to the specified tendon object(s).
None means that no property is assigned to the tendon.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```

If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected tendon objects, and the Name
item is ignored.

## Remarks

This function assigns a tendon property to a tendon object.

The function returns zero if the tendon property is successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub SetTendonProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'set tendon property
ret = SapModel.TendonObj.SetProperty(Name, "TEN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetProperty

# SetSelected

## Syntax

Sap2000.TendonObj.SetSelected

## VB6 Procedure

Function SetSelected(ByVal Name As String, ByVal Selected As Boolean, Optional ByVal
ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

Selected

This item is True if the specified tendon object is selected, otherwise it is False.

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the selected status is set for the tendon object specified by the Name item.

If this item is Group, the selected status is set for all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, the selected status is set for all selected tendon objects, and the
Name item is ignored.

## Remarks

This function sets the selected status for a tendon object.


The function returns zero if the selected status is successfully set, otherwise it returns a nonzero
value.

## VBA Example

Sub SetTendonObjectSelected()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'set tendon object selected
ret = SapModel.TendonObj.SetSelected(Name, True)

'update view
ret = SapModel.View.RefreshView

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetSelected


# SetTCLimits

## Syntax

SapObject.SapModel.TendonObj.SetTCLimits

## VB6 Procedure

Function SetTCLimits(ByVal Name As String, ByVal LimitCompressionExists As Boolean,
ByVal LimitCompression As Double, ByVal LimitTensionExists As Boolean, ByVal
LimitTension As Double, Optional ByVal ItemType As eItemType = Object) As Long

## Parameters

Name

The name of an existing tendon object or group, depending on the value of the ItemType item.

LimitCompressionExists

This item is True if a compression force limit exists for the tendon object.

LimitCompression

The compression force limit for the tendon object. [F]

LimitTensionExists

This item is True if a tension force limit exists for the tendon object.

LimitTension

The tension force limit for the tendon object. [F]

ItemType

This is one of the following items in the eItemType enumeration:

```
Object = 0
Group = 1
SelectedObjects = 2
```
If this item is Object, the assignment is made to the tendon object specified by the Name item.

If this item is Group, the assignment is made to all tendon objects in the group specified by the
Name item.

If this item is SelectedObjects, assignment is made to all selected tendon objects and the Name
item is ignored.


## Remarks

This function makes tension/compression force limit assignments to tendon objects.

The function returns zero if the assignments are successfully applied, otherwise it returns a
nonzero value.

Note that the tension and compression limits are used in nonlinear analyses only.

## VBA Example

Sub AssignTendonTCLimits()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by points
ret = SapModel.TendonObj.AddByPoint("3", "9", Name)

'assign tension/compression limits
ret = SapModel.TendonObj.SetTCLimits(Name, True, 0, True, 100)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

GetTCLimits

# SetTendonData

## Syntax

SapObject.SapModel.TendonObj.SetTendonData

## VB6 Procedure

Function SetTendonData(ByVal Name As String, ByVal NumberPoints As Long, ByRef MyType
() As Long, ByRef x() As Double, ByRef y() As Double, ByRef z() As Double, Optional ByVal
CSys As String = "Global") As Long

## Parameters

Name

The name of a defined tendon object.

NumberPoints

The number of items used to define the tendon geometry.

MyType

This is an array of values that are 1, 3, 6, 7, 8, or 9, indicating the tendon geometry definition
parameter for the specified point.

```
1 = Start of tendon
2 = The segment preceding the point is linear
6 = The specified point is the end of a parabola
7 = The specified point is an intermediate point on a parabola
8 = The specified point is the end of a circle
9 = The specified point is an intermediate point on a parabola
```
The first point should always have a MyType value of 1. If it is not equal to 1, the program uses 1
anyway.

MyType of 6 through 9 is based on using three points to calculate a parabolic or circular arc.
MyType 6 and 8 use the specified point and the two previous points as the three points. MyType 7
and 9 use the specified point and the points just before and after the specified point as the three
points.

x


This is an array of the X (or local 1) coordinate of each point in the coordinate system specified by
CSys. [L]

y

This is an array of the Y (or local 2) coordinate of each point in the coordinate system specified by
CSys. [L]

z

This is an array of the Z (or local 3) coordinate of each point in the coordinate system specified by
CSys. [L]

CSys

This is the coordinate system in which the x, y and z coordinate parameters are defined. It is Local
or the name of a defined coordinate system.

Local means that the point coordinates are in the local system of the specified tendon object with
the origin assumed to be at the I-End of the tendon.

## Remarks

This function assigns the tendon geometric definition parameters to a tendon object.

The function returns zero if the tendon object is successfully defined, otherwise it returns a
nonzero value. If the tendon object is not successfully defined, it may be deleted.

## VBA Example

Sub SetTendonGeometryData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberPoints As Long
Dim MyType() As Long
Dim x() As Double
Dim y() As Double
Dim z() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon object by coordinates
ret = SapModel.TendonObj.AddByCoord(-288, 0, 288, 288, 0, 288, Name)

'set tendon geometry
NumberPoints = 3
ReDim MyType(NumberPoints - 1)
ReDim x(NumberPoints - 1)
ReDim y(NumberPoints - 1)
ReDim z(NumberPoints - 1)
MyType(0) = 1
MyType(1) = 7
MyType(2) = 6
x(0) = 0: y(0) = 0
x(1) = 288: y(1) = -12
x(2) = 576: y(2) = 0
ret = SapModel.TendonObj.SetTendonData(Name, NumberPoints, MyType, x, y, z, "Local")

'update view
ret = SapModel.View.RefreshView(0, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

AddByCoord

AddByPoint

GetTendonData

GetTendonGeometry


