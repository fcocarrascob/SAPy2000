# Add

## Syntax

SapObject.SapModel.RespCombo.Add

## VB6 Procedure

Function Add(ByVal Name As String, ByVal ComboType As Long) As Long

## Parameters

Name

The name of a new load combination.

ComboType

This is 0, 1, 2, 3 or 4 indicating the load combination type.

```
0 = Linear Additive
1 = Envelope
2 = Absolute Additive
3 = SRSS
4 = Range Additive
```
## Remarks

This function adds a new load combination.

The function returns zero if the load combination is successfully added, otherwise it returns a
nonzero value.

The new load combination must have a different name from all other load combinations and all
load cases. If the name is not unique, an error will be returned.

## VBA Example

Sub AddNewCombo()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 1)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

AddDesignDefaultCombos

# AddDesignDefaultCombos

## Syntax

SapObject.SapModel.RespCombo.AddDesignDefaultCombos

## VB6 Procedure

Function AddDesignDefaultCombos(ByVal DesignSteel As Boolean, ByVal DesignConcrete As
Boolean, ByVal DesignAluminum As Boolean, ByVal DesignColdFormed As Boolean) As Long

## Parameters

DesignSteel


If this item is True, default steel design combinations are to be added to the model.

DesignConcrete

If this item is True, default concrete design combinations are to be added to the model.

DesignAluminum

If this item is True, default aluminum design combinations are to be added to the model.

DesignColdFormed

If this item is True, default cold formed design combinations are to be added to the model.

## Remarks

This function adds a new default design load combinations to the model.

The function returns zero if the load combinations are successfully added, otherwise it returns a
nonzero value.

## VBA Example

Sub AddNewDefaultSteelDesignCombos()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'add combo
ret = SapModel.RespCombo.AddDesignDefaultCombos(True, False, False, False)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

Add

# ChangeName

## Syntax

SapObject.SapModel.RespCombo.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined load combination.

NewName

The new name for the combination.

## Remarks

The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

The new load combination name must be different from all other load combinations and all load
cases. If the name is not unique, an error will be returned.

## VBA Example

Sub ChangeComboName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 1)

'change combo name
ret = SapModel.RespCombo.ChangeName("COMB1", "MyCombo")

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# Count

## Syntax

SapObject.SapModel.RespCombo.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None


## Remarks

This function returns the total number of load combinations defined in the model.

## VBA Example

Sub CountCombos()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 1)

'return number of combos
Count = SapModel.RespCombo.Count

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also


# CountCase

## Syntax

SapObject.SapModel.RespCombo.CountCase

## VB6 Procedure

Function CountCase(ByVal Name As String, ByRef Count As Long) As Long

## Parameters

Name

The name of an existing load combination.

Count

The number of load case and/or combinations included in the specified combination.

## Remarks

This function retrieves the total number of load case and/or combinations included in a specified
load combination.

The function returns zero if the count is successfully retrieved, otherwise it returns a nonzero
value.

## VBA Example

Sub CountComboCases()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 0)

'add load case to combo
ret = SapModel.RespCombo.SetCaseList("COMB1", LoadCase, "DEAD", 1.4)

'count cases and combos in combo COMB
ret = SapModel.RespCombo.CountCase("COMB1", Count)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetCaseList

SetCaseList

# Delete

## Syntax

SapObject.SapModel.RespCombo.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing load combination.


## Remarks

This function deletes the specified load combination.

The function returns zero if the combination is successfully deleted, otherwise it returns a nonzero
value.

## VBA Example

Sub DeleteCombo()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 0)

'delete combo
ret = SapModel.RespCombo.Delete("COMB1")

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

Add

# DeleteCase

## Syntax

SapObject.SapModel.RespCombo.DeleteCase

## VB6 Procedure

Function DeleteCase(ByVal Name As String, ByVal CType As eCNameType, ByVal CName As
String) As Long

## Parameters

Name

The name of an existing load combination.

CType

This is one of the following items in the eCNameType enumeration:

```
LoadCase = 0
LoadCombo = 1
```
This item indicates whether the CName item is an analysis case (LoadCase) or a load combination
(LoadCombo).

CName

The name of the load case or load combination to be deleted from the specified combination.

## Remarks

This function deletes one load case or load combination from the list of cases included in the
specified load combination.

The function returns zero if the item is successfully deleted, otherwise it returns a nonzero value.

## VBA Example

Sub DeleteComboCase()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 0)

'add load case to combo
ret = SapModel.RespCombo.SetCaseList("COMB1", eCNameType_LoadCase, "DEAD", 1.4)

'delete load case from combo
ret = SapModel.RespCombo.DeleteCase("COMB1", eCNameType_LoadCase, "DEAD")

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetCaseList

SetCaseList

# GetCaseList

## Syntax

SapObject.SapModel.RespCombo.GetCaseList


## VB6 Procedure

Function GetCaseList(ByVal Name As String, ByRef NumberItems As Long, ByRef CType() As
eCNameType, ByRef CName() As String, ByRef SF() As Double) As Long

## Parameters

Name

The name of an existing load combination.

NumberItems

The total number of load cases and load combinations included in the load combination specified
by the Name item.

CType

This is an array of one of the following items in the eCNameType enumeration:

```
LoadCase = 0
LoadCombo = 1
```
This item indicates if the associated CName item is an load case (LoadCase) or a load
combination (LoadCombo).

CName

This is an array of the names of the load cases or load combinations included in the load
combination specified by the Name item.

SF

The scale factor multiplying the case or combination indicated by the CName item.

## Remarks

This function returns all load cases and response combinations included in the load combination
specified by the Name item.

The function returns zero if the data is successfully retrieved, otherwise it returns a nonzero value.

## VBA Example

Sub GetCasesInCombo()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim CType() As eCNameType


Dim CName() As String
Dim SF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 0)

'add load case to combo
ret = SapModel.RespCombo.SetCaseList("COMB1", eCNameType_LoadCase, "DEAD", 1.4)

'get all cases and combos included in combo COMB
ret = SapModel.RespCombo.GetCaseList("COMB1", NumberItems, CType, CName, SF)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetCaseList

# GetNameList

## Syntax

SapObject.SapModel.RespCombo.GetNameList


## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of load combination names retrieved by the program.

MyName

This is a one-dimensional array of load combination names. The MyName array is created as a
dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames – 1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined response combinations.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetComboNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)


'add combos
ret = SapModel.RespCombo.Add("COMB1", 0)
ret = SapModel.RespCombo.Add("COMB2", 2)

'get combo names
ret = SapModel.RespCombo.GetNameList(NumberNames, MyName)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# GetNote

## Syntax

SapObject.SapModel.RespCombo.GetNote

## VB6 Procedure

Function GetNote(ByVal Name As String, ByRef Note As String) As Long

## Parameters

Name

The name of an existing load combination.

Note

The user note, if any, included with the specified combination.

## Remarks

This function retrieves the user note for specified response combination. The note may be blank.

The function returns zero if the note is successfully retrieved, otherwise it returns a nonzero value.


## VBA Example

Sub GetComboNote()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Note As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 0)

'add note to combo
ret = SapModel.RespCombo.SetNote("COMB1", "My combo note")

'get note for combo
ret = SapModel.RespCombo.GetNote("COMB1", Note)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetNote


# GetTypeOAPI

## Syntax

SapObject.SapModel.RespCombo.GetTypeOAPI

## VB6 Procedure

Function GetTypeOAPI(ByVal Name As String, ByRef ComboType As Long) As Long

## Parameters

Name

The name of an existing load combination.

ComboType

This is 0, 1, 2, 3 or 4 indicating the load combination type.

```
0 = Linear Additive
1 = Envelope
2 = Absolute Additive
3 = SRSS
4 = Range Additive
```
## Remarks

This function retrieves the combination type for specified load combination.

The function returns zero if the type is successfully retrieved, otherwise it returns a nonzero value.

## VBA Example

Sub GetComboType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ComboType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 2)

'get combo type
ret = SapModel.RespCombo.GetTypeOAPI("COMB1", ComboType )

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Changed function name to GetTypeOAPI in v17.0.0.

## See Also

SetTypeOAPI

# SetCaseList

## Syntax

SapObject.SapModel.RespCombo.SetCaseList

## VB6 Procedure

Function SetCaseList(ByVal Name As String, ByRef CNameType As eCNameType, ByVal
CName As String, ByVal SF As Double) As Long

## Parameters

Name

The name of an existing load combination.


CNameType

This is one of the following items in the eCNameType enumeration:

```
LoadCase = 0
LoadCombo = 1
```
This item indicates if the CName item is an load case (LoadCase) or a load combination
(LoadCombo).

CName

The name of the load case or load combination to be added to or modified in the combination
specified by the Name item. If the load case or combination already exists in the combination
specified by the Name item, the scale factor is modified as indicated by the SF item for that load
case or combination. If the analysis case or combination does not exist in the combination
specified by the Name item, it is added.

SF

The scale factor multiplying the case or combination indicated by the CName item.

## Remarks

This function adds or modifies one load case or response combination in the list of cases included
in the load combination specified by the Name item.

The function returns zero if the item is successfully added or modified, otherwise it returns a
nonzero value.

## VBA Example

Sub AddCaseToCombo()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 0)

'add load case to combo
ret = SapModel.RespCombo.SetCaseList("COMB1", eCNameType_LoadCase, "DEAD", 1.4)

'close Sap
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetCaseList

# SetNote

## Syntax

SapObject.SapModel.RespCombo.SetNote

## VB6 Procedure

Function SetNote(ByVal Name As String, ByVal Note As String) As Long

## Parameters

Name

The name of an existing load combination.

Note

The user note included with the specified combination. It may be a blank string.

## Remarks

This function sets the user note for specified response combination. The note may be blank.


The function returns zero if the note is successfully set, otherwise it returns a nonzero value.

## VBA Example

Sub AddComboNote()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Note As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 0)

'add note to combo
ret = SapModel.RespCombo.SetNote("COMB1", "My combo note")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetNote


# SetTypeOAPI

## Syntax

SapObject.SapModel.RespCombo.SetTypeOAPI

## VB6 Procedure

Function SetTypeOAPI(ByVal Name As String, ByVal ComboType As Long) As Long

## Parameters

Name

The name of an existing load combination.

ComboType

This is 0, 1, 2, 3 or 4 indicating the load combination type.

```
0 = Linear Additive
1 = Envelope
2 = Absolute Additive
3 = SRSS
4 = Range Additive
```
## Remarks

This function sets the combination type for specified load combination.

The function returns zero if the type is successfully set, otherwise it returns a nonzero value.

## VBA Example

Sub SetComboType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add combo
ret = SapModel.RespCombo.Add("COMB1", 0)

'set combo type to Envelope
ret = SapModel.RespCombo.SetTypeOAPI("COMB1", 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Changed function name to SetTypeOAPI in v17.0.0.

## See Also

GetTypeOAPI

# ChangeName

## Syntax

SapObject.SapModel.ConstraintDef.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined constraint.

NewName


The new name for the constraint.

## Remarks

The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeConstraintName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new contraint
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", AutoAxis)

'change name of contraint
ret = SapModel.ConstraintDef.ChangeName("Diaph1", "MyConstraint")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

# Count

## Syntax

SapObject.SapModel.ConstraintDef.Count

## VB6 Procedure

Function Count(Optional ByVal ConstraintType As eConstraintType) As Long

## Parameters

ConstraintType

This optional value is one of the following items in the eConstraintType enumeration.

```
CONSTRAINT_BODY = 1
```
```
CONSTRAINT_DIAPHRAGM = 2
```
```
CONSTRAINT_PLATE = 3
```
```
CONSTRAINT_ROD = 4
```
```
CONSTRAINT_BEAM = 5
```
```
CONSTRAINT_EQUAL = 6
```
```
CONSTRAINT_LOCAL = 7
```
```
CONSTRAINT_WELD = 8
```
```
CONSTRAINT_LINE = 13
```
## Remarks

If the ConstraintType item is specified, the function returns the number of defined constraints of
the specified type. Otherwise it returns the total number of defined constraints without regard for
type.

## VBA Example

Sub CountConstraints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'return number of defined constraints
ret = SapModel.ConstraintDef.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Modified optional argument ConstraintType to be ByVal in version 12.0.1.

## See Also

# Delete

## Syntax

SapObject.SapModel.ConstraintDef.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing constraint.


## Remarks

The function deletes the specified constraint. All constraint assignments for that constraint are also
deleted.

The function returns zero if the constraint is successfully deleted, otherwise it returns a nonzero
value.

## VBA Example

Sub DeleteConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new contraint
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", AutoAxis)

'delete constraint
ret = SapModel.ConstraintDef.Delete("Diaph1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetBeam


SetBody

SetDiaphragm

SetEqual

SetLine

SetLocal

SetPlate

SetRod

SetWeld

# GetBeam

## Syntax

SapObject.SapModel.ConstraintDef.GetBeam

## VB6 Procedure

Function GetBeam(ByVal Name As String, ByRef Axis As eConstraintAxis, ByRef CSys As
String) As Long

## Parameters

Name

The name of an existing constraint.

Axis

This is one of the following items from the eConstraintAxis enumeration. It specifies the axis in
the specified coordinate system that is parallel to the axis of the constraint. If AutoAxis is
specified, the axis of the constraint is automatically determined from the joints assigned to the
constraint.

```
X = 1
Y = 2
Z = 3
```
```
AutoAxis = 4
```
CSys

The name of the coordinate system in which the constraint is defined.


## Remarks

The function returns the definition for the specified constraint.

The function returns zero if the constraint data is successfully obtained, otherwise it returns a
nonzero value.

## VBA Example

Sub GetBeamConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ConstraintType As eConstraintType
Dim Axis As eConstraintAxis
Dim CSys as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new contraint
ret = SapModel.ConstraintDef.SetBeam("Beam1")

'get constraint data
ret = SapModel.ConstraintDef.GetConstraintType("Beam1", ConstraintType)
If ConstraintType = CONSTRAINT_BEAM Then
ret = SapModel.ConstraintDef.GetBeam("Beam1", Axis, CSys)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

SetBeam

# GetBody

## Syntax

SapObject.SapModel.ConstraintDef.GetBody

## VB6 Procedure

Function GetBody(ByVal Name As String, ByRef Value() As Boolean, ByRef CSys As String)
As Long

## Parameters

Name

The name of an existing constraint.

Value

Value is an array of six booleans that indicate which joint degrees of freedom are included in the
constraint. In order, the degrees of freedom addressed in the array are UX, UY, UZ, RX, RY and
RZ.

CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

The function returns the definition for the specified constraint.

The function returns zero if the constraint data is successfully obtained, otherwise it returns a
nonzero value.

## VBA Example

Sub GetBodyConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim i as long
Dim ret As Long
Dim Value() As Boolean
Dim CSys as String


Dim UY as Boolean
Dim ConstraintType As eConstraintType

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new contraint
redim Value(5)
for i = 0 To 5
Value(i) = True
Next i
ret = SapModel.ConstraintDef.SetBody("Body1", Value)

'get constraint data
ret = SapModel.ConstraintDef.GetConstraintType("Body1", ConstraintType)
If ConstraintType = CONSTRAINT_BODY Then
ret = SapModel.ConstraintDef.GetBody("Body1", Value, CSys)
if ret = 0 Then UY = Value(1)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetBody


# GetConstraintType

## Syntax

SapObject.SapModel.ConstraintDef.GetConstraintType

## VB6 Procedure

Function GetConstraintType(ByVal Name As String, ByRef ConstraintType As eConstraintType)
As Long

## Parameters

Name

The name of an existing constraint.

ConstraintType

This value is one of the following items in the eConstraintType enumeration.

```
CONSTRAINT_BODY = 1
```
```
CONSTRAINT_DIAPHRAGM = 2
```
```
CONSTRAINT_PLATE = 3
```
```
CONSTRAINT_ROD = 4
```
```
CONSTRAINT_BEAM = 5
```
```
CONSTRAINT_EQUAL = 6
```
```
CONSTRAINT_LOCAL = 7
```
```
CONSTRAINT_WELD = 8
```
```
CONSTRAINT_LINE = 13
```
## Remarks

The function returns the constraint type for the specified constraint.

The function returns zero if the constraint type is successfully obtained, otherwise it returns a
nonzero value.

## VBA Example

Sub ConstraintType()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim ConstraintType As eConstraintType

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", AutoAxis)

'get constraint type
ret = SapModel.ConstraintDef.GetConstraintType("Diaph1", ConstraintType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetBeam

GetBody

GetDiaphragm

GetEqual

GetLine

GetLocal

GetPlate


GetRod

GetWeld

# GetDiaphragm

## Syntax

SapObject.SapModel.ConstraintDef.GetDiaphragm

## VB6 Procedure

Function GetDiaphragm(ByVal Name As String, ByRef Axis As eConstraintAxis, ByRef CSys
As String) As Long

## Parameters

Name

The name of an existing constraint.

Axis

This is one of the following items from the eConstraintAxis enumeration. It specifies the axis in
the specified coordinate system that is perpendicular to the plane of the constraint. If AutoAxis is
specified, the axis of the constraint is automatically determined from the joints assigned to the
constraint.

```
X = 1
Y = 2
Z = 3
```
```
AutoAxis = 4
```
CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

The function returns the definition for the specified constraint.

The function returns zero if the constraint data is successfully obtained, otherwise it returns a
nonzero value.

## VBA Example

Sub GetDiaphragmConstraint()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ConstraintType As eConstraintType
Dim Axis As eConstraintAxis
Dim CSys as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1")

'get constraint data
ret = SapModel.ConstraintDef.GetConstraintType("Diaph1", ConstraintType)
If ConstraintType = CONSTRAINT_DIAPHRAGM Then
ret = SapModel.ConstraintDef.GetDiaphragm("Diaph1", Axis, CSys)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetDiaphragm

# GetEqual

## Syntax


SapObject.SapModel.ConstraintDef.GetEqual

## VB6 Procedure

Function GetEqual(ByVal Name As String, ByRef Value() As Boolean, ByRef CSys As String)
As Long

## Parameters

Name

The name of an existing constraint.

Value

Value is an array of six booleans that indicate which joint degrees of freedom are included in the
constraint. In order, the degrees of freedom addressed in the array are UX, UY, UZ, RX, RY and
RZ.

CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

The function returns the definition for the specified constraint.

The function returns zero if the constraint data is successfully obtained, otherwise it returns a
nonzero value.

## VBA Example

Sub GetEqualConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim i as long
Dim ret As Long
Dim Value() As Boolean
Dim CSys as String
Dim UY as Boolean
Dim ConstraintType As eConstraintType

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
redim Value(5)
for i = 0 To 5
Value(i) = True
Next i
ret = SapModel.ConstraintDef.SetEqual("Equal1", Value)

'get constraint data
ret = SapModel.ConstraintDef.GetConstraintType("Equal1", ConstraintType)
If ConstraintType = CONSTRAINT_EQUAL Then
ret = SapModel.ConstraintDef.GetEqual("Equal1", Value, CSys)
if ret = 0 Then UY = Value(1)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetEqual

# GetLine

## Syntax

SapObject.SapModel.ConstraintDef.GetLine

## VB6 Procedure

Function GetLine(ByVal Name As String, ByRef Value() As Boolean, ByRef CSys As String) As
Long

## Parameters


Name

The name of an existing constraint.

Value

Value is an array of six booleans that indicate which joint degrees of freedom are included in the
constraint. In order, the degrees of freedom addressed in the array are UX, UY, UZ, RX, RY and
RZ.

CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

The function returns the definition for the specified constraint.

The function returns zero if the constraint data is successfully obtained, otherwise it returns a
nonzero value.

## VBA Example

Sub GetLineConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim i as long
Dim ret As Long
Dim Value() As Boolean
Dim CSys as String
Dim UY as Boolean
Dim ConstraintType As eConstraintType

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new contraint
redim Value(5)
for i = 0 To 5


Value(i) = True
Next i
ret = SapModel.ConstraintDef.SetLine("Line1", Value)

'get constraint data
ret = SapModel.ConstraintDef.GetConstraintType("Line1", ConstraintType)
If ConstraintType = CONSTRAINT_LINE Then
ret = SapModel.ConstraintDef.GetLine("Line1", Value, CSys)
if ret = 0 Then UY = Value(1)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetLine

# GetLocal

## Syntax

SapObject.SapModel.ConstraintDef.GetLocal

## VB6 Procedure

Function GetLocal(ByVal Name As String, ByRef Value() As Boolean) As Long

## Parameters

Name

The name of an existing constraint.

Value

Value is an array of six booleans that indicate which joint degrees of freedom are included in the
constraint. In order, the degrees of freedom addressed in the array are U1, U2, U3, R1, R2 and R3.

## Remarks


The function returns the definition for the specified constraint.

The function returns zero if the constraint data is successfully obtained, otherwise it returns a
nonzero value.

## VBA Example

Sub GetLocalConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim i as long
Dim ret As Long
Dim Value() As Boolean
Dim UY as Boolean
Dim ConstraintType As eConstraintType

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
redim Value(5)
for i = 0 To 5
Value(i) = True
Next i
ret = SapModel.ConstraintDef.SetLocal("Local1", Value)

'get constraint data
ret = SapModel.ConstraintDef.GetConstraintType("Local1", ConstraintType)
If ConstraintType = CONSTRAINT_LOCAL Then
ret = SapModel.ConstraintDef.GetLocal("Local1", Value)
if ret = 0 Then UY = Value(1)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

SetLocal

# GetNameList

## Syntax

SapObject.SapModel.ConstraintDef.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of joint constraint names retrieved by the program.

MyName

This is a one-dimensional array of joint constraint names. The MyName array is created as a
dynamic, zero-based, array by the API user:

Dim MyName() as String

The array is dimensioned to (NumberNames – 1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined joint constraints.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetJointConstraintNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", AutoAxis)

'get constraint names
ret = SapModel.ConstraintDef.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetPlate

## Syntax

SapObject.SapModel.ConstraintDef.GetPlate

## VB6 Procedure

Function GetPlate(ByVal Name As String, ByRef Axis As eConstraintAxis, ByRef CSys As
String) As Long


## Parameters

Name

The name of an existing constraint.

Axis

This is one of the following items from the eConstraintAxis enumeration. It specifies the axis in
the specified coordinate system that is perpendicular to the plane of the constraint. If AutoAxis is
specified, the axis of the constraint is automatically determined from the joints assigned to the
constraint.

```
X = 1
Y = 2
Z = 3
```
```
AutoAxis = 4
```
CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

The function returns the definition for the specified constraint.

The function returns zero if the constraint data is successfully obtained, otherwise it returns a
nonzero value.

## VBA Example

Sub GetPlateConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ConstraintType As eConstraintType
Dim Axis As eConstraintAxis
Dim CSys as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
ret = SapModel.ConstraintDef.SetPlate("Plate1")

'get constraint data
ret = SapModel.ConstraintDef.GetConstraintType("Plate1", ConstraintType)
If ConstraintType = CONSTRAINT_PLATE Then
ret = SapModel.ConstraintDef.GetPlate("Plate1", Axis, CSys)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetPlate

# GetRod

## Syntax

SapObject.SapModel.ConstraintDef.GetRod

## VB6 Procedure

Function GetRod(ByVal Name As String, ByRef Axis As eConstraintAxis, ByRef CSys As
String) As Long

## Parameters

Name

The name of an existing constraint.

Axis

This is one of the following items from the eConstraintAxis enumeration. It specifies the axis in
the specified coordinate system that is parallel to the axis of the constraint. If AutoAxis is


specified, the axis of the constraint is automatically determined from the joints assigned to the
constraint.

```
X = 1
Y = 2
Z = 3
```
```
AutoAxis = 4
```
CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

The function returns the definition for the specified constraint.

The function returns zero if the constraint data is successfully obtained, otherwise it returns a
nonzero value.

## VBA Example

Sub GetRodConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ConstraintType As eConstraintType
Dim Axis As eConstraintAxis
Dim CSys as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
ret = SapModel.ConstraintDef.SetRod("Rod1")

'get constraint data
ret = SapModel.ConstraintDef.GetConstraintType("Rod1", ConstraintType)
If ConstraintType = CONSTRAINT_ROD Then


ret = SapModel.ConstraintDef.GetRod("Rod1", Axis, CSys)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetRod

# GetSpecialRigidDiaphragmList

## Syntax

SapObject.SapModel.ConstraintDef.GetSpecialRigidDiaphragmList

## VB6 Procedure

Function GetSpecialRigidDiaphragmList(ByRef Num As Long, ByRefDiaph() As String) As
Long

## Parameters

Num

The number of special rigid diaphragm constraints.

Diaph

This is an array that includes the name of each special rigid diaphragm constraint.

## Remarks

This function retrieves the list of the names of each special rigid diaphragm constraint. A special
rigid diaphragm constraint is required for assignment of auto seismic load diaphragm eccentricity
overwrites. It is also required for calculation of auto wind loads whose exposure widths are
determined from the extents of rigid diaphragms.

A special rigid diaphragm constraint is a constraint with the following features:

1. The constraint type is CONSTRAINT_DIAPHRAGM = 2.


2. The constraint coordinate system is Global.
3. The constraint axis is Z.

The function returns zero if the name list is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetSpecialDiaphragmList()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Num As Long
Dim Diaph() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'createSapModelobject
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2")
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph3", Z)

'get special rigid diaphragm name list
ret = SapModel.ConstraintDef.GetSpecialRigidDiaphragmList(Num, Diaph)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

# GetWeld

## Syntax

SapObject.SapModel.ConstraintDef.GetWeld

## VB6 Procedure

Function GetWeld(ByVal Name As String, ByRef Value() As Boolean, ByRef Tolerance As
Double, ByRef CSys As String) As Long

## Parameters

Name

The name of an existing constraint.

Value

Value is an array of six booleans that indicate which joint degrees of freedom are included in the
constraint. In order, the degrees of freedom addressed in the array are UX, UY, UZ, RX, RY and
RZ.

Tolerance

Joints within this distance of each other are constrained together.

CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

The function returns the definition for the specified constraint.

The function returns zero if the constraint data is successfully obtained, otherwise it returns a
nonzero value.

## VBA Example

Sub GetWeldConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim i as long
Dim ret As Long
Dim Value() As Boolean


Dim Tolerance As Double
Dim CSys as String
Dim UY as Boolean
Dim ConstraintType As eConstraintType

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
redim Value(5)
for i = 0 To 5
Value(i) = True
Next i
Tolerance = 2
ret = SapModel.ConstraintDef.SetWeld("Weld1", Value, Tolerance)

'get constraint data
ret = SapModel.ConstraintDef.GetConstraintType("Weld1", ConstraintType)
If ConstraintType = CONSTRAINT_WELD Then
ret = SapModel.ConstraintDef.GetWeld("Weld1", Value, Tolerance, CSys)
if ret = 0 Then UY = Value(1)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetWeld


# SetBeam

## Syntax

SapObject.SapModel.ConstraintDef.SetBeam

## VB6 Procedure

Function SetBeam(ByVal Name As String, Optional ByVal Axis As eConstraintAxis = AutoAxis,
Optional ByVal CSys As String = "Global") As Long

## Parameters

Name

The name of a constraint.

Axis

This is one of the following items from the eConstraintAxis enumeration. It specifies the axis in
the specified coordinate system that is parallel to the axis of the constraint. If AutoAxis is
specified, the axis of the constraint is automatically determined from the joints assigned to the
constraint.

```
X = 1
Y = 2
Z = 3
```
```
AutoAxis = 4
```
CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

This function defines a Beam constraint. If the specified name is not used for a constraint, a new
constraint is defined using the specified name. If the specified name is already used for another
Beam constraint, the definition of that constraint is modified. If the specified name is already used
for some constraint that is not a Beam constraint, an error is returned.

The function returns zero if the constraint data is successfully added or modified, otherwise it
returns a nonzero value.

## VBA Example

Sub SetBeamConstraint()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim Axis As eConstraintAxis
Dim CSys as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
ret = SapModel.ConstraintDef.SetBeam("Beam1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetBeam

# SetBody

## Syntax

SapObject.SapModel.ConstraintDef.SetBody

## VB6 Procedure

Function SetBody(ByVal Name As String, ByRef Value() As Boolean, Optional ByVal CSys As
String = "Global") As Long


## Parameters

Name

The name of an existing constraint.

Value

Value is an array of six booleans that indicate which joint degrees of freedom are included in the
constraint. In order, the degrees of freedom addressed in the array are UX, UY, UZ, RX, RY and
RZ.

CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

This function defines a Body constraint. If the specified name is not used for a constraint, a new
constraint is defined using the specified name. If the specified name is already used for another
Body constraint, the definition of that constraint is modified. If the specified name is already used
for some constraint that is not a Body constraint, an error is returned.

The function returns zero if the constraint data is successfully added or modified, otherwise it
returns a nonzero value.

## VBA Example

Sub SetBodyConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim i as long
Dim ret As Long
Dim Value() As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint


redim Value(5)
for i = 0 To 5
Value(i) = True
Next i
ret = SapModel.ConstraintDef.SetBody("Body1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetBody

# SetDiaphragm

## Syntax

SapObject.SapModel.ConstraintDef.SetDiaphragm

## VB6 Procedure

Function SetDiaphragm(ByVal Name As String, Optional ByVal Axis As eConstraintAxis =
AutoAxis, Optional ByVal CSys As String = "Global") As Long

## Parameters

Name

The name of a constraint.

Axis

This is one of the following items from the eConstraintAxis enumeration. It specifies the axis in
the specified coordinate system that is perpendicular to the plane of the constraint. If AutoAxis is
specified, the axis of the constraint is automatically determined from the joints assigned to the
constraint.

```
X = 1
Y = 2
Z = 3
```
```
AutoAxis = 4
```

CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

This function defines a Diaphragm constraint. If the specified name is not used for a constraint, a
new constraint is defined using the specified name. If the specified name is already used for
another Diaphragm constraint, the definition of that constraint is modified. If the specified name is
already used for some constraint that is not a Diaphragm constraint, an error is returned.

The function returns zero if the constraint data is successfully added or modified, otherwise it
returns a nonzero value.

## VBA Example

Sub SetDiaphragmConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Axis As eConstraintAxis
Dim CSys as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

GetDiaphragm

# SetEqual

## Syntax

SapObject.SapModel.ConstraintDef.SetEqual

## VB6 Procedure

Function SetEqual(ByVal Name As String, ByRef Value() As Boolean, Optional ByVal CSys As
String = "Global") As Long

## Parameters

Name

The name of an existing constraint.

Value

Value is an array of six booleans that indicate which joint degrees of freedom are included in the
constraint. In order, the degrees of freedom addressed in the array are UX, UY, UZ, RX, RY and
RZ.

CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

```
This function defines an Equal constraint. If the specified name is not used for a constraint,
a new constraint is defined using the specified name. If the specified name is already used
for another Equal constraint, the definition of that constraint is modified. If the specified
name is already used for some constraint that is not an Equal constraint, an error is
returned.
```
```
The function returns zero if the constraint data is successfully added or modified,
otherwise it returns a nonzero value.
```
## VBA Example

Sub SetEqualConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim i as long
Dim ret As Long
Dim Value() As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new contraint
redim Value(5)
for i = 0 To 5
Value(i) = True
Next i
ret = SapModel.ConstraintDef.SetEqual("Equal1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetEqual

# SetLine

## Syntax

SapObject.SapModel.ConstraintDef.SetLine

## VB6 Procedure


Function SetLine(ByVal Name As String, ByRef Value() As Boolean, Optional ByVal CSys As
String = "Global") As Long

## Parameters

Name

The name of an existing constraint.

Value

Value is an array of six booleans that indicate which joint degrees of freedom are included in the
constraint. In order, the degrees of freedom addressed in the array are UX, UY, UZ, RX, RY and
RZ.

CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

This function defines a Line constraint. If the specified name is not used for a constraint, a new
constraint is defined using the specified name. If the specified name is already used for another
Line constraint, the definition of that constraint is modified. If the specified name is already used
for some constraint that is not a Line constraint, an error is returned.

The function returns zero if the constraint data is successfully added or modified, otherwise it
returns a nonzero value.

## VBA Example

Sub SetLineConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim i as long
Dim ret As Long
Dim Value() As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
redim Value(5)
for i = 0 To 5
Value(i) = True
Next i
ret = SapModel.ConstraintDef.SetLine("Line1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetLine

# SetLocal

## Syntax

SapObject.SapModel.ConstraintDef.SetLocal

## VB6 Procedure

Function SetLocal(ByVal Name As String, ByRef Value() As Boolean) As Long

## Parameters

Name

The name of an existing constraint.

Value

Value is an array of six booleans that indicate which joint degrees of freedom are included in the
constraint. In order, the degrees of freedom addressed in the array are U1, U2, U3, R1, R2 and R3.

## Remarks


This function defines a Local constraint. If the specified name is not used for a constraint, a new
constraint is defined using the specified name. If the specified name is already used for another
Local constraint, the definition of that constraint is modified. If the specified name is already used
for some constraint that is not a Local constraint, an error is returned.

The function returns zero if the constraint data is successfully added or modified, otherwise it
returns a nonzero value.

## VBA Example

Sub SetLocalConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim i as long
Dim ret As Long
Dim Value() As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
redim Value(5)
for i = 0 To 5
Value(i) = True
Next i
ret = SapModel.ConstraintDef.SetLocal("Local1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

GetLocal

# SetPlate

## Syntax

SapObject.SapModel.ConstraintDef.SetPlate

## VB6 Procedure

Function SetPlate(ByVal Name As String, Optional ByVal Axis As eConstraintAxis = AutoAxis,
Optional ByVal CSys As String = "Global") As Long

## Parameters

Name

The name of a constraint.

Axis

This is one of the following items from the eConstraintAxis enumeration. It specifies the axis in
the specified coordinate system that is perpendicular to the plane of the constraint. If AutoAxis is
specified, the axis of the constraint is automatically determined from the joints assigned to the
constraint.

```
X = 1
Y = 2
Z = 3
```
```
AutoAxis = 4
```
CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

This function defines a Plate constraint. If the specified name is not used for a constraint, a new
constraint is defined using the specified name. If the specified name is already used for another
Plate constraint, the definition of that constraint is modified. If the specified name is already used
for some constraint that is not a Plate constraint, an error is returned.

The function returns zero if the constraint data is successfully added or modified, otherwise it
returns a nonzero value.


## VBA Example

Sub SetPlateConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Axis As eConstraintAxis
Dim CSys as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
ret = SapModel.ConstraintDef.SetPlate("Plate1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetPlate

# SetRod

## Syntax

SapObject.SapModel.ConstraintDef.SetRod


## VB6 Procedure

Function SetRod(ByVal Name As String, Optional ByVal Axis As eConstraintAxis = AutoAxis,
Optional ByVal CSys As String = "Global") As Long

## Parameters

Name

The name of a constraint.

Axis

This is one of the following items from the eConstraintAxis enumeration. It specifies the axis in
the specified coordinate system that is parallel to the axis of the constraint. If AutoAxis is
specified, the axis of the constraint is automatically determined from the joints assigned to the
constraint.

```
X = 1
Y = 2
Z = 3
```
```
AutoAxis = 4
```
CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

This function defines a Rod constraint. If the specified name is not used for a constraint, a new
constraint is defined using the specified name. If the specified name is already used for another
Rod constraint, the definition of that constraint is modified. If the specified name is already used
for some constraint that is not a Rod constraint, an error is returned.

The function returns zero if the constraint data is successfully added or modified, otherwise it
returns a nonzero value.

## VBA Example

Sub SetRodConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Axis As eConstraintAxis
Dim CSys as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new constraint
ret = SapModel.ConstraintDef.SetRod("Rod1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetRod

# SetWeld

## Syntax

SapObject.SapModel.ConstraintDef.SetWeld

## VB6 Procedure

Function SetWeld(ByVal Name As String, ByRef Value() As Boolean, ByVal Tolerance As
Double, Optional ByVal CSys As String = "Global") As Long

## Parameters

Name

The name of an existing constraint.

Value


Value is an array of six booleans that indicate which joint degrees of freedom are included in the
constraint. In order, the degrees of freedom addressed in the array are UX, UY, UZ, RX, RY and
RZ.

Tolerance

Joints within this distance of each other are constrained together.

CSys

The name of the coordinate system in which the constraint is defined.

## Remarks

This function defines a Weld constraint. If the specified name is not used for a constraint, a new
constraint is defined using the specified name. If the specified name is already used for another
Weld constraint, the definition of that constraint is modified. If the specified name is already used
for some constraint that is not a Weld constraint, an error is returned.

The function returns zero if the constraint data is successfully added or modified, otherwise it
returns a nonzero value.

## VBA Example

Sub SetWeldConstraint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim i as long
Dim ret As Long
Dim Value() As Boolean
Dim Tolerance As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new contraint
redim Value(5)
for i = 0 To 5
Value(i) = True


Next i
Tolerance = 1
ret = SapModel.ConstraintDef.SetWeld("Weld1", Value, Tolerance)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetWeld

# ChangeName

## Syntax

SapObject.SapModel.CoordSys.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined coordinate system.

NewName

The new name for the coordinate system.

## Remarks

The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

Changing the name of the Global coordinate system will fail and return an error.

## VBA Example


Sub ChangeCoordSystemName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new coordinate system
ret = SapModel.CoordSys.SetCoordSys("CSys1", 1000, 1000, 0, 0, 0, 0)

'change name of new coordinate system
ret = SapModel.CoordSys.ChangeName("CSys1", "MyCSys")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Count

## Syntax

SapObject.SapModel.CoordSys.Count

## VB6 Procedure

Function Count() As Long


## Parameters

None

## Remarks

The function returns the number of defined coordinate systems.

## VBA Example

Sub CountCoordSystems()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'return number of defined coordinate systems
ret = SapModel.CoordSys.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Delete


## Syntax

SapObject.SapModel.CoordSys.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing coordinate system.

## Remarks

The function deletes the specified coordinate system. Attempting to delete the Global coordinate
system will fail and return an error.

The function returns zero if the coordinate system is successfully deleted, otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteCoordSystem()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new coordinate system
ret = SapModel.CoordSys.SetCoordSys("CSys1", 1000, 1000, 0, 0, 0, 0)

'delete coordinate system
ret = SapModel.CoordSys.Delete("CSys1")


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetCoordSys

# GetCoordSys

## Syntax

SapObject.SapModel.CoordSys.GetCoordSys

## VB6 Procedure

Function GetCoordSys(ByVal Name As String, ByRef x As Double, ByRef y As Double, ByRef z
As Double, ByRef RZ As Double, ByRef RY As Double, ByRef RX As Double) As Long

## Parameters

Name

The name of an existing coordinate system.

x

The global X coordinate of the origin of the coordinate system. [L]

y

The global Y coordinate of the origin of the coordinate system. [L]

z

The global Z coordinate of the origin of the coordinate system. [L]

RZ, RY, RX

The rotation of an axis of the new coordinate system relative to the global coordinate system is
defined as follows: (1) Rotate the coordinate system about the positive global Z-axis as defined by
the RZ item. (2) Rotate the coordinate system about the positive global Y-axis as defined by the


RY item. (3) Rotate the coordinate system about the positive global X-axis as defined by the RX
item. Note that the order in which these rotations are performed is important. RX, RY and RZ are
angles in degrees [deg].

## Remarks

The function returns zero if the coordinate system data is successfully retrieved, otherwise it
returns a nonzero value.

## VBA Example

Sub GetCoordSystem()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim x as Double, y as Double, z as Double
Dim RX as Double, RY as Double, RZ as Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new coordinate system
ret = SapModel.CoordSys.SetCoordSys("CSys1", 1000, 1000, 0, 0, 0, 0)

'get new coordinate system data
ret = SapModel.CoordSys.GetCoordSys("CSys1", x, y, z, RZ, RY, RX)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

SetCoordSys

# GetNameList

## Syntax

SapObject.SapModel.CoordSys.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of coordinate system names retrieved by the program.

MyName

This is a one-dimensional array of coordinate system names. The MyName array is created as a
dynamic, zero-based, array by the API user:

Dim MyName() as String

The array is dimensioned to (NumberNames – 1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined coordinate systems.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetCoordinateSystemNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get coordinate system names
ret = SapModel.CoordSys.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetTransformationMatrix

## Syntax

SapObject.SapModel.CoordSys.GetTransformationMatrix

## VB6 Procedure

Function GetTransformationMatrix(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing coordinate system.

Value


Value is an array of nine direction cosines that define the transformation matrix from the specified
global coordinate system to the global coordinate system.

The following matrix equation shows how the transformation matrix is used to convert
coordinates from a coordinate system to the global coordinate system.

In the equation, c0 through c8 are the nine values from the transformation array; (x, y, z) are the
coordinates of a point in the CSys coordinate system; (ux, uy, uz) are the offset of the origin of the
CSys coordinate system from the global coordinate system; and (gx, gy, gz) are the global
coordinates of the point.

## Remarks

The function returns zero if the coordinate system transformation matrix is successfully returned,
otherwise it returns a nonzero value.

## VBA Example

Sub GetCoordSystemMatrix()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long
Dim Value() as double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new coordinate system
ret = SapModel.CoordSys.SetCoordSys("CSys1", 1000, 1000, 0, 0, 0, 0)


'get coordinate system transformation matrix
redim Value(8)
ret = SapModel.CoordSys.GetTransformationMatrix("CSys1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# SetCoordSys

## Syntax

SapObject.SapModel.CoordSys.SetCoordSys

## VB6 Procedure

Function SetCoordSys(ByVal Name As String, ByVal x As Double, ByVal y As Double, ByVal z
As Double, ByVal RZ As Double, ByVal RY As Double, ByVal RX As Double) As Long

## Parameters

Name

This is the name of a coordinate system. If this is the name of an existing coordinate system, that
coordinate system is modified, otherwise a new coordinate system is added.

x

The global X coordinate of the origin of the coordinate system. [L]

y

The global Y coordinate of the origin of the coordinate system. [L]

z

The global Z coordinate of the origin of the coordinate system. [L]

RZ, RY, RX


The rotation of an axis of the new coordinate system relative to the global coordinate system is
defined as follows: (1) Rotate the coordinate system about the positive global Z-axis as defined by
the RZ item. (2) Rotate the coordinate system about the positive global Y-axis as defined by the
RY item. (3) Rotate the coordinate system about the positive global X-axis as defined by the RX
item. Note that the order in which these rotations are performed is important. RX, RY and RZ are
angles in degrees [deg].

## Remarks

The function returns zero if the coordinate system is successfully added or modified, otherwise it
returns a nonzero value.

Modifying the Global coordinate system will fail and return an error.

## VBA Example

Sub AddCoordSystem()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new coordinate system
ret = SapModel.CoordSys.SetCoordSys("CSys1", 1000, 1000, 0, 0, 0, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

GetCoordSys

Delete

# ChangeName

## Syntax

SapObject.SapModel.Func.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined function.

NewName

The new name for the function.

## Remarks

This function changes the name of an existing function.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeFunctionName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'change name of function
ret = SapModel.Func.ChangeName("UNIFRS", "MyFunc")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

## See Also

# ConvertToUser

## Syntax

SapObject.SapModel.Func.ConvertToUser

## VB6 Procedure

Function ConvertToUser(ByVal Name As String) As Long

## Parameters

Name

The name of an existing function that is not a user defined function.

## Remarks

This function converts an existing function to a user defined function.

The function returns zero if the function definition is successfully converted; otherwise it returns a
nonzero value. An error is returned if the specified function is already a user defined function.


## VBA Example

Sub ConvertFuncToUser()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'convert to user function
ret = SapModel.Func.ConvertToUser("TH-1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# Count

## Syntax

SapObject.SapModel.Func.Count


## VB6 Procedure

Function Count(Optional ByVal FuncType As Long = 0) As Long

## Parameters

FuncType

This optional value is one of the following numbers, indicating the type of function for which the
count is desired.

```
0 = All function types
1 = Response spectrum
2 = Time history
3 = Power spectral density
4 = Steady state
```
## Remarks

This function returns the total number of defined functions in the model of the specified type.

## VBA Example

Sub CountFunctions()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'return number of defined functions of all types
Count = SapModel.Func.Count

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

## See Also

# Delete

## Syntax

SapObject.SapModel.Func.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing function.

## Remarks

The function deletes a specified function.

The function returns zero if the function is successfully deleted; otherwise it returns a nonzero
value. It returns an error if the specified function can not be deleted if, for example, it is being
used in an load case.

## VBA Example

Sub DeleteFunction()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'delete function
ret = SapModel.Func.Delete("UNIFRS")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# GetNameList

## Syntax

SapObject.SapModel.Func.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String, Optional
ByVal FuncType As Long = 0) As Long

## Parameters

NumberNames

The number of function names retrieved by the program.

MyName


This is a one-dimensional array of function names. The MyName array is created as a dynamic,
zero-based array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

FuncType

This is one of the following numbers, indicating the type of function for which the name list is
desired.

```
0 = All function types
1 = Response spectrum
2 = Time history
3 = Power spectral density
4 = Steady state
```
## Remarks

This function retrieves the names of all defined functions of the specified type.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetFunctionNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get function names
ret = SapModel.Func.GetNameList(NumberNames, MyName)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

## See Also

# GetTypeOAPI

## Syntax

SapObject.SapModel.Func.GetTypeOAPI

## VB6 Procedure

Function GetTypeOAPI(ByVal Name As String, ByRef FuncType As Long, ByRef AddType As
Long) As Long

## Parameters

Name

The name of an existing function.

FuncType

This is one of the following numbers, indicating the type of function.

```
1 = Response spectrum
2 = Time history
3 = Power spectral density
4 = Steady state
```
AddType

The is one of the following items, indicating the function subtype.

```
Response Spectrum Functions
```
```
0 = From file
1 = User
2 = UBC 94
3 = UBC 97
```

### 4 = BOCA 96

### 5 = NBCC 95

### 6 = IBC 2003

### 7 = NEHRP 97

```
8 = Eurocode 8-1998
9 = NZS4203 1992
10 = Chinese 2010
11 = Italian Ordinanza 3274
12 = IS1893:2002
13 = AASHTO LRFD 2006
14 = NCHRP Project 20-07
15 = IBC 2006
16 = NBCC 2005
17 = Eurocode 8-2004
18 = AS 1170.4-2007
19 = NZS 1170.5-2004
20 = AASHTO 2007
21 = Chinese JTG/T B02-2013
22 = Chinese GB 50111-2006
23 = IBC 2009
24 = NBCC 2010
25 = NTC 2008
26 = AASHTO 2012
27 = IBC 2012
28 = TSC 2007
29 = SI 413(1995)
30 = Argentina INPRES-CIRSOC 103
31 = Chile Norma NCh433+DS61
32 = Chile Norma NCh2369-2003
33 = Colombia NSR-10
34 = Ecuador NEC-11 Capitulo 2
35 = Guatemala AGIES NSE 2-10
36 = Mexico NTC 2004
37 = Peru Norma E.030
38 = Dominican Republic R-001
39 = Venezuela COVENIN 1756-2:2001
40 = KBC 2009
41 = Mexico CFE-93
42 = Peru NTE E.030 2014
43 = Mexico CFE-2008
44 = Ecuado Norma NEC-SE-DS 2015
45 = Costa Rica Seismic Code 2010
46 = SP 14.13330.2014
47 = Chinese CJJ 166-2011
48 = NBCC 2015
49 = IS 1893:2016
50 = ASCE 7-16
51 = KBC 2016
52 = NTC 2018
53 = TSC 2018
```
Time History Functions


```
0 = From file
1 = User
2 = Sine
3 = Cosine
4 = Ramp
5 = Sawtooth
6 = Triangular
7 = User periodic
```
```
Power Spectral Density Functions
```
```
0 = From file
1 = User
```
```
Steady State Functions
```
```
0 = From file
1 = User
```
## Remarks

This function retrieves the function type for the specified function.

The function returns zero if the type is successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetFunctionType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FuncType As Long
Dim AddType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'get function type
ret = SapModel.Func.GetTypeOAPI("UNIFRS", FuncType, AddType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed function name to GetTypeOAPI in v17.0.0.

Updated list of AddType values for response spectrum functions in v18.2.0.

## See Also

# GetValues

## Syntax

SapObject.SapModel.Func.GetValues

## VB6 Procedure

Function GetValues(ByVal Name As String, ByRef NumberItems As Long, ByRef MyTime() As
Double, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing function.

NumberItems

The number of time and function value pairs retrieved.

MyTime

This is an array that includes the time value for each data point. [s] for response spectrum and time
history functions, [cyc/s] for power spectral density and steady state functions

Value

This is an array that includes the function value for each data point.


## Remarks

This function retrieves the time and function values for any defined function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFuncValues()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim MyTime() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'get function values
ret = SapModel.Func.GetValues("TH-1", NumberItems, MyTime, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

# GetFromFile

## Syntax

SapObject.SapModel.Func.FuncPSD.GetFromFile

## VB6 Procedure

Function GetFromFile(ByVal Name As String, ByRef FileName As String, ByRef HeadLines As
Long, ByRef PreChars As Long, ByRef PointsPerLine As Long, ByRef ValueType As Long,
ByRef FreeFormat As Boolean, ByRef NumberFixed As Long, ByRef FreqTypeInFile As Long)
As Long

## Parameters

Name

The name of a defined power spectral density function specified to be from a text file.

FileName

The full path of the text file containing the function data.

HeadLines

The number of header lines in the text file to be skipped before starting to read function data.

PreChars

The number of prefix characters to be skipped on each line in the text file.

PointsPerLine

The number of function points included on each text file line.

ValueType

This is either 1 or 2, indicating value type.

```
1 = Values at equal time intervals
2 = Time and function values
```
FreeFormat

This item is True if the data is provided in a free format. It is False if it is in a fixed format.

NumberFixed

This item applies only when the FreeFormat item is False. It is the number of characters per item.


FreqTypeInFile

This is either 1 or 2, indicating frequency type.

```
1 = Hz
2 = RPM
```
## Remarks

This function retrieves the definition of a power spectral density function from file.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetPSDFuncFromFile()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim HeadLines As Long
Dim PreChars As Long
Dim PointsPerLine As Long
Dim ValueType As Long
Dim FreeFormat As Boolean
Dim NumberFixed As Long
Dim FreqTypeInFile As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add PSD function from file
ret = SapModel.Func.FuncPSD.SetFromFile("PSD-1", "C:\SapAPI\FuncPSD.txt", 2, 0, 1, 2,
True)

'get PSD function from file
ret = SapModel.Func.FuncPSD.GetFromFile("PSD-1", FileName, HeadLines, PreChars,
PointsPerLine, ValueType, FreeFormat, NumberFixed, FreqTypeInFile)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Text File

Following is the contents of the text file name FuncPSD.txt used in the VBA Example.

Power Spectral Density Function

One pair of Frequency (Hz) and Value items per line

0 1

1 1

2 2

3 2

## Release Notes

Initial release in version 11.02.

## See Also

SetFromFile

# GetUser

## Syntax

SapObject.SapModel.Func.FuncPSD.GetUser

## VB6 Procedure

Function GetUser(ByVal Name As String, ByRef NumberItems As Long, ByRef Frequency() As
Double, ByRef Value() As Double) As Long

## Parameters

Name

The name of a user defined power spectral density function.


NumberItems

The number of frequency and value pairs defined.

Frequency

This is an array that includes the frequency in Hz for each data point. [cyc/s]

Value

This is an array that includes the function value for each data point.

## Remarks

This function retrieves the definition of a user defined power spectral density function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetPSDFuncUser()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Num As Long
Dim Freq() As Double
Dim Val() As Double
Dim NumberItems As Long
Dim Frequency() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add user PSD function
Num = 4
ReDim Freq(Num - 1)
ReDim Val(Num - 1)


Freq(0) = 0: Val(0) = 1
Freq(1) = 1: Val(1) = 1
Freq(2) = 2: Val(2) = 2
Freq(3) = 3: Val(3) = 2
ret = SapModel.Func.FuncPSD.SetUser("PSD-1", Num, Freq, Val)

'get user PSD function
ret = SapModel.Func.FuncPSD.GetUser("PSD-1", NumberItems, Frequency, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetUser

# SetFromFile

## Syntax

SapObject.SapModel.Func.FuncPSD.SetFromFile

## VB6 Procedure

Function SetFromFile(ByVal Name As String, ByVal FileName As String, ByVal HeadLines As
Long, ByVal PreChars As Long, ByVal PointsPerLine As Long, ByVal ValueType As Long,
ByVal FreeFormat As Boolean, Optional ByVal NumberFixed As Long = 10, Optional ByVal
FreqTypeInFile As Long = 1) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

FileName

The full path of the text file containing the function data.

HeadLines


The number of header lines in the text file to be skipped before starting to read function data.

PreChars

The number of prefix characters to be skipped on each line in the text file.

PointsPerLine

The number of function points included on each text file line.

ValueType

This is either 1 or 2, indicating value type.

```
1 = Values at equal time intervals
2 = Time and function values
```
FreeFormat

This item is True if the data is provided in a free format. It is False if it is in a fixed format.

NumberFixed

This item only applies when the FreeFormat item is False. It is the number of characters per item.

FreqTypeInFile

This is either 1 or 2, indicating frequency type.

```
1 = Hz
2 = RPM
```
## Remarks

This function defines a power spectral density function from file.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetPSDFuncFromFile()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add PSD function from file
ret = SapModel.Func.FuncPSD.SetFromFile("PSD-1", "C:\SapAPI\FuncPSD.txt", 2, 0, 1, 2,
True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Text File

Following is the contents of the text file name FuncPSD.txt used in the VBA Example.

Power Spectral Density Function

One pair of Frequency (Hz) and Value items per line

0 1

1 1

2 2

3 2

## Release Notes

Initial release in version 11.02.

## See Also

GetFromFile

# SetUser

## Syntax

SapObject.SapModel.Func.FuncPSD.SetUser


## VB6 Procedure

Function SetUser(ByVal Name As String, ByVal NumberItems As Long, ByRef Frequency() As
Double, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

NumberItems

The number of frequency and value pairs defined.

Frequency

This is an array that includes the frequency in Hz for each data point. [cyc/s]

Value

This is an array that includes the function value for each data point.

## Remarks

This function defines a user power spectral density function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetPSDFuncUser()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim Frequency() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add user PSD function
NumberItems = 4
ReDim Frequency(NumberItems - 1)
ReDim Value(NumberItems - 1)
Frequency(0) = 0: Value(0) = 1
Frequency(1) = 1: Value(1) = 1
Frequency(2) = 2: Value(2) = 2
Frequency(3) = 3: Value(3) = 2
ret = SapModel.Func.FuncPSD.SetUser("PSD-1", NumberItems, Frequency, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetUser

# GetAASHTO2006

## Syntax

SapObject.SapModel.Func.FuncRS.GetAASHTO2006

## VB6 Procedure

Function GetAASHTO2006(ByVal Name As String, ByRef AASHTO2006A As Double, ByRef
AASHTO2006SoilProfileType As Long, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of an AASHTO2006 response spectrum function.

AASHTO2006A


The acceleration coefficient, A.

AASHTO2006SoilProfileType

This is 1, 2, 3 or 4, indicating the soil profile type.

```
1 = I
2 = II
3 = III
4 = IV
```
DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of an AASHTO2006 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncAASHTO2006()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim AASHTO2006A As Double
Dim AASHTO2006SoilProfileType As Long
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add AASHTO2006 RS function
ret = SapModel.Func.FuncRS.SetAASHTO2006("RS-1", 0.3, 4, 0.04)

'get AASHTO2006 RS function


ret = SapModel.Func.FuncRS.GetAASHTO2006("RS-1", AASHTO2006A,
AASHTO2006SoilProfileType, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetAASHTO2006

# GetAASHTO2007

## Syntax

SapObject.SapModel.Func.FuncRS.GetAASHTO2007

## VB6 Procedure

Function GetAASHTO2007(ByVal Name As String, ByRef AASHTO2007Option As Long,
ByRef AASHTO2007Latitude As Double, ByRef AASHTO2007Longitude As Double, ByRef
AASHTO2007ZipCode As String, ByRef AASHTO2007SS As Double, ByRef AASHTO2007S1
As Double, ByRef AASHTO2007PGA As Double, ByRef AASHTO2007SiteClass As Long,
ByRef AASHTO2007Fa As Double, ByRef AASHTO2007Fv As Double, ByRef
AASHTO2007Fpga As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of an AASHTO 20-07 response spectrum function.

AASHTO2007Option

This is 0, 1, or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
AASHTO2007Latitude, AASHTO2007Longitude


The latitude and longitude for which the seismic coefficients are obtained. These items are used
only when AASHTO2007Option = 0.

AASHTO2007ZipCode

The zip code for which the seismic coefficients are obtained. This item is used only when
AASHTO2007Option = 1.

AASHTO2007SS, AASHTO2007S1, AASHTO2007PGA

The seismic coefficients Ss, S1 and PGA. These items are used only when AASHTO2007Option
= 2.

AASHTO2007SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
AASHTO2007Fa, AASHTO2007Fv, AASHTO2007Fpga

The site coefficients Fa, Fv and Fpga. These items are used only when AASHTO2007SiteClass=
6.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a AASHTO 20-07 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncAASHTO2007()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim AASHTO2007Option As Long
Dim AASHTO2007Latitude As Double
Dim AASHTO2007Longitude As Double
Dim AASHTO2007ZipCode As String
Dim AASHTO2007SS As Double
Dim AASHTO2007S1 As Double


Dim AASHTO2007PGA As Double
Dim AASHTO2007SiteClass As Long
Dim AASHTO2007Fa As Double
Dim AASHTO2007Fv As Double
Dim AASHTO2007Fpga As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add AASHTO2007 RS function
ret = SapModel.Func.FuncRS.SetAASHTO2007("RS-1", 1, 0, 0, "94704", 0, 0, 0, 4, 0, 0, 0,
0.04)

'get AASHTO2007 RS function
ret = SapModel.Func.FuncRS.GetAASHTO2007("RS-1", AASHTO2007Option,
AASHTO2007Latitude, AASHTO2007Longitude, AASHTO2007ZipCode, AASHTO2007SS,
AASHTO2007S1, AASHTO2007PGA, AASHTO2007SiteClass, AASHTO2007Fa,
AASHTO2007Fv, AASHTO2007Fpga, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also

SetAASHTO2007


# GetAS11702007

## Syntax

SapObject.SapModel.Func.FuncRS.GetAS11702007

## VB6 Procedure

Function GetAS11702007(ByVal Name As String, ByRef AS2007SiteClass As Long, ByRef
AS2007kp As Double, ByRef AS2007Z As Double, ByRef AS2007Sp As Double, ByRef
AS2007Mu As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a AS 1170 2007 response spectrum function.

AS2007SiteClass

This is 1, 2, 3, 4 or 5, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
AS2007kp

The probability factor, kp.

AS2007Z

The hazard factor, Z.

AS2007Sp

The structural performance factor, Sp.

AS2007Mu

The structural ductility factor, u.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of an AS 1170 2007 response spectrum function.


The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncAS11702007()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim AS2007SiteClass As Long
Dim AS2007kp As Double
Dim AS2007Z As Double
Dim AS2007Sp As Double
Dim AS2007Mu As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add AS 1170 2007 RS function

ret = SapModel.Func.FuncRS.SetAS11702007("RS-1", 3, 1.3, 0.9, 0.77, 2, 0.04)

'get AS 1170 2007 RS function
ret = SapModel.Func.FuncRS.GetAS11702007("RS-1", AS2007SiteClass, AS2007kp,
AS2007Z, AS2007Sp, AS2007Mu, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing

Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.


## See Also

SetAS11702007

# GetBOCA96

## Syntax

SapObject.SapModel.Func.FuncRS.GetBOCA96

## VB6 Procedure

Function GetBOCA96(ByVal Name As String, ByRef BOCA96Aa As Double, ByRef
BOCA96Av As Double, ByRef BOCA96S As Double, ByRef BOCA96R As Double, ByRef
DampRatio As Double) As Long

## Parameters

Name

The name of a BOCA96 response spectrum function.

BOCA96Aa

The effective peak acceleration, Aa.

BOCA96Av

The effective peak velocity, Av.

BOCA96S

The soil profile coefficient, S.

BOCA96R

The response modification factor, R.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a BOCA96 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetRSFuncBOCA96()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim BOCA96Aa As Double
Dim BOCA96Av As Double
Dim BOCA96S As Double
Dim BOCA96R As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add BOCA96 RS function
ret = SapModel.Func.FuncRS.SetBOCA96("RS-1", 0.3, 0.3, 1.2, 1, 0.04)

'get BOCA96 RS function
ret = SapModel.Func.FuncRS.GetBOCA96("RS-1", BOCA96Aa, BOCA96Av, BOCA96S,
BOCA96R, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetBOCA96


# GetChinese2010

## Syntax

SapObject.SapModel.Func.FuncRS.GetChinese2010

## VB6 Procedure

Function GetChinese2010(ByVal Name As String, ByRef JGJ32010AlphaMax As Double, ByRef
JGJ32010SI As Long, ByRef JGJ32010Tg As Double, ByRef JGJ32010PTDF As Double, ByRef
DampRatio As Double) As Long

## Parameters

Name

The name of a Chinese 2010 response spectrum function.

JGJ32010AlphaMax

The maximum influence factor.

JGJ32010SI

This is 1, 2, 3, 4, 5 or 6, indicating the seismic intensity.

```
1 = 6 (0.05g)
2 = 7 (0.10g)
3 = 7 (0.15g)
4 = 8 (0.20g)
5 = 8 (0.30g)
6 = 9 (0.40g)
```
JGJ32010Tg

The characteristic ground period, Tg > 0.1. [s]

JGJ32010PTDF

The period time discount factor.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a Chinese 2010 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetRSFuncChinese2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim JGJ32010AlphaMax As Double
Dim JGJ32010SI As Long
Dim JGJ32010Tg As Double
Dim JGJ32010PTDF As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add Chinese2010 RS function
ret = SapModel.Func.FuncRS.SetChinese2010("RS-1", 0.18, 5, 0.36, 1, 0.04)

'get Chinese2010 RS function
ret = SapModel.Func.FuncRS.GetChinese2010("RS-1", JGJ32010AlphaMax, JGJ32010SI,
JGJ32010Tg, JGJ32010PTDF, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.2.

## See Also

SetChinese2010


# GetCJJ1662011 {RS}

## Syntax

SapObject.SapModel.Func.FuncRS.GetCJJ1662011

## VB6 Procedure

Function GetCJJ1662011(ByVal Name As String, ByRef Direction As Integer, ByRef PeakAccel
As Double, ByRef Tg As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a CJJ 166-2011 response spectrum function.

Direction

This is 1 or 2, indicating the response spectrum direction.

```
1 = Horizontal
2 = Vertical
```
PeakAccel

The peak acceleration, A.

Tg

The characteristic ground period , Tg > 0.1. [s]

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a CJJ 166-2011 response spectrum function.

The function returns zero if the function is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example


Sub GetRSFuncCJJ1662011()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim Direction As Long

Dim PeakAccel As Double

Dim Tg As Double

Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add CJJ 166-2011 RS function
ret = SapModel.Func.FuncRS.SetCJJ1662011("RS-1", 0.35, 0.25, 0.04)

'get CJJ 166-2011 RS function

ret = SapModel.Func.FuncRS.GetCJJ1662011("RS-1", Direction, PeakAccel, Tg, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 18.2.0.

## See Also

SetCJJ1662011


# GetEuroCode8

## Syntax

SapObject.SapModel.Func.FuncRS.GetEuroCode8

## VB6 Procedure

Function GetEuroCode8(ByVal Name As String, ByRef EuroCode8AG As Double, ByRef
EuroCode8S As Long, ByRef EuroCode8n As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a EuroCode8 response spectrum function.

EuroCode8AG

The design ground acceleration, Ag.

EuroCode8S

This is 1, 2 or 3, indicating the subsoil class.

```
1 = A
2 = B
3 = C
```
EuroCode8n

The damping correction factor, n, where n >= 0.7.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a EuroCode8 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncEuroCode8()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim EuroCode8AG As Double
Dim EuroCode8S As Long
Dim EuroCode8n As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add EuroCode8 RS function
ret = SapModel.Func.FuncRS.SetEuroCode8("RS-1", 0.3, 3, 1.2, 0.04)

'get EuroCode8 RS function
ret = SapModel.Func.FuncRS.GetEuroCode8("RS-1", EuroCode8AG, EuroCode8S,
EuroCode8n, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetEuroCode8

# GetEurocode82004_1

## Syntax

SapObject.SapModel.Func.FuncRS.GetEurocode82004_1


## VB6 Procedure

Function GetEurocode82004_1(ByVal Name As String, ByRef EURO2004Country As Long,
ByRef EURO2004Direction As Long, ByRef EURO2004SpectrumType As Long, ByRef
EURO2004GroundType As Long, ByRef EURO2004ag As Double, ByRef EURO2004S As
Double, ByRef EURO2004AvgoverAg As Double, ByRef EURO2004Tb As Double, ByRef
EURO2004Tc As Double, ByRef EURO2004Td As Double, ByRef EURO2004Beta As Double,
ByRef EURO2004q As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a Eurocode 8 2004 response spectrum function.

EURO2004Country

This is 0, 1, 5, 6, or 10 indicating the country for which the Nationally Determined Parameters
(NDPs) are specified.

```
0 = Other (NDPs are user specified)
```
```
1 = CEN Default
```
```
5 = Norway
```
```
6 = Singapore
```
```
10 = Portugal
```
EURO2004Direction

This is 1 or 2, indicating the ground motion direction.

```
1 = Horizontal
```
```
2 = Vertical (Does not apply when EURO2004Country = 6)
```
EURO2004SpectrumType

This is 1 or 2, indicating the spectrum type.

```
1 = Type 1
```
```
2 = Type 2 (Does not apply when EURO2004Country = 5 or 6)
```
EURO2004GroundType

This is 1, 2, 3, 4, 5 or 6, indicating the ground type. This item only applies when the
EURO2004Direction item is 1 (horizontal).

```
1 = A (Does not apply when EURO2004Country = 6)
```

```
2 = B (Does not apply when EURO2004Country = 6)
```
```
3 = C
```
```
4 = D
```
```
5 = E (Does not apply when EURO2004Country = 6)
```
```
6 = S1 (Only applies when EURO2004Country = 6)
```
EURO2004ag

The design ground acceleration in g, ag.

EURO2004S

The soil factor, S. This item only applies when the EURO2004Direction item is 1 (horizontal).

EURO2004AvgoverAg

The vertical ground acceleration divided by the horizontal ground acceleration, Avg/Ag. This item
only applies when the EURO2004Direction item is 2 (vertical).

EURO2004Tb

The lower limit of period of the constant spectral acceleration branch, Tb.

EURO2004Tc

The upper limit of period of the constant spectral acceleration branch, Tc.

EURO2004Td

The period defining the start of the constant displacement range, Td.

EURO2004Beta

The lower bound factor, Beta.

EURO2004q

The behavior factor, q.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a Eurocode 8 2004 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetRSFuncEurocode82004()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim EURO2004Country As Long
Dim EURO2004Direction As Long
Dim EURO2004SpectrumType As Long
Dim EURO2004GroundType As Long
Dim EURO2004ag As Double
Dim EURO2004S As Double
Dim EURO2004AvgoverAg As Double
Dim EURO2004Tb As Double
Dim EURO2004Tc As Double
Dim EURO2004Td As Double
Dim EURO2004Beta As Double
Dim EURO2004q As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add Eurocode 8 2004 RS function
ret = SapModel.Func.FuncRS.SetEurocode82004_1("RS-1", 1, 1, 1, 2, 0.4, 1.2, 0.9, 0.15, 0.5,
2, 0.2, 2, 0.04)

'get Eurocode 8 2004 RS function
ret = SapModel.Func.FuncRS.GetEurocode82004_1("RS-1", EURO2004Country,
EURO2004Direction, EURO2004SpectrumType, EURO2004GroundType, EURO2004ag,
EURO2004S, EURO2004AvgoverAg, EURO2004Tb, EURO2004Tc, EURO2004Td,
EURO2004Beta, EURO2004q, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 14.1.0.

This function supersedes GetEurocode82004.

Added Portugal as a Country parameter in SAP2000 Version 15.0.0 and CSiBridge Version
15.1.0.

Added Singapore as a Country parameter in v20.1.0.

## See Also

SetEurocode82004_1

# GetFromFile

## Syntax

SapObject.SapModel.Func.FuncRS.GetFromFile

## VB6 Procedure

Function GetFromFile(ByVal Name As String, ByRef FileName As String, ByRef HeadLines As
Long, ByRef DampRatio As Double, ByRef ValueType As Long) As Long

## Parameters

Name

The name of a defined response spectrum function specified to be from a text file.

FileName

The full path of the text file containing the function data.

HeadLines

The number of header lines in the text file to be skipped before starting to read function data.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

ValueType

This is either 1 or 2, indicating time value type.

```
1 = Frequency
2 = Period
```

## Remarks

This function retrieves the definition of a response spectrum function from file.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncFromFile()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim HeadLines As Long
Dim DampRatio As Double
Dim ValueType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add RS function from file
ret = SapModel.Func.FuncRS.SetFromFile("RS-1", "C:\SapAPI\FuncRS.txt", 3, 0.04)

'get RS function from file
ret = SapModel.Func.FuncRS.GetFromFile("RS-1", FileName, HeadLines, DampRatio,
ValueType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Text File

Following is the contents of the text file name FuncRS.txt used in the VBA Example.


Reponse Spectrum Function

One pair of Period (sec) and Acceleration (g) values per line

Acceleration values at equal spacing of 0.01 seconds.

0.030 0.500

0.125 1.355

0.587 1.355

0.660 1.355

1.562 0.576

4.000 0.219

10.00 0.037

## Release Notes

Initial release in version 11.02.

## See Also

SetFromFile

# GetJTGB022013

## Syntax

SapObject.SapModel.Func.FuncRS.GetJTGB022013

## VB6 Procedure

Function GetJTGB022013(ByVal Name As String, ByRef Direction As Integer, ByRef PeakAccel
As Double, ByRef Tg As Double, ByRef Ci As Double, ByRef Cs As Double, ByRef DampRatio
As Double) As Long

## Parameters

Name

The name of a JTG B02-2013 response spectrum function.

Direction

This is 1, 2 or 3, indicating the response spectrum direction.


```
1 = Horizontal
2 = Vertical-Rock
3 = Vertical-Soil
```
PeakAccel

The peak acceleration, A.

Tg

The characteristic ground period, Tg > 0.1. [s]

Ci

The importance coefficient.

Cs

The site soil coefficient.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a JTG B02-2013 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncJTGB022013()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Direction As Long
Dim PeakAccel As Double
Dim Tg As Double
Dim Ci As Double
Dim Cs As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add JTG B02-2013 RS function
ret = SapModel.Func.FuncRS.SetJTGB022013("RS-1", 1, 0.18, 0.36, 0.4, 1, 0.04)

'get JTG B02-2013 RS function
ret = SapModel.Func.FuncRS.GetJTGB022013("RS-1", Direction, PeakAccel, Tg, Ci, Cs,
DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v18.2.0.

## See Also

SetJTBG022013

# GetJTGT2231012020

## Syntax

SapObject.SapModel.Func.FuncRS.GetJTGT2231012020

## VB6 Procedure

Function GetJTGT2231012020(ByVal Name As String, ByRef PeakAccel As Double, ByRef Tg
As Double, ByRef Ci As Double, ByRef Cs As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a JTGT2231012020 response spectrum function.

PeakAccel

The peak ground acceleration.


Tg

The characteristic ground period, Tg > 0.1 [s]

Ci

The importance coefficient.

Cs

The site soil coefficient.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a JTGT2231012020 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncJTGT2231012020()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PeakAccel As Double
Dim Tg As Double

Dim Ci As Double

Dim Cs As Double

Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add JTGT2231012020 RS function
ret = SapModel.Func.FuncRS.SetJTGT2231012020("RS-1", 0.18, 0.36, 0.4, 1, 0.04)

'get JTG/T 2231-01-2020 RS function
ret = SapModel.Func.FuncRS.GetJTGT2231012020("RS-1", PeakAccel, Tg, Ci, Cs,
DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v23.2.0

## See Also

SetJTGT2231012020

# GetIBC2003

## Syntax

SapObject.SapModel.Func.FuncRS.GetIBC2003

## VB6 Procedure

Function GetIBC2003(ByVal Name As String, ByRef IBC2003SS As Double, ByRef IBC2003S1
As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a IBC2003 response spectrum function.

IBC2003SS

The design spectral acceleration at short periods, Sds.

IBC2003S1


The design spectral acceleration at a one second period, Sd1.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a IBC2003 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncIBC2003()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim IBC2003SS As Double
Dim IBC2003S1 As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add IBC2003 RS function
ret = SapModel.Func.FuncRS.SetIBC2003("RS-1", 1.2, 0.3, 0.04)

'get IBC2003 RS function
ret = SapModel.Func.FuncRS.GetIBC2003("RS-1", IBC2003SS, IBC2003S1, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

SetIBC2003

# GetIBC2006

## Syntax

SapObject.SapModel.Func.FuncRS.GetIBC2006

## VB6 Procedure

Function GetIBC2006(ByVal Name As String, ByRef IBC2006Option As Long, ByRef
IBC2006Latitude As Double, ByRef IBC2006Longitude As Double, ByRef IBC2006ZipCode As
String, ByRef IBC2006SS As Double, ByRef IBC2006S1 As Double, ByRef IBC2006TL As
Double, ByRef IBC2006SiteClass As Long, ByRef IBC2006Fa As Double, ByRef IBC2006Fv As
Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a IBC2006 response spectrum function.

IBC2006Option

This is 0, 1 or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitiude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
IBC2006Latitude, IBC2006Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are used
only when IBC2006Option = 0.

IBC2006ZipCode

The zip code for which the seismic coefficients are obtained. This item is used only when
IBC2006Option = 1.

IBC2006SS, IBC2006S1

The seismic coefficients Ss and S1. This item is used only when IBC2006Option = 2.


### IBC2006TL

The long-period transition period. [s]

IBC2006SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
IBC2006Fa, IBC2006Fv

The site coefficients Fa and Fv. These items are used only when IBC2006SiteClass= 6.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a IBC2006 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncIBC2006()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim IBC2006Option As Long
Dim IBC2006Latitude As Double
Dim IBC2006Longitude As Double
Dim IBC2006ZipCode As String
Dim IBC2006SS As Double
Dim IBC2006S1 As Double
Dim IBC2006TL As Double
Dim IBC2006SiteClass As Long
Dim IBC2006Fa As Double
Dim IBC2006Fv As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add IBC2006 RS function
ret = SapModel.Func.FuncRS.SetIBC2006("RS-1", 1, 0, 0, "94704", 0, 0, 7.5, 4, 0, 0, 0.04)

'get IBC2006 RS function
ret = SapModel.Func.FuncRS.GetIBC2006("RS-1", IBC2006Option, IBC2006Latitude,
IBC2006Longitude, IBC2006ZipCode, IBC2006SS, IBC2006S1, IBC2006TL, IBC2006SiteClass,
IBC2006Fa, IBC2006Fv, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetIBC2006

# GetIS18932002

## Syntax

SapObject.SapModel.Func.FuncRS.GetIS18932002

## VB6 Procedure

Function GetIS18932002(ByVal Name As String, ByRef INZ As Double, ByRef INS As Long,
ByRef DampRatio As Double) As Long

## Parameters

Name


The name of a IS1893-2002 response spectrum function.

INZ

The seismic zone factor, Z.

INS

This is 1, 2 or 3, indicating the soil type.

```
1 = I
2 = II
3 = III
```
DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a IS1893-2002 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncIS18932002()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim INZ As Double
Dim INS As Long
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add IS18932002 RS function


ret = SapModel.Func.FuncRS.SetIS18932002("RS-1", 0.3, 3, 0.04)

'get IS18932002 RS function
ret = SapModel.Func.FuncRS.GetIS18932002("RS-1", INZ, INS, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetIS18932002

# GetItalian3274

## Syntax

SapObject.SapModel.Func.FuncRS.GetItalian3274

## VB6 Procedure

Function GetItalian3274(ByVal Name As String, ByRef Italag As Double, ByRef ItalSoilType As
Long, ByRef Italq As Double, ByRef ItalLevel As Double, ByRef DampRatio As Double) As
Long

## Parameters

Name

The name of a Italian 3274 response spectrum function.

Italag

The peak ground acceleration.

ItalSoilType

This is 1, 2, 3, 4 or 5, indicating the seismic intensity.

```
1 = A
2 = B
3 = C
4 = E
```

### 5 = D

Italq

The structure factor.

ItalLevel

This is 0, 1, 2, 3, 4, 5, 6 or 7, indicating the spectral level, direction and building type.

```
0 = SLU/H/Building
1 = SLU/H/Bridge
2 = SLU/V/Building
3 = SLU/V/Bridge
4 = EL/H/Building
5 = EL/H/Bridge
6 = EL/V/Building
7 = EL/V/Bridge
```
SLU refers to ultimate strength design and EL refers to elastic design. H and V are horizontal and
vertical, respectively.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a Italian 3274 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncItalian3274()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Italag As Double
Dim ItalSoilType As Long
Dim Italq As Double
Dim ItalLevel As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add Italian3274 RS function
ret = SapModel.Func.FuncRS.SetItalian3274("RS-1", 0.3, 2, 1.1, 4, 0.04)

'get Italian3274 RS function
ret = SapModel.Func.FuncRS.GetItalian3274("RS-1", Italag, ItalSoilType, Italq, ItalLevel,
DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetItalian3274

# GetNBCC2015

## Syntax

SapObject.SapModel.Func.FuncRS.GetNBCC2015

## VB6 Procedure

Function GetNBCC2015(ByVal Name As String, ByRef PGA As Double, ByRef S02 As Double,
ByRef S05 As Double, ByRef S1 As Double, ByRef S2 As Double, ByRef S5 As Double, ByRef
S10 As Double, ByRef SiteClass As Long, ByRef F02 As Double, ByRef F05 As Double, ByRef
F1 As Double, ByRef F2 As Double, ByRef F5 As Double, ByRef F10 As Double, ByRef
DampRatio As Double) As Long

## Parameters

Name


The name of a NBCC2015 response spectrum function.

PGA

The peak ground acceleration.

S02

The spectral acceleration at a 0.2 second period.

S05

The spectral acceleration at a 0.5 second period.

S1

The spectral acceleration at a 1 second period.

S2

The spectral acceleration at a 2 second period.

S5

The spectral acceleration at a 5 second period.

S10

The spectral acceleration at a 10 second period.

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
F02

The site coefficient at a 0.2 second period. This item is read when the site class is F only.

F05

The site coefficient at a 0.5 second period. This item is read when the site class is F only.

F1

The site coefficient at a 1 second period. This item is read when the site class is F only.

F2

The site coefficient at a 2 second period. This item is read when the site class is F only.


### F5

The site coefficient at a 5 second period. This item is read when the site class is F only.

F10

The site coefficient at a 10 second period. This item is read when the site class is F only.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a NBCC2015 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncNBCC2015()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PGA As Double
Dim S02 As Double

Dim S05 As Double

Dim S1 As Double

Dim S2 As Double

Dim S5 As Double

Dim S10 As Double

Dim SiteClass As Long
Dim F02 As Double

Dim F05 As Double

Dim F1 As Double

Dim F2 As Double

Dim F5 As Double

Dim F10 As Double
Dim DampRatio As Double

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NBCC2015 RS function
ret = SapModel.Func.FuncRS.SetNBCC2015("RS-1", 0.6, 1.1, 0.7, 0.35, 0.2, 0.035, 0.01, 6,
1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 0.04)

'get NBCC2015 RS function
ret = SapModel.Func.FuncRS.GetNBCC2015("RS-1", PGA, S02, S05, S1, S2, S5, S10,
SiteClass, F02, F05, F1, F2, F5, F10, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

## See Also

SetNBCC2015

# GetNBCC2010

## Syntax

SapObject.SapModel.Func.FuncRS.GetNBCC2010

## VB6 Procedure


Function GetNBCC2010(ByVal Name As String, ByRef PGA As Double, ByRef S02 As Double,
ByRef S05 As Double, ByRef S1 As Double, ByRef S2 As Double, ByRef SiteClass As Long,
ByRef Fa As Double, ByRef Fv As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a NBCC2010 response spectrum function.

PGA

The peak ground acceleration.

S02

The spectral acceleration at a 0.2 second period.

S05

The spectral acceleration at a 0.5 second period.

S1

The spectral acceleration at a 1 second period.

S2

The spectral acceleration at a 2 second period.

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
Fa

The site coefficient, Fa. This item is read when the site class is F only.

Fv

The site coefficient, Fv. This item is read when the site class is F only.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.


## Remarks

This function retrieves the definition of a NBCC2010 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncNBCC2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PGA As Double
Dim S02 As Double

Dim S05 As Double

Dim S1 As Double

Dim S2 As Double

Dim SiteClass As Long
Dim Fa As Double

Dim Fv As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NBCC2010 RS function
ret = SapModel.Func.FuncRS.SetNBCC2010("RS-1", 0.6, 1.1, 0.7, 0.35, 0.2, 6, 1.8, 2, 0.04)

'get NBCC2010 RS function
ret = SapModel.Func.FuncRS.GetNBCC2010("RS-1", PGA, S02, S05, S1, S2, SiteClass, Fa,
Fv, DampRatio)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

## See Also

SetNBCC2010

# GetNBCC2005

## Syntax

SapObject.SapModel.Func.FuncRS.GetNBCC2005

## VB6 Procedure

Function GetNBCC2005(ByVal Name As String, ByRef NBCC2005PGA As Double, ByRef
NBCC2005S02 As Double, ByRef NBCC2005S05 As Double, ByRef NBCC2005S1 As Double,
ByRef NBCC2005S2 As Double, ByRef NBCC2005SiteClass As Long, ByRef NBCC2005Fa As
Double, ByRef NBCC2005Fv As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a NBCC2005 response spectrum function.

NBCC2005PGA

The peak ground acceleration.

NBCC2005S02

The spectral acceleration at a 0.2 second period.

NBCC2005S05

The spectral acceleration at a 0.52 second period.

NBCC2005S1

The spectral acceleration at a 1 second period.


### NBCC2005S2

The spectral acceleration at a 2 second period.

NBCC2005SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
NBCC2005Fa

The site coefficient, Fa. This item is read when the site class is F only.

NBCC2005Fv

The site coefficient, Fv. This item is read when the site class is F only.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a NBCC2005 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncNBCC2005()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NBCC2005PGA As Double
Dim NBCC2005S02 As Double
Dim NBCC2005S05 As Double
Dim NBCC2005S1 As Double
Dim NBCC2005S2 As Double
Dim NBCC2005SiteClass As Long
Dim NBCC2005Fa As Double
Dim NBCC2005Fv As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NBCC2005 RS function
ret = SapModel.Func.FuncRS.SetNBCC2005("RS-1", 0.6, 1.1, 0.7, 0.35, 0.2, 6, 1.8, 2, 0.04)

'get NBCC2005 RS function
ret = SapModel.Func.FuncRS.GetNBCC2005("RS-1", NBCC2005PGA, NBCC2005S02,
NBCC2005S05, NBCC2005S1, NBCC2005S2, NBCC2005SiteClass, NBCC2005Fa,
NBCC2005Fv, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetNBCC2005

# GetNBCC95

## Syntax

SapObject.SapModel.Func.FuncRS.GetNBCC95

## VB6 Procedure

Function GetNBCC95(ByVal Name As String, ByRef NBCC95ZVR As Double, ByRef
NBCC95ZA As Long, ByRef NBCC95ZV As Long, ByRef DampRatio As Double) As Long

## Parameters


Name

The name of a NBCC95 response spectrum function.

NBCC95ZVR

The zonal velocity ratio.

NBCC95ZA

The acceleration-related seismic zone.

NBCC95ZV

The velocity-related seismic zone.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a NBCC95 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncNBCC95()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NBCC95ZVR As Double
Dim NBCC95ZA As Long
Dim NBCC95ZV As Long
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add NBCC95 RS function
ret = SapModel.Func.FuncRS.SetNBCC95("RS-1", 0.3, 5, 5, 0.04)

'get NBCC95 RS function
ret = SapModel.Func.FuncRS.GetNBCC95("RS-1", NBCC95ZVR, NBCC95ZA,
NBCC95ZV, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetNBCC95

# GetNCHRP2007

## Syntax

SapObject.SapModel.Func.FuncRS.GetNCHRP2007

## VB6 Procedure

Function GetNCHRP2007(ByVal Name As String, ByRef NCHRP2007Option As Long, ByRef
NCHRP2007Latitude As Double, ByRef NCHRP2007Longitude As Double, ByRef
NCHRP2007ZipCode As String, ByRef NCHRP2007SS As Double, ByRef NCHRP2007S1 As
Double, ByRef NCHRP2007SiteClass As Long, ByRef NCHRP2007Fa As Double, ByRef
NCHRP2007Fv As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a NCHRP 20-07 response spectrum function.

NCHRP2007Option

This is 0, 1 or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitiude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```

NCHRP2007Latitude, NCHRP2007Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are used
only when NCHRP2007Option = 0.

NCHRP2007ZipCode

The zip code for which the seismic coefficients are obtained. This item is used only when
NCHRP2007Option = 1.

NCHRP2007SS, NCHRP2007S1

The seismic coefficients Ss and S1. This item is used only when NCHRP2007Option = 2.

NCHRP2007SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
NCHRP2007Fa, NCHRP2007Fv

The site coefficients Fa and Fv. These items are used only when NCHRP2007SiteClass= 6.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a NCHRP 20-07 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncNCHRP2007()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NCHRP2007Option As Long
Dim NCHRP2007Latitude As Double
Dim NCHRP2007Longitude As Double
Dim NCHRP2007ZipCode As String
Dim NCHRP2007SS As Double
Dim NCHRP2007S1 As Double


Dim NCHRP2007SiteClass As Long
Dim NCHRP2007Fa As Double
Dim NCHRP2007Fv As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NCHRP2007 RS function
ret = SapModel.Func.FuncRS.SetNCHRP2007("RS-1", 1, 0, 0, "94704", 0, 0, 4, 0, 0, 0.04)

'get NCHRP2007 RS function
ret = SapModel.Func.FuncRS.GetNCHRP2007("RS-1", NCHRP2007Option,
NCHRP2007Latitude, NCHRP2007Longitude, NCHRP2007ZipCode, NCHRP2007SS,
NCHRP2007S1, NCHRP2007SiteClass, NCHRP2007Fa, NCHRP2007Fv, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetNCHRP2007

# GetNEHRP97

## Syntax

SapObject.SapModel.Func.FuncRS.GetNEHRP97


## VB6 Procedure

Function GetNEHRP97(ByVal Name As String, ByRef NEHRP97SS As Double, ByRef
NEHRP97S1 As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a NEHRP97 response spectrum function.

NEHRP97SS

The design spectral acceleration at short periods, Sds.

NEHRP97S1

The design spectral acceleration at a one second period, Sd1.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a NEHRP97 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncNEHRP97()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NEHRP97SS As Double
Dim NEHRP97S1 As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NEHRP97 RS function
ret = SapModel.Func.FuncRS.SetNEHRP97("RS-1", 1.2, 0.3, 0.04)

'get NEHRP97 RS function
ret = SapModel.Func.FuncRS.GetNEHRP97("RS-1", NEHRP97SS, NEHRP97S1,
DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetNEHRP97

# GetNZS11702004_1

## Syntax

SapObject.SapModel.Func.FuncRS.GetNZS11702004_1

## VB6 Procedure

Function GetNZS11702004_1(ByVal Name As String, ByRef NZS2004SpectrumType As Long,
ByRef NZS2004SiteClass As Long, ByRef NZS2004Z As Double, ByRef NZS2004R As Double,
ByRef NZS2004DIST As Double, ByRef NZS2004ConsiderTSite As Boolean, ByRef
NZS2004TSite As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a NZS 1170 2004 response spectrum function.

NZS2004SpectrumType

This is 1 or 2, indicating the spectrum type.


```
1 = Horizontal
2 = Vertical
```
NZS2004SiteClass

This is 1, 2, 3, 4 or 5, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
NZS2004Z

The hazard factor, Z.

NZS2004R

The return period factor, R.

NZS2004DIST

Distance to the fault in km, used to calculate the near fault factor.

NZS2004ConsiderTSite

Indicates whether to consider the site period for the spectral shape factor.

NZS2004TSite

The low amplitude site period.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of an NZS 1170 2004 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncNZS11702004()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim NZS2004SpectrumType As Long
Dim NZS2004SiteClass As Long
Dim NZS2004Z As Double
Dim NZS2004R As Double
Dim NZS2004DIST As Double

Dim NZS2004ConsiderTSite As Boolean

Dim NZS2004TSite As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NZS 1170 2004 RS function
ret = SapModel.Func.FuncRS.SetNZS11702004_1("RS-1", 1, 3, 0.4, 1.3, 20, True, 1, 0.04)

'get NZS 1170 2004 RS function
ret = SapModel.Func.FuncRS.GetNZS11702004_1("RS-1", NZS2004SpectrumType,
NZS2004SiteClass, NZS2004Z, NZS2004R, NZS2004DIST, NZS2004ConsiderTSite,
NZS2004TSite, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

This function supersedes GetNZS11702004

## See Also

SetNZS11702004_1


# GetNZS42031992

## Syntax

SapObject.SapModel.Func.FuncRS.GetNZS42031992

## VB6 Procedure

Function GetNZS42031992(ByVal Name As String, ByRef NZS4203SF As Double, ByRef
NZS4203S As Long, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a NZS4203-1992 response spectrum function.

NZS4203SF

The scaling factor (Sm * Sp * R * Z * L).

NZS4203S

This is 1, 2 or 3, indicating the site subsoil category.

```
1 = A
2 = B
3 = C
```
DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a NZS4203-1992 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncNZS42031992()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NZS4203SF As Double
Dim NZS4203S As Long


Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel
'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NZS42031992 RS function
ret = SapModel.Func.FuncRS.SetNZS42031992("RS-1", 1.2, 3, 0.04)

'get NZS42031992 RS function
ret = SapModel.Func.FuncRS.GetNZS42031992("RS-1", NZS4203SF, NZS4203S,
DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetNZS42031992

# GetNTC2008

## Syntax

SapObject.SapModel.Func.FuncRS.GetNTC2008

## VB6 Procedure

Function GetNTC2008(ByVal Name As String, ByRef ParamsOption As Long, ByRef Latitude
As Double, ByRef Longitude As Double, ByRef Island As Long, ByRef LimitState As Long,
ByRef UsageClass As Long, ByRef NomLife As Double, ByRef PeakAccel As Double, ByRef F0
As Double, ByRef Tcs As Double, ByRef SpecType As Long, ByRef SoilType As Long, ByRef


Topography As Long, ByRef hRatio As Double, ByRef Damping As Double, ByRef q As
Double) As Long

## Parameters

Name

The name of a NTC2008 response spectrum function.

ParamsOption

This is 1, 2, or 3, indicating the option for defining the parameters.

```
1 = by latitude and longitude
2 = by island
3 = user specified
```
Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are
meaningful only when ParamsOption = 1.

Island

This is one of the following values. This item is used only when ParamsOption = 2.

```
1 = Alicudi
2 = Arcipelago Toscano
3 = Filcudi
4 = Isole Egadi
5 = Lampedusa
6 = Linosa
7 = Lipari
8 = Palmarola
9 = Panarea
10 = Pantelleria
11 = Ponza
12 = Salina
13 = Santo Stefano
14 = Sardegna
15 = Stromboli
16 = Tremiti
17 = Ustica
18 = Ventotene
19 = Vulcano
20 = Zannone
```
LimitState

This is 1, 2, 3, or 4, indicating the limit state.

```
1 = SLO
2 = SLD
3 = SLV
```

### 4 = SLC

UsageClass

This is 1, 2, 3, or 4, indicating the usage class.

```
1 = I
2 = II
3 = III
4 = IV
```
NomLife

The nominal life to be considered.

PeakAccel

The peak ground acceleration, ag/g.

F0

The magnitude factor, F0.

Tcs

The reference period, Tc* [s].

SpecType

This is 1, 2, 3, or 4, indicating the type of spectrum to consider.

```
1 = Elastic horizontal
2 = Elastic vertical
3 = Design horizontal
4 = Design vertical
```
SoilType

This is 1, 2, 3, 4, or 5, indicating the subsoil type.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
Topography

This is 1, 2, 3, or 4, indicating the topography type.

```
1 = T1
2 = T2
3 = T3
4 = T4
```

hRatio

The ratio for the site altitude at the base of the hill to the height of the hill.

Damping

The damping, in percent. This is only applicable for SpecType 1 and 2.

q

The behavior correction factor. This is only applicable for SpecType 3 and 4.

## Remarks

This function retrieves the definition of a NTC2008 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub GetRSFuncNTC2008()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim ParamsOption As Long

Dim Latitude As Double

Dim Longitude As Double

Dim Island As Long

Dim LimitState As Long

Dim UsageClass As Long

Dim NomLife As Double

Dim PeakAccel As Double

Dim F0 As Double

Dim Tcs As Double

Dim SpecType As Long

Dim SoilType As Long

Dim Topography As Long

Dim hRatio As Double


Dim Damping As Double

Dim q As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NTC2008 RS function
ret = SapModel.Func.FuncRS.SetNTC2008("RS-1", 1, 45.9, 12.6, 1, 3, 2, 50, 0.2, 2.4, 0.3, 3,
2, 1, 1, 5, 1)

'get NTC2008 RS function

ret = SapModel.Func.FuncRS.GetNTC2008("RS-1", ParamsOption, Latitude, Longitude,
Island, LimitState, UsageClass, NomLife, PeakAccel, F0, Tcs, SpecType, SoilType, Topography,
hRatio, Damping, q)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 18.1.0.

## See Also

SetNTC2008

# GetNTC2018

## Syntax

SapObject.SapModel.Func.FuncRS.GetNTC2018


## VB6 Procedure

Function GetNTC2018(ByVal Name As String, ByRef ParamsOption As Long, ByRef Latitude
As Double, ByRef Longitude As Double, ByRef Island As Long, ByRef LimitState As Long,
ByRef UsageClass As Long, ByRef NomLife As Double, ByRef PeakAccel As Double, ByRef F0
As Double, ByRef Tcs As Double, ByRef SpecType As Long, ByRef SoilType As Long, ByRef
Topography As Long, ByRef hRatio As Double, ByRef Damping As Double, ByRef q As
Double) As Long

## Parameters

Name

The name of a NTC2018 response spectrum function.

ParamsOption

This is 1, 2, or 3, indicating the option for defining the parameters.

```
1 = by latitude and longitude
2 = by island
3 = user specified
```
Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are
meaningful only when ParamsOption = 1.

Island

This is one of the following values. This item is used only when ParamsOption = 2.

```
1 = Alicudi
2 = Arcipelago Toscano
3 = Filcudi
4 = Isole Egadi
5 = Lampedusa
6 = Linosa
7 = Lipari
8 = Palmarola
9 = Panarea
10 = Pantelleria
11 = Ponza
12 = Salina
13 = Santo Stefano
14 = Sardegna
15 = Stromboli
16 = Tremiti
17 = Ustica
18 = Ventotene
19 = Vulcano
20 = Zannone
```

LimitState

This is 1, 2, 3, or 4, indicating the limit state.

```
1 = SLO
2 = SLD
3 = SLV
4 = SLC
```
UsageClass

This is 1, 2, 3, or 4, indicating the usage class.

```
1 = I
2 = II
3 = III
4 = IV
```
NomLife

The nominal life to be considered.

PeakAccel

The peak ground acceleration, ag/g.

F0

The magnitude factor, F0.

Tcs

The reference period, Tc* [s].

SpecType

This is 1, 2, 3, or 4, indicating the type of spectrum to consider.

```
1 = Elastic horizontal
2 = Elastic vertical
3 = Design horizontal
4 = Design vertical
```
SoilType

This is 1, 2, 3, 4, or 5, indicating the subsoil type.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
Topography


This is 1, 2, 3, or 4, indicating the topography type.

```
1 = T1
2 = T2
3 = T3
4 = T4
```
hRatio

The ratio for the site altitude at the base of the hill to the height of the hill.

Damping

The damping, in percent. This is only applicable for SpecType 1 and 2.

q

The behavior correction factor. This is only applicable for SpecType 3 and 4.

## Remarks

This function retrieves the definition of a NTC2018 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub GetRSFuncNTC2018()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim ParamsOption As Long

Dim Latitude As Double

Dim Longitude As Double

Dim Island As Long

Dim LimitState As Long

Dim UsageClass As Long

Dim NomLife As Double

Dim PeakAccel As Double

Dim F0 As Double

Dim Tcs As Double


Dim SpecType As Long

Dim SoilType As Long

Dim Topography As Long

Dim hRatio As Double

Dim Damping As Double

Dim q As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NTC2018 RS function
ret = SapModel.Func.FuncRS.SetNTC2018("RS-1", 1, 45.9, 12.6, 1, 3, 2, 50, 0.2, 2.4, 0.3, 3,
2, 1, 1, 5, 1)

'get NTC2018 RS function

ret = SapModel.Func.FuncRS.GetNTC2018("RS-1", ParamsOption, Latitude, Longitude,
Island, LimitState, UsageClass, NomLife, PeakAccel, F0, Tcs, SpecType, SoilType, Topography,
hRatio, Damping, q)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v20.1.0.

## See Also

SetNTC2018


# GetSP14133302014

## Syntax

SapObject.SapModel.Func.FuncRS.GetSP14133302014

## VB6 Procedure

Function GetSP14133302014(ByVal Name As String, ByRef Direction As Long, ByRef
Seismicity As Long, ByRef SoilCat As Long, ByRef K0Factor As Double, ByRef K1Factor As
Double, ByRef KPsiFactor As Double, ByRef NonlinSoil As Boolean, ByRef ASoil As Double,
ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a SP 14.13330.2014 response spectrum function.

Direction

This is 1, 2, 3, or 4, indicating the direction and structure type for which the response spectrum is
generated.

```
1 = Building Horizontal
2 = Building Vertical
3 = Bridge Horizontal
4 = Bridge Vertical
```
Seismicity

This is 1, 2, 3, or 4, indicating the region seismicity of the construction site.

```
1 = 6
2 = 7
3 = 8
4 = 9
```
SoilCat

This is 1, 2, 3, or 4, indicating the soil category.

```
1 = I
2 = II
3 = III
4 = IV
```

K0Factor

The K0Factor, 0 < K0 <= 2.0. This is only applicable when the Direction parameter is 1 or 3 for
horizontal spectra.

K1Factor

The K1Factor, 0 < K1 <= 1.0.

KPsiFactor

The KPsiFactor, 0.5 < KPsi <= 1.5. This is only applicable when the Direction parameter is 1 or 3
for horizontal spectra.

NonlinSoil

This item is True if nonlinear soil deformation should be accounted for. This is only applicable
when the Direction parameter is 1 or 2 for buildings and the SoilCat parameter is 3 or 4.

ASoil

The nonlinear soil deformation factor, 0 > a_soil <= 1.0. This is only applicable when the
NonlinSoil parameter is True, the Direction parameter is 1 or 2 buildings, and the SoilCat
parameter is 3 or 4.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a SP 14.13330.2014 response spectrum function.

The function returns zero if the function is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetRSFuncSP14133302014()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim Direction As Long

Dim Seismicity As Long

Dim SoilCat As Long

Dim K0Factor As Double

Dim K1Factor As Double


Dim KPsiFactor As Double

Dim NonlinSoil As Boolean

Dim ASoil As Double

Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add SP 14.13330.2014 RS function
ret = SapModel.Func.FuncRS.SetSP14133302014("RS-1", 1, 2, 2, 1.0, 0.25, 1.0, False, 0.7,
0.04)

'get SP 14.13330.2014 RS function

ret = SapModel.Func.FuncRS.GetSP14133302014("RS-1", Direction, Seismicity, SoilCat,
K0Factor, K1Factor, KPsiFactor, NonlinSoil, ASoil, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 18.2.0.

## See Also

SetSP14133302014


# GetUBC94

## Syntax

SapObject.SapModel.Func.FuncRS.GetUBC94

## VB6 Procedure

Function GetUBC94(ByVal Name As String, ByRef UBC94Z As Double, ByRef UBC94S As
Long, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a UBC94 response spectrum function.

UBC94Z

The seismic zone factor, Z.

UBC94S

This is 1, 2 or 3, indicating the soil type.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a UBC94 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncUBC94()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim UBC94Z As Double
Dim UBC94S As Long
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add UBC94 RS function
ret = SapModel.Func.FuncRS.SetUBC94("RS-1", 0.35, 3, 0.04)

'get UBC94 RS function
ret = SapModel.Func.FuncRS.GetUBC94("RS-1", UBC94Z, UBC94S, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetUBC94

# GetUBC97

## Syntax

SapObject.SapModel.Func.FuncRS.GetUBC97

## VB6 Procedure

Function GetUBC97(ByVal Name As String, ByRef UBC97Ca As Double, ByRef UBC97Cv As
Double, ByRef DampRatio As Double) As Long

## Parameters

Name


The name of a UBC97 response spectrum function.

UBC97Ca

The seismic coefficient, Ca.

UBC97Cv

The seismic coefficient, Cv.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a UBC97 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncUBC97()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim UBC97Ca As Double
Dim UBC97Cv As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add UBC97 RS function
ret = SapModel.Func.FuncRS.SetUBC97("RS-1", 0.36, 0.54, 0.04)

'get UBC97 RS function
ret = SapModel.Func.FuncRS.GetUBC97("RS-1", UBC97Ca, UBC97Cv, DampRatio)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetUBC97

# GetUser

## Syntax

SapObject.SapModel.Func.FuncRS.GetUser

## VB6 Procedure

Function GetUser(ByVal Name As String, ByRef NumberItems As Long, ByRef Period() As
Double, ByRef Value() As Double, ByRef DampRatio As Double) As Long

## Parameters

Name

The name of a user defined response spectrum function.

NumberItems

The number of frequency and value pairs defined.

Period

This is an array that includes the time for each data point. [s]

Value

This is an array that includes the function value for each data point.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.


## Remarks

This function retrieves the definition of a user defined response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRSFuncUser()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Num As Long
Dim Tmp() As Double
Dim Val() As Double
Dim NumberItems As Long
Dim Period() As Double
Dim Value() As Double
Dim DampRatio As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add user RS function
NumberItems = 6
ReDim Tmp(NumberItems - 1)
ReDim Val(NumberItems - 1)
Tmp(0) = 0.03: Val(0) = 0.4
Tmp(1) = 0.05: Val(1) = 2.2
Tmp(2) = 0.80: Val(2) = 2.2
Tmp(3) = 1.20: Val(3) = 1.0
Tmp(4) = 4.00: Val(4) = 0.2
Tmp(5) = 10.0: Val(5) = 0.05
ret = SapModel.Func.FuncRS.SetUser("RS-1", NumberItems, Tmp, Val, 0.04)

'get user RS function
ret = SapModel.Func.FuncRS.GetUser("RS-1", NumberItems, Period, Value, DampRatio)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetUser

# SetAASHTO2006

## Syntax

SapObject.SapModel.Func.FuncRS.SetAASHTO2006

## VB6 Procedure

Function SetAASHTO2006(ByVal Name As String, ByVal AASHTO2006A As Double, ByVal
AASHTO2006SoilProfileType As Long, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function then that function is
modified, otherwise, a new function is added.

AASHTO2006A

The acceleration coefficient, A.

AASHTO2006SoilProfileType

This is 1, 2, 3 or 4, indicating the soil profile type.

```
1 = I
2 = II
3 = III
4 = IV
```
DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.


## Remarks

This function defines an AASHTO2006 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncAASHTO2006()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add AASHTO2006 RS function
ret = SapModel.Func.FuncRS.SetAASHTO2006("RS-1", 0.3, 4, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetAASHTO2006

# SetAASHTO2007


## Syntax

SapObject.SapModel.Func.FuncRS.SetAASHTO2007

## VB6 Procedure

Function SetAASHTO2007(ByVal Name As String, ByVal AASHTO2007Option As Long,
ByVal AASHTO2007Latitude As Double, ByVal AASHTO2007Longitude As Double, ByVal
AASHTO2007ZipCode As String, ByVal AASHTO2007SS As Double, ByVal AASHTO2007S1
As Double, ByVal AASHTO2007PGA As Double, ByVal AASHTO2007SiteClass As Long,
ByVal AASHTO2007Fa As Double, ByRef AASHTO2007Fv As Double, ByVal
AASHTO2007Fpga As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

AASHTO2007Option

This is 0, 1 or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
AASHTO2007Latitude, AASHTO2007Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are used
only when AASHTO2007Option = 0.

AASHTO2007ZipCode

The zip code for which the seismic coefficients are obtained. This item is used only when
AASHTO2007Option = 1.

AASHTO2007SS, AASHTO2007S1, AASHTO2007PGA

The seismic coefficients Ss, S1 and PGA. These items are used only when AASHTO2007Option
= 2.

AASHTO2007SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```

### 6 = F

AASHTO2007Fa, AASHTO2007Fv, AASHTO2007Fpga

The site coefficients Fa, Fv and Fpga. These items are used only when AASHTO2007SiteClass=
6.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a AASHTO 2007 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncAASHTO2007()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add AASHTO2007 RS function
ret = SapModel.Func.FuncRS.SetAASHTO2007("RS-1", 1, 0, 0, "94704", 0, 0, 0, 4, 0, 0, 0,
0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 14.00.

## See Also

GetAASHTO2007

# SetAS11702007

## Syntax

SapObject.SapModel.Func.FuncRS.SetAS11702007

## VB6 Procedure

Function SetAS11702007(ByVal Name As String, ByVal AS2007SiteClass As Long, ByVal
AS2007kp As Double, ByVal AS2007Z As Double, ByVal AS2007Sp As Double, ByVal
AS2007Mu As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function then that function is
modified, otherwise, a new function is added.

AS2007SiteClass

This is 1, 2, 3, 4 or 5, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
AS2007kp

The probability factor, kp.

AS2007Z

The hazard factor, Z.

AS2007Sp

The structural performance factor, Sp.

AS2007Mu


The structural ductility factor, u.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines an AS 1170.4 2007 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncAS11702007()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add AS 1170 2007 RS function
ret = SapModel.Func.FuncRS.SetAS11702007("RS-1", 3, 1.3, 0.9, 0.77, 2, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.


## See Also

GetAS11702007

# SetBOCA96

## Syntax

SapObject.SapModel.Func.FuncRS.SetBOCA96

## VB6 Procedure

Function SetBOCA96(ByVal Name As String, ByVal BOCA96Aa As Double, ByVal
BOCA96Av As Double, ByVal BOCA96S As Double, ByVal BOCA96R As Double, ByVal
DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

BOCA96Aa

The effective peak acceleration, Aa.

BOCA96Av

The effective peak velocity, Av.

BOCA96S

The soil profile coefficient, S.

BOCA96R

The response modification factor, R.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a BOCA96 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.


## VBA Example

Sub SetRSFuncBOCA96()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add BOCA96 RS function
ret = SapModel.Func.FuncRS.SetBOCA96("RS-1", 0.3, 0.3, 1.2, 1, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetBOCA96

# SetChinese2010

## Syntax

SapObject.SapModel.Func.FuncRS.SetChinese2010

## VB6 Procedure


Function SetChinese2010(ByVal Name As String, ByVal JGJ32010AlphaMax As Double, ByVal
JGJ32010SI As Long, ByVal JGJ32010Tg As Double, ByVal JGJ32010PTDF As Double, ByVal
DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

JGJ32010AlphaMax

The maximum influence factor.

JGJ32010SI

This is 1, 2, 3, 4, 5 or 6, indicating the seismic intensity.

```
1 = 6 (0.05g)
2 = 7 (0.10g)
3 = 7 (0.15g)
4 = 8 (0.20g)
5 = 8 (0.30g)
6 = 9 (0.40g)
```
JGJ32010Tg

The characteristic ground period, Tg > 0.1. [s]

JGJ32010PTDF

The period time discount factor.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a Chinese 2010 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncChinese2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add Chinese2010 RS function
ret = SapModel.Func.FuncRS.SetChinese2010("RS-1", 0.18, 5, 0.36, 1, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.2.

## See Also

GetChinese2010

# SetCJJ1662011

## Syntax

SapObject.SapModel.Func.FuncRS.SetCJJ1662011

## VB6 Procedure

Function SetCJJ1662011(ByVal Name As String, ByVal Direction As Long, ByVal PeakAccel As
Double, ByVal Tg As Double, ByVal DampRatio As Double) As Long

## Parameters

Name


The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

Direction

This is 1 or 2, indicating the response spectrum direction.

```
1 = Horizontal
2 = Vertical
```
PeakAccel

The peak acceleration, A.

Tg

The characteristic ground period, Tg > 0.1. [s]

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a CJJ 166-2011 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncCJJ1662011()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add CJJ 166-2011 RS function
ret = SapModel.Func.FuncRS.SetCJJ1662011("RS-1", 1, 0.35, 0.25, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v18.2.0.

## See Also

GetCJJ1662011

# SetEuroCode8

## Syntax

SapObject.SapModel.Func.FuncRS.SetEuroCode8

## VB6 Procedure

Function SetEuroCode8(ByVal Name As String, ByVal EuroCode8AG As Double, ByVal
EuroCode8S As Long, ByVal EuroCode8n As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

EuroCode8AG

The design ground acceleration, Ag.

EuroCode8S

This is 1, 2 or 3, indicating the subsoil class.

```
1 = A
2 = B
3 = C
```
EuroCode8n


The damping correction factor, n, where n >= 0.7.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a EuroCode8 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncEuroCode8()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add EuroCode8 RS function
ret = SapModel.Func.FuncRS.SetEuroCode8("RS-1", 0.3, 3, 1.2, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

GetEuroCode8

# SetEurocode82004_1

## Syntax

SapObject.SapModel.Func.FuncRS.SetEurocode82004_1

## VB6 Procedure

Function SetEurocode82004_1(ByVal Name As String, ByVal EURO2004Country As Long,
ByVal EURO2004Direction As Long, ByVal EURO2004SpectrumType As Long, ByVal
EURO2004GroundType As Long, ByVal EURO2004ag As Double, ByVal EURO2004S As
Double, ByVal EURO2004AvgoverAg As Double, ByVal EURO2004Tb As Double, ByVal
EURO2004Tc As Double, ByVal EURO2004Td As Double, ByVal EURO2004Beta As Double,
ByVal EURO2004q As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function,n that function is modified;
otherwise, a new function is added.

EURO2004Country

This is 0, 1, 5, 6, or 10 indicating the country for which the Nationally Determined Parameters
(NDPs) are specified.

```
0 = Other (NDPs are user specified)
```
```
1 = CEN Default
```
```
5 = Norway
```
```
6 = Singapore
```
```
10 = Portugal
```
EURO2004Direction

This is 1 or 2, indicating the ground motion direction.

```
1 = Horizontal
```
```
2 = Vertical (Does not apply when EURO2004Country = 6)
```

EURO2004SpectrumType

This is 1 or 2, indicating the spectrum type.

```
1 = Type 1
```
```
2 = Type 2 (Does not apply when EURO2004Country = 5 or 6)
```
EURO2004GroundType

This is 1, 2, 3, 4, 5 or 6, indicating the ground type. This item only applies when the
EURO2004Direction item is 1 (horizontal).

```
1 = A (Does not apply when EURO2004Country = 6)
```
```
2 = B (Does not apply when EURO2004Country = 6)
```
```
3 = C
```
```
4 = D
```
```
5 = E (Does not apply when EURO2004Country = 6)
```
```
6 = S1 (Only applies when EURO2004Country = 6)
```
EURO2004ag

The design ground acceleration in g, ag.

EURO2004S

The soil factor, S. This item only applies when the EURO2004Direction item is 1 (horizontal). If
the EURO2004Country item is not 0, then the input value for this item is ignored.

EURO2004AvgoverAg

The vertical ground acceleration divided by the horizontal ground acceleration, Avg/Ag. This item
only applies when the EURO2004Direction item is 2 (vertical). If the EURO2004Country item is
not 0, then the input value for this item is ignored.

EURO2004Tb

The lower limit of period of the constant spectral acceleration branch, Tb. If the
EURO2004Country item is not 0, then the input value for this item is ignored.

EURO2004Tc

The upper limit of period of the constant spectral acceleration branch, Tc. If the
EURO2004Country item is not 0, then the input value for this item is ignored.

EURO2004Td

The period defining the start of the constant displacement range, Td. If the EURO2004Country
item is not 0, then the input value for this item is ignored.

EURO2004Beta


The lower bound factor, Beta. If the EURO2004Country item is not 0, then the input value for this
item is ignored.

EURO2004q

The behavior factor, q.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a Eurocode 8 2004 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncEurocode82004()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add Eurocode 8 2004 RS function
ret = SapModel.Func.FuncRS.SetEurocode82004_1("RS-1", 1, 1, 1, 2, 0.4, 1.2, 0.9, 0.15, 0.5,
2, 0.2, 2, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 14.1.0.

This function supersedes SetEurocode82004.

Added Portugal as a Country parameter in SAP2000 Version 15.0.0 and CSiBridge Version
15.1.0.

Added Singapore as a Country parameter in v20.1.0.

## See Also

GetEurocode82004_1

# SetFromFile

## Syntax

SapObject.SapModel.Func.FuncRS.SetFromFile

## VB6 Procedure

Function SetFromFile(ByVal Name As String, ByVal FileName As String, ByVal HeadLines As
Long, ByVal DampRatio As Double, Optional ByVal ValueType As Long = 2) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function. that function is modified;
otherwise, a new function is added.

FileName

The full path of the text file containing the function data.

HeadLines

The number of header lines in the text file to be skipped before starting to read function data.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

ValueType

This is either 1 or 2, indicating time value type.

```
1 = Frequency
```

```
2 = Period
```
## Remarks

This function defines a response spectrum function from file.

The function returns zero if the function is successfully defined, otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncFromFile()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add RS function from file
ret = SapModel.Func.FuncRS.SetFromFile("RS-1", "C:\SapAPI\FuncRS.txt", 3, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Text File

Following is the contents of the text file name FuncRS.txt used in the VBA Example.

Reponse Spectrum Function

One pair of Period (sec) and Acceleration (g) values per line

Acceleration values at equal spacing of 0.01 seconds.


### 0.030 0.500

### 0.125 1.355

### 0.587 1.355

### 0.660 1.355

### 1.562 0.576

### 4.000 0.219

### 10.00 0.037

## Release Notes

Initial release in version 11.02.

## See Also

GetFromFile

# SetJTBG022013

## Syntax

SapObject.SapModel.Func.FuncRS.SetJTGB022013

## VB6 Procedure

Function SetJTGB022013(ByVal Name As String, ByVal Direction As Long, ByVal PeakAccel
As Double, ByVal Tg As Double, ByVal Ci As Double, ByVal Cs As Double, ByVal DampRatio
As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

Direction

This is 1, 2 or 3, indicating the response spectrum direction.

```
1 = Horizontal
2 = Vertical-Rock
3 = Vertical-Soil
```
PeakAccel


The peak acceleration, A.

Tg

The characteristic ground period, Tg > 0.1. [s]

Ci

The importance coefficient.

Cs

The site soil coefficient.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a JTG B02-2013 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncJTGB022013()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add JTG B02-2013 RS function
ret = SapModel.Func.FuncRS.SetJTGB022013("RS-1", 1, 0.18, 0.36, 0.4, 1, 0.04)

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v18.2.0.

## See Also

GetJTBG022013

# SetJTGT2231012020

## Syntax

SapObject.SapModel.Func.FuncRS.SetJTGT2231012020

## VB6 Procedure

Function SetJTGT2231012020(ByVal Name As String, ByVal PeakAccel As Double, ByVal Tg
As Double, ByVal Ci As Double, ByVal Cs As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of a JTGT2231012020 response spectrum function.

PeakAccel

The peak ground acceleration.

Tg

The characteristic ground period, Tg > 0.1 [s]

Ci

The importance coefficient.

Cs

The site soil coefficient.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.


## Remarks

This function retrieves the definition of a JTGT2231012020 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub SetRSFuncJTGT2231012020()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add JTG/T 2231-01-2020 RS function
ret = SapModel.Func.FuncRS.SetJTGT2231012020("RS-1", 0.18, 0.36, 0.4, 1, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v23.2.0

## See Also

GetJTGT2231012020


# SetIBC2003

## Syntax

SapObject.SapModel.Func.FuncRS.SetIBC2003

## VB6 Procedure

Function SetIBC2003(ByVal Name As String, ByVal IBC2003SS As Double, ByVal IBC2003S1
As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function then that function is
modified, otherwise, a new function is added.

IBC2003SS

The design spectral acceleration at short periods, Sds.

IBC2003S1

The design spectral acceleration at a one second period, Sd1.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a IBC2003 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncIBC2003()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add IBC2003 RS function
ret = SapModel.Func.FuncRS.SetIBC2003("RS-1", 1.2, 0.3, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetIBC2003

# SetIBC2006

## Syntax

SapObject.SapModel.Func.FuncRS.SetIBC2006

## VB6 Procedure

Function SetIBC2006(ByVal Name As String, ByVal IBC2006Option As Long, ByVal
IBC2006Latitude As Double, ByVal IBC2006Longitude As Double, ByVal IBC2006ZipCode As
String, ByVal IBC2006SS As Double, ByVal IBC2006S1 As Double, ByVal IBC2006TL As
Double, ByVal IBC2006SiteClass As Long, ByVal IBC2006Fa As Double, ByRef IBC2006Fv As
Double, ByVal DampRatio As Double) As Long

## Parameters

Name


The name of an existing or new function. If this is an existing function then that function is
modified; otherwise, a new function is added.

IBC2006Option

This is 0, 1 or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitiude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
IBC2006Latitude, IBC2006Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are used
only when IBC2006Option = 0.

IBC2006ZipCode

The zip code for which the seismic coefficients are obtained. This item is used only when
IBC2006Option = 1.

IBC2006SS, IBC2006S1

The seismic coefficients Ss and S1. This item is used only when IBC2006Option = 2.

IBC2006TL

The long-period transition period. [s]

IBC2006SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
IBC2006Fa, IBC2006Fv

The site coefficients Fa and Fv. These items are used only when IBC2006SiteClass= 6.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a IBC2006 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.


## VBA Example

Sub SetRSFuncIBC2006()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add IBC2006 RS function
ret = SapModel.Func.FuncRS.SetIBC2006("RS-1", 1, 0, 0, "94704", 0, 0, 7.5, 4, 0, 0, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetIBC2006

# SetIS18932002

## Syntax

SapObject.SapModel.Func.FuncRS.SetIS18932002

## VB6 Procedure


Function SetIS18932002(ByVal Name As String, ByVal INZ As Double, ByVal INS As Long,
ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

INZ

The seismic zone factor, Z.

INS

This is 1, 2 or 3, indicating the soil type.

```
1 = I
2 = II
3 = III
```
DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a IS1893-2002 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncIS18932002()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add IS18932002 RS function
ret = SapModel.Func.FuncRS.SetIS18932002("RS-1", 0.3, 3, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetIS18932002

# SetItalian3274

## Syntax

SapObject.SapModel.Func.FuncRS.SetItalian3274

## VB6 Procedure

Function SetItalian3274(ByVal Name As String, ByVal Italag As Double, ByVal ItalSoilType As
Long, ByVal Italq As Double, ByVal ItalLevel As Double, ByVal DampRatio As Double) As
Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

Italag

The peak ground acceleration.

ItalSoilType

This is 1, 2, 3, 4 or 5, indicating the seismic intensity.

```
1 = A
```

### 2 = B

### 3 = C

### 4 = E

### 5 = D

Italq

The structure factor.

ItalLevel

This is 0, 1, 2, 3, 4, 5, 6 or 7, indicating the spectral level, direction and building type.

```
0 = SLU/H/Building
1 = SLU/H/Bridge
2 = SLU/V/Building
3 = SLU/V/Bridge
4 = EL/H/Building
5 = EL/H/Bridge
6 = EL/V/Building
7 = EL/V/Bridge
```
SLU refers to ultimate strength design and EL refers to elastic design. H and V are horizontal and
vertical, respectively.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a Italian 3274 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncItalian3274()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add Italian3274 RS function
ret = SapModel.Func.FuncRS.SetItalian3274("RS-1", 0.3, 2, 1.1, 4, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetItalian3274

# SetNBCC2015

## Syntax

SapObject.SapModel.Func.FuncRS.SetNBCC2015

## VB6 Procedure

Function SetNBCC2015(ByVal Name As String, ByVal PGA As Double, ByVal S02 As Double,
ByVal S05 As Double, ByVal S1 As Double, ByVal S2 As Double, ByVal S5 As Double, ByVal
S10 As Double, ByVal SiteClass As Long, ByVal F02 As Double, ByVal F05 As Double, ByVal
F1 As Double, ByVal F2 As Double, ByVal F5 As Double, ByVal F10 As Double, ByVal
DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

PGA

The peak ground acceleration.


### S02

The spectral acceleration at a 0.2 second period.

S05

The spectral acceleration at a 0.5 second period.

S1

The spectral acceleration at a 1 second period.

S2

The spectral acceleration at a 2 second period.

S5

The spectral acceleration at a 5 second period.

S10

The spectral acceleration at a 10 second period.

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
F02

The site coefficient at a 0.2 second period. This item is read when the site class is F only.

F05

The site coefficient at a 0.5 second period. This item is read when the site class is F only.

F1

The site coefficient at a 1 second period. This item is read when the site class is F only.

F2

The site coefficient at a 2 second period. This item is read when the site class is F only.

F5

The site coefficient at a 5 second period. This item is read when the site class is F only.

F10


The site coefficient at a 10 second period. This item is read when the site class is F only.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a NBCC2015 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub SetRSFuncNBCC2015()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NBCC2015 RS function
ret = SapModel.Func.FuncRS.SetNBCC2015("RS-1", 0.6, 1.1, 0.7, 0.35, 0.2, 0.035, 0.01, 6,
1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.


## See Also

GetNBCC2015

# SetNBCC2010

## Syntax

SapObject.SapModel.Func.FuncRS.SetNBCC2010

## VB6 Procedure

Function SetNBCC2010(ByVal Name As String, ByVal PGA As Double, ByVal S02 As Double,
ByVal S05 As Double, ByVal S1 As Double, ByVal S2 As Double, ByVal SiteClass As Long,
ByVal Fa As Double, ByVal Fv As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

PGA

The peak ground acceleration.

S02

The spectral acceleration at a 0.2 second period.

S05

The spectral acceleration at a 0.5 second period.

S1

The spectral acceleration at a 1 second period.

S2

The spectral acceleration at a 2 second period.

SiteClass


This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
Fa

The site coefficient, Fa. This item is read when the site class is F only.

Fv

The site coefficient, Fv. This item is read when the site class is F only.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a NBCC2010 response spectrum function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub SetRSFuncNBCC2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NBCC2010 RS function


ret = SapModel.Func.FuncRS.SetNBCC2010("RS-1", 0.6, 1.1, 0.7, 0.35, 0.2, 6, 1.8, 2, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

## See Also

GetNBCC2010

# SetNBCC2005

## Syntax

SapObject.SapModel.Func.FuncRS.SetNBCC2005

## VB6 Procedure

Function SetNBCC2005(ByVal Name As String, ByVal NBCC2005PGA As Double, ByVal
NBCC2005S02 As Double, ByVal NBCC2005S05 As Double, ByVal NBCC2005S1 As Double,
ByVal NBCC2005S2 As Double, ByVal NBCC2005SiteClass As Long, ByVal NBCC2005Fa As
Double, ByVal NBCC2005Fv As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

NBCC2005PGA

The peak ground acceleration.

NBCC2005S02

The spectral acceleration at a 0.2 second period.

NBCC2005S05


The spectral acceleration at a 0.52 second period.

NBCC2005S1

The spectral acceleration at a 1 second period.

NBCC2005S2

The spectral acceleration at a 2 second period.

NBCC2005SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
NBCC2005Fa

The site coefficient, Fa. This item is read when the site class is F only.

NBCC2005Fv

The site coefficient, Fv. This item is read when the site class is F only.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a NBCC2005 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncNBCC2005()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NBCC2005 RS function
ret = SapModel.Func.FuncRS.SetNBCC2005("RS-1", 0.6, 1.1, 0.7, 0.35, 0.2, 6, 1.8, 2, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetNBCC2005

# SetNBCC95

## Syntax

SapObject.SapModel.Func.FuncRS.SetNBCC95

## VB6 Procedure

Function SetNBCC95(ByVal Name As String, ByVal NBCC95ZVR As Double, ByVal
NBCC95ZA As Long, ByVal NBCC95ZV As Long, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function then that function is
modified; otherwise, a new function is added.

NBCC95ZVR

The zonal velocity ratio.


### NBCC95ZA

The acceleration-related seismic zone.

NBCC95ZV

The velocity-related seismic zone.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a NBCC95 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncNBCC95()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NBCC95 RS function
ret = SapModel.Func.FuncRS.SetNBCC95("RS-1", 0.3, 5, 5, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

GetNBCC95

# SetNCHRP2007

## Syntax

SapObject.SapModel.Func.FuncRS.SetNCHRP2007

## VB6 Procedure

Function SetNCHRP2007(ByVal Name As String, ByVal NCHRP2007Option As Long, ByVal
NCHRP2007Latitude As Double, ByVal NCHRP2007Longitude As Double, ByVal
NCHRP2007ZipCode As String, ByVal NCHRP2007SS As Double, ByVal NCHRP2007S1 As
Double, ByVal NCHRP2007SiteClass As Long, ByVal NCHRP2007Fa As Double, ByRef
NCHRP2007Fv As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

NCHRP2007Option

This is 0, 1 or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitiude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
NCHRP2007Latitude, NCHRP2007Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are used
only when NCHRP2007Option = 0.

NCHRP2007ZipCode

The zip code for which the seismic coefficients are obtained. This item is used only when
NCHRP2007Option = 1.

NCHRP2007SS, NCHRP2007S1


The seismic coefficients Ss and S1. This item is used only when NCHRP2007Option = 2.

NCHRP2007SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
NCHRP2007Fa, NCHRP2007Fv

The site coefficients Fa and Fv. These items are used only when NCHRP2007SiteClass= 6.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a NCHRP 20-07 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncNCHRP2007()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NCHRP2007 RS function


ret = SapModel.Func.FuncRS.SetNCHRP2007("RS-1", 1, 0, 0, "94704", 0, 0, 4, 0, 0, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetNCHRP2007

# SetNEHRP97

## Syntax

SapObject.SapModel.Func.FuncRS.SetNEHRP97

## VB6 Procedure

Function SetNEHRP97(ByVal Name As String, ByVal NEHRP97SS As Double, ByVal
NEHRP97S1 As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function then that function is
modified; otherwise, a new function is added.

NEHRP97SS

The design spectral acceleration at short periods, Sds.

NEHRP97S1

The design spectral acceleration at a one second period, Sd1.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks


This function defines a NEHRP97 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncNEHRP97()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NEHRP97 RS function
ret = SapModel.Func.FuncRS.SetNEHRP97("RS-1", 1.2, 0.3, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetNEHRP97

# SetNTC2008

## Syntax


SapObject.SapModel.Func.FuncRS.SetNTC2008

## VB6 Procedure

Function SetNTC2008(ByVal Name As String, ByVal ParamsOption As Long, ByVal Latitude
As Double, ByVal Longitude As Double, ByVal Island As Long, ByVal LimitState As Long,
ByVal UsageClass As Long, ByVal NomLife As Double, ByVal PeakAccel As Double, ByVal F0
As Double, ByVal Tcs As Double, ByVal SpecType As Long, ByVal SoilType As Long, ByVal
Topography As Long, ByVal hRatio As Double, ByVal Damping As Double, ByVal q As
Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

ParamsOption

This is 1, 2, or 3, indicating the option for defining the parameters.

```
1 = by latitude and longitude
2 = by island
3 = user specified
```
Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are
meaningful only when ParamsOption = 1.

Island

This is one of the following values. This item is used only when ParamsOption = 2.

```
1 = Alicudi
2 = Arcipelago Toscano
3 = Filcudi
4 = Isole Egadi
5 = Lampedusa
6 = Linosa
7 = Lipari
8 = Palmarola
9 = Panarea
10 = Pantelleria
11 = Ponza
12 = Salina
13 = Santo Stefano
14 = Sardegna
15 = Stromboli
16 = Tremiti
17 = Ustica
18 = Ventotene
```

```
19 = Vulcano
20 = Zannone
```
LimitState

This is 1, 2, 3, or 4, indicating the limit state.

```
1 = SLO
2 = SLD
3 = SLV
4 = SLC
```
UsageClass

This is 1, 2, 3, or 4, indicating the usage class.

```
1 = I
2 = II
3 = III
4 = IV
```
NomLife

The nominal life to be considered.

PeakAccel

The peak ground acceleration, ag/g.

F0

The magnitude factor, F0.

Tcs

The reference period, Tc* [s].

SpecType

This is 1, 2, 3, or 4, indicating the type of spectrum to consider.

```
1 = Elastic horizontal
2 = Elastic vertical
3 = Design horizontal
4 = Design vertical
```
SoilType

This is 1, 2, 3, 4, or 5, indicating the subsoil type.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```

Topography

This is 1, 2, 3, or 4, indicating the topography type.

```
1 = T1
2 = T2
3 = T3
4 = T4
```
hRatio

The ratio for the site altitude at the base of the hill to the height of the hill.

Damping

The damping, in percent. This is only applicable for SpecType 1 and 2.

q

The behavior correction factor. This is only applicable for SpecType 3 and 4.

## Remarks

This function defines a NTC2008 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncNTC2008()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add NTC2008 RS function
ret = SapModel.Func.FuncRS.SetNTC2008("RS-1", 1, 45.9, 12.6, 1, 3, 2, 50, 0.2, 2.4, 0.3, 3,
2, 1, 1, 5, 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 18.1.0.

## See Also

GetNTC2008

# SetNZS11702004_1

## Syntax

SapObject.SapModel.Func.FuncRS.SetNZS11702004_1

## VB6 Procedure

Function SetNZS11702004_1(ByVal Name As String, ByRef NZS2004SpectrumType As Long,
ByVal NZS2004SiteClass As Long, ByVal NZS2004Z As Double, ByVal NZS2004R As Double,
ByVal NZS2004DIST As Double, ByVal NZS2004ConsiderTSite As Boolean, ByVal
NZS2004TSite As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

NZS2004SpectrumType

This is 1 or 2, indicating the spectrum type.

```
1 = Horizontal
2 = Vertical
```
NZS2004SiteClass


This is 1, 2, 3, 4 or 5, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
NZS2004Z

The hazard factor, Z.

NZS2004R

The return period factor, R.

NZS2004DIST

Distance to the fault in kim, used to calculate the near fault factor.

NZS2004ConsiderTSite

Indicates whether to consider the site period for the spectral shape factor.

NZS2004TSite

The low amplitude site period.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines an NZS 1170.5 2004 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncNZS11702004()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NZS 1170 2004 RS function
ret = SapModel.Func.FuncRS.SetNZS11702004_1("RS-1", 1, 3, 0.4, 1.3, 20, True, 1, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

This function supersedes SetNZS11702004

## See Also

GetNZS11702004_1

# SetNZS42031992

## Syntax

SapObject.SapModel.Func.FuncRS.SetNZS42031992

## VB6 Procedure

Function SetNZS42031992(ByVal Name As String, ByVal NZS4203SF As Double, ByVal
NZS4203S As Long, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

NZS4203SF

The scaling factor (Sm * Sp * R * Z * L).


### NZS4203S

This is 1, 2 or 3, indicating the site subsoil category.

```
1 = A
2 = B
3 = C
```
DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a NZS4203-1992 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncNZS42031992()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add NZS42031992 RS function
ret = SapModel.Func.FuncRS.SetNZS42031992("RS-1", 1.2, 3, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

GetNZS42031992

# SetSP14133302014

## Syntax

SapObject.SapModel.Func.FuncRS.SetSP14133302014

## VB6 Procedure

Function SetSP14133302014(ByVal Name As String, ByVal Direction As Long, ByVal
Seismicity As Long, ByVal SoilCat As Long, ByVal K0Factor As Double, ByVal K1Factor As
Double, ByVal KPsiFactor As Double, ByVal NonlinSoil As Boolean, ByVal ASoil As Double,
ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

Direction

This is 1, 2, 3, or 4, indicating the direction and structure type for which the response spectrum is
generated.

```
1 = Building Horizontal
2 = Building Vertical
3 = Bridge Horizontal
4 = Bridge Vertical
```
Seismicity

This is 1, 2, 3, or 4, indicating the region seismicity of the construction site.

```
1 = 6
2 = 7
3 = 8
4 = 9
```

SoilCat

This is 1, 2, 3, or 4, indicating the soil category.

```
1 = I
2 = II
3 = III
4 = IV
```
K0Factor

The K0Factor, 0 < K0 <= 2.0. This is only applicable when the Direction parameter is 1 or 3 for
horizontal spectra.

K1Factor

The K1Factor, 0 < K1 <= 1.0.

KPsiFactor

The KPsiFactor, 0.5 < KPsi <= 1.5. This is only applicable when the Direction parameter is 1 or 3
for horizontal spectra.

NonlinSoil

This item is True if nonlinear soil deformation should be accounted for. This is only applicable
when the Direction parameter is 1 or 2 for buildings and the SoilCat parameter is 3 or 4.

ASoil

The nonlinear soil deformation factor, 0 > a_soil <= 1.0. This is only applicable when the
NonlinSoil parameter is True, the Direction parameter is 1 or 2 buildings, and the SoilCat
parameter is 3 or 4.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function retrieves the definition of a SP 14.13330.2014 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncSP14133302014()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add SP 14.13330.2014 RS function
ret = SapModel.Func.FuncRS.SetSP14133302014("RS-1", 1, 2, 2, 1.0, 0.25, 1.0, False, 0.7,
0.04)

'get SP 14.13330.2014 RS function

ret = SapModel.Func.FuncRS.GetSP14133302014("RS-1", Direction, Seismicity, SoilCat,
K0Factor, K1Factor, KPsiFactor, NonlinSoil, ASoil, DampRatio)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 18.2.0.

## See Also

GetSP14133302014

# SetUBC94

## Syntax

SapObject.SapModel.Func.FuncRS.SetUBC94


## VB6 Procedure

Function SetUBC94(ByVal Name As String, ByVal UBC94Z As Double, ByVal UBC94S As
Long, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

UBC94Z

The seismic zone factor, Z.

UBC94S

This is 1, 2 or 3, indicating the soil type.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a UBC94 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncUBC94()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add UBC94 RS function
ret = SapModel.Func.FuncRS.SetUBC94("RS-1", 0.35, 3, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetUBC94

# SetUBC97

## Syntax

SapObject.SapModel.Func.FuncRS.SetUBC97

## VB6 Procedure

Function SetUBC97(ByVal Name As String, ByVal UBC97Ca As Double, ByVal UBC97Cv As
Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

UBC97Ca

The seismic coefficient, Ca.

UBC97Cv

The seismic coefficient, Cv.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.


## Remarks

This function defines a UBC97 response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncUBC97()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add UBC97 RS function
ret = SapModel.Func.FuncRS.SetUBC97("RS-1", 0.36, 0.54, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetUBC97

# SetUser


## Syntax

SapObject.SapModel.Func.FuncRS.SetUser

## VB6 Procedure

Function SetUser(ByVal Name As String, ByVal NumberItems As Long, ByRef Period() As
Double, ByRef Value() As Double, ByVal DampRatio As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

NumberItems

The number of period and value pairs defined.

Period

This is an array that includes the period for each data point. [s]

Value

This is an array that includes the function value for each data point.

DampRatio

The damping ratio for the function, 0 <= DampRatio < 1.

## Remarks

This function defines a user response spectrum function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetRSFuncUser()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim Period() As Double
Dim Value() As Double

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add user RS function
NumberItems = 6
ReDim Period(NumberItems - 1)
ReDim Value(NumberItems - 1)
Period(0) = 0.03: Value(0) = 0.4
Period(1) = 0.05: Value(1) = 2.2
Period(2) = 0.80: Value(2) = 2.2
Period(3) = 1.20: Value(3) = 1.0
Period(4) = 4.00: Value(4) = 0.2
Period(5) = 10.0: Value(5) = 0.05
ret = SapModel.Func.FuncRS.SetUser("RS-1", NumberItems, Period, Value, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetUser

# GetFromFile

## Syntax

SapObject.SapModel.Func.FuncSS.GetFromFile

## VB6 Procedure


Function GetFromFile(ByVal Name As String, ByRef FileName As String, ByRef HeadLines As
Long, ByRef PreChars As Long, ByRef PointsPerLine As Long, ByRef ValueType As Long,
ByRef FreeFormat As Boolean, ByRef NumberFixed As Long, ByRef FreqTypeInFile As Long)
As Long

## Parameters

Name

The name of a defined steady state function specified to be from a text file.

FileName

The full path of the text file containing the function data.

HeadLines

The number of header lines in the text file to be skipped before starting to read function data.

PreChars

The number of prefix characters to be skipped on each line in the text file.

PointsPerLine

The number of function points included on each text file line.

ValueType

This is either 1 or 2, indicating value type.

```
1 = Values at equal time intervals
2 = Time and function values
```
FreeFormat

This item is True if the data is provided in a free format. It is False if it is in a fixed format.

NumberFixed

This item only applies when the FreeFormat item is False. It is the number of characters per item.

FreqTypeInFile

This is either 1 or 2, indicating frequency type.

```
1 = Hz
2 = RPM
```
## Remarks

This function retrieves the definition of a steady state function from file.


The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSSFuncFromFile()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim HeadLines As Long
Dim PreChars As Long
Dim PointsPerLine As Long
Dim ValueType As Long
Dim FreeFormat As Boolean
Dim NumberFixed As Long
Dim FreqTypeInFile As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add SS function from file
ret = SapModel.Func.FuncSS.SetFromFile("SS-1", "C:\SapAPI\FuncSS.txt", 2, 0, 1, 2, True)

'get SS function from file
ret = SapModel.Func.FuncSS.GetFromFile("SS-1", FileName, HeadLines, PreChars,
PointsPerLine, ValueType, FreeFormat, NumberFixed, FreqTypeInFile)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Text File

Following is the contents of the text file name FuncSS.txt used in the VBA Example.


Steady State Function

One pair of Frequency (Hz) and Value items per line

0 1

1 1

2 2

3 2

## Release Notes

Initial release in version 11.02.

## See Also

SetFromFile

# GetUser

## Syntax

SapObject.SapModel.Func.FuncSS.GetUser

## VB6 Procedure

Function GetUser(ByVal Name As String, ByRef NumberItems As Long, ByRef Frequency() As
Double, ByRef Value() As Double) As Long

## Parameters

Name

The name of a user defined steady state function.

NumberItems

The number of frequency and value pairs defined.

Frequency

This is an array that includes the frequency in Hz for each data point. [cyc/s]

Value

This is an array that includes the function value for each data point.


## Remarks

This function retrieves the definition of a user defined steady state function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSSFuncUser()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Num As Long
Dim Freq() As Double
Dim Val() As Double
Dim NumberItems As Long
Dim Frequency() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add user SS function
Num = 4
ReDim Freq(Num - 1)
ReDim Val(Num - 1)
Freq(0) = 0: Val(0) = 1
Freq(1) = 1: Val(1) = 1
Freq(2) = 2: Val(2) = 2
Freq(3) = 3: Val(3) = 2
ret = SapModel.Func.FuncSS.SetUser("SS-1", Num, Freq, Val)

'get user SS function
ret = SapModel.Func.FuncSS.GetUser("SS-1", NumberItems, Frequency, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetUser

# SetFromFile

## Syntax

SapObject.SapModel.Func.FuncSS.SetFromFile

## VB6 Procedure

Function SetFromFile(ByVal Name As String, ByVal FileName As String, ByVal HeadLines As
Long, ByVal PreChars As Long, ByVal PointsPerLine As Long, ByVal ValueType As Long,
ByVal FreeFormat As Boolean, Optional ByVal NumberFixed As Long = 10, Optional ByVal
FreqTypeInFile As Long = 1) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

FileName

The full path of the text file containing the function data.

HeadLines

The number of header lines in the text file to be skipped before starting to read function data.

PreChars

The number of prefix characters to be skipped on each line in the text file.

PointsPerLine

The number of function points included on each text file line.

ValueType

This is either 1 or 2, indicating value type.


```
1 = Values at equal time intervals
2 = Time and function values
```
FreeFormat

This item is True if the data is provided in a free format. It is False if it is in a fixed format.

NumberFixed

This item only applies when the FreeFormat item is False. It is the number of characters per item.

FreqTypeInFile

This is either 1 or 2, indicating frequency type.

```
1 = Hz
2 = RPM
```
## Remarks

This function defines a steady state function from file.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetSSFuncFromFile()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add SS function from file
ret = SapModel.Func.FuncSS.SetFromFile("SS-1", "C:\SapAPI\FuncSS.txt", 2, 0, 1, 2, True)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Text File

Following is the contents of the text file name FuncSS.txt used in the VBA Example.

Steady State Function

One pair of Frequency (Hz) and Value items per line

0 1

1 1

2 2

3 2

## Release Notes

Initial release in version 11.02.

## See Also

GetFromFile

# SetUser

## Syntax

SapObject.SapModel.Func.FuncSS.SetUser

## VB6 Procedure

Function SetUser(ByVal Name As String, ByVal NumberItems As Long, ByRef Frequency() As
Double, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

NumberItems


The number of frequency and value pairs defined.

Frequency

This is an array that includes the frequency in Hz for each data point. [cyc/s]

Value

This is an array that includes the function value for each data point.

## Remarks

This function defines a user steady state function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetSSFuncUser()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim Frequency() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add user SS function
NumberItems = 4
ReDim Frequency(NumberItems - 1)
ReDim Value(NumberItems - 1)
Frequency(0) = 0: Value(0) = 1
Frequency(1) = 1: Value(1) = 1
Frequency(2) = 2: Value(2) = 2
Frequency(3) = 3: Value(3) = 2
ret = SapModel.Func.FuncSS.SetUser("SS-1", NumberItems, Frequency, Value)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetUser

# GetCosine

## Syntax

SapObject.SapModel.Func.FuncTH.GetCosine

## VB6 Procedure

Function GetCosine(ByVal Name As String, ByRef CosineP As Double, ByRef CosineSteps As
Long, ByRef CosineCycles As Long, ByRef CosineAmp As Double) As Long

## Parameters

Name

The name of a cosine-type time history function.

CosineP

The period of the cosine function. [s]

CosineSteps

The number of steps in the cosine function. This item can not be less than 8.

CosineCycles

The number of cycles in the cosine function.

CosineAmp

The amplitude of the cosine function.


## Remarks

This function retrieves the definition of a cosine-type time history function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetTHFuncCosine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim CosineP As Double
Dim CosineSteps As Long
Dim CosineCycles As Long
Dim CosineAmp As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cosine TH function
ret = SapModel.Func.FuncTH.SetCosine("TH-1", 1, 16, 4, 1.25)

'get cosine TH function
ret = SapModel.Func.FuncTH.GetCosine("TH-1", CosineP, CosineSteps, CosineCycles,
CosineAmp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

SetCosine

# GetFromFile_1

## Syntax

SapObject.SapModel.Func.FuncTH.GetFromFile_1

## VB6 Procedure

Function GetFromFile_1(ByVal Name As String, ByRef FileName As String, ByRef HeadLines
As Long, ByRef PreChars As Long, ByRef PointsPerLine As Long, ByRef ValueType As Long,
ByRef FreeFormat As Boolean, ByRef NumberFixed As Long, DT As Double) As Long

## Parameters

Name

The name of a defined time history function specified to be from a text file.

FileName

The full path of the text file containing the function data.

HeadLines

The number of header lines in the text file to be skipped before starting to read function data.

PreChars

The number of prefix characters to be skipped on each line in the text file.

PointsPerLine

The number of function points included on each text file line.

ValueType

This is 1 or 2, indicating value type.

```
1 = Values at equal time intervals
```
```
2 = Time and function values
```
FreeFormat

This item is True if the data is provided in a free format. It is False if it is in a fixed format.

NumberFixed


This item applies only when the FreeFormat item is False. It is the number of characters per item.

DT

This item applies only when the ValueType item is 1 (equal time intervals). It is the time interval
between function points.

## Remarks

This function retrieves the definition of a time history function from file.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetTHFuncFromFile_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim HeadLines As Long
Dim PreChars As Long
Dim PointsPerLine As Long
Dim ValueType As Long
Dim FreeFormat As Boolean
Dim NumberFixed As Long
Dim DT As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add TH function from file
ret = SapModel.Func.FuncTH.SetFromFile_1("TH-1", "C:\SapAPI\FuncTH.txt", 3, 0, 3, 2,
True)

'get TH function from file
ret = SapModel.Func.FuncTH.GetFromFile_1("TH-1", FileName, HeadLines, PreChars,
PointsPerLine, ValueType, FreeFormat, NumberFixed, DT)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Text File

Following is the contents of the text file name FuncTH.txt used in the VBA Example.

Time History Function

Time (sec) and Acceleration (g) values

3 points per line

0.00000 .01080 .04200 .00100 .09700 .01590
.16100 -.00010 .22100 .01890 .26300 .00010
.29100 .00590 .33200 -.00120 .37400 .02000
.42900 -.02370 .47100 .00760 .58100 .04250
.62300 .00940 .66500 .01380 .72000 -.00880
.72010 -.02560 .78900 -.03870 .78910 -.05680
.87200 -.02320 .87210 -.03430 .94100 -.04020
.94110 -.06030 .99700 -.07890 1.06600 -.06660
1.06610 -.03810 1.09400 -.04290 1.16800 .08970
1.31500 -.16960 1.38400 -.08280 1.41200 -.08280
1.44000 -.09450 1.48100 -.08850 1.50900 -.10800
1.53700 -.12800 1.62800 .11440 1.70300 .23550
1.80000 .14280 1.85500 .17770 1.92400 -.26100
2.00700 -.31940 2.21500 .29520 2.27000 .26340
2.32000 -.29840 2.39500 .00540 2.45000 .28650
2.51900 -.04690 2.57500 .15160 2.65200 .20770
2.70800 .10870 2.76900 -.03250 2.89300 .10330
2.97600 -.08030 3.06800 .05200 3.12900 -.15470
3.21200 .00650 3.25300 -.20600 3.38600 .19270
3.41900 -.09370 3.53000 .17080 3.59900 -.03590
3.66800 .03650 3.73800 -.07360 3.83500 .03110
3.90400 -.18330 4.01400 .02270 4.05600 -.04350
4.10600 .02160 4.22200 -.19720 4.31400 -.17620
4.41600 .14600 4.47100 -.00470 4.61800 .25720
4.66500 -.20450 4.75600 .06080 4.83100 -.27330
4.97000 .17790 5.03900 .03010 5.10800 .21830
5.19900 .02670 5.23300 .12520 5.30200 .12900
5.33000 .10890 5.34300 -.02390 5.45400 .17230
5.51000 -.10210 5.60600 .01410 5.69000 -.19490
5.77300 -.02420 5.80000 -.00500 5.80900 -.02750
5.86900 -.05730 5.88300 -.03270 5.92500 .02160
5.98000 .01080 6.01300 .02350 6.08500 -.06650
6.13200 .00140 6.17400 .04930 6.18800 .01490
6.18810 -.02000 6.22900 -.03810 6.27900 .02070
6.32600 -.00580 6.36800 -.06030 6.38200 -.01620
6.40900 .02000 6.45900 -.01760 6.47800 -.00330


### 6.52000 .00430 6.53400 -.00400 6.56200 -.00990

### 6.57500 -.00170 6.60300 -.01700 6.64500 .03730

### 6.68600 .04570 6.71400 .03850 6.72800 .00090

### 6.76900 -.02880 6.76910 .00160 6.81100 .01130

### 6.85200 .00220 6.90800 .00920 6.99100 -.09960

### 7.07400 .03600 7.12100 .00780 7.14300 -.02770

### 7.14900 .00260 7.17100 .02720 7.22600 .05760

### 7.29500 -.04920 7.37000 .02970 7.40600 .01090

### 7.42500 .01860 7.46100 -.02530 7.52500 -.03470

### 7.57200 .00360 7.60000 -.06280 7.64100 -.02800

### 7.66900 -.01960 7.69100 .00680 7.75200 -.00540

### 7.79400 -.06030 7.83500 -.03570 7.87700 -.07160

### 7.96000 -.01400 7.98700 -.00560 8.00100 .02220

### 8.07000 .04680 8.12600 .02600 8.12610 -.03350

### 8.19500 -.01280 8.22300 .06610 8.27800 .03050

### 8.33400 .02460 8.40300 .03470 8.45800 -.03690

### 8.53300 -.03440 8.59600 -.01040 8.63800 -.02600

### 8.73500 .15340 8.81800 -.00280 8.86000 .02330

### 8.88200 -.02610 8.91500 -.00220 8.95600 -.18490

### 9.05300 .12600 9.09500 .03200 9.12300 .09550

### 9.15000 .12460 9.25300 -.03280 9.28900 -.04510

### 9.42700 .13010 9.44100 -.16570 9.51000 .04190

### 9.63500 -.09360 9.70400 .08160 9.81500 -.08810

### 9.89800 .00640 9.93900 -.00060 9.99500 .05860

### 10.02200 -.07130 10.05000 -.04480 10.05010 -.02210

### 10.10500 .00930 10.10510 .00240 10.18800 .05100

### 10.27200 -.12430 10.38200 .05870 10.42400 .01330

### 10.45200 .03860 10.46500 .11640 10.50700 -.03740

### 10.53400 -.05720 10.64500 .03080 10.70100 .02230

### 10.71400 .05150 10.77000 .09030 10.83900 -.01940

### 10.92200 .04710 10.92210 -.06770 10.96400 -.07940

### 10.99100 -.01200 11.07400 .06080 11.08800 -.02690

### 11.11600 -.04160 11.20700 .02930 11.20710 .05520

### 11.22700 .07560 11.26800 .04310 11.32400 .02080

### 11.43400 .11800 11.57300 -.09990 11.65600 -.12470

### 11.72500 -.20940 11.72510 -.14180 11.78000 -.11630

### 11.80800 0.00000 11.87700 .07620 11.91900 .05700

### 11.98800 .13540 12.04300 .06730 12.11300 .08650

## Release Notes

Initial release in version 14.12.

This function supersedes GetFromFile.

## See Also

SetFromFile_1


# GetRamp

## Syntax

SapObject.SapModel.Func.FuncTH.GetRamp

## VB6 Procedure

Function GetRamp(ByVal Name As String, ByRef RampTime As Double, ByRef RampAmp As
Double, ByRef RampMaxTime As Double) As Long

## Parameters

Name

The name of a ramp-type time history function.

RampTime

The time it takes for the ramp function to initially reach its maximum value. [s]

RampAmp

The maximum amplitude of the ramp function.

RampMaxTime

The time at the end of the ramp function. This time must be greater than the RampTime. [s]

## Remarks

This function retrieves the definition of a ramp-type time history function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetTHFuncRamp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim RampTime As Double
Dim RampAmp As Double
Dim RampMaxTime As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ramp TH function
ret = SapModel.Func.FuncTH.SetRamp("TH-1", 1, 1.25, 8)

'get ramp TH function
ret = SapModel.Func.FuncTH.GetRamp("TH-1", RampTime, RampAmp, RampMaxTime)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetRamp

# GetSawtooth

## Syntax

SapObject.SapModel.Func.FuncTH.GetSawtooth

## VB6 Procedure

Function GetSawtooth(ByVal Name As String, ByRef SawP As Double, ByRef SawTime As
Double, ByRef SawCycles As Long, ByRef SawAmp As Double) As Long

## Parameters

Name


The name of a sawtooth-type time history function.

SawP

The period of the sawtooth function. [s]

SawTime

The time it takes for the sawtooth function to ramp up from a function value of zero to its
maximum amplitude. [s]

SawCycles

The number of cycles in the function.

SawAmp

The maximum amplitude of the sawtooth function.

## Remarks

This function retrieves the definition of a sawtooth-type time history function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetTHFuncSawtooth()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SawP As Double
Dim SawTime As Double
Dim SawCycles As Long
Dim SawAmp As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add sawtooth TH function
ret = SapModel.Func.FuncTH.SetSawtooth("TH-1", 1, 0.25, 4, 1.75)

'get sawtooth TH function
ret = SapModel.Func.FuncTH.GetSawtooth("TH-1", SawP, SawTime, SawCycles, SawAmp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetSawtooth

# GetSine

## Syntax

SapObject.SapModel.Func.FuncTH.GetSine

## VB6 Procedure

Function GetSine(ByVal Name As String, ByRef SineP As Double, ByRef SineSteps As Long,
ByRef SineCycles As Long, ByRef SineAmp As Double) As Long

## Parameters

Name

The name of a sine-type time history function.

SineP

The period of the sine function. [s]

SineSteps

The number of steps in the sine function. This item can not be less than 8.

SineCycles

The number of cycles in the sine function.


SineAmp

The amplitude of the sine function.

## Remarks

This function retrieves the definition of a sine-type time history function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetTHFuncSine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SineP As Double
Dim SineSteps As Long
Dim SineCycles As Long
Dim SineAmp As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'get sine TH function
ret = SapModel.Func.FuncTH.GetSine("TH-1", SineP, SineSteps, SineCycles, SineAmp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

SetSine

# GetTriangular

## Syntax

SapObject.SapModel.Func.FuncTH.GetTriangular

## VB6 Procedure

Function GetTriangular(ByVal Name As String, ByRef TriP As Double, ByRef TriCycles As
Long, ByRef TriAmp As Double) As Long

## Parameters

Name

The name of a triangular-type time history function.

TriP

The period of the triangular function. [s]

TriCycles

The number of cycles in the function.

TriAmp

The maximum amplitude of the triangular function.

## Remarks

This function retrieves the definition of a triangular-type time history function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetTHFuncTriangular()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim TriP As Double
Dim TriCycles As Long
Dim TriAmp As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add triangular TH function
ret = SapModel.Func.FuncTH.SetTriangular("TH-1", 1, 4, 1.75)

'get triangular TH function
ret = SapModel.Func.FuncTH.GetTriangular("TH-1", TriP, TriCycles, TriAmp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetTriangular

# GetUser

## Syntax

SapObject.SapModel.Func.FuncTH.GetUser


## VB6 Procedure

Function GetUser(ByVal Name As String, ByRef NumberItems As Long, ByRef MyTime() As
Double, ByRef Value() As Double) As Long

## Parameters

Name

The name of a user defined time history function.

NumberItems

The number of frequency and value pairs defined.

MyTime

This is an array that includes the time for each data point. [s]

Value

This is an array that includes the function value for each data point.

## Remarks

This function retrieves the definition of a user defined time history function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetTHFuncUser()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Num As Long
Dim Tmp() As Double
Dim Val() As Double
Dim NumberItems As Long
Dim MyTime() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add user TH function
NumberItems = 6
ReDim Tmp(NumberItems - 1)
ReDim Val(NumberItems - 1)
Tmp(0) = 0: Val(0) = 0.1
Tmp(1) = 1: Val(1) = 0.02
Tmp(2) = 2: Val(2) = -0.06
Tmp(3) = 3: Val(3) = -0.02
Tmp(4) = 4: Val(4) = 0.05
Tmp(5) = 5: Val(5) = 0.02
ret = SapModel.Func.FuncTH.SetUser("TH-1", NumberItems, Tmp, Val)

'get user TH function
ret = SapModel.Func.FuncTH.GetUser("TH-1", NumberItems, MyTime, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetUser

# GetUserPeriodic

## Syntax

SapObject.SapModel.Func.FuncTH.GetUserPeriodic

## VB6 Procedure

Function GetUserPeriodic(ByVal Name As String, ByRef UPCycles As Long, ByRef
NumberItems As Long, ByRef MyTime() As Double, ByRef Value() As Double) As Long


## Parameters

Name

The name of a user periodic time history function.

UPCycles

The number of cycles in the function.

NumberItems

The number of frequency and value pairs defined.

MyTime

This is an array that includes the time for each data point. [s]

Value

This is an array that includes the function value for each data point.

## Remarks

This function retrieves the definition of a user periodic time history function.

The function returns zero if the function definition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetTHFuncUserPeriodic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Num As Long
Dim Tmp() As Double
Dim Val() As Double
Dim UPCycles As Long
Dim NumberItems As Long
Dim MyTime() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add user periodic TH function
NumberItems = 6
ReDim Tmp(NumberItems - 1)
ReDim Val(NumberItems - 1)
Tmp(0) = 0: Val(0) = 0.1
Tmp(1) = 1: Val(1) = 0.02
Tmp(2) = 2: Val(2) = -0.06
Tmp(3) = 3: Val(3) = -0.02
Tmp(4) = 4: Val(4) = 0.05
Tmp(5) = 5: Val(5) = 0.02
ret = SapModel.Func.FuncTH.SetUserPeriodic("TH-1", 4, NumberItems, Tmp, Val)

'get user periodic TH function
ret = SapModel.Func.FuncTH.GetUserPeriodic("TH-1", UPCycles, NumberItems, MyTime,
Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetUserPeriodic

# SetCosine

## Syntax

SapObject.SapModel.Func.FuncTH.SetCosine

## VB6 Procedure

Function SetCosine(ByVal Name As String, ByVal CosineP As Double, ByVal CosineSteps As
Long, ByVal CosineCycles As Long, ByVal CosineAmp As Double) As Long


## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

CosineP

The period of the cosine function. [s]

CosineSteps

The number of steps in the cosine function. This item can not be less than 8.

CosineCycles

The number of cycles in the cosine function.

CosineAmp

The amplitude of the cosine function.

## Remarks

This function defines a cosine-type time history function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetTHFuncCosine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add cosine TH function
ret = SapModel.Func.FuncTH.SetCosine("TH-1", 1, 16, 4, 1.25)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetCosine

# SetFromFile_1

## Syntax

SapObject.SapModel.Func.FuncTH.SetFromFile_1

## VB6 Procedure

Function SetFromFile_1(ByVal Name As String, ByVal FileName As String, ByVal HeadLines
As Long, ByVal PreChars As Long, ByVal PointsPerLine As Long, ByVal ValueType As Long,
ByVal FreeFormat As Boolean, Optional ByVal NumberFixed As Long = 10, Optional ByVal DT
As Double = 0.02) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

FileName

The full path of the text file containing the function data.

HeadLines

The number of header lines in the text file to be skipped before starting to read function data.

PreChars

The number of prefix characters to be skipped on each line in the text file.


PointsPerLine

The number of function points included on each text file line.

ValueType

This is 1 or 2, indicating value type.

```
1 = Values at equal time intervals
```
```
2 = Time and function values
```
FreeFormat

This item is True if the data is provided in a free format. It is False if it is in a fixed format.

NumberFixed

This item applies only when the FreeFormat item is False. It is the number of characters per item.

DT

This item applies only when the ValueType item is 1 (equal time intervals). It is the time interval
between function points.

## Remarks

This function defines a time history function from file.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetTHFuncFromFile_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add TH function from file
ret = SapModel.Func.FuncTH.SetFromFile_1("TH-1", "C:\SapAPI\FuncTH.txt", 3, 0, 3, 2,
True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Text File

Following is the contents of the text file name FuncTH.txt used in the VBA Example.

Time History Function

Time (sec) and Acceleration (g) values

3 points per line

0.00000 .01080 .04200 .00100 .09700 .01590
.16100 -.00010 .22100 .01890 .26300 .00010
.29100 .00590 .33200 -.00120 .37400 .02000
.42900 -.02370 .47100 .00760 .58100 .04250
.62300 .00940 .66500 .01380 .72000 -.00880
.72010 -.02560 .78900 -.03870 .78910 -.05680
.87200 -.02320 .87210 -.03430 .94100 -.04020
.94110 -.06030 .99700 -.07890 1.06600 -.06660
1.06610 -.03810 1.09400 -.04290 1.16800 .08970
1.31500 -.16960 1.38400 -.08280 1.41200 -.08280
1.44000 -.09450 1.48100 -.08850 1.50900 -.10800
1.53700 -.12800 1.62800 .11440 1.70300 .23550
1.80000 .14280 1.85500 .17770 1.92400 -.26100
2.00700 -.31940 2.21500 .29520 2.27000 .26340
2.32000 -.29840 2.39500 .00540 2.45000 .28650
2.51900 -.04690 2.57500 .15160 2.65200 .20770
2.70800 .10870 2.76900 -.03250 2.89300 .10330
2.97600 -.08030 3.06800 .05200 3.12900 -.15470
3.21200 .00650 3.25300 -.20600 3.38600 .19270
3.41900 -.09370 3.53000 .17080 3.59900 -.03590
3.66800 .03650 3.73800 -.07360 3.83500 .03110
3.90400 -.18330 4.01400 .02270 4.05600 -.04350
4.10600 .02160 4.22200 -.19720 4.31400 -.17620
4.41600 .14600 4.47100 -.00470 4.61800 .25720
4.66500 -.20450 4.75600 .06080 4.83100 -.27330
4.97000 .17790 5.03900 .03010 5.10800 .21830
5.19900 .02670 5.23300 .12520 5.30200 .12900
5.33000 .10890 5.34300 -.02390 5.45400 .17230
5.51000 -.10210 5.60600 .01410 5.69000 -.19490
5.77300 -.02420 5.80000 -.00500 5.80900 -.02750
5.86900 -.05730 5.88300 -.03270 5.92500 .02160


### 5.98000 .01080 6.01300 .02350 6.08500 -.06650

### 6.13200 .00140 6.17400 .04930 6.18800 .01490

### 6.18810 -.02000 6.22900 -.03810 6.27900 .02070

### 6.32600 -.00580 6.36800 -.06030 6.38200 -.01620

### 6.40900 .02000 6.45900 -.01760 6.47800 -.00330

### 6.52000 .00430 6.53400 -.00400 6.56200 -.00990

### 6.57500 -.00170 6.60300 -.01700 6.64500 .03730

### 6.68600 .04570 6.71400 .03850 6.72800 .00090

### 6.76900 -.02880 6.76910 .00160 6.81100 .01130

### 6.85200 .00220 6.90800 .00920 6.99100 -.09960

### 7.07400 .03600 7.12100 .00780 7.14300 -.02770

### 7.14900 .00260 7.17100 .02720 7.22600 .05760

### 7.29500 -.04920 7.37000 .02970 7.40600 .01090

### 7.42500 .01860 7.46100 -.02530 7.52500 -.03470

### 7.57200 .00360 7.60000 -.06280 7.64100 -.02800

### 7.66900 -.01960 7.69100 .00680 7.75200 -.00540

### 7.79400 -.06030 7.83500 -.03570 7.87700 -.07160

### 7.96000 -.01400 7.98700 -.00560 8.00100 .02220

### 8.07000 .04680 8.12600 .02600 8.12610 -.03350

### 8.19500 -.01280 8.22300 .06610 8.27800 .03050

### 8.33400 .02460 8.40300 .03470 8.45800 -.03690

### 8.53300 -.03440 8.59600 -.01040 8.63800 -.02600

### 8.73500 .15340 8.81800 -.00280 8.86000 .02330

### 8.88200 -.02610 8.91500 -.00220 8.95600 -.18490

### 9.05300 .12600 9.09500 .03200 9.12300 .09550

### 9.15000 .12460 9.25300 -.03280 9.28900 -.04510

### 9.42700 .13010 9.44100 -.16570 9.51000 .04190

### 9.63500 -.09360 9.70400 .08160 9.81500 -.08810

### 9.89800 .00640 9.93900 -.00060 9.99500 .05860

### 10.02200 -.07130 10.05000 -.04480 10.05010 -.02210

### 10.10500 .00930 10.10510 .00240 10.18800 .05100

### 10.27200 -.12430 10.38200 .05870 10.42400 .01330

### 10.45200 .03860 10.46500 .11640 10.50700 -.03740

### 10.53400 -.05720 10.64500 .03080 10.70100 .02230

### 10.71400 .05150 10.77000 .09030 10.83900 -.01940

### 10.92200 .04710 10.92210 -.06770 10.96400 -.07940

### 10.99100 -.01200 11.07400 .06080 11.08800 -.02690

### 11.11600 -.04160 11.20700 .02930 11.20710 .05520

### 11.22700 .07560 11.26800 .04310 11.32400 .02080

### 11.43400 .11800 11.57300 -.09990 11.65600 -.12470

### 11.72500 -.20940 11.72510 -.14180 11.78000 -.11630

### 11.80800 0.00000 11.87700 .07620 11.91900 .05700

### 11.98800 .13540 12.04300 .06730 12.11300 .08650

## Release Notes

Initial release in version 14.12.

This function supersedes SetFromFile.


## See Also

GetFromFile_1

# SetRamp

## Syntax

SapObject.SapModel.Func.FuncTH.SetRamp

## VB6 Procedure

Function SetRamp(ByVal Name As String, ByVal RampTime As Double, ByVal RampAmp As
Double, ByVal RampMaxTime As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

RampTime

The time it takes for the ramp function to initially reach its maximum value. [s]

RampAmp

The maximum amplitude of the ramp function.

RampMaxTime

The time at the end of the ramp function. This time must be greater than the RampTime. [s]

## Remarks

This function defines a ramp-type time history function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetTHFuncRamp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ramp TH function
ret = SapModel.Func.FuncTH.SetRamp("TH-1", 1, 1.25, 8)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetRamp

# SetSawtooth

## Syntax

SapObject.SapModel.Func.FuncTH.SetSawtooth

## VB6 Procedure

Function SetSawtooth(ByVal Name As String, ByVal SawP As Double, ByVal SawTime As
Double, ByVal SawCycles As Long, ByVal SawAmp As Double) As Long

## Parameters

Name


The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

SawP

The period of the sawtooth function. [s]

SawTime

The time it takes for the sawtooth function to ramp up from a function value of zero to its
maximum amplitude. [s]

SawCycles

The number of cycles in the function.

SawAmp

The maximum amplitude of the sawtooth function.

## Remarks

This function defines a sawtooth-type time history function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetTHFuncSawtooth()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sawtooth TH function
ret = SapModel.Func.FuncTH.SetSawtooth("TH-1", 1, 0.25, 4, 1.75)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetSawtooth

# SetSine

## Syntax

SapObject.SapModel.Func.FuncTH.SetSine

## VB6 Procedure

Function SetSine(ByVal Name As String, ByVal SineP As Double, ByVal SineSteps As Long,
ByVal SineCycles As Long, ByVal SineAmp As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

SineP

The period of the sine function. [s]

SineSteps

The number of steps in the sine function. This item can not be less than 8.

SineCycles

The number of cycles in the sine function.

SineAmp

The amplitude of the sine function.


## Remarks

This function defines a sine-type time history function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetTHFuncSine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetSine

# SetTriangular


## Syntax

SapObject.SapModel.Func.FuncTH.SetTriangular

## VB6 Procedure

Function SetTriangular(ByVal Name As String, ByVal TriP As Double, ByVal TriCycles As
Long, ByVal TriAmp As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

TriP

The period of the triangular function. [s]

TriCycles

The number of cycles in the function.

TriAmp

The maximum amplitude of the triangular function.

## Remarks

This function defines a triangular-type time history function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetTHFuncTriangular()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add triangular TH function
ret = SapModel.Func.FuncTH.SetTriangular("TH-1", 1, 4, 1.75)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetTriangular

# SetUser

## Syntax

SapObject.SapModel.Func.FuncTH.SetUser

## VB6 Procedure

Function SetUser(ByVal Name As String, ByVal NumberItems As Long, ByRef MyTime() As
Double, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

NumberItems

The number of time and value pairs defined.

MyTime


This is an array that includes the time for each data point. [s]

Value

This is an array that includes the function value for each data point.

## Remarks

This function defines a user time history function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetTHFuncUser()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim MyTime() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add user TH function
NumberItems = 6
ReDim MyTime(NumberItems - 1)
ReDim Value(NumberItems - 1)
MyTime(0) = 0: Value(0) = 0.1
MyTime(1) = 1: Value(1) = 0.02
MyTime(2) = 2: Value(2) = -0.06
MyTime(3) = 3: Value(3) = -0.02
MyTime(4) = 4: Value(4) = 0.05
MyTime(5) = 5: Value(5) = 0.02
ret = SapModel.Func.FuncTH.SetUser("TH-1", NumberItems, MyTime, Value)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetUser

# SetUserPeriodic

## Syntax

SapObject.SapModel.Func.FuncTH.SetUserPeriodic

## VB6 Procedure

Function SetUserPeriodic(ByVal Name As String, ByVal UPCycles As Long, ByVal
NumberItems As Long, ByRef MyTime() As Double, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing or new function. If this is an existing function, that function is modified;
otherwise, a new function is added.

UPCycles

The number of cycles in the function.

NumberItems

The number of time and value pairs defined.

MyTime

This is an array that includes the time for each data point. [s]

Value

This is an array that includes the function value for each data point.

## Remarks


This function defines a user periodic time history function.

The function returns zero if the function is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetTHFuncUserPeriodic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim MyTime() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add user periodic TH function
NumberItems = 6
ReDim MyTime(NumberItems - 1)
ReDim Value(NumberItems - 1)
MyTime(0) = 0: Value(0) = 0.1
MyTime(1) = 1: Value(1) = 0.02
MyTime(2) = 2: Value(2) = -0.06
MyTime(3) = 3: Value(3) = -0.02
MyTime(4) = 4: Value(4) = 0.05
MyTime(5) = 5: Value(5) = 0.02
ret = SapModel.Func.FuncTH.SetUserPeriodic("TH-1", 4, NumberItems, MyTime, Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.02.

## See Also

GetUserPeriodic

# ConvertLineToBLL

## Syntax

SapObject.SapModel.GenRefLine.ConvertLineToBLL

## VB6 Procedure

Function ConvertLineToBLL(ByVal Name As String, Optional ByVal FirstStation As Double =
0, Optional ByVal CSys As String = "Global", Optional ByVal OffsetX As Double = 0, Optional
ByVal OffsetY As Double = 0, Optional ByVal OffsetZ As Double) As Long

## Parameters

Name

This is the name of an existing general reference line.

FirstStation

The first station value on the bridge layout line. [L]

CSys

The name of the coordinate system in which the general reference line is offset to create the bridge
layout line.

OffsetX

The distance to offset the general reference line in the x-direction of the specified CSys, to the
location of the new bridge layout line.

OffsetY
The distance to offset the general reference line in the y-direction of the specified CSys, to the
location of the new bridge layout line.

OffsetZ
The distance to offset the general reference line in the z-direction of the specified CSys, to the
location of the new bridge layout line.

## Remarks


This function converts an existing general reference line to a new bridge layout line, with the
ability to specify offset values.

The function returns zero if the bridge layout line is successfully created; otherwise it returns a
nonzero value.

## VBA Example

Sub ConvertGenRefLine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new general reference line
ret = SapModel.GenRefLine.SetLine("GRef1", 120, 5)

'convert general reference line to bridge layout line
ret = SapModel.GenRefLine.ConvertLineToBLL("GRef1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0.

## See Also

SetLine


# Count

## Syntax

SapObject.SapModel.GenRefLine.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None.

## Remarks

The function returns the number of defined general reference lines.

## VBA Example

Sub CountGenRefLine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new general reference line
ret = SapModel.GenRefLine.SetLine("GRef1", 120, 5)

'get number of general reference line
ret = SapModel.GenRefLine.Count

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0.

## See Also

SetLine

# Delete

## Syntax

SapObject.SapModel.GenRefLine.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing general reference line.

## Remarks

The function deletes the specified general reference line.

The function returns zero if the general reference line is successfully deleted; otherwise it returns a
nonzero value.

## VBA Example

Sub DeleteGenRefLine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new general reference line
ret = SapModel.GenRefLine.SetLine("GRef1", 120, 5)

'delete general reference line
ret = SapModel.GenRefLine.Delete("GRef1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0.

## See Also

SetLine

SetLinePlanPoints

SetLineElevPoints

# GetLine

## Syntax

SapObject.SapModel.GenRefLine.GetLine

## VB6 Procedure

Function GetLine(ByVal Name As String, ByRef DiscLength As Double, ByRef DiscAngle As
Double, ByRef Color As Long, ByRef Visible As Boolean) As Long


## Parameters

Name

The name of an existing general reference line.

DiscLength

The maximum segment discretization length of the segments used to define curves in the general
reference line. [L]

DiscAngle

The maximum discretization angle in degrees for the general reference line. [deg]

Color

The display color assigned to the general reference line.

Visible

Specifies whether the general reference line will be displayed in windows displaying the model.

## Remarks

The function returns zero if the general reference line data is successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetGenRefLine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim discLength As Double, discAngle As Double
Dim color As Long
Dim visible As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new general reference line
ret = SapModel.GenRefLine.SetLine("GRef1", 120, 5)

'get new general reference line
ret = SapModel.GenRefLine.GetLine("GRef1", discLength, discAngle, color, visible)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0.

## See Also

SetLine
GetLinePlanPoints
GetLineElevPoints

# GetLineElevPoints

## Syntax

SapObject.SapModel.GenRefLine.GetLineElevPoints

## VB6 Procedure

Function GetLineElevPoints(ByVal Name As String, ByRef NumberPoints As Long, ByRef
CurveType() As Long, ByRef Value1() As Double, ByRef Value2() As Double, ByRef Value3()
As Double, ByRef s() As Double, ByRef z() As Double, Optional ByVal CSys As String =
"Global") As Long

## Parameters

Name

The name of an existing general reference line.

NumberPoints

The number of points used to define the general reference line elevation layout.

CurveType


This is an array of values indicating the general reference line elevation layout curve type for each
point.

```
0 = None
1 = Circular Curve
2 = Highway Curve
3 = Parabolic Curve
4 = Bezier Curve
5 = BSpline Curve
6 = Bezier Curve Child Point
7 = BSpline Curve Child Point
```
Value1

This is the value of a parameter used to define the general reference line layout. The item that
Value1 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Curve Radius [L]
CurveType = 2: Curve Radius [L]
CurveType = 3: Angle measured from the horizontal, up station axis, to the axis of
symmetry of the parabolic curve. [deg]
CurveType = 4: Number of control points. This is currently hard-wired internally to
4.
CurveType = 5: Number of control points.
CurveType = 6: Not Used
CurveType = 7: Not Used
```
Value2
This is the value of a parameter used to define the general reference line layout. The item that
Value2 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Not Used
CurveType = 2: Curve length, including length of spirals on either end. [L]
CurveType = 3: Rate at which the slope of a parabolic curve is changing in percent.
[1/L]
CurveType = 4: Number of discretization points.
CurveType = 5: Number of discretization points.
CurveType = 6: Not Used
CurveType = 7: Not Used
```
Value3

This is the value of a parameter used to define the general reference line layout. The item that
Value3 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Not Used
CurveType = 2: Not Used
CurveType = 3: Not Used
CurveType = 4: Not Used
CurveType = 5: Curve order.
```

```
CurveType = 6: Not Used
CurveType = 7: Not Used
```
s

This is an array of the station coordinate of each point in the coordinate system specified for the
general reference line. [L]

z

This is an array of the Z coordinate of each point in the coordinate system specified for the general
reference line. [L]

## Remarks

This function retrieves the general reference line elevation points and the associated parameters.

The function returns zero if the general reference line parameters are successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetElevPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberPoints As Long
Dim CurveType() As Long
Dim Value1() As Double
Dim Value2() As Double
Dim Value3() As Double
Dim s() As Double
Dim z() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new general reference line


Name = "GRef1"
ret = SapModel.GenRefLine.SetLine(Name, 120, 5)

'set general reference line elev points data
NumberPoints = 3
ReDim CurveType(NumberPoints – 1)
ReDim x(NumberPoints – 1)
Redim y(NumberPoints – 1)
CurveType(0) = 0
CurveType(1) = 1
CurveType(2) = 0
s(0) = 0: z(0) = 0
s(1) = 100: z(1) = 100
s(2) = 200: z(2) = 100
Value1(0) = 0: Value1(1) = 100: Value1(2) = 0
Value2(0) = 0: Value2(1) = 0: Value2(2) = 0
Value3(0) = 0: Value3(1) = 0: Value3(2) = 0
ret = SapModel.GenRefLine.SetLineElevPoints(Name, NumberPoints, CurveType, Value1,
Value2, Value3, s, z)

'get general reference line plan points data
ReDim CurveType(0)
ReDim Value1(0)
ReDim Value2(0)
ReDim Value3(0)
ReDim s(0)
ReDim z(0)
Ret = SapModel.GenRefLine.GetLinePlanPoints(Name, NumberPoints, Value1, Value2,
Value3, s, z)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0.

## See Also

SetLineElevPoints
GetLine
GetLinePlanPoints


# GetLinePlanPoints

## Syntax

SapObject.SapModel.GenRefLine.GetLinePlanPoints

## VB6 Procedure

Function GetLinePlanPoints(ByVal Name As String, ByRef NumberPoints As Long, ByRef
CurveType() As Long, ByRef Value1() As Double, ByRef Value2() As Double, ByRef Value3()
As Double, ByRef x() As Double, ByRef y() As Double, Optional ByVal CSys As String =
"Global") As Long

## Parameters

Name

The name of an existing general reference line.

NumberPoints

The number of points used to define the general reference line plan layout.

CurveType

This is an array of values indicating the general reference line plan layout curve type for each
point.

```
0 = None
1 = Circular Curve
2 = Highway Curve
3 = Parabolic Curve
4 = Bezier Curve
5 = BSpline Curve
6 = Bezier Curve Child Point
7 = BSpline Curve Child Point
```
Value1

This is the value of a parameter used to define the general reference line layout. The item that
Value1 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Curve Radius [L]
CurveType = 2: Curve Radius [L]
CurveType = 3: Angle measured from the X-axis of the coordinate system in which
the general reference line is defined, to the axis of symmetry of the parabolic curve.
[deg]
CurveType = 4: Number of control points. This is currently hard-wired internally to
4.
CurveType = 5: Number of control points.
```

```
CurveType = 6: Not Used
CurveType = 7: Not Used
```
Value2

This is the value of a parameter used to define the general reference line layout. The item that
Value2 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Not Used
CurveType = 2: Curve length, including length of spirals on either end. [L]
CurveType = 3: Rate at which the slope of a parabolic curve is changing in percent.
[1/L]
CurveType = 4: Number of discretization points.
CurveType = 5: Number of discretization points.
CurveType = 6: Not Used
CurveType = 7: Not Used
```
Value3

This is the value of a parameter used to define the general reference line layout. The item that
Value3 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Not Used
CurveType = 2: Not Used
CurveType = 3: Not Used
CurveType = 4: Not Used
CurveType = 5: Curve order.
CurveType = 6: Not Used
CurveType = 7: Not Used
```
x

This is an array of the X coordinate of each point in the coordinate system specified for the
general reference line. [L]

y

This is an array of the Y coordinate of each point in the coordinate system specified for the
general reference line. [L]

## Remarks

This function retrieves the general reference line plan points and the associated parameters.

The function returns zero if the general reference line parameters are successfully retrieved;
otherwise it returns a nonzero value.

## VBA Example

Sub GetPlanPoints()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberPoints As Long
Dim CurveType() As Long
Dim Value1() As Double
Dim Value2() As Double
Dim Value3() As Double
Dim x() As Double
Dim y() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new general reference line
Name = "GRef1"
ret = SapModel.GenRefLine.SetLine(Name, 120, 5)

'set general reference line plan points data
NumberPoints = 3
ReDim CurveType(NumberPoints – 1)
ReDim x(NumberPoints – 1)
Redim y(NumberPoints – 1)
CurveType(0) = 0
CurveType(1) = 1
CurveType(2) = 0
x(0) = 0: y(0) = 0
x(1) = 100: y(1) = 100
x(2) = 200: y(2) = 100
Value1(0) = 0: Value1(1) = 100: Value1(2) = 0
Value2(0) = 0: Value2(1) = 0: Value2(2) = 0
Value3(0) = 0: Value3(1) = 0: Value3(2) = 0
ret = SapModel.GenRefLine.SetLinePlanPoints(Name, NumberPoints, CurveType, Value1,
Value2, Value3, x, y)

'get general reference line plan points data
ReDim CurveType(0)
ReDim Value1(0)
ReDim Value2(0)
ReDim Value3(0)


ReDim x(0)
ReDim y(0)
Ret = SapModel.GenRefLine.GetLinePlanPoints(Name, NumberPoints, Value1, Value2,
Value3, x, y)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0.

## See Also

SetLinePlanPoints
GetLine
GetLineElevPoints

# GetNameList

## Syntax

SapObject.SapModel.GenRefLine.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of general reference line names retrieved by the program.

MyName

This is a one-dimensional array of general reference line names. The MyName array is created as
a dynamic, zero-based array by the API user:

```
Dim MyName() As String
```
The array is dimensioned to (NumberNames – 1) inside the SAP2000 program, filled with the
names, and returned to the API user.


## Remarks

This function retrieves the names of all defined general reference lines.

The function returns the names; otherwise it returns a nonzero value.

## VBA Example

Sub GetGenRefLineNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new general reference line
ret = SapModel.GenRefLine.SetLine("GRef1", 120, 5)

'get general reference line names
ret = SapModel.GenRefLine.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0.

## See Also

SetLine


# SetLine

## Syntax

SapObject.SapModel.GenRefLine.SetLine

## VB6 Procedure

Function SetLine(ByVal Name As String, ByVal DiscLength As Double, ByVal DiscAngle As
Double, Optional ByVal CSys As String = "Global", Optional ByVal Color As Long = -1,
Optional ByVal Visible As Boolean = True) As Long

## Parameters

Name

This is the name of a general reference line. If this is the name of an existing general reference
line, that general reference line is modified; otherwise a new general reference line is added.

DiscLength

The maximum segment discretization length of the segments used to define curves in the general
reference line. [L]

DiscAngle

The maximum discretization angle in degrees for the general reference line. [deg]

CSys

The name of the coordinate system in which the general reference line is defined.

Color

The display color assigned to the general reference line. If Color is specified as 1, the program
will automatically assign a color.

Visible

The item is True if the general reference line should be displayed in windows displaying the
model.

## Remarks

The function returns zero if the general reference line is successfully added or modified; otherwise
it returns a nonzero value.

## VBA Example


Sub AddGenRefLine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new general reference line
ret = SapModel.GenRefLine.SetLine("GRef1", 120, 5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0.

## See Also

GetLine
SetLinePlanPoints
SetLineElevPoints

Delete

# SetLineElevPoints

## Syntax

SapObject.SapModel.GenRefLine.SetLineElevPoints


## VB6 Procedure

Function SetLineElevPoints(ByVal Name As String, ByVal NumberPoints As Long, ByRef
CurveType() As Long, ByRef Value1() As Double, ByRef Value2() As Double, ByRef Value3()
As Double, ByRef s() As Double, ByRef z() As Double) As Long

## Parameters

Name

The name of a defined general reference line.

NumberPoints

The number of points used to define the general reference line elevation layout.

CurveType

This is an array of values indicating the general reference line elevation layout curve type for each
point.

```
0 = None
1 = Circular Curve
2 = Highway Curve
3 = Parabolic Curve
4 = Bezier Curve
5 = BSpline Curve
6 = Bezier Curve Child Point
7 = BSpline Curve Child Point
```
Value1

This is the value of a parameter used to define the general reference line layout. The item that
Value1 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Curve Radius [L]
CurveType = 2: Curve Radius [L]
CurveType = 3: Angle measured from the horizontal, up station axis, to the axis of
symmetry of the parabolic curve. [deg]
CurveType = 4: Number of control points. This is currently hard-wired internally to
4.
CurveType = 5: Number of control points.
CurveType = 6: Not Used
CurveType = 7: Not Used
```
Value2

This is the value of a parameter used to define the general reference line layout. The item that
Value2 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Not Used
```

```
CurveType = 2: Curve length, including length of spirals on either end. [L]
CurveType = 3: Rate at which the slope of a parabolic curve is changing in percent.
[1/L]
CurveType = 4: Number of discretization points.
CurveType = 5: Number of discretization points.
CurveType = 6: Not Used
CurveType = 7: Not Used
```
Value3

This is the value of a parameter used to define the general reference line layout. The item that
Value3 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Not Used
CurveType = 2: Not Used
CurveType = 3: Not Used
CurveType = 4: Not Used
CurveType = 5: Curve order.
CurveType = 6: Not Used
CurveType = 7: Not Used
```
x

This is an array of the station coordinate of each point in the coordinate system specified for the
general reference line. [L]

y

This is an array of the Z coordinate of each point in the coordinate system specified for the general
reference line. [L]

## Remarks

This function assigns the general reference line elevation layout parameters.

A minimum of three points is required for the Circular, Highway, and Parabolic curves. The
Bezier curve requires a minimum of four points. The BSpline curve requires a minimum of two
points.

The Bezier and BSpline curve types require additional control points as specified by Value2.
These control points are considered to be defined directly after the point specifying the Bezier or
BSpline curve. Any Value1, Value2, or Value3 parameters defined on these control points are
ignored.

The function returns zero if the general reference line parameters are successfully defined;
otherwise it returns a nonzero value.

## VBA Example

Sub SetElevPoints()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberPoints As Long
Dim CurveType() As Long
Dim Value1() As Double
Dim Value2() As Double
Dim Value3() As Double
Dim s() As Double
Dim z() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new general reference line
Name = "GRef1"
ret = SapModel.GenRefLine.SetLine(Name, 120, 5)

'set general reference line elev points data
NumberPoints = 3
ReDim CurveType(NumberPoints – 1)
ReDim s(NumberPoints – 1)
Redim z(NumberPoints – 1)
CurveType(0) = 0
CurveType(1) = 1
CurveType(2) = 0
s(0) = 0: z(0) = 0
s(1) = 100: z(1) = 100
s(2) = 200: z(2) = 100
Value1(0) = 0: Value1(1) = 100: Value1(2) = 0
Value2(0) = 0: Value2(1) = 0: Value2(2) = 0
Value3(0) = 0: Value3(1) = 0: Value3(2) = 0
ret = SapModel.GenRefLine.SetLineElevPoints(Name, NumberPoints, CurveType, Value1,
Value2, Value3, s, z)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 15.0.0.

## See Also

GetLineElevPoints
SetLine
SetLinePlanPoints

# SetLinePlanPoints

## Syntax

SapObject.SapModel.GenRefLine.SetLinePlanPoints

## VB6 Procedure

Function SetLinePlanPoints(ByVal Name As String, ByVal NumberPoints As Long, ByRef
CurveType() As Long, ByRef Value1() As Double, ByRef Value2() As Double, ByRef Value3()
As Double, ByRef x() As Double, ByRef y() As Double) As Long

## Parameters

Name

The name of a defined general reference line.

NumberPoints

The number of points used to define the general reference line plan layout.

CurveType

This is an array of values indicating the general reference line plan layout curve type for each
point.

```
0 = None
1 = Circular Curve
2 = Highway Curve
3 = Parabolic Curve
4 = Bezier Curve
5 = BSpline Curve
6 = Bezier Curve Child Point
7 = BSpline Curve Child Point
```
Value1


This is the value of a parameter used to define the general reference line layout. The item that
Value1 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Curve Radius [L]
CurveType = 2: Curve Radius [L]
CurveType = 3: Angle measured from the X-axis of the coordinate system in which
the general reference line is defined, to the axis of symmetry of the parabolic curve.
[deg]
CurveType = 4: Number of control points. This is currently hard-wired internally to
4.
CurveType = 5: Number of control points.
CurveType = 6: Not Used
CurveType = 7: Not Used
```
Value2

This is the value of a parameter used to define the general reference line layout. The item that
Value2 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Not Used
CurveType = 2: Curve length, including length of spirals on either end. [L]
CurveType = 3: Rate at which the slope of a parabolic curve is changing in percent.
[1/L]
CurveType = 4: Number of discretization points.
CurveType = 5: Number of discretization points.
CurveType = 6: Not Used
CurveType = 7: Not Used
```
Value3

This is the value of a parameter used to define the general reference line layout. The item that
Value3 represents depends on the CurveType item.

```
CurveType = 0: Not Used
CurveType = 1: Not Used
CurveType = 2: Not Used
CurveType = 3: Not Used
CurveType = 4: Not Used
CurveType = 5: Curve order.
CurveType = 6: Not Used
CurveType = 7: Not Used
```
x

This is an array of the X coordinate of each point in the coordinate system specified for the
general reference line. [L]

y

This is an array of the Y coordinate of each point in the coordinate system specified for the
general reference line. [L]


## Remarks

This function assigns the general reference line plan layout parameters.

A minimum of three points is required for the Circular, Highway, and Parabolic curves. The
Bezier curve requires a minimum of four points. The BSpline curve requires a minimum of two
points.

The Bezier and BSpline curve types require additional control points as specified by Value2.
These control points are considered to be defined directly after the point specifying the Bezier or
BSpline curve. Any Value1, Value2, or Value3 parameters defined on these control points are
ignored.

The function returns zero if the general reference line parameters are successfully defined;
otherwise it returns a nonzero value.

## VBA Example

Sub SetPlanPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberPoints As Long
Dim CurveType() As Long
Dim Value1() As Double
Dim Value2() As Double
Dim Value3() As Double
Dim x() As Double
Dim y() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new general reference line
Name = "GRef1"
ret = SapModel.GenRefLine.SetLine(Name, 120, 5)

'set general reference line plan points data


NumberPoints = 3
ReDim CurveType(NumberPoints – 1)
ReDim x(NumberPoints – 1)
Redim y(NumberPoints – 1)
CurveType(0) = 0
CurveType(1) = 1
CurveType(2) = 0
x(0) = 0: y(0) = 0
x(1) = 100: y(1) = 100
x(2) = 200: y(2) = 100
Value1(0) = 0: Value1(1) = 100: Value1(2) = 0
Value2(0) = 0: Value2(1) = 0: Value2(2) = 0
Value3(0) = 0: Value3(1) = 0: Value3(2) = 0
ret = SapModel.GenRefLine.SetLinePlanPoints(Name, NumberPoints, CurveType, Value1,
Value2, Value3, x, y)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0.

## See Also

GetLinePlanPoints
SetLine
SetLineElevPoints

# Add

## Syntax

SapObject.SapModel.GDispl.Add

## VB6 Procedure

Function Add(ByVal Name As String, ByVal MyType As Long) As Long

## Parameters

Name

The name of a new generalized displacement.


MyType

This is 1 or 2 indicating the generalized displacement type.

```
1 = Translational
2 = Rotational
```
## Remarks

This function adds a new generalized displacement with the specified name and type.

The function returns zero if the generalized displacement is successfully added, otherwise it
returns a nonzero value.

The new generalized displacement must have a different name from all other generalized
displacements. If the name is not unique, an error will be returned.

## VBA Example

Sub AddNewGDispl()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

SetPoint

# ChangeName

## Syntax

SapObject.SapModel.GDispl.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined generalized displacement.

NewName

The new name for the generalized displacement.

## Remarks

The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

The new generalized displacement name must be different from all other generalized displacement
names. If the name is not unique, an error will be returned.

## VBA Example

Sub ChangeGDisplName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 1)

'change generalized displacement name
ret = SapModel.GDispl.ChangeName("GD1", "MyGD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# CountPoint

## Syntax

SapObject.SapModel.GDispl.CountPoint

## VB6 Procedure

Function CountPoint(ByVal Name As String, ByRef Count As Long) As Long

## Parameters

Name

The name of an existing generalized displacement.

Count

The number of point objects included in the specified generalized displacement.


## Remarks

This function retrieves the total number of point objects included in a specified generalized
displacement.

The function returns zero if the count is successfully retrieved, otherwise it returns a nonzero
value.

## VBA Example

Sub CountGDisplPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SF() As Double
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 1)

'add points to generalized displacement
ReDim SF(5)
SF(0) = 0.5
ret = SapModel.GDispl.SetPoint("GD1", "3", SF)
ret = SapModel.GDispl.SetPoint("GD1", "7", SF)

'get number of points in generalized displacement
ret = SapModel.GDispl.CountPoint("GD1", Count)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

GetPoint

SetPoint

# Delete

## Syntax

SapObject.SapModel.GDispl.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing generalized displacement.

## Remarks

This function deletes the specified generalized displacement.

The function returns zero if the generalized displacement is successfully deleted, otherwise it
returns a nonzero value.

## VBA Example

Sub DeleteGDispl()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 1)

'delete generalized displacement
ret = SapModel.GDispl.Delete("GD1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

Add

# DeletePoint

## Syntax

SapObject.SapModel.GDispl.DeletePoint

## VB6 Procedure

Function DeletePoint(ByVal Name As String, ByVal PointName As String) As Long

## Parameters

Name

The name of an existing generalized displacement.

PointName

The name of a point object included in the generalized displacement that is to be deleted.


## Remarks

This function deletes one point object from a generalized displacement definition.

The function returns zero if the point is successfully deleted from the generalized displacement
definition, otherwise it returns a nonzero value.

## VBA Example

Sub DeleteGDisplPoint()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 1)

'add points to generalized displacement
ReDim SF(5)
SF(0) = 0.5
ret = SapModel.GDispl.SetPoint("GD1", "3", SF)
ret = SapModel.GDispl.SetPoint("GD1", "7", SF)

'delete point from generalized displacement
ret = SapModel.GDispl.DeletePoint("GD1", "3")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.00.

## See Also

GetPoint

SetPoint

# GetNameList

## Syntax

SapObject.SapModel.GDispl.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of generalized displacement names retrieved by the program.

MyName

This is a one-dimensional array of generalized displacement names. The MyName array is created
as a dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames – 1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined generalized displacements.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetGDisplNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacements
ret = SapModel.GDispl.Add("GD1", 1)
ret = SapModel.GDispl.Add("GD2", 2)

'get generalized displacement names
ret = SapModel.GDispl.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Count

## Syntax

SapObject.SapModel.GDispl.Count

## VB6 Procedure

Function Count() As Long


## Parameters

None

## Remarks

This function returns the total number of generalized displacements defined in the model.

## VBA Example

Sub CountGDispls()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 1)

'return number of generalized displacements
Count = SapModel.GDispl.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

# GetTypeOAPI

## Syntax

SapObject.SapModel.GDispl.GetTypeOAPI

## VB6 Procedure

Function GetTypeOAPI(ByVal Name As String, ByRef MyType As Long) As Long

## Parameters

Name

The name of an existing generalized displacement.

MyType

This is 1 or 2, indicating the generalized displacement type.

```
1 = Translational
2 = Rotational
```
## Remarks

This function retrieves the generalized displacement type.

The function returns zero if the type is successfully retrieved, otherwise it returns a nonzero value.

## VBA Example

Sub GetGDisplType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 2)

'get generalized displacement type
ret = SapModel.GDispl.GetTypeOAPI("GD1", MyType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Change function name to GetTypeOAPI in v17.0.0.

## See Also

SetTypeOAPI

# SetPoint

## Syntax

SapObject.SapModel.GDispl.SetPoint

## VB6 Procedure

Function SetPoint(ByVal Name As String, ByVal PointName As String, ByRef SF() As Double)
As Long

## Parameters

Name

The name of an existing generalized displacement.

PointName

The name of a point object to be included in the generalized displacement definition.


### SF

This is an array of six unitless scale factors for the point object displacement degrees of freedom.

```
SF(0) = U1 scale factor
SF(1) = U2 scale factor
SF(2) = U3 scale factor
SF(3) = R1 scale factor
SF(4) = R2 scale factor
SF(5) = R3 scale factor
```
## Remarks

This function adds a point object and its scale factors to a generalized displacement definition, or,
if the point object already exists in the generalized displacement definition, it modifies the scale
factors.

The function returns zero if the data is successfully added or modified, otherwise it returns a
nonzero value.

## VBA Example

Sub SetGDisplPointData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 1)

'add point to generalized displacement
ReDim SF(5)
SF(0) = 0.5
ret = SapModel.GDispl.SetPoint("GD1", "3", SF)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetPoint

# GetPoint

## Syntax

SapObject.SapModel.GDispl.GetPoint

## VB6 Procedure

Function GetPoint(ByVal Name As String, ByRef NumberItems As Long, ByRef PointName() As
String, ByRef U1() As Double, ByRef U2() As Double, ByRef U3() As Double, ByRef R1() As
Double, ByRef R2() As Double, ByRef R3() As Double) As Long

## Parameters

Name

The name of an existing generalized displacement.

NumberItems

The number of point objects included in the generalized displacement definition.

PointName

This is an array that includes the name of the point objects included in the generalized
displacement definition.

U1, U2, U3, R1, R2, R3

These are arrays that include the unitless scale factors for each of the displacement degrees of
freedom of the associated point objects that are included in the generalized displacement
definition.


## Remarks

This function retrieves the point objects and their scale factors from a generalized displacement
definition.

The function returns zero if the data is successfully retrieved, otherwise it returns a nonzero value.

## VBA Example

Sub GetGDisplPointData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim PointName() As String
Dim U1() As Double
Dim U2() As Double
Dim U3() As Double
Dim R1() As Double
Dim R2() As Double
Dim R3() As Double
Dim SF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 1)

'add points to generalized displacement
ReDim SF(5)
SF(0) = 0.5
ret = SapModel.GDispl.SetPoint("GD1", "3", SF)
ret = SapModel.GDispl.SetPoint("GD1", "7", SF)

'get point data from generalized displacement
ret = SapModel.GDispl.GetPoint("GD1", NumberItems, PointName, U1, U2, U3, R1, R2, R3)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetPoint

# SetTypeOAPI

## Syntax

SapObject.SapModel.GDispl.SetTypeOAPI

## VB6 Procedure

Function SetTypeOAPI(ByVal Name As String, ByVal MyType As Long) As Long

## Parameters

Name

The name of an existing generalized displacement.

MyType

This is 1 or 2, indicating the generalized displacement type.

```
1 = Translational
2 = Rotational
```
## Remarks

This function sets the generalized displacement type.

The function returns zero if the type is successfully set, otherwise it returns a nonzero value.

## VBA Example

Sub SetGDisplType()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 2)

'modify generalized displacement type
ret = SapModel.GDispl.SetTypeOAPI("GD1", 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed function name to SetTypeOAPI in v17.0.0.

## See Also

GetTypeOAPI

# ChangeName

## Syntax

SapObject.SapModel.GroupDef.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long


## Parameters

Name

The existing name of a defined group.

NewName

The new name for the group.

## Remarks

The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

Changing the name of group ALL will fail and return an error.

## VBA Example

Sub ChangeGroupName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'change name of group
ret = SapModel.GroupDef.ChangeName("Group1", "MyGroup")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.00.

## See Also

# Clear

## Syntax

SapObject.SapModel.GroupDef.Clear

## VB6 Procedure

Function Clear(ByVal Name As String) As Long

## Parameters

Name

The name of an existing group.

## Remarks

This function clears (removes) all assignments from the specified group.

The function returns zero if the group assignment is successfully cleared, otherwise it returns a
nonzero value.

## VBA Example

Sub ClearGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'add frame objects to group
ret = SapModel.FrameObj.SetGroupAssign("8", "Group1")
ret = SapModel.FrameObj.SetGroupAssign("10", "Group1")

'clear group
ret = SapModel.GroupDef.Clear("Group1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Count

## Syntax

SapObject.SapModel.GroupDef.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

The function returns the number of defined groups.

## VBA Example


Sub CountGroups()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'return number of defined groups
ret = SapModel.GroupDef.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.GroupDef.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters


Name

The name of an existing group.

## Remarks

The function deletes the specified group. It will return an error if an attempt is made to delete the
Group named ALL.

The function returns zero if the group is successfully deleted, otherwise it returns a nonzero value.

## VBA Example

Sub DeleteGroup()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'delete group
ret = SapModel.GroupDef.Delete("Group1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


## See Also

SetGroup

# GetAssignments

## Syntax

SapObject.SapModel.GroupDef.GetAssignments

## VB6 Procedure

Function GetAssignments(ByVal Name As String, ByRef NumberItems As Long, ByRef
ObjectType() As Long, ByRef ObjectName() As String) As Long

## Parameters

Name

The name of an existing group.

NumberItems

The number of assignments made to the specified group.

ObjectType

This is an array that includes the object type of each item in the group.

```
1 = Point object
2 = Frame object
3 = Cable object
4 = Tendon object
5 = Area object
6 = Solid object
7 = Link object
```
ObjectName

This is an array that includes the name of each item in the group.

## Remarks

This function retrieves the assignments to a specified group.

The function returns zero if the group assignment is successfully retrieved, otherwise it returns a
nonzero value.


## VBA Example

Sub GetGroupAssignments()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberItems As Long
Dim ObjectType() As Long
Dim ObjectName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cable object by points
ret = SapModel.CableObj.AddByPoint("1", "5", Name)

'set cable data
ret = SapModel.CableObj.SetCableData(Name, 7, 1, 0, 0, 24)

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'add point objects to group
ret = SapModel.PointObj.SetGroupAssign("3", "Group1")
ret = SapModel.PointObj.SetGroupAssign("6", "Group1")
ret = SapModel.PointObj.SetGroupAssign("9", "Group1")

'add frame objects to group
ret = SapModel.FrameObj.SetGroupAssign("8", "Group1")
ret = SapModel.FrameObj.SetGroupAssign("10", "Group1")

'add cable object to group
ret = SapModel.CableObj.SetGroupAssign(Name, "Group1")

'get group assignments
ret = SapModel.GroupDef.GetAssignments("Group1", NumberItems, ObjectType,
ObjectName)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# GetGroup

## Syntax

SapObject.SapModel.GroupDef.GetGroup

## VB6 Procedure

Function GetGroup(ByVal Name As String, ByRef color As Long, ByRef SpecifiedForSelection
As Boolean,ByRef SpecifiedForSectionCutDefinition As Boolean, ByRef
SpecifiedForSteelDesign As Boolean, ByRef SpecifiedForConcreteDesign As Boolean, ByRef
SpecifiedForAluminumDesign As Boolean, ByRef SpecifiedForColdFormedDesign As Boolean,
ByRef SpecifiedForStaticNLActiveStage As Boolean, ByRef SpecifiedForBridgeResponseOutput
As Boolean, ByRef SpecifiedForAutoSeismicOutput As Boolean, ByRef
SpecifiedForAutoWindOutput As Boolean, ByRef SpecifiedForMassAndWeight As Boolean) As
Long

## Parameters

Name

The name of an existing group.

color

The display color for the group specified as a Long.

SpecifiedForSelection

This item is True if the group is specified to be used for selection; otherwise it is False.

SpecifiedForSectionCutDefinition

This item is True if the group is specified to be used for defining section cuts; otherwise it is False.

SpecifiedForSteelDesign


This item is True if the group is specified to be used for defining steel frame design groups;
otherwise it is False.

SpecifiedForConcreteDesign

This item is True if the group is specified to be used for defining concrete frame design groups;
otherwise it is False.

SpecifiedForAluminumDesign

This item is True if the group is specified to be used for defining aluminum frame design groups;
otherwise it is False.

SpecifiedForColdFormedDesign

This item is True if the group is specified to be used for defining cold formed frame design
groups; otherwise it is False.

SpecifiedForStaticNLActiveStage

This item is True if the group is specified to be used for defining stages for nonlinear static
analysis; otherwise it is False.

SpecifiedForBridgeResponseOutput

This item is True if the group is specified to be used for reporting bridge response output;
otherwise it is False.

SpecifiedForAutoSeismicOutput

This item is True if the group is specified to be used for reporting auto seismic loads; otherwise it
is False.

SpecifiedForAutoWindOutput

This item is True if the group is specified to be used for reporting auto wind loads; otherwise it is
False.

SpecifiedForMassAndWeight

This item is True if the group is specified to be used for reporting group masses and weight;
otherwise it is False.

## Remarks

The function returns zero if the group data is successfully retrieved, otherwise it returns a nonzero
value.

## VBA Example

Sub GetGroupData()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret as Long
Dim Color as long
Dim SpecifiedForSelection as Boolean
Dim SpecifiedForSectionCutDefinition as Boolean
Dim SpecifiedForSteelDesign as Boolean
Dim SpecifiedForConcreteDesign as Boolean
Dim SpecifiedForAluminumDesign as Boolean
Dim SpecifiedForColdFormedDesign as Boolean
Dim SpecifiedForStaticNLActiveStage as Boolean
Dim SpecifiedForBridgeResponseOutput as Boolean
Dim SpecifiedForAutoSeismicOutput as Boolean
Dim SpecifiedForAutoWindOutput as Boolean
Dim SpecifiedForMassAndWeight as Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get group data
ret = SapModel.GroupDef.GetGroup("ALL", Color, SpecifiedForSelection,
SpecifiedForSectionCutDefinition, SpecifiedForSteelDesign, SpecifiedForConcreteDesign,
SpecifiedForAluminumDesign, SpecifiedForColdFormedDesign,
SpecifiedForStaticNLActiveStage, SpecifiedForBridgeResponseOutput,
SpecifiedForAutoSeismicOutput, SpecifiedForAutoWindOutput, SpecifiedForMassAndWeight)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetGroup


# GetNameList

## Syntax

SapObject.SapModel.GroupDef.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of group names retrieved by the program.

MyName

This is a one-dimensional array of group names. The MyName array is created as a dynamic, zero-
based, array by the API user:

Dim MyName() as String

The array is dimensioned to (NumberNames – 1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined groups.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetGroupNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get group names
ret = SapModel.GroupDef.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# SetGroup

## Syntax

SapObject.SapModel.GroupDef.SetGroup

## VB6 Procedure

Function SetGroup(ByVal Name As String, Optional ByVal color As Long = -1, Optional ByVal
SpecifiedForSelection As Boolean = True, Optional ByVal SpecifiedForSectionCutDefinition As
Boolean = True, Optional ByVal SpecifiedForSteelDesign As Boolean = True, Optional ByVal
SpecifiedForConcreteDesign As Boolean = True, Optional ByVal SpecifiedForAluminumDesign
As Boolean = True, Optional ByVal SpecifiedForColdFormedDesign As Boolean = True,
Optional ByVal SpecifiedForStaticNLActiveStage As Boolean = True, Optional ByVal
SpecifiedForBridgeResponseOutput As Boolean = True, Optional ByVal
SpecifiedForAutoSeismicOutput As Boolean = False, Optional ByVal
SpecifiedForAutoWindOutput As Boolean = False, Optional ByVal SpecifiedForMassAndWeight
As Boolean = True) As Long

## Parameters

Name


This is the name of a group. If this is the name of an existing group, that group is modified,
otherwise a new group is added.

color

The display color for the group specified as a Long. If this value is input as –1, the program
automatically selects a display color for the group.

SpecifiedForSelection

This item is True if the group is specified to be used for selection; otherwise it is False.

SpecifiedForSectionCutDefinition

This item is True if the group is specified to be used for defining section cuts; otherwise it is False.

SpecifiedForSteelDesign

This item is True if the group is specified to be used for defining steel frame design groups;
otherwise it is False.

SpecifiedForConcreteDesign

This item is True if the group is specified to be used for defining concrete frame design groups;
otherwise it is False.

SpecifiedForAluminumDesign

This item is True if the group is specified to be used for defining aluminum frame design groups;
otherwise it is False.

SpecifiedForColdFormedDesign

This item is True if the group is specified to be used for defining cold formed frame design
groups; otherwise it is False.

SpecifiedForStaticNLActiveStage

This item is True if the group is specified to be used for defining stages for nonlinear static
analysis; otherwise it is False.

SpecifiedForBridgeResponseOutput

This item is True if the group is specified to be used for reporting bridge response output;
otherwise it is False.

SpecifiedForAutoSeismicOutput

This item is True if the group is specified to be used for reporting auto seismic loads; otherwise it
is False.

SpecifiedForAutoWindOutput

This item is True if the group is specified to be used for reporting auto wind loads; otherwise it is
False.


SpecifiedForMassAndWeight

This item is True if the group is specified to be used for reporting group masses and weight;
otherwise it is False.

## Remarks

The function returns zero if the group data is successfully set, otherwise it returns a nonzero value.

## VBA Example

Sub SetGroupData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define new group
ret = SapModel.GroupDef.SetGroup("Group1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

GetGroup


# ChangeName

## Syntax

SapObject.SapModel.PatternDef.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined joint pattern.

NewName

The new name for the joint pattern.

## Remarks

The function returns zero if the new name is successfully applied, otherwise it returns a nonzero
value.

## VBA Example

Sub ChangePatternName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'change name of group


ret = SapModel.PatternDef.ChangeName("Default", "MyPattern")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Count

## Syntax

SapObject.SapModel.PatternDef.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

The function returns the number of defined joint patterns.

## VBA Example

Sub CountPatterns()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'return number of defined joint patterns
ret = SapModel.PatternDef.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.PatternDef.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing joint pattern.

## Remarks

The function deletes the specified joint pattern. At least one joint pattern must be defined. The
function will return an error if an attempt is made to delete the last joint pattern.

The function returns zero if the joint pattern is successfully deleted, otherwise it returns a nonzero
value.


## VBA Example

Sub DeletePattern()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add joint pattern
ret = SapModel.PatternDef.SetPattern("MyPattern")

'delete joint pattern
ret = SapModel.PatternDef.Delete("MyPattern")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

SetPattern

# GetNameList

## Syntax

SapObject.SapModel.PatternDef.GetNameList


## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of joint pattern names retrieved by the program.

MyName

This is a one-dimensional array of joint pattern names. The MyName array is created as a
dynamic, zero-based, array by the API user:

Dim MyName() as String

The array is dimensioned to (NumberNames – 1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined joint patterns.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetJointPatternNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get joint pattern names
ret = SapModel.PatternDef.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# SetPattern

## Syntax

SapObject.SapModel.PatternDef.SetPattern

## VB6 Procedure

Function SetPattern(ByVal Name As String) As Long

## Parameters

Name

The name of a new joint pattern.

## Remarks

The function defines a new joint pattern. It returns an error if the specified joint pattern name is
already in use.

The function returns zero if the new joint pattern is successfully defined, otherwise it returns a
nonzero value.

## VBA Example

Sub AddPattern()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add joint pattern
ret = SapModel.PatternDef.SetPattern("MyPattern")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

## See Also

# ChangeName

## Syntax

SapObject.SapModel.LoadCases.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name


The existing name of a defined load case.

NewName

The new name for the load case.

## Remarks

This function changes the name of an existing load case.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeLoadCaseName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'change load case name
ret = SapModel.LoadCases.ChangeName("DEAD", "DL")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

# Count

## Syntax

SapObject.SapModel.LoadCases.Count

## VB6 Procedure

Function Count(Optional ByVal CaseType As eLoadCaseType) As Long

## Parameters

```
CaseType
```
This optional value is one of the following items in the eLoadCaseType enumeration.

```
CASE_LINEAR_STATIC = 1
```
```
CASE_NONLINEAR_STATIC = 2
```
```
CASE_MODAL = 3
```
```
CASE_RESPONSE_SPECTRUM = 4
```
```
CASE_LINEAR_HISTORY = 5 (Modal Time History)
```
```
CASE_NONLINEAR_HISTORY = 6 (Modal Time History)
```
```
CASE_LINEAR_DYNAMIC = 7 (Direct Integration Time History)
```
```
CASE_NONLINEAR_DYNAMIC = 8 (Direct Integration Time History)
```
```
CASE_MOVING_LOAD = 9
```
```
CASE_BUCKLING = 10
```
```
CASE_STEADY_STATE = 11
```
```
CASE_POWER_SPECTRAL_DENSITY = 12
```
```
CASE_LINEAR_STATIC_MULTISTEP = 13
```
```
CASE_HYPERSTATIC = 14
```
If no value is input for CaseType, a count is returned for all load cases in the model regardless of
type.


## Remarks

This function returns the total number of defined load cases in the model. If desired, counts can be
returned for all load cases of a specified type in the model.

## VBA Example

Sub CountLoadCases()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'return number of load cases of all types
Count = SapModel.LoadCases.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Added optional CaseType parameter in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Added one item to the eLoadCaseType enumeration in version 12.00.


## See Also

# Delete

## Syntax

SapObject.SapModel.LoadCases.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing load case.

## Remarks

The function deletes the specified load case.

The function returns zero if the load case is successfully deleted, otherwise it returns a nonzero
value.

## VBA Example

Sub DeleteLoadCase()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)


'delete load case
ret = SapModel.LoadCases.Delete("DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# GetNameList_1

## Syntax

SapObject.SapModel.LoadCases.GetNameList_1

## VB6 Procedure

Function GetNameList_1(ByRef NumberNames As Long, ByRef MyName() As String, Optional
ByVal CaseType As eLoadCaseType) As Long

## Parameters

**NumberNames**

The number of load case names retrieved by the program.

**MyName**

This is a one-dimensional array of load case names. The MyName array is created as a dynamic,
zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the Sap2000 program, filled with the
names, and returned to the API user.

**CaseType**

This optional value is one of the following items in the eLoadCaseType enumeration.


```
Linear Static = 1
```
```
Nonlinear_Static = 2
```
```
Modal = 3
```
```
Response_Spectrum = 4
```
```
Linear_History = 5 (Modal Time History)
```
```
Nonlinear_History = 6 (Modal Time History)
```
```
Linear_Dynamic = 7 (Direct Integration Time History)
```
```
Nonlinear_Dynamic = 8 (Direct Integration Time History)
```
```
Moving_Load = 9
```
```
Buckling = 10
```
```
Steady_State = 11
```
```
Power_Spectral_Density = 12
```
```
Linear_Static_Multistep = 13
```
```
Hyperstatic = 14
```
```
External_Results = 15
```
```
StagedConstruction = 16
```
```
NonlinearStaticMultiStep = 17
```
If no value is input for CaseType, names are returned for all load cases in the model regardless of
type.

## Remarks

This function retrieves the names of all defined load cases of the specified type.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetLoadCaseNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get load case names
ret = SapModel.LoadCases.GetNameList_1(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

This function supersedes GetNameList {Load Case}.

## See Also

# GetTypeOAPI_2

## Syntax

SapObject.SapModel.LoadCases.GetTypeOAPI_2

## VB6 Procedure

Function GetTypeOAPI_2(ByVal Name As String, ByRef CaseType As eLoadCaseType, ByRef
SubType As Long, ByRef DesignType As eLoadPatternType, ByRef DesignTypeOption As
Long, ByRef Auto As Long) As Long

## Parameters

Name

The name of an existing load case.


CaseType

This is one of the following items in the eLoadCaseType enumeration.

```
LinearStatic = 1
```
```
NonlinearStatic = 2
```
```
Modal = 3
```
```
ResponseSpectrum = 4
```
```
LinearHistory = 5 (Modal Time History)
```
```
NonlinearHistory = 6 (Modal Time History)
```
```
LinearDynamic = 7 (Direct Integration Time History)
```
```
NonlinearDynamic = 8 (Direct Integration Time History)
```
```
MovingLoad = 9
```
```
Buckling = 10
```
```
SteadyState = 11
```
```
PowerSpectralDensity = 12
```
```
LinearStaticMultistep = 13
```
```
Hyperstatic = 14
```
```
ExternalResults = 15
```
```
StagedConstruction = 16
```
```
NonlinearStaticMultiStep = 17
```
SubType

This is an integer representing the load case sub type. This item applies only for certain case types.

For CASE_MODAL:

```
1 = Eigen
2 = Ritz
```
For CASE_LINEAR_HISTORY:

```
1 = Transient
2 = Periodic
```
DesignType

This is one of the following items in the eLoadPatternType enumeration.


Dead = 1
SuperDead = 2
Live = 3
ReduceLive = 4
Quake = 5
Wind = 6
Snow = 7
Other = 8
Move = 9
Temperature = 10
RoofLive = 11
Notional = 12
PatternLive = 13
Wave= 14
Braking = 15
Centrifugal = 16
Friction = 17
Ice = 18
WindOnLiveLoad = 19
HorizontalEarthPressure = 20
VerticalEarthPressure = 21
EarthSurcharge = 22
DownDrag = 23
VehicleCollision = 24
VesselCollision = 25
TemperatureGradient = 26
Settlement = 27
Shrinkage = 28
Creep = 29
WaterLoadPressure = 30
LiveLoadSurcharge = 31
LockedInForces = 32
PedestrianLL = 33
Prestress = 34
Hyperstatic = 35
Bouyancy = 36
StreamFlow = 37
Impact = 38
Construction = 39
DeadWearing = 40
DeadWater = 41
DeadManufacture = 42
EarthHydrostatic = 43
PassiveEarthPressure = 44
ActiveEarthPressure = 45
PedestrianLLReduced = 46
SnowHighAltitude = 47
EuroLm1Char = 48
EuroLm1Freq = 49
EuroLm2 = 50
EuroLm3 = 51
EuroLm4 = 52


DesignTypeOption

This is one of the following options for the DesignType item.

```
0 = Program determined
1 = User specified
```
Auto

This is one of the following values indicating if the load case has been automatically created.

```
0 = Not automatically created
1 = Automatically created by the bridge construction scheduler
```
## Remarks

This function retrieves the case type, design type, and auto flag for the specified load case.

The function returns zero if the type is successfully retrieved; otherwise it returns nonzero.

This function supersedes. GetTypeOAPI_1 {LoadCase}.

## VBA Example

Sub GetLoadCaseType_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim CaseType As eLoadCaseType
Dim SubType As Long
Dim DesignType As Long
Dim DesignTypeOption As Long
Dim Auto As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get load case type
ret = SapModel.LoadCases.GetTypeOAPI_2("DEAD", CaseType, SubType, DesignType,


DesignTypeOption, Auto)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

This function supersedes GetTypeOAPI _1{Load Case}.

## See Also

# SetDesignType

## Syntax

SapObject.SapModel.LoadCases.SetDesignType

## VB6 Procedure

Function SetDesignType(ByVal Name As String, ByVal DesignTypeOption As Long, Optional
ByVal DesignType As eLoadPatternType = LTYPE_DEAD) As Long

## Parameters

Name

The name of an existing load case.

DesignTypeOption

This is one of the following options for the DesignType item.

```
0 = Program determined
1 = User specified
```
DesignType

This item only applies when the DesignTypeOption is 1 (user specified). It is one of the following
items in the eLoadPatternType enumeration.

```
LTYPE_DEAD = 1
LTYPE_SUPERDEAD = 2
LTYPE_LIVE = 3
LTYPE_REDUCELIVE = 4
```

### LTYPE_QUAKE = 5

### LTYPE_WIND= 6

### LTYPE_SNOW = 7

### LTYPE_OTHER = 8

### LTYPE_MOVE = 9

### LTYPE_TEMPERATURE = 10

### LTYPE_ROOFLIVE = 11

### LTYPE_NOTIONAL = 12

### LTYPE_PATTERNLIVE = 13

### LTYPE_WAVE= 14

### LTYPE_BRAKING = 15

### LTYPE_CENTRIFUGAL = 16

### LTYPE_FRICTION = 17

### LTYPE_ICE = 18

### LTYPE_WINDONLIVELOAD = 19

### LTYPE_HORIZONTALEARTHPRESSURE = 20

### LTYPE_VERTICALEARTHPRESSURE = 21

### LTYPE_EARTHSURCHARGE = 22

### LTYPE_DOWNDRAG = 23

### LTYPE_VEHICLECOLLISION = 24

### LTYPE_VESSELCOLLISION = 25

### LTYPE_TEMPERATUREGRADIENT = 26

### LTYPE_SETTLEMENT = 27

### LTYPE_SHRINKAGE = 28

### LTYPE_CREEP = 29

### LTYPE_WATERLOADPRESSURE = 30

### LTYPE_LIVELOADSURCHARGE = 31

### LTYPE_LOCKEDINFORCES = 32

### LTYPE_PEDESTRIANLL = 33

### LTYPE_PRESTRESS = 34

### LTYPE_HYPERSTATIC = 35

### LTYPE_BOUYANCY = 36

### LTYPE_STREAMFLOW = 37

### LTYPE_IMPACT = 38

### LTYPE_CONSTRUCTION = 39

## Remarks

This function sets the design type for the specified load case.

The function returns zero if the type is successfully set; otherwise it returns nonzero.

## VBA Example

Sub SetLoadCaseDesignType

'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set load case design type
ret = SapModel.LoadCases.SetDesignType("DEAD", 1, LTYPE_SUPERDEAD)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetType_1

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.Buckling.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing buckling load case.


InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else then zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseBucklingInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add buckling load case
ret = SapModel.LoadCases.Buckling.SetCase("LCASE1")

'get initial condition
ret = SapModel.LoadCases.Buckling.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.Buckling.GetLoads

## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef SF() As Double) As Long

## Parameters

Name

The name of an existing buckling load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for
Accel UX UY and UZ; otherwise unitless


## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseBucklingLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MySF() As Double
Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim SF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add buckling load case
ret = SapModel.LoadCases.Buckling.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MySF(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MySF(0) = 0.7
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MySF(1) = 1.2
ret = SapModel.LoadCases.Buckling.SetLoads("LCASE1", 2, MyLoadType, MyLoadName,
MySF)


'get load data
ret = SapModel.LoadCases.Buckling.GetLoads("LCASE1", NumberLoads, LoadType,
LoadName, SF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoads

# GetParameters

## Syntax

SapObject.SapModel.LoadCases.Buckling.GetParameters

## VB6 Procedure

Function GetParameters(ByVal Name As String, ByRef NumBucklingModes As Long, ByRef
EigenTol As Double) As Long

## Parameters

Name

The name of an existing buckling load case.

NumBucklingModes

The number of buckling modes requested.

EigenTol

The relative convergence tolerance for eigenvalues.

## Remarks


This function retrieves various parameters for the specified load case.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseBucklingParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumBucklingModes As Long
Dim EigenTol As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add buckling load case
ret = SapModel.LoadCases.Buckling.SetCase("LCASE1")

'get parameters
ret = SapModel.LoadCases.Buckling.GetParameters("LCASE1", NumBucklingModes,
EigenTol)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

SetParameters

# SetCase

## Syntax

SapObject.SapModel.LoadCases.Buckling.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case then that case is modified,
otherwise, a new case is added.

## Remarks

This function initializes a buckling load case. If this function is called for an existing load case, all
items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseBuckling()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add buckling load case
ret = SapModel.LoadCases.Buckling.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.Buckling.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing buckling load case.

InitialCase

This is blank, None or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.


## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseBucklingInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add buckling load case
ret = SapModel.LoadCases.Buckling.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.Buckling.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetInitialCase

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.Buckling.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef SF() As Double) As Long

## Parameters

Name

The name of an existing buckling load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Acce, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction of
the load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for
Accel UX UY and UZ; otherwise unitless

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.


## VBA Example

Sub SetCaseBucklingLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MySF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add buckling load case
ret = SapModel.LoadCases.Buckling.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MySF(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MySF(0) = 0.7
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MySF(1) = 1.2
ret = SapModel.LoadCases.Buckling.SetLoads("LCASE1", 2, MyLoadType, MyLoadName,
MySF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# SetParameters

## Syntax

SapObject.SapModel.LoadCases.Buckling.SetParameters

## VB6 Procedure

Function SetParameters(ByVal Name As String, ByVal NumBucklingModes As Long, ByVal
EigenTol As Double) As Long

## Parameters

Name

The name of an existing buckling load case.

NumBucklingModes

The number of buckling modes requested.

EigenTol

The relative convergence tolerance for eigenvalues.

## Remarks

This function sets various parameters for the specified buckling load case.

The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseBucklingParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add buckling load case
ret = SapModel.LoadCases.Buckling.SetCase("LCASE1")

'set parameters
ret = SapModel.LoadCases.Buckling.SetParameters("LCASE1", 4, 1E-10)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetParameters

# GetDampProportional

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.GetDampProportional

## VB6 Procedure

Function GetDampProportional(ByVal Name As String, ByRef DampType As Long, ByRef
Dampa As Double, ByRef Dampb As Double, ByRef Dampf1 As Double, ByRef Dampf2 As
Double, ByRef Dampd1 As Double, ByRef Dampd2 As Double) As Long


## Parameters

Name

The name of an existing linear direct integration time history load case that has proportional
damping.

DampType

This is 1, 2 or 3, indicating the proportional modal damping type.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
```
Dampa

The mass proportional damping coefficient.

Dampb

The stiffness proportional damping coefficient.

Dampf1

This is the period or the frequency (depending on the value of the DampType item) for point 1. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampf2

This is the period or the frequency (depending on the value of the DampType item) for point 2. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampd1

This is the damping at point 1 (0 <= Dampd1 < 1).

This item applies only when DampType = 2 or 3.

Dampd2

This is the damping at point 2 (0 <= Dampd2 < 1).

This item applies only when DampType = 2 or 3.

## Remarks

This function retrieves the proportional modal damping data assigned to the specified load case.


The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseDirHistLinearDampProportional()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long
Dim Dampa As Double
Dim Dampb As Double
Dim Dampf1 As Double
Dim Dampf2 As Double
Dim Dampd1 As Double
Dim Dampd2 As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'set proportional damping
ret = SapModel.LoadCases.DirHistLinear.SetDampProportional("LCASE1", 2, 0, 0, 0.1, 1,
0.05, 0.06)

'get proportional damping
ret = SapModel.LoadCases.DirHistLinear.GetDampProportional("LCASE1", DampType,
Dampa, Dampb, Dampf1, Dampf2, Dampd1, Dampd2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampProportional

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing linear direct integration time history load case.

InitialCase

This is blank, None or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseDirHistLinearInitialCondition()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'get initial condition
ret = SapModel.LoadCases.DirHistLinear.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.GetLoads


## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef
TF() As Double, ByRef AT() As Double, ByRef CSys() As String, ByRef Ang() As Double) As
Long

## Parameters

Name

The name of an existing linear direct integration time history load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load or Accel, indicating the type of each load assigned to the load
case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the time history function associated with each load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

TF

This is an array that includes the time scale factor of each load assigned to the load case.

AT

This is an array that includes the arrival time of each load assigned to the load case.

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.


Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseDirHistLinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyTF() As Double
Dim MyAT() As Double
Dim MyCSys() As String
Dim MyAng() As Double
Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim Func() As String
Dim SF() As Double
Dim TF() As Double
Dim AT() As Double
Dim CSys() As String
Dim Ang() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyTF(1)
ReDim MyAT(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "RAMPTH"
MySF(0) = 1
MyTF(0) = 1
MyAT(0) = 0
MyCSys(0) = "Global"
MyAng(0) = 0
MyLoadType(1) = "Accel"
MyLoadName(1) = "U2"
MyFunc(1) = "TH-1"
MySF(1) = 2
MyTF(1) = 1.5
MyAT(1) = 10
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.DirHistLinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MyFunc, MySF, MyTF, MyAT, MyCSys, MyAng)

'get load data
ret = SapModel.LoadCases.DirHistLinear.GetLoads("LCASE1", NumberLoads, LoadType,
LoadName, Func, SF, TF, AT, CSys, Ang)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

SetLoads

# GetTimeIntegration

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.GetTimeIntegration

## VB6 Procedure

Function GetTimeIntegration(ByVal Name As String, ByRef IntegrationType As Long, ByRef
Alpha As Double, ByRef Beta As Double, ByRef Gamma As Double, ByRef Theta As Double,
ByRef m As Double) As Long

## Parameters

Name

The name of an existing linear direct integration time history load case.

IntegrationType

This is 1, 2, 3, 4 or 5, indicating the time integration type.

```
1 = Newmark
2 = Wilson
3 = Collocation
4 = Hilber-Hughes-Taylor
5 = Chung and Hulbert
```
Alpha

The alpha factor (-1/3 <= Alpha <= 0).

This item applies only when IntegrationType = 4 or 5.

Beta

The beta factor (Beta >= 0).

This item applies only when IntegrationType = 1, 3 or 5. It is returned for informational purposes
when IntegrationType = 4.

Gamma

The gamma factor (Gamma >= 0.5).

This item applies only when IntegrationType = 1, 3 or 5. It is returned for informational purposes
when IntegrationType = 4.


Theta

The theta factor (Theta > 0).

This item applies only when IntegrationType = 2 or 3.

m

The alpha-m factor.

This item only applies when IntegrationType = 5.

## Remarks

This function retrieves the time integration data assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseDirHistLinearTimeIntegration()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim IntegrationType As Long
Dim Alpha As Double
Dim Beta As Double
Dim Gamma As Double
Dim Theta As Double
Dim m As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'set time integration parameters


ret = SapModel.LoadCases.DirHistLinear.SetTimeIntegration("LCASE1", 3, 0, 0.17, 0.52,
0.9)

'get time integration parameters
ret = SapModel.LoadCases.DirHistLinear.GetTimeIntegration("LCASE1", IntegrationType,
Alpha, Beta, Gamma, Theta, m)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetTimeIntegration

# GetTimeStep

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.GetTimeStep

## VB6 Procedure

Function GetTimeStep(ByVal Name As String, ByRef nstep As Long, ByRef DT As Double) As
Long

## Parameters

Name

The name of an existing linear direct integration time history load case.

nstep

The number of output time steps.

DT

The output time step size.


## Remarks

This function retrieves the time step data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseDirHistLinearTimeStep()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim nstep As Long
Dim DT As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'get time step data
ret = SapModel.LoadCases.DirHistLinear.GetTimeStep ("LCASE1", nstep, DT )

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

SetTimeStep

# SetCase

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise a new case is added.

## Remarks

This function initializes a linear direct integration time history load case. If this function is called
for an existing load case, all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseDirHistLinear()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetDampProportional

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.SetDampProportional

## VB6 Procedure

Function SetDampProportional(ByVal Name As String, ByVal DampType As Long, ByVal
Dampa As Double, ByVal Dampb As Double, ByVal Dampf1 As Double, ByVal Dampf2 As
Double, ByVal Dampd1 As Double, ByVal Dampd2 As Double) As Long

## Parameters

Name

The name of an existing linear direct integration time history load case.

DampType

This is 1, 2 or 3, indicating the proportional modal damping type.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
```
Dampa


The mass proportional damping coefficient. This item applies only when DampType = 1.

Dampb

The stiffness proportional damping coefficient. This item applies only when DampType = 1.

Dampf1

This is the period or the frequency (depending on the value of the DampType item) for point 1. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampf2

This is either the period or the frequency (depending on the value of the DampType item) for
point 2. [s] for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampd1

This is the damping at point 1 (0 <= Dampd1 < 1).

This item applies only when DampType = 2 or 3.

Dampd2

This is the damping at point 2 (0 <= Dampd2 < 1).

This item applies only when DampType = 2 or 3.

## Remarks

This function sets proportional modal damping data for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseDirHistLinearDampProportional()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'set proportional damping
ret = SapModel.LoadCases.DirHistLinear.SetDampProportional("LCASE1", 2, 0, 0, 0.1, 1,
0.05, 0.06)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampProportional

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing linear direct integration time history load case.


InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case. the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseDirHistLinearInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.DirHistLinear.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef TF
() As Double, ByRef AT() As Double, ByRef CSys() As String, ByRef Ang() As Double) As
Long

## Parameters

Name

The name of an existing linear direct integration time history load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load or Accel, indicating the type of each load assigned to the load
case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.


If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the time history function associated with each load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

TF

This is an array that includes the time scale factor of each load assigned to the load case.

AT

This is an array that includes the arrival time of each load assigned to the load case.

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.

Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseDirHistLinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyTF() As Double


Dim MyAT() As Double
Dim MyCSys() As String
Dim MyAng() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyTF(1)
ReDim MyAT(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "RAMPTH"
MySF(0) = 1
MyTF(0) = 1
MyAT(0) = 0
MyCSys(0) = "Global"
MyAng(0) = 0
MyLoadType(1) = "Accel"
MyLoadName(1) = "U2"
MyFunc(1) = "TH-1"
MySF(1) = 2
MyTF(1) = 1.5
MyAT(1) = 10
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.DirHistLinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MyFunc, MySF, MyTF, MyAT, MyCSys, MyAng)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# SetTimeIntegration

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.SetTimeIntegration

## VB6 Procedure

Function SetTimeIntegration(ByVal Name As String, ByVal IntegrationType As Long, ByVal
Alpha As Double, ByVal Beta As Double, ByVal Gamma As Double, ByVal Theta As Double,
Optional ByVal m As Double = 0) As Long

## Parameters

Name

The name of an existing linear direct integration time history load case.

IntegrationType

This is 1, 2, 3, 4 or 5, indicating the time integration type.

```
1 = Newmark
2 = Wilson
3 = Collocation
4 = Hilber-Hughes-Taylor
5 = Chung and Hulbert
```
Alpha

The alpha factor (-1/3 <= Alpha <= 0).


This item applies only when IntegrationType = 4 or 5.

Beta

The beta factor (Beta >= 0).

This item applies only when IntegrationType = 1, 3 or 5.

Gamma

The gamma factor (Gamma >= 0.5).

This item applies only when IntegrationType = 1, 3 or 5.

Theta

The theta factor (Theta > 0).

This item applies only when IntegrationType = 2 or 3.

m

The alpha-m factor.

This item applies only when IntegrationType = 5.

## Remarks

This function sets time integration data for the specified load case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseDirHistLinearTimeIntegration()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'set time integration parameters
ret = SapModel.LoadCases.DirHistLinear.SetTimeIntegration("LCASE1", 3, 0, 0.17, 0.52,
0.9)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetTimeIntegration

# SetTimeStep

## Syntax

SapObject.SapModel.LoadCases.DirHistLinear.SetTimeStep

## VB6 Procedure

Function SetTimeStep(ByVal Name As String, ByVal nstep As Long, ByVal DT As Double) As
Long

## Parameters

Name

The name of an existing linear direct integration time history load case.

nstep

The number of output time steps.

DT


The output time step size.

## Remarks

This function sets the time step data for the specified load case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseDirHistLinearTimeStep()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear direct history load case
ret = SapModel.LoadCases.DirHistLinear.SetCase("LCASE1")

'set time step data
ret = SapModel.LoadCases.DirHistLinear.SetTimeStep("LCASE1", 120, 0.05)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetTimeStep

# GetDampProportional

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.GetDampProportional

## VB6 Procedure

Function GetDampProportional(ByVal Name As String, ByRef DampType As Long, ByRef
Dampa As Double, ByRef Dampb As Double, ByRef Dampf1 As Double, ByRef Dampf2 As
Double, ByRef Dampd1 As Double, ByRef Dampd2 As Double) As Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case that has proportional
damping.

DampType

This is 1, 2 or 3, indicating the proportional modal damping type.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
```
Dampa

The mass proportional damping coefficient.

Dampb

The stiffness proportional damping coefficient.

Dampf1

This is the period or the frequency (depending on the value of the DampType item) for point 1. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampf2

This is the period or the frequency (depending on the value of the DampType item) for point 2. [s]
for DampType = 2 and [cyc/s] for DampType = 3


This item applies only when DampType = 2 or 3.

Dampd1

This is the damping at point 1 (0 <= Dampd1 < 1).

This item applies only when DampType = 2 or 3.

Dampd2

This is the damping at point 2 (0 <= Dampd2 < 1).

This item applies only when DampType = 2 or 3.

## Remarks

This function retrieves the proportional modal damping data assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseDirHistNonlinearDampProportional()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long
Dim Dampa As Double
Dim Dampb As Double
Dim Dampf1 As Double
Dim Dampf2 As Double
Dim Dampd1 As Double
Dim Dampd2 As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case


ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'set proportional damping
ret = SapModel.LoadCases.DirHistNonlinear.SetDampProportional("LCASE1", 2, 0, 0, 0.1,
1, 0.05, 0.06)

'get proportional damping
ret = SapModel.LoadCases.DirHistNonlinear.GetDampProportional("LCASE1", DampType,
Dampa, Dampb, Dampf1, Dampf2, Dampd1, Dampd2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampProportional

# GetGeometricNonlinearity

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.GetGeometricNonlinearity

## VB6 Procedure

Function GetGeometricNonlinearity(ByVal Name As String, ByRef NLGeomType As Long) As
Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

NLGeomType

This is 0, 1 or 2, indicating the geometric nonlinearity option selected for the load case.

```
0 = None
```

```
1 = P-delta
2 = P-delta plus large displacements
```
## Remarks

This function retrieves the geometric nonlinearity option for the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseDirHistNonlinearGeometricNonlinearity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NLGeomType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'get geometric nonlinearity option
ret = SapModel.LoadCases.DirHistNonlinear.GetGeometricNonlinearity("LCASE1",
NLGeomType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetGeometricNonlinearity

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

InitialCase

This is blank, None or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts from the state at the end
of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the state at the end of that case is used. If the initial case is anything else then zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseDirHistNonlinearInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'get initial condition
ret = SapModel.LoadCases.DirHistNonlinear.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.GetLoads

## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef


TF() As Double, ByRef AT() As Double, ByRef CSys() As String, ByRef Ang() As Double) As
Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load or Accel, indicating the type of each load assigned to the load
case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the time history function associated with each load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

TF

This is an array that includes the time scale factor of each load assigned to the load case.

AT

This is an array that includes the arrival time of each load assigned to the load case.

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.

Ang


This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseDirHistNonlinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyTF() As Double
Dim MyAT() As Double
Dim MyCSys() As String
Dim MyAng() As Double
Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim Func() As String
Dim SF() As Double
Dim TF() As Double
Dim AT() As Double
Dim CSys() As String
Dim Ang() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyTF(1)
ReDim MyAT(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "RAMPTH"
MySF(0) = 1
MyTF(0) = 1
MyAT(0) = 0
MyCSys(0) = "Global"
MyAng(0) = 0
MyLoadType(1) = "Accel"
MyLoadName(1) = "U2"
MyFunc(1) = "TH-1"
MySF(1) = 2
MyTF(1) = 1.5
MyAT(1) = 10
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.DirHistNonlinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MyFunc, MySF, MyTF, MyAT, MyCSys, MyAng)

'get load data
ret = SapModel.LoadCases.DirHistNonlinear.GetLoads("LCASE1", NumberLoads,
LoadType, LoadName, Func, SF, TF, AT, CSys, Ang)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

SetLoads

# GetMassSource

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.GetMassSource

## VB6 Procedure

Function GetMassSource(ByVal Name As String, ByRef Source As String) As Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

Source

This is the name of an existing mass source or a blank string. Blank indicates to use the mass
source from the previous load case or the default mass source if the load case starts from zero
initial conditions.

## Remarks

This function sets the mass source to be used for the specified load case.

The function returns zero if the mass source is data is successfully set; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseDirHistNonlinearMassSource()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim Source as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'get a mass source from the static nonlinear load case

ret = SapModel.LoadCases.DirHistNonlinear.GetMassSource("LCASE1", "Source")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.20.

## See Also

SetMassSource

# GetSolControlParameters

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.GetSolControlParameters

## VB6 Procedure

Function GetSolControlParameters(ByVal Name As String, ByRef DTMax As Double, ByRef
DTMin As Double, ByRef MaxIterCS As Long, ByRef MaxIterNR As Long, ByRef TolConvD
As Double, ByRef UseEventStepping As Boolean, ByRef TolEventD As Double, ByRef
MaxLineSearchPerIter As Long, ByRef TolLineSearch As Double, ByRef LineSearchStepFact As
Double) As Long


## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

DTMax

The maximum substep size.

DTMin

The minimum substep size.

MaxIterCS

The maximum constant-stiffness iterations per step.

MaxIterNR

The maximum Newton_Raphson iterations per step.

TolConvD

The relative iteration convergence tolerance.

UseEventStepping

This item is True if event-to-event stepping is used.

TolEventD

The relative event lumping tolerance.

MaxLineSearchPerIter

The maximum number of line searches per iteration.

TolLineSearch

The relative line-search acceptance tolerance.

LineSearchStepFact

The line-search step factor.

## Remarks

This function retrieves the solution control parameters for the specified load case.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetCaseDirHistNonlinearSolutionControlParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DTMax As Double
Dim DTMin As Double
Dim MaxIterCS As Long
Dim MaxIterNR As Long
Dim TolConvD As Double
Dim UseEventStepping As Boolean
Dim TolEventD As Double
Dim MaxLineSearchPerIter As Long
Dim TolLineSearch As Double
Dim LineSearchStepFact As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'get solution control parameters
ret = SapModel.LoadCases.DirHistNonlinear.GetSolControlParameters("LCASE1", DTMax,
DTMin, MaxIterCS, MaxIterNR, TolConvD, UseEventStepping, TolEventD,
MaxLineSearchPerIter, TolLineSearch, LineSearchStepFact)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetSolControlParameters

# GetTimeIntegration

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.GetTimeIntegration

## VB6 Procedure

Function GetTimeIntegration(ByVal Name As String, ByRef IntegrationType As Long, ByRef
Alpha As Double, ByRef Beta As Double, ByRef Gamma As Double, ByRef Theta As Double,
ByRef m As Double) As Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

IntegrationType

This is 1, 2, 3, 4 or 5; indicating the time integration type.

```
1 = Newmark
2 = Wilson
3 = Collocation
4 = Hilber-Hughes-Taylor
5 = Chung and Hulbert
```
Alpha

The alpha factor (-1/3 <= Alpha <= 0).

This item applies only when IntegrationType = 4 or 5.

Beta

The beta factor (Beta >= 0).

This item applies only when IntegrationType = 1, 3 or 5. It is returned for informational purposes
when IntegrationType = 4.

Gamma


The gamma factor (Gamma >= 0.5).

This item applies only when IntegrationType = 1, 3 or 5. It is returned for informational purposes
when IntegrationType = 4.

Theta

The theta factor (Theta > 0).

This item applies only when IntegrationType = 2 or 3.

m

The alpha-m factor.

This item applies only when IntegrationType = 5.

## Remarks

This function retrieves the time integration data assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseDirHistNonlinearTimeIntegration()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim IntegrationType As Long
Dim Alpha As Double
Dim Beta As Double
Dim Gamma As Double
Dim Theta As Double
Dim m As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'set time integration parameters
ret = SapModel.LoadCases.DirHistNonlinear.SetTimeIntegration("LCASE1", 3, 0, 0.17, 0.52,
0.9)

'get time integration parameters
ret = SapModel.LoadCases.DirHistNonlinear.GetTimeIntegration("LCASE1",
IntegrationType, Alpha, Beta, Gamma, Theta, m)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetTimeIntegration

# GetTimeStep

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.GetTimeStep

## VB6 Procedure

Function GetTimeStep(ByVal Name As String, ByRef nstep As Long, ByRef DT As Double) As
Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

nstep

The number of output time steps.


### DT

The output time step size.

## Remarks

This function retrieves the time step data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseDirHistNonlinearTimeStep()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim nstep As Long
Dim DT As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'get time step data
ret = SapModel.LoadCases.DirHistNonlinear.GetTimeStep ("LCASE1", nstep, DT )

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetTimeStep

# SetCase

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks

This function initializes a nonlinear direct integration time history load case. If this function is
called for an existing load case, all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseDirHistNonlinear()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetDampProportional

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.SetDampProportional

## VB6 Procedure

Function SetDampProportional(ByVal Name As String, ByVal DampType As Long, ByVal
Dampa As Double, ByVal Dampb As Double, ByVal Dampf1 As Double, ByVal Dampf2 As
Double, ByVal Dampd1 As Double, ByVal Dampd2 As Double) As Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

DampType

This is 1, 2 or 3, indicating the proportional modal damping type.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
```

```
3 = Mass and stiffness proportional damping by frequency
```
Dampa

The mass proportional damping coefficient. This item applies only when DampType = 1.

Dampb

The stiffness proportional damping coefficient. This item applies only when DampType = 1.

Dampf1

This is the period or the frequency (depending on the value of the DampType item) for point 1. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampf2

This is the period or the frequency (depending on the value of the DampType item) for point 2. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampd1

This is the damping at point 1 (0 <= Dampd1 < 1).

This item applies only when DampType = 2 or 3.

Dampd2

This is the damping at point 2 (0 <= Dampd2 < 1).

This item applies only when DampType = 2 or 3.

## Remarks

This function sets proportional modal damping data for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseDirHistNonlinearDampProportional()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'set proportional damping
ret = SapModel.LoadCases.DirHistNonlinear.SetDampProportional("LCASE1", 2, 0, 0, 0.1,
1, 0.05, 0.06)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampProportional

# SetGeometricNonlinearity

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.SetGeometricNonlinearity

## VB6 Procedure

Function SetGeometricNonlinearity(ByVal Name As String, ByVal NLGeomType As Long) As
Long

## Parameters


Name

The name of an existing nonlinear direct integration time history load case.

NLGeomType

This is 0, 1 or 2, indicating the geometric nonlinearity option selected for the load case.

```
0 = None
1 = P-delta
2 = P-delta plus large displacements
```
## Remarks

This function sets the geometric nonlinearity option for the specified load case.

The function returns zero if the option is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseDirHistNonlinearGeometricNonlinearity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'set geometric nonlinearity option
ret = SapModel.LoadCases.DirHistNonlinear.SetGeometricNonlinearity("LCASE1", 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetGeometricNonlinearity

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

InitialCase

This is blank, None or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts from the state at the end
of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the state at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseDirHistNonlinearInitialCondition()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.DirHistNonlinear.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.SetLoads


## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef TF
() As Double, ByRef AT() As Double, ByRef CSys() As String, ByRef Ang() As Double) As
Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load or Accel, indicating the type of each load assigned to the load
case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the time history function associated with each load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

TF

This is an array that includes the time scale factor of each load assigned to the load case.

AT

This is an array that includes the arrival time of each load assigned to the load case.

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.


Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseDirHistNonlinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyTF() As Double
Dim MyAT() As Double
Dim MyCSys() As String
Dim MyAng() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'set load data


ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyTF(1)
ReDim MyAT(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "RAMPTH"
MySF(0) = 1
MyTF(0) = 1
MyAT(0) = 0
MyCSys(0) = "Global"
MyAng(0) = 0
MyLoadType(1) = "Accel"
MyLoadName(1) = "U2"
MyFunc(1) = "TH-1"
MySF(1) = 2
MyTF(1) = 1.5
MyAT(1) = 10
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.DirHistNonlinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MyFunc, MySF, MyTF, MyAT, MyCSys, MyAng)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# SetMassSource

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.SetMassSource


## VB6 Procedure

Function SetMassSource(ByVal Name As String, ByVal Source As String) As Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

Source

This is the name of an existing mass source or a blank string. Blank indicates to use the mass
source from the previous load case or the default mass source if the load case starts from zero
initial conditions.

## Remarks

This function sets the mass source to be used for the specified load case.

The function returns zero if the mass source is data is successfully set; otherwise it returns a
nonzero value.

## VBA Example

Sub SetCase DirHistNonlinear MassSource()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")


'add a new mass source and make it the default mass source

LoadPat(0) = "DEAD"

SF(0) = 1.25

ret = SapModel.SourceMass.SetMassSource("MyMassSource", True, True, True, True, 1,
LoadPat, SF)

'assign a mass source to the static nonlinear load case

ret = SapModel.LoadCases.DirHistNonlinear.SetMassSource("LCASE1", "MyMassSource")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.20.

## See Also

GeGetMassSourcetMassSource

# SetSolControlParameters

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.SetSolControlParameters

## VB6 Procedure

Function SetSolControlParameters(ByVal Name As String, ByVal DTMax As Double, ByVal
DTMin As Double, ByVal MaxIterCS As Long, ByVal MaxIterNR As Long, ByVal TolConvD
As Double, ByVal UseEventStepping As Boolean, ByVal TolEventD As Double, ByVal
MaxLineSearchPerIter As Long, ByVal TolLineSearch As Double, ByVal LineSearchStepFact As
Double) As Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

DTMax


The maximum substep size.

DTMin

The minimum substep size.

MaxIterCS

The maximum constant-stiffness iterations per step.

MaxIterNR

The maximum Newton_Raphson iterations per step.

TolConvD

The relative iteration convergence tolerance.

UseEventStepping

This item is True if event-to-event stepping is used.

TolEventD

The relative event lumping tolerance.

MaxLineSearchPerIter

The maximum number of line searches per iteration.

TolLineSearch

The relative line-search acceptance tolerance.

LineSearchStepFact

The line-search step factor.

## Remarks

This function sets the solution control parameters for the specified load case.

The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseDirHistNonlinearSolutionControlParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'set solution control parameters
ret = SapModel.LoadCases.DirHistNonlinear.SetSolControlParameters("LCASE1", 0.01,
0.00001, 15, 50, 0.00005, False, 0.02, 10, 0.2, 1.7)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetSolControlParameters

# SetTimeIntegration

## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.SetTimeIntegration

## VB6 Procedure

Function SetTimeIntegration(ByVal Name As String, ByVal IntegrationType As Long, ByVal
Alpha As Double, ByVal Beta As Double, ByVal Gamma As Double, ByVal Theta As Double,
Optional ByVal m As Double = 0) As Long


## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

IntegrationType

This is 1, 2, 3, 4 or 5, indicating the time integration type.

```
1 = Newmark
2 = Wilson
3 = Collocation
4 = Hilber-Hughes-Taylor
5 = Chung and Hulbert
```
Alpha

The alpha factor (-1/3 <= Alpha <= 0).

This item applies only when IntegrationType = 4 or 5.

Beta

The beta factor (Beta >= 0).

This item applies only when IntegrationType = 1, 3 or 5.

Gamma

The gamma factor (Gamma >= 0.5).

This item applies only when IntegrationType = 1, 3 or 5.

Theta

The theta factor (Theta > 0).

This item applies only when IntegrationType = 2 or 3.

m

The alpha-m factor.

This item applies only when IntegrationType = 5.

## Remarks

This function sets time integration data for the specified load case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.


## VBA Example

Sub SetCaseDirHistNonlinearTimeIntegration()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'set time integration parameters
ret = SapModel.LoadCases.DirHistNonlinear.SetTimeIntegration("LCASE1", 3, 0, 0.17, 0.52,
0.9)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetTimeIntegration

# SetTimeStep


## Syntax

SapObject.SapModel.LoadCases.DirHistNonlinear.SetTimeStep

## VB6 Procedure

Function SetTimeStep(ByVal Name As String, ByVal nstep As Long, ByVal DT As Double) As
Long

## Parameters

Name

The name of an existing nonlinear direct integration time history load case.

nstep

The number of output time steps.

DT

The output time step size.

## Remarks

This function sets the time step data for the specified load case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseDirHistNonlinearTimeStep()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear direct history load case
ret = SapModel.LoadCases.DirHistNonlinear.SetCase("LCASE1")

'set time step data
ret = SapModel.LoadCases.DirHistNonlinear.SetTimeStep("LCASE1", 120, 0.05)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetTimeStep

# SetCase

## Syntax

```
SapObject.SapModel.LoadCases.ExternalResults.SetCase
```
## VB6 Procedure

```
Function SetCase(ByVal Name As String) As Long
```
## Parameters

```
Name
```
```
The name of an existing or new load case for which user-supplied external analysis results
are available for some frame objects. If this is an existing case, that case is modified;
otherwise, a new case is added.
```
## Remarks


```
This function initializes an external results load case. If this function is called for an
existing load case, all items for the case are reset to their default value.
```
```
The function returns zero if the load case is successfully initialized; otherwise it returns a
nonzero value.
```
## VBA Example

```
Sub SetFrameExternalResultStations()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim ObjSta() As Double = New Double() {0.0, 124.0}
```
```
Dim LoadCase() As String = New String() {"EXTERNAL"}
```
```
Dim P() As Double = New Double() {5.0, 5.0}
```
```
Dim V2() As Double = New Double() {-5.0, 5.0}
```
```
Dim V3() As Double = Nothing
```
```
Dim T() As Double = Nothing
```
```
Dim M2() As Double = Nothing
```
```
Dim M3() As Double = New Double() {100.0, 100.0}
```
'create Sap2000 object

```
SapObject = New Sap2000v16.SapObject
```
'start Sap2000 application

```
SapObject.ApplicationStart()
```
'create SapModel object

```
SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```

'create model from template

```
ret = SapModel.File.New2DFrame
(e2DFrameType.PortalFrame, 3, 124, 3, 200)
```
'create load case for external results

```
ret = SapModel.LoadCases.ExternalResults.SetCase
("EXTERNAL")
```
'set cases and stations for frame external results

```
ret = SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1,
LoadCase)
ret = SapModel.ExternalAnalysisResults.SetFrameStations("1", ObjSta)
```
'set frame external result forces at case first step

```
ret = SapModel.ExternalAnalysisResults.SetFrameForce("1",
"EXTERNAL", 0, P, V2, V3, T, M2, M3)
```
'close Sap2000

```
SapObject.ApplicationExit(False)
```
```
SapModel = Nothing
SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0

# SetNumberSteps

## Syntax

```
SapObject.SapModel.LoadCases.ExternalResults.SetNumberSteps
```
## VB6 Procedure


```
Function SetNumberSteps (ByVal Name As String, ByVal FirstStep As Long, ByVal
LastStep As Long) As Long
```
## Parameters

```
Name
```
```
The name of an existing external results load case.
```
```
FirstStep
```
```
The number of the first step for which external results are to be subsequently provided for
frame objects in conjunction with this load case. The value may be 0 or 1. A value of zero
is typically used for cases that include the initial conditions, such as time-history cases.
```
```
LastStep
```
```
The number of the last step for which external results are to be subsequently provided for
frame objects in conjunction with this load case. The value must be greater than or equal to
FirstStep.
```
## Remarks

```
In the absence of a call to this function, the default values are FirstStep = 1 and LastStep =
1.
```
```
The number of steps available for this load case will be LastStep – FirstStep + 1.
```
```
The function returns zero if the number of steps is successfully initialized; otherwise it
returns a nonzero value.
```
## VBA Example

```
Sub SetFrameExternalResultStations()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim ObjSta() As Double = New Double() {0.0, 124.0}
```
```
Dim LoadCase() As String = New String()
{"EXTERNAL"}
```
```
Dim P() As Double = New Double() {5.0, 5.0}
```
```
Dim V2() As Double = New Double() {-5.0, 5.0}
```
```
Dim V3() As Double = Nothing
```

```
Dim T() As Double = Nothing
```
```
Dim M2() As Double = Nothing
```
```
Dim M3() As Double = New Double() {100.0, 100.0}
```
'create Sap2000 object

```
SapObject = New Sap2000v16.SapObject
```
'start Sap2000 application

```
SapObject.ApplicationStart()
```
'create SapModel object

```
SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame
(e2DFrameType.PortalFrame, 3, 124, 3, 200)
```
'create load case for external results

```
ret = SapModel.LoadCases.ExternalResults.SetCase
("EXTERNAL")
```
```
ret =
SapModel.LoadCases.ExternalResults.SetNumberSteps("EXTERNAL",
1, 1)
```
'set cases and stations for frame external results

```
ret =
SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1,
LoadCase)
```

```
ret =
SapModel.ExternalAnalysisResults.SetFrameStations("1", ObjSta)
```
```
'set frame external result forces at case first step
```
```
ret = SapModel.ExternalAnalysisResults.SetFrameForce
("1", "EXTERNAL", 0, P, V2, V3, T, M2, M3)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit(False)
```
```
SapModel = Nothing
```
```
SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0

# GetBaseCase

## Syntax

SapObject.SapModel.LoadCases.HyperStatic.GetBaseCase

## VB6 Procedure

Function GetBaseCase(ByVal Name As String, ByRef BaseCase As String) As Long

## Parameters

Name

The name of an existing hyperstatic load case.

BaseCase


The name of an existing static linear load case that is the base case for the specified hyperstatic
load case.

## Remarks

This function retrieves the base case for the specified hyperstatic load case.

The function returns zero if the base case is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseHyperStaticInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim BaseCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add hyperstatic load case
ret = SapModel.LoadCases.HyperStatic.SetCase("LCASE1")

'set base case
ret = SapModel.LoadCases.HyperStatic.SetBaseCase("LCASE1", "DEAD")

'get base case
ret = SapModel.LoadCases.HyperStatic.GetBaseCase("LCASE1", BaseCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 12.00.

## See Also

SetBaseCase

# SetBaseCase

## Syntax

SapObject.SapModel.LoadCases.HyperStatic.SetBaseCase

## VB6 Procedure

Function SetBaseCase(ByVal Name As String, ByVal BaseCase As String) As Long

## Parameters

Name

The name of an existing hyperstatic load case.

BaseCase

The name of an existing static linear load case that is the base case for the specified hyperstatic
load case.

## Remarks

This function sets the base case for the specified hyperstatic load case.

The function returns zero if the base case is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseHyperStaticBaseCase()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add hyperstatic load case
ret = SapModel.LoadCases.HyperStatic.SetCase("LCASE1")

'set base case
ret = SapModel.LoadCases.HyperStatic.SetBaseCase("LCASE1", "DEAD")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetBaseCase

# SetCase

## Syntax

SapObject.SapModel.LoadCases.HyperStatic.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks


This function initializes a hyperstatic load case. If this function is called for an existing load case,
all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseHyperStatic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add hyperstatic load case
ret = SapModel.LoadCases.HyperStatic.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.ModalEigen.GetInitialCase


## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing modal eigen load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseModalEigenInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add modal eigen load case
ret = SapModel.LoadCases.ModalEigen.SetCase("LCASE1")

'get initial condition
ret = SapModel.LoadCases.ModalEigen.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.ModalEigen.GetLoads

## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef TargetPar() As Double, ByRef StaticCorrect() As
Boolean) As Long

## Parameters

Name

The name of an existing modal eigen load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load, Accel or Link, indicating the type of each load assigned to the
load case.


LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

If the LoadType item is Link, this item is not used.

TargetPar

This is an array that includes the target mass participation ratio.

StaticCorrect

This is an array that includes either 0 or 1, indicating if static correction modes are to be
calculated.

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseModalEigenLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyTargetPar() As Double
Dim MyStaticCorrect() As Boolean
Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim TargetPar() As Double
Dim StaticCorrect() As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal eigen load case
ret = SapModel.LoadCases.ModalEigen.SetCase("LCASE1")

'set load data
ReDim MyLoadType(2)
ReDim MyLoadName(2)
ReDim MyTargetPar(2)
ReDim MyStaticCorrect(2)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyTargetPar(0) = 99
MyStaticCorrect(0) = 1
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MyTargetPar(1) = 99
MyStaticCorrect(1) = 0
MyLoadType(2) = "Link"
MyTargetPar(2) = 99
MyStaticCorrect(2) = 0
ret = SapModel.LoadCases.ModalEigen.SetLoads("LCASE1", 3, MyLoadType,
MyLoadName, MyTargetPar, MyStaticCorrect)

'get load data
ret = SapModel.LoadCases.ModalEigen.GetLoads("LCASE1", NumberLoads, LoadType,
LoadName, TargetPar, StaticCorrect)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoads

# GetNumberModes


## Syntax

SapObject.SapModel.LoadCases.ModalEigen.GetNumberModes

## VB6 Procedure

Function GetNumberModes(ByVal Name As String, ByRef MaxModes As Long, ByRef
MinModes As Long) As Long

## Parameters

Name

The name of an existing modal eigen load case.

MaxModes

The maximum number of modes requested.

MinModes

The minimum number of modes requested.

## Remarks

This function retrieves the number of modes requested for the specified load case.

The function returns zero if the number of modes is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseModalEigenNumberModes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MaxModes As Long
Dim MinModes As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal eigen load case
ret = SapModel.LoadCases.ModalEigen.SetCase("LCASE1")

'get number of modes requested
ret = SapModel.LoadCases.ModalEigen.GetNumberModes("LCASE1", MaxModes,
MinModes)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetNumberModes

# GetParameters

## Syntax

SapObject.SapModel.LoadCases.ModalEigen.GetParameters

## VB6 Procedure

Function GetParameters(ByVal Name As String, ByRef EigenShiftFreq As Double, ByRef
EigenCutOff As Double, ByRef EigenTol As Double, ByRef AllowAutoFreqShift As Long) As
Long

## Parameters

Name

The name of an existing modal eigen load case.

EigenShiftFreq


The eigenvalue shift frequency. [cyc/s]

EigenCutOff

The eigencutoff frequency radius. [cyc/s]

EigenTol

The relative convergence tolerance for eigenvalues.

AllowAutoFreqShift

This is either 0 or 1, indicating if automatic frequency shifting is allowed.

```
0 = Automatic frequency shifting is NOT allowed
1 = Automatic frequency shifting is allowed
```
## Remarks

This function retrieves various parameters for the specified load case.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseModalEigenParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim EigenShiftFreq As Double
Dim EigenCutOff As Double
Dim EigenTol As Double
Dim AllowAutoFreqShift As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal eigen load case


ret = SapModel.LoadCases.ModalEigen.SetCase("LCASE1")

'get parameters
ret = SapModel.LoadCases.ModalEigen.GetParameters("LCASE1", EigenShiftFreq,
EigenCutOff, EigenTol, AllowAutoFreqShift)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetParameters

# SetCase

## Syntax

SapObject.SapModel.LoadCases.ModalEigen.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks

This function initializes a modal eigen load case. If this function is called for an existing load case,
all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.


## VBA Example

Sub SetCaseModalEigen()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal eigen load case
ret = SapModel.LoadCases.ModalEigen.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.ModalEigen.SetInitialCase


## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing modal eigen load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseModalEigenInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case


ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add modal eigen load case
ret = SapModel.LoadCases.ModalEigen.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.ModalEigen.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.ModalEigen.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef TargetPar() As Double, ByRef StaticCorrect() As
Boolean) As Long

## Parameters

Name

The name of an existing modal eigen load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType


This is an array that includes Load, Accel or Link, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

If the LoadType item is Link, this item is not used.

TargetPar

This is an array that includes the target mass participation ratio.

StaticCorrect

This is an array that includes either 0 or 1, indicating if static correction modes are to be
calculated.

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModalEigenLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyTargetPar() As Double
Dim MyStaticCorrect() As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal eigen load case
ret = SapModel.LoadCases.ModalEigen.SetCase("LCASE1")

'set load data
ReDim MyLoadType(2)
ReDim MyLoadName(2)
ReDim MyTargetPar(2)
ReDim MyStaticCorrect(2)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyTargetPar(0) = 99
MyStaticCorrect(0) = 1
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MyTargetPar(1) = 99
MyStaticCorrect(1) = 0
MyLoadType(2) = "Link"
MyTargetPar(2) = 99
MyStaticCorrect(2) = 0
ret = SapModel.LoadCases.ModalEigen.SetLoads("LCASE1", 3, MyLoadType,
MyLoadName, MyTargetPar, MyStaticCorrect)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# SetNumberModes

## Syntax

SapObject.SapModel.LoadCases.ModalEigen.SetNumberModes


## VB6 Procedure

Function SetNumberModes(ByVal Name As String, ByVal MaxModes As Long, ByVal
MinModes As Long) As Long

## Parameters

Name

The name of an existing modal eigen load case.

MaxModes

The maximum number of modes requested.

MinModes

The minimum number of modes requested.

## Remarks

This function sets the number of modes requested for the specified load case.

The function returns zero if the number of modes is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseModalEigenNumberModes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal eigen load case
ret = SapModel.LoadCases.ModalEigen.SetCase("LCASE1")


'set number of modes
ret = SapModel.LoadCases.ModalEigen.SetNumberModes("LCASE1", 10, 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetNumberModes

# SetParameters

## Syntax

SapObject.SapModel.LoadCases.ModalEigen.SetParameters

## VB6 Procedure

Function SetParameters(ByVal Name As String, ByVal EigenShiftFreq As Double, ByVal
EigenCutOff As Double, ByVal EigenTol As Double, ByVal AllowAutoFreqShift As Long) As
Long

## Parameters

Name

The name of an existing modal eigen load case.

EigenShiftFreq

The eigenvalue shift frequency. [cyc/s]

EigenCutOff

The eigencutoff frequency radius. [cyc/s]

EigenTol


The relative convergence tolerance for eigenvalues.

AllowAutoFreqShift

This is either 0 or 1, indicating if automatic frequency shifting is allowed.

```
0 = Automatic frequency shifting is NOT allowed
1 = Automatic frequency shifting is allowed
```
## Remarks

This function sets various parameters for the specified modal eigen load case.

The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseModalEigenParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal eigen load case
ret = SapModel.LoadCases.ModalEigen.SetCase("LCASE1")

'set parameters
ret = SapModel.LoadCases.ModalEigen.SetParameters("LCASE1", 0.05, 0.0001, 1E-10, 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetParameters

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.ModalRitz.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing modal ritz load case.

InitialCase

This is blank, None or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseModalRitzInitialCondition()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal ritz load case
ret = SapModel.LoadCases.ModalRitz.SetCase("LCASE1")

'get initial condition
ret = SapModel.LoadCases.ModalRitz.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.ModalRitz.GetLoads


## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef RitzMaxCyc() As Long, ByRef TargetPar() As
Double) As Long

## Parameters

Name

The name of an existing modal ritz load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load, Accel or Link, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

If the LoadType item is Link, this item is not used.

RitzMaxCyc

This is an array that includes the maximum number of generation cycles to be performed for the
specified ritz starting vector. A value of 0 means there is no limit on the number of cycles.

TargetPar

This is an array that includes the target dynamic participation ratio.

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseModalRitzLoads()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyRitzMaxCyc() As Long
Dim MyTargetPar() As Double
Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim RitzMaxCyc() As Long
Dim TargetPar() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal ritz load case
ret = SapModel.LoadCases.ModalRitz.SetCase("LCASE1")

'set load data
ReDim MyLoadType(2)
ReDim MyLoadName(2)
ReDim MyRitzMaxCyc(2)
ReDim MyTargetPar(2)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyRitzMaxCyc(0) = 0
MyTargetPar(0) = 99
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MyRitzMaxCyc(1) = 0
MyTargetPar(1) = 99
MyLoadType(2) = "Link"
MyRitzMaxCyc(2) = 0
MyTargetPar(2) = 99
ret = SapModel.LoadCases.ModalRitz.SetLoads("LCASE1", 3, MyLoadType, MyLoadName,
MyRitzMaxCyc, MyTargetPar)

'get load data
ret = SapModel.LoadCases.ModalRitz.GetLoads("LCASE1", NumberLoads, LoadType,
LoadName, RitzMaxCyc, TargetPar)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoads

# GetNumberModes

## Syntax

SapObject.SapModel.LoadCases.ModalRitz.GetNumberModes

## VB6 Procedure

Function GetNumberModes(ByVal Name As String, ByRef MaxModes As Long, ByRef
MinModes As Long) As Long

## Parameters

Name

The name of an existing modal ritz load case.

MaxModes

The maximum number of modes requested.

MinModes

The minimum number of modes requested.

## Remarks

This function retrieves the number of modes requested for the specified load case.

The function returns zero if the number of modes is successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetCaseModalRitzNumberModes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MaxModes As Long
Dim MinModes As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal ritz load case
ret = SapModel.LoadCases.ModalRitz.SetCase("LCASE1")

'get number of modes requested
ret = SapModel.LoadCases.ModalRitz.GetNumberModes("LCASE1", MaxModes,
MinModes)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetNumberModes


# SetCase

## Syntax

SapObject.SapModel.LoadCases.ModalRitz.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks

This function initializes a modal ritz load case. If this function is called for an existing load case,
all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseModalRitz()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal ritz load case


ret = SapModel.LoadCases.ModalRitz.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.ModalRitz.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing modal ritz load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.


The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseModalRitzInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add modal ritz load case
ret = SapModel.LoadCases.ModalRitz.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.ModalRitz.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase


# SetLoads

## Syntax

SapObject.SapModel.LoadCases.ModalRitz.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef RitzMaxCyc() As Long, ByRef TargetPar() As
Double) As Long

## Parameters

Name

The name of an existing modal ritz load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load, Accel or Link, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

If the LoadType item is Link, this item is not used.

RitzMaxCyc

This is an array that includes the maximum number of generation cycles to be performed for the
specified ritz starting vector. A value of 0 means there is no limit on the number of cycles.

TargetPar

This is an array that includes the target dynamic participation ratio.

## Remarks

This function sets the load data for the specified analysis case.


The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModalRitzLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyRitzMaxCyc() As Long
Dim MyTargetPar() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal ritz load case
ret = SapModel.LoadCases.ModalRitz.SetCase("LCASE1")

'set load data
ReDim MyLoadType(2)
ReDim MyLoadName(2)
ReDim MyRitzMaxCyc(2)
ReDim MyTargetPar(2)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyRitzMaxCyc(0) = 0
MyTargetPar(0) = 99
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MyRitzMaxCyc(1) = 0
MyTargetPar(1) = 99
MyLoadType(2) = "Link"
MyRitzMaxCyc(2) = 0
MyTargetPar(2) = 99
ret = SapModel.LoadCases.ModalRitz.SetLoads("LCASE1", 3, MyLoadType, MyLoadName,
MyRitzMaxCyc, MyTargetPar)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.03.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# SetNumberModes

## Syntax

SapObject.SapModel.LoadCases.ModalRitz.SetNumberModes

## VB6 Procedure

Function SetNumberModes(ByVal Name As String, ByVal MaxModes As Long, ByVal
MinModes As Long) As Long

## Parameters

Name

The name of an existing modal ritz load case.

MaxModes

The maximum number of modes requested.

MinModes

The minimum number of modes requested.

## Remarks

This function sets the number of modes requested for the specified load case.

The function returns zero if the number of modes is successfully set; otherwise it returns a nonzero
value.


## VBA Example

Sub SetCaseModalRitzNumberModes()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add modal ritz load case
ret = SapModel.LoadCases.ModalRitz.SetCase("LCASE1")

'set number of modes
ret = SapModel.LoadCases.ModalRitz.SetNumberModes("LCASE1", 10, 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetNumberModes


# GetDampConstant

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.GetDampConstant

## VB6 Procedure

Function GetDampConstant(ByVal Name As String, ByRef Damp As Double) As Long

## Parameters

Name

The name of an existing linear modal history analysis case that has constant damping.

Damp

The constant damping for all modes (0 <= Damp < 1).

## Remarks

This function retrieves the constant modal damping for all modes assigned to the specified load
case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseModHistLinearDampConstant()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long
Dim Damp As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ModHistLinear.SetDampConstant("LCASE1", 0.04)

'get constant damping
ret = SapModel.LoadCases.ModHistLinear.GetDampType("LCASE1", DampType)
If DampType = 4 Then
ret = SapModel.LoadCases.ModHistLinear.GetDampConstant("LCASE1", Damp)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampConstant

# GetDampInterpolated

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.GetDampInterpolated

## VB6 Procedure

Function GetDampInterpolated(ByVal Name As String, ByRef DampType As Long, ByRef
NumberItems As Long, ByRef Time() As Double, ByRef Damp() As Double) As Long

## Parameters

Name


The name of an existing linear modal history analysis case that has interpolated damping.

DampType

This is 5 or 6, indicating the interpolated modal damping type.

```
5 = Interpolated damping by period
6 = Interpolated damping by frequency
```
NumberItems

The number of Time and Damp pairs.

Time

This is an array that includes the period or the frequency, depending on the value of the
DampType item. [s] for DampType = 5 and [cyc/s] for DampType = 6

Damp

This is an array that includes the damping for the specified period of frequency (0 <= Damp < 1).

## Remarks

This function retrieves the interpolated modal damping data assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseModHistLinearDampInterpolated()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyTime() As Double
Dim MyDamp() As Double
Dim DampType As Long
Dim NumberItems As Long
Dim Time() As Double
Dim Damp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set interpolated damping
ReDim MyTime(2)
ReDim MyDamp(2)
MyTime(0) = 0.001
MyDamp(0) = 0.1
MyTime(1) = 0.3
MyDamp(1) = 0.03
MyTime(2) = 1
MyDamp(2) = 0.05
ret = SapModel.LoadCases.ModHistLinear.SetDampInterpolated("LCASE1", 5, 3, MyTime,
MyDamp)

'get interpolated damping
ret = SapModel.LoadCases.ModHistLinear.GetDampType("LCASE1", DampType)
If DampType = 5 or DampType = 6 Then
ret = SapModel.LoadCases.ModHistLinear.GetDampInterpolated("LCASE1", DampType,
NumberItems, Time, Damp)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampInterpolated

# GetDampOverrides

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.GetDampInterpolated


## VB6 Procedure

Function GetDampInterpolated(ByVal Name As String, ByRef NumberItems As Long, ByRef
Mode() As Long, ByRef Damp() As Double) As Long

## Parameters

Name

The name of an existing linear modal history analysis case.

NumberItems

The number of Mode and Damp pairs.

Mode

This is an array that includes a mode number.

Damp

This is an array that includes the damping for the specified mode (0 <= Damp < 1).

## Remarks

This function retrieves the modal damping overrides assigned to the specified load case.

The function returns zero if the overrides are successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseModHistLinearDampOverrides()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyMode() As Long
Dim MyDamp() As Double
Dim NumberItems As Long
Dim Mode() As Long
Dim Damp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ModHistLinear.SetDampConstant("LCASE1", 0.04)

'set modal damping overrides
ReDim MyMode(1)
ReDim MyDamp(1)
MyMode(0) = 1
MyDamp(0) = 0.02
MyMode(1) = 2
MyDamp(1) = 0.03
ret = SapModel.LoadCases.ModHistLinear.SetDampOverrides("LCASE1", 2, MyMode,
MyDamp)

'get modal damping overrides
ret = SapModel.LoadCases.ModHistLinear.GetDampOverrides("LCASE1", NumberItems,
Mode, Damp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampOverrides

# GetDampProportional

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.GetDampProportional


## VB6 Procedure

Function GetDampProportional(ByVal Name As String, ByRef DampType As Long, ByRef
Dampa As Double, ByRef Dampb As Double, ByRef Dampf1 As Double, ByRef Dampf2 As
Double, ByRef Dampd1 As Double, ByRef Dampd2 As Double) As Long

## Parameters

Name

The name of an existing linear modal history analysis case that has proportional damping.

DampType

This is 1, 2 or 3, indicating the proportional modal damping type.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
```
Dampa

The mass proportional damping coefficient.

Dampb

The stiffness proportional damping coefficient.

Dampf1

This is the period or the frequency (depending on the value of the DampType item) for point 1. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampf2

This is the period or the frequency (depending on the value of the DampType item) for point 2. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampd1

This is the damping at point 1 (0 <= Dampd1 < 1).

This item applies only when DampType = 2 or 3.

Dampd2

This is the damping at point 2 (0 <= Dampd2 < 1).

This item applies only when DampType = 2 or 3.


## Remarks

This function retrieves the proportional modal damping data assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseModHistLinearDampProportional()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long
Dim Dampa As Double
Dim Dampb As Double
Dim Dampf1 As Double
Dim Dampf2 As Double
Dim Dampd1 As Double
Dim Dampd2 As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set proportional damping
ret = SapModel.LoadCases.ModHistLinear.SetDampProportional("LCASE1", 2, 0, 0, 0.1, 1,
0.05, 0.06)

'get proportional damping
ret = SapModel.LoadCases.ModHistLinear.GetDampType("LCASE1", DampType)
If DampType >= 1 or DampType <= 3 Then
ret = SapModel.LoadCases.ModHistLinear.GetDampProportional("LCASE1", DampType,
Dampa, Dampb, Dampf1, Dampf2, Dampd1, Dampd2)
End If

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampProportional

# GetDampType

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.GetDampType

## VB6 Procedure

Function GetDampType(ByVal Name As String, ByRef DampType As Long) As Long

## Parameters

Name

The name of an existing linear modal history analysis case.

DampType

This is 1, 2, 3, 4, 5 or 6, indicating the modal damping type for the load case.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
4 = Constant damping for all modes
5 = Interpolated damping by period
6 = Interpolated damping by frequency
```
## Remarks

This function retrieves the modal damping type for the specified load case.

The function returns zero if the type is successfully retrieved; otherwise it returns a nonzero value.


## VBA Example

Sub GetCaseModHistLinearDampType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'get damping type
ret = SapModel.LoadCases.ModHistLinear.GetDampType("LCASE1", DampType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampConstant

GetDampInterpolated

GetDampProportional


GetDampOverrides

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.GetLoads

## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef
TF() As Double, ByRef AT() As Double, ByRef CSys() As String, ByRef Ang() As Double) As
Long

## Parameters

Name

The name of an existing linear modal history analysis case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load or Accel, indicating the type of each load assigned to the load
case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the time history function associated with each load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

TF

This is an array that includes the time scale factor of each load assigned to the load case.


### AT

This is an array that includes the arrival time of each load assigned to the load case.

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.

Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseModHistLinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyTF() As Double
Dim MyAT() As Double
Dim MyCSys() As String
Dim MyAng() As Double
Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim Func() As String
Dim SF() As Double
Dim TF() As Double
Dim AT() As Double
Dim CSys() As String
Dim Ang() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyTF(1)
ReDim MyAT(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "RAMPTH"
MySF(0) = 1
MyTF(0) = 1
MyAT(0) = 0
MyCSys(0) = "Global"
MyAng(0) = 0
MyLoadType(1) = "Accel"
MyLoadName(1) = "U2"
MyFunc(1) = "TH-1"
MySF(1) = 2
MyTF(1) = 1.5
MyAT(1) = 10
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.ModHistLinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MyFunc, MySF, MyTF, MyAT, MyCSys, MyAng)

'get load data
ret = SapModel.LoadCases.ModHistLinear.GetLoads("LCASE1", NumberLoads, LoadType,
LoadName, Func, SF, TF, AT, CSys, Ang)

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoads

# GetModalCase

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.GetModalCase

## VB6 Procedure

Function GetModalCase(ByVal Name As String, ByRef ModalCase As String) As Long

## Parameters

Name

The name of an existing linear modal history analysis case.

ModalCase

This is None or the name of an existing modal analysis case. It specifies the modal load case on
which any mode-type load assignments to the specified load case are based.

## Remarks

This function retrieves the modal case assigned to the specified load case.

The function returns zero if the modal case is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseModHistLinearModalCase()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ModalCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'get modal case
ret = SapModel.LoadCases.ModHistLinear.GetModalCase("LCASE1", ModalCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetModalCase

# GetMotionType

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.GetMotionType


## VB6 Procedure

Function GetMotionType(ByVal Name As String, ByRef MotionType As Long) As Long

## Parameters

Name

The name of an existing linear modal history analysis case.

MotionType

This is 1 or 2, indicating the time history motion type.

```
1 = Transient
2 = Periodic
```
## Remarks

This function retrieves the motion type for the specified load case.

The function returns zero if the motion type is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseModHistLinearMotionType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MotionType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")


'get motion type
ret = SapModel.LoadCases.ModHistLinear.GetMotionType ("LCASE1", MotionType )

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetMotionType

# GetTimeStep

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.GetTimeStep

## VB6 Procedure

Function GetTimeStep(ByVal Name As String, ByRef nstep As Long, ByRef DT As Double) As
Long

## Parameters

Name

The name of an existing linear modal history analysis case.

nstep

The number of output time steps.

DT

The output time step size.

## Remarks

This function retrieves the time step data for the specified load case.


The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseModHistLinearTimeStep()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim nstep As Long
Dim DT As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'get time step data
ret = SapModel.LoadCases.ModHistLinear.GetTimeStep ("LCASE1", nstep, DT )

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetTimeStep


# SetCase

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise a new case is added.

## Remarks

This function initializes a linear modal history analysis case. If this function is called for an
existing load case then all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseModHistLinear()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case


ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetDampConstant

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.SetDampConstant

## VB6 Procedure

Function SetDampConstant(ByVal Name As String, ByVal Damp As Double) As Long

## Parameters

Name

The name of an existing linear modal history analysis case.

Damp

The constant damping for all modes (0 <= Damp < 1).

## Remarks

This function sets constant modal damping for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistLinearDampConstant()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ModHistLinear.SetDampConstant("LCASE1", 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampConstant

# SetDampInterpolated

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.SetDampInterpolated

## VB6 Procedure


Function SetDampInterpolated(ByVal Name As String, ByVal DampType As Long, ByVal
NumberItems As Long, ByRef Time() As Double, ByRef Damp() As Double) As Long

## Parameters

Name

The name of an existing linear modal history analysis case.

DampType

This is 5 or 6, indicating the interpolated modal damping type.

```
5 = Interpolated damping by period
6 = Interpolated damping by frequency
```
NumberItems

The number of Time and Damp pairs.

Time

This is an array that includes the period or the frequency, depending on the value of the
DampType item. [s] for DampType = 5 and [cyc/s] for DampType = 6

Damp

This is an array that includes the damping for the specified period of frequency (0 <= Damp < 1).

## Remarks

This function sets interpolated modal damping data for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistLinearDampInterpolated()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyTime() As Double
Dim MyDamp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set interpolated damping
ReDim MyTime(2)
ReDim MyDamp(2)
MyTime(0) = 0.001
MyDamp(0) = 0.1
MyTime(1) = 0.3
MyDamp(1) = 0.03
MyTime(2) = 1
MyDamp(2) = 0.05
ret = SapModel.LoadCases.ModHistLinear.SetDampInterpolated("LCASE1", 5, 3, MyTime,
MyDamp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampInterpolated

# SetDampOverrides

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.SetDampOverrides

## VB6 Procedure


Function SetDampOverrides(ByVal Name As String, ByVal NumberItems As Long, ByRef Mode
() As Long, ByRef Damp() As Double) As Long

## Parameters

Name

The name of an existing linear modal history analysis case.

NumberItems

The number of Mode and Damp pairs.

Mode

This is an array that includes a mode number.

Damp

This is an array that includes the damping for the specified mode (0 <= Damp < 1).

## Remarks

This function sets the modal damping overrides for the specified load case.

The function returns zero if the overrides are successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistLinearDampOverrides()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyMode() As Long
Dim MyDamp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ModHistLinear.SetDampConstant("LCASE1", 0.04)

'set modal damping overrides
ReDim MyMode(1)
ReDim MyDamp(1)
MyMode(0) = 1
MyDamp(0) = 0.02
MyMode(1) = 2
MyDamp(1) = 0.03
ret = SapModel.LoadCases.ModHistLinear.SetDampOverrides("LCASE1", 2, MyMode,
MyDamp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampOverrides

# SetDampProportional

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.SetDampProportional

## VB6 Procedure

Function SetDampProportional(ByVal Name As String, ByVal DampType As Long, ByVal
Dampa As Double, ByVal Dampb As Double, ByVal Dampf1 As Double, ByVal Dampf2 As
Double, ByVal Dampd1 As Double, ByVal Dampd2 As Double) As Long

## Parameters

Name


The name of an existing linear modal history analysis case.

DampType

This is 1, 2 or 3, indicating the proportional modal damping type.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
```
Dampa

The mass proportional damping coefficient. This item applies only when DampType = 1.

Dampb

The stiffness proportional damping coefficient. This item applies only when DampType = 1.

Dampf1

This is the period or the frequency (depending on the value of the DampType item) for point 1. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampf2

This is the period or the frequency (depending on the value of the DampType item) for point 2. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampd1

This is the damping at point 1 (0 <= Dampd1 < 1).

This item applies only when DampType = 2 or 3.

Dampd2

This is the damping at point 2 (0 <= Dampd2 < 1).

This item applies only when DampType = 2 or 3.

## Remarks

This function sets proportional modal damping data for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistLinearDampProportional()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set proportional damping
ret = SapModel.LoadCases.ModHistLinear.SetDampProportional("LCASE1", 2, 0, 0, 0.1, 1,
0.05, 0.06)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampProportional

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.SetLoads


## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef TF
() As Double, ByRef AT() As Double, ByRef CSys() As String, ByRef Ang() As Double) As
Long

## Parameters

Name

The name of an existing linear modal history analysis case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load or Accel, indicating the type of each load assigned to the load
case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the time history function associated with each load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

TF

This is an array that includes the time scale factor of each load assigned to the load case.

AT

This is an array that includes the arrival time of each load assigned to the load case.

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.


Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistLinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyTF() As Double
Dim MyAT() As Double
Dim MyCSys() As String
Dim MyAng() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set load data


ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyTF(1)
ReDim MyAT(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "RAMPTH"
MySF(0) = 1
MyTF(0) = 1
MyAT(0) = 0
MyCSys(0) = "Global"
MyAng(0) = 0
MyLoadType(1) = "Accel"
MyLoadName(1) = "U2"
MyFunc(1) = "TH-1"
MySF(1) = 2
MyTF(1) = 1.5
MyAT(1) = 10
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.ModHistLinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MyFunc, MySF, MyTF, MyAT, MyCSys, MyAng)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# SetModalCase

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.SetModalCase


## VB6 Procedure

Function SetModalCase(ByVal Name As String, ByVal ModalCase As String) As Long

## Parameters

Name

The name of an existing linear modal history analysis case.

ModalCase

This is the name of an existing modal load case. It specifies the modal load case on which any
mode-type load assignments to the specified load case are based.

## Remarks

This function sets the modal case for the specified analysis case.

The function returns zero if the modal case is successfully set; otherwise it returns a nonzero
value.

If the specified modal case is not actually a modal case, the program automatically replaces it with
the first modal case it can find. If no modal load cases exist, an error is returned.

## VBA Example

Sub SetCaseModHistLinearModalCase()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")


'set modal case
ret = SapModel.LoadCases.ModHistLinear.SetModalCase("LCASE1", "MODAL")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetModalCase

# SetMotionType

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.SetMotionType

## VB6 Procedure

Function SetMotionType(ByVal Name As String, ByVal MotionType As Long) As Long

## Parameters

Name

The name of an existing linear modal history analysis case.

MotionType

This is 1 or 2, indicating the time history motion type.

```
1 = Transient
2 = Periodic
```
## Remarks

This function sets the motion type for the specified analysis case.


The function returns zero if the motion type is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseModHistLinearMotionType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set motion type
ret = SapModel.LoadCases.ModHistLinear.SetMotionType("LCASE1", 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetMotionType


# SetTimeStep

## Syntax

SapObject.SapModel.LoadCases.ModHistLinear.SetTimeStep

## VB6 Procedure

Function SetTimeStep(ByVal Name As String, ByVal nstep As Long, ByVal DT As Double) As
Long

## Parameters

Name

The name of an existing linear modal history analysis case.

nstep

The number of output time steps.

DT

The output time step size.

## Remarks

This function sets the time step data for the specified load case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistLinearTimeStep()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'set time step data
ret = SapModel.LoadCases.ModHistLinear.SetTimeStep("LCASE1", 120, 0.05)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetTimeStep

# GetDampConstant

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.GetDampConstant

## VB6 Procedure

Function GetDampConstant(ByVal Name As String, ByRef Damp As Double) As Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case that has constant damping.

Damp

The constant damping for all modes (0 <= Damp < 1).


## Remarks

This function retrieves the constant modal damping for all modes assigned to the specified load
case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseModHistNonlinearDampConstant()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long
Dim Damp As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ModHistNonlinear.SetDampConstant("LCASE1", 0.04)

'get constant damping
ret = SapModel.LoadCases.ModHistNonlinear.GetDampType("LCASE1", DampType)
If DampType = 4 Then
ret = SapModel.LoadCases.ModHistNonlinear.GetDampConstant("LCASE1", Damp)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampConstant

# GetDampInterpolated

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.GetDampInterpolated

## VB6 Procedure

Function GetDampInterpolated(ByVal Name As String, ByRef DampType As Long, ByRef
NumberItems As Long, ByRef Time() As Double, ByRef Damp() As Double) As Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case that has interpolated damping.

DampType

This is 5 or 6, indicating the interpolated modal damping type.

```
5 = Interpolated damping by period
6 = Interpolated damping by frequency
```
NumberItems

The number of Time and Damp pairs.

Time

This is an array that includes the period or the frequency, depending on the value of the
DampType item. [s] for DampType = 5 and [cyc/s] for DampType = 6

Damp

This is an array that includes the damping for the specified period of frequency (0 <= Damp < 1).


## Remarks

This function retrieves the interpolated modal damping data assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseModHistNonlinearDampInterpolated()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyTime() As Double
Dim MyDamp() As Double
Dim DampType As Long
Dim NumberItems As Long
Dim Time() As Double
Dim Damp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set interpolated damping
ReDim MyTime(2)
ReDim MyDamp(2)
MyTime(0) = 0.001
MyDamp(0) = 0.1
MyTime(1) = 0.3
MyDamp(1) = 0.03
MyTime(2) = 1
MyDamp(2) = 0.05
ret = SapModel.LoadCases.ModHistNonlinear.SetDampInterpolated("LCASE1", 5, 3,
MyTime, MyDamp)

'get interpolated damping


ret = SapModel.LoadCases.ModHistNonlinear.GetDampType("LCASE1", DampType)
If DampType = 5 or DampType = 6 Then
ret = SapModel.LoadCases.ModHistNonlinear.GetDampInterpolated("LCASE1",
DampType, NumberItems, Time, Damp)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampInterpolated

# GetDampOverrides

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.GetDampInterpolated

## VB6 Procedure

Function GetDampInterpolated(ByVal Name As String, ByRef NumberItems As Long, ByRef
Mode() As Long, ByRef Damp() As Double) As Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.

NumberItems

The number of Mode and Damp pairs.

Mode

This is an array that includes a mode number.

Damp


This is an array that includes the damping for the specified mode (0 <= Damp < 1).

## Remarks

This function retrieves the modal damping overrides assigned to the specified load case.

The function returns zero if the overrides are successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseModHistNonlinearDampOverrides()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyMode() As Long
Dim MyDamp() As Double
Dim NumberItems As Long
Dim Mode() As Long
Dim Damp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ModHistNonlinear.SetDampConstant("LCASE1", 0.04)

'set modal damping overrides
ReDim MyMode(1)
ReDim MyDamp(1)
MyMode(0) = 1
MyDamp(0) = 0.02
MyMode(1) = 2
MyDamp(1) = 0.03
ret = SapModel.LoadCases.ModHistNonlinear.SetDampOverrides("LCASE1", 2, MyMode,


MyDamp)

'get modal damping overrides
ret = SapModel.LoadCases.ModHistNonlinear.GetDampOverrides("LCASE1", NumberItems,
Mode, Damp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampOverrides

# GetDampProportional

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.GetDampProportional

## VB6 Procedure

Function GetDampProportional(ByVal Name As String, ByRef DampType As Long, ByRef
Dampa As Double, ByRef Dampb As Double, ByRef Dampf1 As Double, ByRef Dampf2 As
Double, ByRef Dampd1 As Double, ByRef Dampd2 As Double) As Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case that has proportional damping.

DampType

This is 1, 2 or 3, indicating the proportional modal damping type.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
```

Dampa

The mass proportional damping coefficient.

Dampb

The stiffness proportional damping coefficient.

Dampf1

This is the period or the frequency (depending on the value of the DampType item) for point 1. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampf2

This is the period or the frequency (depending on the value of the DampType item) for point 2. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampd1

This is the damping at point 1 (0 <= Dampd1 < 1).

This item applies only when DampType = 2 or 3.

Dampd2

This is the damping at point 2 (0 <= Dampd2 < 1).

This item applies only when DampType = 2 or 3.

## Remarks

This function retrieves the proportional modal damping data assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseModHistNonlinearDampProportional()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long
Dim Dampa As Double
Dim Dampb As Double
Dim Dampf1 As Double
Dim Dampf2 As Double


Dim Dampd1 As Double
Dim Dampd2 As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set proportional damping
ret = SapModel.LoadCases.ModHistNonlinear.SetDampProportional("LCASE1", 2, 0, 0, 0.1,
1, 0.05, 0.06)

'get proportional damping
ret = SapModel.LoadCases.ModHistNonlinear.GetDampType("LCASE1", DampType)
If DampType >= 1 or DampType <= 3 Then
ret = SapModel.LoadCases.ModHistNonlinear.GetDampProportional("LCASE1",
DampType, Dampa, Dampb, Dampf1, Dampf2, Dampd1, Dampd2)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampProportional


# GetDampType

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.GetDampType

## VB6 Procedure

Function GetDampType(ByVal Name As String, ByRef DampType As Long) As Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.

DampType

This is 1, 2, 3, 4, 5 or 6, indicating the modal damping type for the load case.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
4 = Constant damping for all modes
5 = Interpolated damping by period
6 = Interpolated damping by frequency
```
## Remarks

This function retrieves the modal damping type for the specified load case.

The function returns zero if the type is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseModHistNonlinearDampType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'get damping type
ret = SapModel.LoadCases.ModHistNonlinear.GetDampType("LCASE1", DampType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampConstant

GetDampInterpolated

GetDampProportional

GetDampOverrides

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters


Name

The name of an existing nonlinear modal history analysis case.

InitialCase

This is blank, None or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it continues from the end of
another nonlinear modal time history load case.

If the specified initial case is not a nonlinear modal time history load case, zero initial conditions
are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseModHistNonlinearInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load cases
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE2")

'set initial condition
ret = SapModel.LoadCases.ModHistNonlinear.SetInitialCase("LCASE1", "LCASE2")

'get initial condition


ret = SapModel.LoadCases.ModHistNonlinear.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.GetLoads

## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef
TF() As Double, ByRef AT() As Double, ByRef CSys() As String, ByRef Ang() As Double) As
Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load or Accel, indicating the type of each load assigned to the load
case.

LoadName


This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the time history function associated with each load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

TF

This is an array that includes the time scale factor of each load assigned to the load case.

AT

This is an array that includes the arrival time of each load assigned to the load case.

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.

Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseModHistNonlinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String


Dim MyFunc() As String
Dim MySF() As Double
Dim MyTF() As Double
Dim MyAT() As Double
Dim MyCSys() As String
Dim MyAng() As Double
Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim Func() As String
Dim SF() As Double
Dim TF() As Double
Dim AT() As Double
Dim CSys() As String
Dim Ang() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyTF(1)
ReDim MyAT(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "RAMPTH"
MySF(0) = 1
MyTF(0) = 1
MyAT(0) = 0
MyCSys(0) = "Global"


MyAng(0) = 0
MyLoadType(1) = "Accel"
MyLoadName(1) = "U2"
MyFunc(1) = "TH-1"
MySF(1) = 2
MyTF(1) = 1.5
MyAT(1) = 10
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.ModHistNonlinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MyFunc, MySF, MyTF, MyAT, MyCSys, MyAng)

'get load data
ret = SapModel.LoadCases.ModHistNonlinear.GetLoads("LCASE1", NumberLoads,
LoadType, LoadName, Func, SF, TF, AT, CSys, Ang)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoads

# GetModalCase

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.GetModalCase

## VB6 Procedure

Function GetModalCase(ByVal Name As String, ByRef ModalCase As String) As Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.


ModalCase

This is None or the name of an existing modal analysis case. It specifies the modal load case on
which any mode-type load assignments to the specified load case are based.

## Remarks

This function retrieves the modal case assigned to the specified load case.

The function returns zero if the modal case is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseModHistNonlinearModalCase()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ModalCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'get modal case
ret = SapModel.LoadCases.ModHistNonlinear.GetModalCase("LCASE1", ModalCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetModalCase

# GetSolControlParameters

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.GetSolControlParameters

## VB6 Procedure

Function GetSolControlParameters(ByVal Name As String, ByRef tstat As Double, ByRef dtmax
As Double, ByRef dtmin As Double, ByRef ftol As Double, ByRef etol As Double, ByRef itmax
As Long, ByRef itmin As Long, ByRef Cf As Double) As Long

## Parameters

Name

The name of an existing nonlinear modal time history analysis case.

tstat

The static period.

dtmax

The maximum substep size.

dtmin

The minimum substep size.

ftol

The relative force convergence tolerance.

etol

The relative energy convergence tolerance.

itmax

The maximum iteration limit.

itmin


The minimum iteration limit.

Cf

The convergence factor.

## Remarks

This function retrieves the solution control parameters for the specified load case.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseModHistNonlinearSolutionControlParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim tstat As Double
Dim dtmax As Double
Dim dtmin As Double
Dim ftol As Double
Dim etol As Double
Dim itmax As Long
Dim itmin As Long
Dim Cf As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal time history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'get solution control parameters
ret = SapModel.LoadCases.ModHistNonlinear.GetSolControlParameters("LCASE1", tstat,
dtmax, dtmin, ftol, etol, itmax, itmin, Cf)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetSolControlParameters

# GetTimeStep

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.GetTimeStep

## VB6 Procedure

Function GetTimeStep(ByVal Name As String, ByRef nstep As Long, ByRef DT As Double) As
Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.

nstep

The number of output time steps.

DT

The output time step size.

## Remarks

This function retrieves the time step data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.


## VBA Example

Sub GetCaseModHistNonlinearTimeStep()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim nstep As Long
Dim DT As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'get time step data
ret = SapModel.LoadCases.ModHistNonlinear.GetTimeStep ("LCASE1", nstep, DT )

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetTimeStep

# SetCase

## Syntax


SapObject.SapModel.LoadCases.ModHistNonlinear.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks

This function initializes a nonlinear modal history analysis case. If this function is called for an
existing load case, all items for the case are reset to their default values.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseModHistNonlinear()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetDampConstant

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.SetDampConstant

## VB6 Procedure

Function SetDampConstant(ByVal Name As String, ByVal Damp As Double) As Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.

Damp

The constant damping for all modes (0 <= Damp < 1).

## Remarks

This function sets constant modal damping for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistNonlinearDampConstant()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ModHistNonlinear.SetDampConstant("LCASE1", 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampConstant

# SetDampInterpolated

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.SetDampInterpolated

## VB6 Procedure

Function SetDampInterpolated(ByVal Name As String, ByVal DampType As Long, ByVal
NumberItems As Long, ByRef Time() As Double, ByRef Damp() As Double) As Long


## Parameters

Name

The name of an existing nonlinear modal history analysis case.

DampType

This is 5 or 6, indicating the interpolated modal damping type.

```
5 = Interpolated damping by period
6 = Interpolated damping by frequency
```
NumberItems

The number of Time and Damp pairs.

Time

This is an array that includes the period or the frequency, depending on the value of the
DampType item. [s] for DampType = 5 and [cyc/s] for DampType = 6

Damp

This is an array that includes the damping for the specified period of frequency (0 <= Damp < 1).

## Remarks

This function sets interpolated modal damping data for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistNonlinearDampInterpolated()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyTime() As Double
Dim MyDamp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set interpolated damping
ReDim MyTime(2)
ReDim MyDamp(2)
MyTime(0) = 0.001
MyDamp(0) = 0.1
MyTime(1) = 0.3
MyDamp(1) = 0.03
MyTime(2) = 1
MyDamp(2) = 0.05
ret = SapModel.LoadCases.ModHistNonlinear.SetDampInterpolated("LCASE1", 5, 3,
MyTime, MyDamp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampInterpolated

# SetDampOverrides

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.SetDampOverrides

## VB6 Procedure

Function SetDampOverrides(ByVal Name As String, ByVal NumberItems As Long, ByRef Mode
() As Long, ByRef Damp() As Double) As Long


## Parameters

Name

The name of an existing nonlinear modal history analysis case.

NumberItems

The number of Mode and Damp pairs.

Mode

This is an array that includes a mode number.

Damp

This is an array that includes the damping for the specified mode (0 <= Damp < 1).

## Remarks

This function sets the modal damping overrides for the specified load case.

The function returns zero if the overrides are successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistNonlinearDampOverrides()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyMode() As Long
Dim MyDamp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")


'set constant damping
ret = SapModel.LoadCases.ModHistNonlinear.SetDampConstant("LCASE1", 0.04)

'set modal damping overrides
ReDim MyMode(1)
ReDim MyDamp(1)
MyMode(0) = 1
MyDamp(0) = 0.02
MyMode(1) = 2
MyDamp(1) = 0.03
ret = SapModel.LoadCases.ModHistNonlinear.SetDampOverrides("LCASE1", 2, MyMode,
MyDamp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampOverrides

# SetDampProportional

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.SetDampProportional

## VB6 Procedure

Function SetDampProportional(ByVal Name As String, ByVal DampType As Long, ByVal
Dampa As Double, ByVal Dampb As Double, ByVal Dampf1 As Double, ByVal Dampf2 As
Double, ByVal Dampd1 As Double, ByVal Dampd2 As Double) As Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.


DampType

This is 1, 2 or 3, indicating the proportional modal damping type.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
```
Dampa

The mass proportional damping coefficient. This item applies only when DampType = 1.

Dampb

The stiffness proportional damping coefficient. This item applies only when DampType = 1.

Dampf1

This is the period or the frequency (depending on the value of the DampType item) for point 1. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampf2

This is the period or the frequency (depending on the value of the DampType item) for point 2. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampd1

This is the damping at point 1 (0 <= Dampd1 < 1).

This item applies only when DampType = 2 or 3.

Dampd2

This is the damping at point 2 (0 <= Dampd2 < 1).

This item applies only when DampType = 2 or 3.

## Remarks

This function sets proportional modal damping data for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistNonlinearDampProportional()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set proportional damping
ret = SapModel.LoadCases.ModHistNonlinear.SetDampProportional("LCASE1", 2, 0, 0, 0.1,
1, 0.05, 0.06)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampProportional

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.SetInitialCase

## VB6 Procedure


Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.

InitialCase

This is blank, None or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it continues from the end of
another nonlinear modal time history load case.

If the specified initial case is not a nonlinear modal time history load case, zero initial conditions
are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseModHistNonlinearInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load cases
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE2")


'set initial condition
ret = SapModel.LoadCases.ModHistNonlinear.SetInitialCase("LCASE1", "LCASE2")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef TF
() As Double, ByRef AT() As Double, ByRef CSys() As String, ByRef Ang() As Double) As
Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes Load or Accel, indicating the type of each load assigned to the load
case.

LoadName


This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the time history function associated with each load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

TF

This is an array that includes the time scale factor of each load assigned to the load case.

AT

This is an array that includes the arrival time of each load assigned to the load case.

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.

Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistNonlinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String


Dim MyFunc() As String
Dim MySF() As Double
Dim MyTF() As Double
Dim MyAT() As Double
Dim MyCSys() As String
Dim MyAng() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add sine TH function
ret = SapModel.Func.FuncTH.SetSine("TH-1", 1, 16, 4, 1.25)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyTF(1)
ReDim MyAT(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "RAMPTH"
MySF(0) = 1
MyTF(0) = 1
MyAT(0) = 0
MyCSys(0) = "Global"
MyAng(0) = 0
MyLoadType(1) = "Accel"
MyLoadName(1) = "U2"
MyFunc(1) = "TH-1"
MySF(1) = 2
MyTF(1) = 1.5
MyAT(1) = 10
MyCSys(1) = "Global"
MyAng(1) = 10


ret = SapModel.LoadCases.ModHistNonlinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MyFunc, MySF, MyTF, MyAT, MyCSys, MyAng)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# SetModalCase

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.SetModalCase

## VB6 Procedure

Function SetModalCase(ByVal Name As String, ByVal ModalCase As String) As Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.

ModalCase

This is the name of an existing modal load case. It specifies the modal load case on which any
mode-type load assignments to the specified load case are based.

## Remarks

This function sets the modal case for the specified analysis case.

The function returns zero if the modal case is successfully set; otherwise it returns a nonzero
value.


If the specified modal case is not actually a modal case, the program automatically replaces it with
the first modal case it can find. If no modal load cases exist, an error is returned.

## VBA Example

Sub SetCaseModHistNonlinearModalCase()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set modal case
ret = SapModel.LoadCases.ModHistNonlinear.SetModalCase("LCASE1", "MODAL")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetModalCase


# SetSolControlParameters

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.SetSolControlParameters

## VB6 Procedure

Function SetSolControlParameters(ByVal Name As String, ByVal tstat As Double, ByVal dtmax
As Double, ByVal dtmin As Double, ByVal ftol As Double, ByVal etol As Double, ByVal itmax
As Long, ByVal itmin As Long, ByVal Cf As Double) As Long

## Parameters

Name

The name of an existing nonlinear modal time history analysis case.

tstat

The static period.

dtmax

The maximum substep size.

dtmin

The minimum substep size.

ftol

The relative force convergence tolerance.

etol

The relative energy convergence tolerance.

itmax

The maximum iteration limit.

itmin

The minimum iteration limit.

Cf

The convergence factor.


## Remarks

This function sets the solution control parameters for the specified load case.

The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseModHistNonlinearSolutionControlParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal time history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set solution control parameters
ret = SapModel.LoadCases.ModHistNonlinear.SetSolControlParameters("LCASE1", 0.1,
0.001, 0.000001, 0.00002, 0.00003, 80, 10, 1.5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetSolControlParameters

# SetTimeStep

## Syntax

SapObject.SapModel.LoadCases.ModHistNonlinear.SetTimeStep

## VB6 Procedure

Function SetTimeStep(ByVal Name As String, ByVal nstep As Long, ByVal DT As Double) As
Long

## Parameters

Name

The name of an existing nonlinear modal history analysis case.

nstep

The number of output time steps.

DT

The output time step size.

## Remarks

This function sets the time step data for the specified load case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseModHistNonlinearTimeStep()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add nonlinear modal history load case
ret = SapModel.LoadCases.ModHistNonlinear.SetCase("LCASE1")

'set time step data
ret = SapModel.LoadCases.ModHistNonlinear.SetTimeStep("LCASE1", 120, 0.05)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetTimeStep

# GetDirectionalFactors

## Syntax

SapObject.SapModel.LoadCases.Moving.GetDirectionalFactors

## VB6 Procedure

Function GetDirectionalFactors(ByVal Name As String, ByRef Vertical As Double, ByRef
Braking As Double, ByRef Centrifugal As Double) As Integer

## Parameters

Name


The name of an existing moving load case.

Vertical

The moving load directional factor for vertical load.

Braking

The moving load directional factor.

Centrifugal

The moving directional factor for centrifugal load.

## Remarks

This function retrieves the directional factors for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetDirectionalFactors()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Vertical As Double
Dim Braking As Double
Dim Centrifugal As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add moving load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")

'set directional factors


ret = SapModel.LoadCases.Moving.SetDirectionalFactors("LCASE1", 1, 0.7, 0.4)

'get directional factors
ret = SapModel.LoadCases.Moving.GetDirectionalFactors("LCASE1", 1, Vertical, Braking,
Centrifugal)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.

## See Also

SetDirectionalFactors

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.Moving.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing moving load load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks


This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseMovingInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add moving load load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")

'get initial condition
ret = SapModel.LoadCases.Moving.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase


# GetLanesLoaded

## Syntax

SapObject.SapModel.LoadCases.Moving.GetLanesLoaded

## VB6 Procedure

Function GetLanesLoaded(ByVal Name As String, ByVal LoadNumber As Long, ByRef
NumberItems As Long, ByRef MyName() As String) As Long

## Parameters

Name

The name of an existing moving load case.

LoadNumber

The load assignment number.

NumberItems

The number of lanes loaded for the specified load assignment number.

MyName

This is an array that includes the name of each lane loaded for the specified load assignment
number.

## Remarks

This function retrieves the lanes loaded data for a specified load assignment number in a specified
load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseMovingLanesLoaded()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyMyClass() As String
Dim MySF() As Double
Dim MyMin() As Double
Dim MyMax() As Double
Dim MyMyName() As String


Dim NumberItems As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add moving load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")

'set load data
ReDim MyMyClass(1)
ReDim MySF(1)
ReDim MyMin(1)
ReDim MyMax(1)
MyMyClass(0) = "VECL1"
MySF(0) = 1.5
MyMin(0) = 1
MyMax(0) = 1
MyMyClass(1) = "VECL1"
MySF(1) = 0.8
MyMin(1) = 0
MyMax(1) = 0
ret = SapModel.LoadCases.Moving.SetLoads("LCASE1", 2, MyMyClass, MySF, MyMin,
MyMax)

'set lanes loaded data for first load assignment
ReDim MyMyName(0)
MyMyName(0) = "LANE1"
ret = SapModel.LoadCases.Moving.SetLanesLoaded("LCASE1", 1, 1, MyMyName)

'get lanes loaded data for first load assignment
ret = SapModel.LoadCases.Moving.GetLanesLoaded("LCASE1", 1, NumberItems, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLanesLoaded

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.Moving.GetLoads

## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef MyClass() As
String, ByRef SF() As Double, ByRef Min() As Double, ByRef Max() As Double) As Long

## Parameters

Name

The name of an existing moving load case.

NumberLoads

The number of loads assigned to the specified analysis case.

MyClass

This is an array that includes the vehicle class for each load assigned to the load case.

SF

This is an array that includes the scale factor for each load assigned to the load case.

Min

This is an array that includes the minimum number of lanes loaded for each load assigned to the
load case.

Max

This is an array that includes the maximum number of lanes loaded for each load assigned to the
load case. This item must be 0, or it must be greater than or equal to Min. If this item is 0, all
available lanes are loaded.


## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseMovingLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyMyClass() As String
Dim MySF() As Double
Dim MyMin() As Double
Dim MyMax() As Double
Dim NumberLoads As Long
Dim MyClass() As String
Dim SF() As Double
Dim Min() As Double
Dim Max() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add moving load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")

'set load data
ReDim MyMyClass(1)
ReDim MySF(1)
ReDim MyMin(1)
ReDim MyMax(1)
MyMyClass(0) = "VECL1"
MySF(0) = 1.5
MyMin(0) = 1
MyMax(0) = 1
MyMyClass(1) = "VECL1"
MySF(1) = 0.8


MyMin(1) = 0
MyMax(1) = 0
ret = SapModel.LoadCases.Moving.SetLoads("LCASE1", 2, MyMyClass, MySF, MyMin,
MyMax)

'get load data
ret = SapModel.LoadCases.Moving.GetLoads("LCASE1", NumberLoads, MyClass, SF, Max,
Min)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoads

# GetMultiLaneSF

## Syntax

SapObject.SapModel.LoadCases.Moving.GetMultiLaneSF

## VB6 Procedure

Function GetMultiLaneSF(ByVal Name As String, ByRef NumberItems As Long, ByRef SF() As
Double) As Long

## Parameters

Name

The name of an existing moving load case.

NumberItems

The number of lanes loaded up to which reduction scale factors are provided.

SF


This is an array that includes the reduction scale factor for the number of lanes loaded from 1 up
to NumberItems.

## Remarks

This function retrieves the multilane scale factor data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseMovingMultiLaneSF()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MySF() As Double
Dim NumberItems As Long
Dim SF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add moving load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")

'set multilane scale factor data
ReDim MySF(1)
MySF(0) = 1.2
MySF(1) = 0.8
ret = SapModel.LoadCases.Moving.SetMultiLaneSF("LCASE1", 2, MySF)

'get multilane scale factor data
ret = SapModel.LoadCases.Moving.GetMultiLaneSF("LCASE1", NumberItems, SF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetMultiLaneSF

# SetCase

## Syntax

SapObject.SapModel.LoadCases.Moving.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case then that case is modified,
otherwise, a new case is added.

## Remarks

This function initializes a moving load load case. If this function is called for an existing load
case, all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseMoving()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add moving load load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetDirectionalFactors

## Syntax

SapObject.SapModel.LoadCases.Moving.SetDirectionalFactors

## VB6 Procedure

Function SetDirectionalFactors(ByVal Name As String, ByVal Vertical As Double, ByVal
Braking As Double, ByVal Centrifugal As Double) As Integer

## Parameters

Name


The name of an existing moving load case.

Vertical

The moving load directional factor for vertical load.

Braking

The moving load directional factor.

Centrifugal

The moving directional factor for centrifugal load.

## Remarks

This function sets the directional factors for the specified load case. Calling this function is
optional. By default, the directional factors are set to Vertical = 1, Braking = 0, and Centrifugal =
0 when the moving load case is defied or re-defined. If this function is called, the three directional
factors must be nonnegative, and at least one must be positive.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub SetDirectionalFactors()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Vertical As Double
Dim Braking As Double
Dim Centrifugal As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add moving load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")


'set directional factors
Vertical = 1.0

Braking - 0.7

Centrifugal = 0.4

ret = SapModel.LoadCases.Moving.SetDirectionalFactors("LCASE1", Vertical, Braking,
Centrifugal)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.

## See Also

GetDirectionalFactors

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.Moving.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing moving load load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.


If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseMovingInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add moving load load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.Moving.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase

# SetLanesLoaded

## Syntax

SapObject.SapModel.LoadCases.Moving.SetMultiLaneSF

## VB6 Procedure

Function SetMultiLaneSF(ByVal Name As String, ByVal LoadNumber As Long, ByVal
NumberItems As Long, ByRef MyName() As String) As Long

## Parameters

Name

The name of an existing moving load case.

LoadNumber

The load assignment number.

NumberItems

The number of lanes loaded for the specified load assignment number.

MyName

This is an array that includes the name of each lane loaded for the specified load assignment
number.

## Remarks

This function sets the lanes loaded data for a specified load assignment number in a specified load
case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example


Sub SetCaseMovingLanesLoaded()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyMyClass() As String
Dim MySF() As Double
Dim MyMin() As Double
Dim MyMax() As Double
Dim MyMyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add moving load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")

'set load data
ReDim MyMyClass(1)
ReDim MySF(1)
ReDim MyMin(1)
ReDim MyMax(1)
MyMyClass(0) = "VECL1"
MySF(0) = 1.5
MyMin(0) = 1
MyMax(0) = 1
MyMyClass(1) = "VECL1"
MySF(1) = 0.8
MyMin(1) = 0
MyMax(1) = 0
ret = SapModel.LoadCases.Moving.SetLoads("LCASE1", 2, MyMyClass, MySF, MyMin,
MyMax)

'set lanes loaded data for first load assignment
ReDim MyMyName(0)
MyMyName(0) = "LANE1"
ret = SapModel.LoadCases.Moving.SetLanesLoaded("LCASE1", 1, 1, MyMyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLanesLoaded

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.Moving.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef MyClass() As
String, ByRef SF() As Double, ByRef Min() As Double, ByRef Max() As Double) As Long

## Parameters

Name

The name of an existing moving load case.

NumberLoads

The number of loads assigned to the specified analysis case.

MyClass

This is an array that includes the vehicle class for each load assigned to the load case.

SF

This is an array that includes the scale factor for each load assigned to the load case.

Min

This is an array that includes the minimum number of lanes loaded for each load assigned to the
load case.

Max


This is an array that includes the maximum number of lanes loaded for each load assigned to the
load case. This item must be 0, or it must be greater than or equal to Min. If this item is 0, all
available lanes are loaded.

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseMovingLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyMyClass() As String
Dim MySF() As Double
Dim MyMin() As Double
Dim MyMax() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add moving load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")

'set load data
ReDim MyMyClass(1)
ReDim MySF(1)
ReDim MyMin(1)
ReDim MyMax(1)
MyMyClass(0) = "VECL1"
MySF(0) = 1.5
MyMin(0) = 1
MyMax(0) = 1
MyMyClass(1) = "VECL1"
MySF(1) = 0.8


MyMin(1) = 0
MyMax(1) = 0
ret = SapModel.LoadCases.Moving.SetLoads("LCASE1", 2, MyMyClass, MySF, MyMin,
MyMax)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# SetMultiLaneSF

## Syntax

SapObject.SapModel.LoadCases.Moving.SetMultiLaneSF

## VB6 Procedure

Function SetMultiLaneSF(ByVal Name As String, ByVal NumberItems As Long, ByRef SF() As
Double) As Long

## Parameters

Name

The name of an existing moving load case.

NumberItems

The number of lanes loaded up to which reduction scale factors are provided (NumberItems >= 1).

SF

This is an array that includes the reduction scale factor for the number of lanes loaded from 1 up
to NumberItems.


## Remarks

This function sets the multilane scale factor data for the specified load case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseMovingMultiLaneSF()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MySF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model
SapModel.File.OpenFile("C:\SapAPI\Example 1-030.SDB")

'add moving load case
ret = SapModel.LoadCases.Moving.SetCase("LCASE1")

'set multilane scale factor data
ReDim MySF(1)
MySF(0) = 1.2
MySF(1) = 0.8
ret = SapModel.LoadCases.Moving.SetMultiLaneSF("LCASE1", 2, MySF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetMultiLaneSF

# GetDampConstant

## Syntax

SapObject.SapModel.LoadCases.PSD.GetDampConstant

## VB6 Procedure

Function GetDampConstant(ByVal Name As String, ByRef HysConMassCoeff As Double,
ByRef HysConStiffCoeff As Double) As Long

## Parameters

Name

The name of an existing power spectral density analysis case that has constant damping.

HysConMassCoeff

The mass proportional damping coefficient.

HysConStiffCoeff

The stiffness proportional damping coefficient.

## Remarks

This function retrieves the constant hysteretic damping for all frequencies assigned to the
specified load case.

The function returns zero if the damping is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCasePSDDampConstant()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long
Dim HysConMassCoeff As Double
Dim HysConStiffCoeff As Double


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.PSD.SetDampConstant("LCASE1", 0.8, 0.04)

'get constant damping
ret = SapModel.LoadCases.PSD.GetDampType("LCASE1", DampType)
If DampType = 1 Then
ret = SapModel.LoadCases.PSD.GetDampConstant("LCASE1", HysConMassCoeff,
HysConStiffCoeff)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampConstant

# GetDampInterpolated

## Syntax

SapObject.SapModel.LoadCases.PSD.GetDampInterpolated


## VB6 Procedure

Function GetDampInterpolated(ByVal Name As String, ByRef HysIntFreqUnits As Long, ByRef
HysIntNumFreqs As Long, ByRef HysIntFreq() As Double, ByRef HysIntMassCoeff() As
Double, ByRef HysIntStiffCoeff() As Double) As Long

## Parameters

Name

The name of an existing power spectral density analysis case that has interpolated damping.

HysIntFreqUnits

This is 1 or 2, indicating the units for the frequency.

```
1 = Hz [cyc/s]
2 = RPM
```
HysIntNumFreqs

The number of sets of frequency, mass coefficient and stiffness coefficient data.

HysIntFreq

This is an array of frequencies. The frequency is either in Hz or RPM depending on the value of
HysIntFreqUnits.

HysIntMassCoeff

This is an array that includes the mass proportional damping coefficient.

HysIntStiffCoeff

This is an array that includes the stiffness proportional damping coefficient.

## Remarks

This function retrieves the interpolated hysteretic damping by frequency assigned to the specified
load case.

The function returns zero if the damping is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCasePSDDampInterpolated()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyHysIntFreq() As Double


Dim MyHysIntMassCoeff() As Double
Dim MyHysIntStiffCoeff() As Double
Dim DampType As Long
Dim HysIntFreqUnits As Long
Dim HysIntNumFreqs As Long
Dim HysIntFreq() As Double
Dim HysIntMassCoeff() As Double
Dim HysIntStiffCoeff() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'set interpolated damping
ReDim MyHysIntFreq(2)
ReDim MyHysIntMassCoeff(2)
ReDim MyHysIntStiffCoeff(2)
MyHysIntFreq(0) = 1
MyHysIntMassCoeff(0) = 0.6
MyHysIntStiffCoeff(0) = 0.04
MyHysIntFreq(1) = 10
MyHysIntMassCoeff(1) = 0.7
MyHysIntStiffCoeff(1) = 0.05
MyHysIntFreq(2) = 100
MyHysIntMassCoeff(2) = 0.8
MyHysIntStiffCoeff(2) = 0.08
ret = SapModel.LoadCases.PSD.SetDampInterpolated("LCASE1", 2, 3, MyHysIntFreq,
MyHysIntMassCoeff, MyHysIntStiffCoeff)

'get interpolated damping
ret = SapModel.LoadCases.PSD.GetDampType("LCASE1", DampType)
If DampType = 2 Then
ret = SapModel.LoadCases.PSD.GetDampInterpolated("LCASE1", HysIntFreqUnits,
HysIntNumFreqs, HysIntFreq, HysIntMassCoeff, HysIntStiffCoeff)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampInterpolated

# GetDampType

## Syntax

SapObject.SapModel.LoadCases.PSD.GetDampType

## VB6 Procedure

Function GetDampType(ByVal Name As String, ByRef DampType As Long) As Long

## Parameters

Name

The name of an existing power spectral density analysis case.

DampType

This is 1 or 2, indicating the hysteretic damping type for the load case.

```
1 = Constant hysteretic damping for all frequencies
2 = Interpolated hysteretic damping by frequency
```
## Remarks

This function retrieves the hysteretic damping type for the specified load case.

The function returns zero if the type is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCasePSDDampType()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'get damping type
ret = SapModel.LoadCases.PSD.GetDampType("LCASE1", DampType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampConstant

GetDampInterpolated

# GetFreqData

## Syntax

SapObject.SapModel.LoadCases.PSD.GetFreqData


## VB6 Procedure

Function GetFreqData(ByVal Name As String, ByRef FreqFirst As Double, ByRef FreqLast As
Double, ByRef FreqNumIncs As Long, ByRef FreqAddModal As Boolean, ByRef
FreqAddModalDev As Boolean, ByRef FreqAddSpecified As Boolean, ByRef
FreqNumModalDev As Long, ByRef FreqModalDev() As Double, ByRef FreqNumSpecified As
Long, ByRef FreqSpecified() As Double) As Long

## Parameters

Name

The name of an existing power spectral density analysis case.

FreqFirst

The first frequency. [cyc/s]

FreqLast

The last frequency. [cyc/s]

FreqNumIncs

The number of frequency increments.

FreqAddModal

If this item is True, modal frequencies are added.

FreqAddModalDev

If this item is True, signed fractional deviations from modal frequencies are added.

FreqAddSpecified

If this item is True, specified frequencies are added.

ModalCase

This is the name of an existing modal load case. It specifies the modal load case on which modal
frequencies and modal frequency deviations are based.

FreqNumModalDev

The number of signed fractional deviations from modal frequencies that are added. This item
applies only when FreqAddModalDev = True.

FreqModalDev

This is an array that includes the added signed fractional deviations from modal frequencies. This
item applies only when FreqAddModalDev = True.

FreqNumSpecified


The number of specified frequencies that are added. This item applies only when
FreqAddSpecified = True.

FreqSpecified

This is an array that includes the added specified frequencies. This item applies only when
FreqAddModalDev = True.

## Remarks

This function retrieves the frequency data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCasePSDFreqData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyFreqModalDev() As Double
Dim MyFreqSpecified() As Double
Dim FreqFirst As Double
Dim FreqLast As Double
Dim FreqNumIncs As Long
Dim FreqAddModal As Boolean
Dim FreqAddModalDev As Boolean
Dim FreqAddSpecified As Boolean
Dim ModalCase As String
Dim FreqNumModalDev As Long
Dim FreqModalDev() As Double
Dim FreqNumSpecified As Long
Dim FreqSpecified() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")


'set frequency data
ReDim MyFreqModalDev(1)
ReDim MyFreqSpecified(1)
MyFreqModalDev(0) = -0.1
MyFreqModalDev(1) = 0.2
MyFreqSpecified(0) = 1.2
MyFreqSpecified(1) = 11.4
ret = SapModel.LoadCases.PSD.SetFreqData("LCASE1", .6, 20.6, 10, True, True, True,
"MODAL", 2, MyFreqModalDev, 2, MyFreqSpecified)

'get frequency data
ret = SapModel.LoadCases.PSD.GetFreqData("LCASE1", FreqFirst, FreqLast, FreqNumIncs,
FreqAddModal, FreqAddModalDev, FreqAddSpecified, ModalCase, FreqNumModalDev,
FreqModalDev, FreqNumSpecified, FreqSpecified)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetFreqData

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.PSD.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing power spectral density analysis case.


InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCasePSDInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'get initial condition
ret = SapModel.LoadCases.PSD.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.PSD.GetLoads

## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef
PhaseAngle() As Double, ByRef CSys() As String, ByRef Ang() As Double) As Long

## Parameters

Name

The name of an existing power spectral density analysis case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func


This is an array that includes the name of the power spectral density function associated with each
load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

PhaseAngle

This is an array that includes the phase angle. [deg]

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.

Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCasePSDLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyPhaseAngle() As Double
Dim MyCSys() As String
Dim MyAng() As Double
Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim Func() As String
Dim SF() As Double
Dim PhaseAngle() As Double


Dim CSys() As String
Dim Ang() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyPhaseAngle(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "UNIFPSD"
MySF(0) = 1.5
MyPhaseAngle(0) = 90
MyLoadType(1) = "Accel"
MyLoadName(1) = "U3"
MyFunc(1) = "UNIFPSD"
MySF(1) = 1
MyPhaseAngle(1) = 90
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.PSD.SetLoads("LCASE1", 2, MyLoadType, MyLoadName,
MyFunc, MySF, MyPhaseAngle, MyCSys, MyAng)

'get load data
ret = SapModel.LoadCases.PSD.GetLoads("LCASE1", NumberLoads, LoadType,
LoadName, Func, SF, PhaseAngle, CSys, Ang)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoads

# SetCase

## Syntax

SapObject.SapModel.LoadCases.PSD.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks

This function initializes a power spectral density analysis case. If this function is called for an
existing load case, all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCasePSD()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetDampConstant

## Syntax

SapObject.SapModel.LoadCases.PSD.SetDampConstant

## VB6 Procedure

Function SetDampConstant(ByVal Name As String, ByVal HysConMassCoeff As Double, ByVal
HysConStiffCoeff As Double) As Long

## Parameters

Name

The name of an existing power spectral density analysis case.

HysConMassCoeff


The mass proportional damping coefficient.

HysConStiffCoeff

The stiffness proportional damping coefficient.

## Remarks

This function sets constant hysteretic damping for all frequencies for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCasePSDDampConstant()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.PSD.SetDampConstant("LCASE1", 0.8, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampConstant

# SetDampInterpolated

## Syntax

SapObject.SapModel.LoadCases.PSD.SetDampInterpolated

## VB6 Procedure

Function SetDampInterpolated(ByVal Name As String, ByVal HysIntFreqUnits As Long, ByVal
HysIntNumFreqs As Long, ByRef HysIntFreq() As Double, ByRef HysIntMassCoeff() As
Double, ByRef HysIntStiffCoeff() As Double) As Long

## Parameters

Name

The name of an existing power spectral density analysis case.

HysIntFreqUnits

This is either 1 or 2, indicating the units for the frequency.

```
1 = Hz [cyc/s]
2 = RPM
```
HysIntNumFreqs

The number of sets of frequency, mass coefficient and stiffness coefficient data.

HysIntFreq

This is an array of frequencies. The frequency is either in Hz or RPM depending on the value of
HysIntFreqUnits.

HysIntMassCoeff

This is an array that includes the mass proportional damping coefficient.

HysIntStiffCoeff

This is an array that includes the stiffness proportional damping coefficient.


## Remarks

This function sets interpolated hysteretic damping by frequency for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCasePSDDampInterpolated()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyHysIntFreq() As Double
Dim MyHysIntMassCoeff() As Double
Dim MyHysIntStiffCoeff() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'set interpolated damping
ReDim MyHysIntFreq(2)
ReDim MyHysIntMassCoeff(2)
ReDim MyHysIntStiffCoeff(2)
MyHysIntFreq(0) = 1
MyHysIntMassCoeff(0) = 0.6
MyHysIntStiffCoeff(0) = 0.04
MyHysIntFreq(1) = 10
MyHysIntMassCoeff(1) = 0.7
MyHysIntStiffCoeff(1) = 0.05
MyHysIntFreq(2) = 100
MyHysIntMassCoeff(2) = 0.8
MyHysIntStiffCoeff(2) = 0.08
ret = SapModel.LoadCases.PSD.SetDampInterpolated("LCASE1", 2, 3, MyHysIntFreq,
MyHysIntMassCoeff, MyHysIntStiffCoeff)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampInterpolated

# SetFreqData

## Syntax

SapObject.SapModel.LoadCases.PSD.SetFreqData

## VB6 Procedure

Function SetFreqData(ByVal Name As String, ByVal FreqFirst As Double, ByVal FreqLast As
Double, ByVal FreqNumIncs As Long, ByVal FreqAddModal As Boolean, ByVal
FreqAddModalDev As Boolean, ByVal FreqAddSpecified As Boolean, ByVal
FreqNumModalDev As Long, ByRef FreqModalDev() As Double, ByVal FreqNumSpecified As
Long, ByRef FreqSpecified() As Double) As Long

## Parameters

Name

The name of an existing power spectral density analysis case.

FreqFirst

The first frequency. [cyc/s]

FreqLast

The last frequency. [cyc/s]

FreqNumIncs

The number of frequency increments.

FreqAddModal


If this item is True, modal frequencies are added.

FreqAddModalDev

If this item is True, signed fractional deviations from modal frequencies are added.

FreqAddSpecified

If this item is True, specified frequencies are added.

ModalCase

This is the name of an existing modal load case. It specifies the modal load case on which modal
frequencies and modal frequency deviations are based.

FreqNumModalDev

The number of signed fractional deviations from modal frequencies that are added. This item
applies only when FreqAddModalDev = True.

FreqModalDev

This is an array that includes the added signed fractional deviations from modal frequencies. This
item applies only when FreqAddModalDev = True.

FreqNumSpecified

The number of specified frequencies that are added. This item applies only when
FreqAddSpecified = True.

FreqSpecified

This is an array that includes the added specified frequencies. This item applies only when
FreqAddModalDev = True.

## Remarks

This function sets the frequency data for the specified load case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCasePSDFreqData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyFreqModalDev() As Double
Dim MyFreqSpecified() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'set frequency data
ReDim MyFreqModalDev(1)
ReDim MyFreqSpecified(1)
MyFreqModalDev(0) = -0.1
MyFreqModalDev(1) = 0.2
MyFreqSpecified(0) = 1.2
MyFreqSpecified(1) = 11.4
ret = SapModel.LoadCases.PSD.SetFreqData("LCASE1", .6, 20.6, 10, True, True, True,
"MODAL", 2, MyFreqModalDev, 2, MyFreqSpecified)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetFreqData

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.PSD.SetInitialCase


## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing power spectral density analysis case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCasePSDInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case


ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.PSD.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.PSD.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef
PhaseAngle() As Double, ByRef CSys() As String, ByRef Ang() As Double) As Long

## Parameters

Name

The name of an existing power spectral density analysis case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType


This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the power spectral density function associated with each
load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

PhaseAngle

This is an array that includes the phase angle. [deg]

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies pnly when the LoadType item is Accel.

Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCasePSDLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyPhaseAngle() As Double
Dim MyCSys() As String
Dim MyAng() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add power spectral density load case
ret = SapModel.LoadCases.PSD.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyPhaseAngle(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "UNIFPSD"
MySF(0) = 1.5
MyPhaseAngle(0) = 90
MyLoadType(1) = "Accel"
MyLoadName(1) = "U3"
MyFunc(1) = "UNIFPSD"
MySF(1) = 1
MyPhaseAngle(1) = 90
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.PSD.SetLoads("LCASE1", 2, MyLoadType, MyLoadName,
MyFunc, MySF, MyPhaseAngle, MyCSys, MyAng)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# GetDampConstant

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetDampConstant

## VB6 Procedure

Function GetDampConstant(ByVal Name As String, ByRef Damp As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case that has constant damping.

Damp

The constant damping for all modes (0 <= Damp < 1).

## Remarks

This function retrieves the constant modal damping for all modes assigned to the specified load
case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseResponseSpectrumDampConstant()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long
Dim Damp As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ResponseSpectrum.SetDampConstant("LCASE1", 0.04)

'get constant damping
ret = SapModel.LoadCases.ResponseSpectrum.GetDampType("LCASE1", DampType)
If DampType = 4 Then
ret = SapModel.LoadCases.ResponseSpectrum.GetDampConstant("LCASE1", Damp)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampConstant


# GetDampInterpolated

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetDampInterpolated

## VB6 Procedure

Function GetDampInterpolated(ByVal Name As String, ByRef DampType As Long, ByRef
NumberItems As Long, ByRef Time() As Double, ByRef Damp() As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case that has interpolated damping.

DampType

This is either 5 or 6, indicating the interpolated modal damping type.

```
5 = Interpolated damping by period
6 = Interpolated damping by frequency
```
NumberItems

The number of Time and Damp pairs.

Time

This is an array that includes the period or the frequency depending on the value of the DampType
item. [s] for DampType = 5 and [cyc/s] for DampType = 6

Damp

This is an array that includes the damping for the specified period of frequency (0 <= Damp < 1).

## Remarks

This function retrieves the interpolated modal damping data assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseResponseSpectrumDampInterpolated()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim MyTime() As Double
Dim MyDamp() As Double
Dim DampType As Long
Dim NumberItems As Long
Dim Time() As Double
Dim Damp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set interpolated damping
ReDim MyTime(2)
ReDim MyDamp(2)
MyTime(0) = 0.001
MyDamp(0) = 0.1
MyTime(1) = 0.3
MyDamp(1) = 0.03
MyTime(2) = 1
MyDamp(2) = 0.05
ret = SapModel.LoadCases.ResponseSpectrum.SetDampInterpolated("LCASE1", 5, 3,
MyTime, MyDamp)

'get interpolated damping
ret = SapModel.LoadCases.ResponseSpectrum.GetDampType("LCASE1", DampType)
If DampType = 5 or DampType = 6 Then
ret = SapModel.LoadCases.ResponseSpectrum.GetDampInterpolated("LCASE1",
DampType, NumberItems, Time, Damp)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampInterpolated

# GetDampOverrides

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetDampInterpolated

## VB6 Procedure

Function GetDampInterpolated(ByVal Name As String, ByRef NumberItems As Long, ByRef
Mode() As Long, ByRef Damp() As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case.

NumberItems

The number of Mode and Damp pairs.

Mode

This is an array that includes a mode number.

Damp

This is an array that includes the damping for the specified mode (0 <= Damp < 1).

## Remarks

This function retrieves the modal damping overrides assigned to the specified load case.

The function returns zero if the overrides are successfully retrieved; otherwise it returns a nonzero
value.


## VBA Example

Sub GetCaseResponseSpectrumDampOverrides()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyMode() As Long
Dim MyDamp() As Double
Dim NumberItems As Long
Dim Mode() As Long
Dim Damp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ResponseSpectrum.SetDampConstant("LCASE1", 0.04)

'set modal damping overrides
ReDim MyMode(1)
ReDim MyDamp(1)
MyMode(0) = 1
MyDamp(0) = 0.02
MyMode(1) = 2
MyDamp(1) = 0.03
ret = SapModel.LoadCases.ResponseSpectrum.SetDampOverrides("LCASE1", 2, MyMode,
MyDamp)

'get modal damping overrides
ret = SapModel.LoadCases.ResponseSpectrum.GetDampOverrides("LCASE1",
NumberItems, Mode, Damp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampOverrides

# GetDampProportional

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetDampProportional

## VB6 Procedure

Function GetDampProportional(ByVal Name As String, ByRef DampType As Long, ByRef
Dampa As Double, ByRef Dampb As Double, ByRef Dampf1 As Double, ByRef Dampf2 As
Double, ByRef Dampd1 As Double, ByRef Dampd2 As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case that has proportional damping.

DampType

This is 1, 2 or 3, indicating the proportional modal damping type.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
```
Dampa

The mass proportional damping coefficient.

Dampb

The stiffness proportional damping coefficient.

Dampf1


This is the period or the frequency (depending on the value of the DampType item) for point 1. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampf2

This is the period or the frequency (depending on the value of the DampType item) for point 2. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampd1

This is the damping at point 1 (0 <= Dampd1 < 1).

This item applies only when DampType = 2 or 3.

Dampd2

This is the damping at point 2 (0 <= Dampd2 < 1).

This item applies only when DampType = 2 or 3.

## Remarks

This function retrieves the proportional modal damping data assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseResponseSpectrumDampProportional()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long
Dim Dampa As Double
Dim Dampb As Double
Dim Dampf1 As Double
Dim Dampf2 As Double
Dim Dampd1 As Double
Dim Dampd2 As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set proportional damping
ret = SapModel.LoadCases.ResponseSpectrum.SetDampProportional("LCASE1", 2, 0, 0, 0.1,
1, 0.05, 0.06)

'get proportional damping
ret = SapModel.LoadCases.ResponseSpectrum.GetDampType("LCASE1", DampType)
If DampType >= 1 or DampType <= 3 Then
ret = SapModel.LoadCases.ResponseSpectrum.GetDampProportional("LCASE1",
DampType, Dampa, Dampb, Dampf1, Dampf2, Dampd1, Dampd2)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampProportional

# GetDampType

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetDampType

## VB6 Procedure

Function GetDampType(ByVal Name As String, ByRef DampType As Long) As Long


## Parameters

Name

The name of an existing response spectrum load case.

DampType

This is 1, 2, 3, 4, 5 or 6, indicating the modal damping type for the load case.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
4 = Constant damping for all modes
5 = Interpolated damping by period
6 = Interpolated damping by frequency
```
## Remarks

This function retrieves the modal damping type for the specified load case.

The function returns zero if the type is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseResponseSpectrumDampType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'get damping type


ret = SapModel.LoadCases.ResponseSpectrum.GetDampType("LCASE1", DampType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampConstant

GetDampInterpolated

GetDampProportional

GetDampOverrides

# GetDiaphragmEccentricityOverride

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetDiaphragmEccentricityOverride

## VB6 Procedure

Function GetDiaphragmEccentricityOverride(ByVal Name As String, ByRef Num As Long,
ByRef Diaph() As String, ByRef Eccen() As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case.

Num

The number of diaphragm eccentricity overrides for the specified load case.

Diaph

This is an array that includes the names of the diaphragms that have eccentricity overrides.


Eccen

This is an array that includes the eccentricity applied to each diaphragm. [L]

## Remarks

This function retrieves the diaphragm eccentricity overrides for a response spectrum load case.

The function returns zero if the overrides are successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetResponseSpectrumDiaphragmEccentricityOverride()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Num As Long
Dim Diaph() As String
Dim Eccen() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")


'assign diaphragm eccentricity override
ret = SapModel.LoadCases.ResponseSpectrum.SetDiaphragmEccentricityOverride
("LCASE1", "Diaph1", 50)

'get diaphragm eccentricity override
ret = SapModel.LoadCases.ResponseSpectrum.GetDiaphragmEccentricityOverride
("LCASE1", Num, Diaph, Eccen)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDiaphragmEccentricityOverride

GetSpecialRigidDiaphragmList

# GetDirComb

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetDirComb

## VB6 Procedure

Function GetDirComb(ByVal Name As String, ByRef MyType As Long, ByRef SF As Double)
As Long

## Parameters

Name

The name of an existing response spectrum load case.

MyType

This is 1, 2, or 3, indicating the directional combination option.


### 1 = SRSS

### 2 = ABS

### 3 = CQC3

### SF

This item applies only when MyType = 2. It is the ABS scale factor.

## Remarks

This function retrieves the directional combination option assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseResponseSpectrumDirComb()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As Long
Dim SF As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'get directional combination option
ret = SapModel.LoadCases.ResponseSpectrum.GetDirComb("LCASE1", MyType, SF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Removed Modified SRSS (Chinese) directional combination option in version 14.00.

Added CQC3 directional combination option in version 14.20.

## See Also

SetDirComb

# GetEccentricity

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetEccentricity

## VB6 Procedure

Function GetEccentricity(ByVal Name As String, ByRef Eccen As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case.

Eccen

The eccentricity ratio that applies to all diaphragms.

## Remarks

This function retrieves the eccentricity ratio that applies to all diaphragms for the specified load
case.

The function returns zero if the ratio is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseResponseSpectrumEccentricity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim Eccen As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'get eccentricity ratio
ret = SapModel.LoadCases.ResponseSpectrum.GetEccentricity("LCASE1", Eccen)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetEccentricity

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetLoads

## VB6 Procedure


Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadName()
As String, ByRef Func() As String, ByRef SF() As Double, ByRef CSys() As String, ByRef Ang()
As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadName

This is an array that includes U1, U2, U3, R1, R2 or R3, indicating the direction of the load.

Func

This is an array that includes the name of the response spectrum function associated with each
load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseResponseSpectrumLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyCSys() As String
Dim MyAng() As Double
Dim NumberLoads As Long
Dim LoadName() As String
Dim Func() As String
Dim SF() As Double
Dim CSys() As String
Dim Ang() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add UBC97 RS function
ret = SapModel.Func.FuncRS.SetUBC97("RS-1", 0.36, 0.54, 0.04)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set load data
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadName(0) = "U1"
MyFunc(0) = "RS-1"
MySF(0) = 386
MyCSys(0) = "Global"
MyAng(0) = 10
MyLoadName(1) = "U2"
MyFunc(1) = "RS-1"
MySF(1) = 386
ret = SapModel.LoadCases.ResponseSpectrum.SetLoads("LCASE1", 2, MyLoadName,
MyFunc, MySF, MyCSys, MyAng)

'get load data
ret = SapModel.LoadCases.ResponseSpectrum.GetLoads("LCASE1", NumberLoads,
LoadName, Func, SF, CSys, Ang)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoads

# GetModalCase

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetModalCase

## VB6 Procedure

Function GetModalCase(ByVal Name As String, ByRef ModalCase As String) As Long

## Parameters

Name

The name of an existing response spectrum load case.

ModalCase

This is None or the name of an existing modal analysis case. It specifies the modal load case on
which any mode-type load assignments to the specified load case are based.

## Remarks

This function retrieves the modal case assigned to the specified load case.

The function returns zero if the modal case is successfully retrieved; otherwise it returns a nonzero
value.


## VBA Example

Sub GetCaseResponseSpectrumModalCase()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ModalCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'get modal case
ret = SapModel.LoadCases.ResponseSpectrum.GetModalCase("LCASE1", ModalCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetModalCase

# GetModalComb_1


## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.GetModalComb_1

## VB6 Procedure

Function GetModalComb_1(ByVal Name As String, ByRef MyType As Long, ByRef F1 As
Double, ByRef F2 As Double, ByRef PeriodicRigidCombType As Long, ByRef td As Double) As
Long

## Parameters

Name

The name of an existing response spectrum load case.

MyType

This is 1, 2, 3, 4, 5 or 6, indicating the modal combination option.

```
1 = CQC
```
```
2 = SRSS
```
```
3 = Absolute
```
```
4 = GMC
```
```
5 = NRC 10 percent
```
```
6 = Double sum
```
F1

The GMC f1 factor. This item does not apply when MyType = 3. [cyc/s]

F2

The GMC f2 factor. This item does not apply when MyType = 3. [cyc/s]

PeriodicRigidCombType

This is 1 or 2, indicating the periodic plus rigid modal combination option.

```
1 = SRSS
```
```
2 = Absolute
```
td

This item applies only when MyType = 6. It is the factor td. [s]


## Remarks

This function retrieves the modal combination option assigned to the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseResponseSpectrumModalComb_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As Long
Dim F1 As Double
Dim F2 As Double
Dim PeriodicRigidCombType As Long
Dim td As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'get modal combination option
ret = SapModel.LoadCases.ResponseSpectrum.GetModalComb_1("LCASE1", MyType,F1,
F2, PeriodicRigidCombType, td)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.


This function supersedes GetModalComb.

## See Also

SetModalComb_1

# SetCase

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks

This function initializes a response spectrum analysis case. If this function is called for an existing
load case, all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseResponseSpectrum()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetDampConstant

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetDampConstant

## VB6 Procedure

Function SetDampConstant(ByVal Name As String, ByVal Damp As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case.

Damp

The constant damping for all modes (0 <= Damp < 1).

## Remarks

This function sets constant modal damping for the specified load case.


The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseResponseSpectrumDampConstant()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ResponseSpectrum.SetDampConstant("LCASE1", 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampConstant


# SetDampInterpolated

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetDampInterpolated

## VB6 Procedure

Function SetDampInterpolated(ByVal Name As String, ByVal DampType As Long, ByVal
NumberItems As Long, ByRef Time() As Double, ByRef Damp() As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case.

DampType

This is either 5 or 6, indicating the interpolated modal damping type.

```
5 = Interpolated damping by period
6 = Interpolated damping by frequency
```
NumberItems

The number of Time and Damp pairs.

Time

This is an array that includes the period or the frequency depending on the value of the DampType
item. [s] for DampType = 5 and [cyc/s] for DampType = 6

Damp

This is an array that includes the damping for the specified period of frequency (0 <= Damp < 1).

## Remarks

This function sets interpolated modal damping data for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseResponseSpectrumDampInterpolated()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim MyTime() As Double
Dim MyDamp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set interpolated damping
ReDim MyTime(2)
ReDim MyDamp(2)
MyTime(0) = 0.001
MyDamp(0) = 0.1
MyTime(1) = 0.3
MyDamp(1) = 0.03
MyTime(2) = 1
MyDamp(2) = 0.05
ret = SapModel.LoadCases.ResponseSpectrum.SetDampInterpolated("LCASE1", 5, 3,
MyTime, MyDamp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampInterpolated


# SetDampOverrides

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetDampOverrides

## VB6 Procedure

Function SetDampOverrides(ByVal Name As String, ByVal NumberItems As Long, ByRef Mode
() As Long, ByRef Damp() As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case.

NumberItems

The number of Mode and Damp pairs.

Mode

This is an array that includes a mode number.

Damp

This is an array that includes the damping for the specified mode (0 <= Damp < 1).

## Remarks

This function sets the modal damping overrides for the specified load case.

The function returns zero if the overrides are successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseResponseSpectrumDampOverrides()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyMode() As Long
Dim MyDamp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.ResponseSpectrum.SetDampConstant("LCASE1", 0.04)

'set modal damping overrides
ReDim MyMode(1)
ReDim MyDamp(1)
MyMode(0) = 1
MyDamp(0) = 0.02
MyMode(1) = 2
MyDamp(1) = 0.03
ret = SapModel.LoadCases.ResponseSpectrum.SetDampOverrides("LCASE1", 2, MyMode,
MyDamp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampOverrides

# SetDampProportional

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetDampProportional


## VB6 Procedure

Function SetDampProportional(ByVal Name As String, ByVal DampType As Long, ByVal
Dampa As Double, ByVal Dampb As Double, ByVal Dampf1 As Double, ByVal Dampf2 As
Double, ByVal Dampd1 As Double, ByVal Dampd2 As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case.

DampType

This is 1, 2 or 3, indicating the proportional modal damping type.

```
1 = Mass and stiffness proportional damping by direct specification
2 = Mass and stiffness proportional damping by period
3 = Mass and stiffness proportional damping by frequency
```
Dampa

The mass proportional damping coefficient. This item applies only when DampType = 1.

Dampb

The stiffness proportional damping coefficient. This item applies only when DampType = 1.

Dampf1

This is the period or the frequency (depending on the value of the DampType item) for point 1. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampf2

This is the period or the frequency (depending on the value of the DampType item) for point 2. [s]
for DampType = 2 and [cyc/s] for DampType = 3

This item applies only when DampType = 2 or 3.

Dampd1

This is the damping at point 1 (0 <= Dampd1 < 1).

This item applies only when DampType = 2 or 3.

Dampd2

This is the damping at point 2 (0 <= Dampd2 < 1).

This item applies only when DampType = 2 or 3.


## Remarks

This function sets proportional modal damping data for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseResponseSpectrumDampProportional()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set proportional damping
ret = SapModel.LoadCases.ResponseSpectrum.SetDampProportional("LCASE1", 2, 0, 0, 0.1,
1, 0.05, 0.06)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetDampProportional

# SetDiaphragmEccentricityOverride

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetDiaphragmEccentricityOverride

## VB6 Procedure

Function SetDiaphragmEccentricityOverride(ByVal Name As String, ByVal Diaph As String,
ByVal Eccen As Double, Optional ByVal Delete As Boolean = False) As Long

## Parameters

Name

The name of an existing response spectrum load case.

Diaph

The name of an existing special rigid diaphragm constraint, that is, a diaphragm constraint with
the following features:

1. The constraint type is CONSTRAINT_DIAPHRAGM = 2.
2. The constraint coordinate system is Global.
3. The constraint axis is Z.

Eccen

The eccentricity applied to the specified diaphragm. [L]

Delete

If this item is True, the eccentricity override for the specified diaphragm is deleted.

## Remarks

This function assigns diaphragm eccentricity overrides for response spectrum load cases.

The function returns zero if the overrides are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignResponseSpectrumDiaphragmEccentricityOverride()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'assign diaphragm eccentricity override
ret = SapModel.LoadCases.ResponseSpectrum.SetDiaphragmEccentricityOverride
("LCASE1", "Diaph1", 50)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


Modified optional argument Delete to be ByVal in version 12.0.1.

## See Also

GetDiaphragmEccentricityOverride

GetSpecialRigidDiaphragmList

# SetDirComb

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetDirComb

## VB6 Procedure

Function SetDirComb(ByVal Name As String, ByVal MyType As Long, ByVal SF As Double)
As Long

## Parameters

Name

The name of an existing response spectrum load case.

MyType

This is 1, 2, or 3, indicating the directional combination option.

```
1 = SRSS
2 = ABS
3 = CQC3
```
SF

This item applies only when MyType = 2. It is the ABS scale factor.

## Remarks

This function sets the directional combination option for the specified load case.

The function returns zero if the option is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseResponseSpectrumDirComb()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set directional combination option
ret = SapModel.LoadCases.ResponseSpectrum.SetDirComb("LCASE1", 2, 1.2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Removed Modified SRSS (Chinese) directional combination option in version 14.00.

Added CQC3 directional combination option in version 14.20.

## See Also

GetDirComb

# SetEccentricity

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetEccentricity


## VB6 Procedure

Function SetEccentricity(ByVal Name As String, ByVal Eccen As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case.

Eccen

The eccentricity ratio that applies to all diaphragms.

## Remarks

This function sets the eccentricity ratio that applies to all diaphragms for the specified load case.

The function returns zero if the ratio is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseResponseSpectrumEccentricity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set eccentricity ratio
ret = SapModel.LoadCases.ResponseSpectrum.SetEccentricity("LCASE1", 0.05)

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetEccentricity

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadName()
As String, ByRef Func() As String, ByRef SF() As Double, ByRef CSys() As String, ByRef Ang()
As Double) As Long

## Parameters

Name

The name of an existing response spectrum load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadName

This is an array that includes U1, U2, U3, R1, R2 or R3, indicating the direction of the load.

Func

This is an array that includes the name of the response spectrum function associated with each
load.

SF


This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseResponseSpectrumLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyCSys() As String
Dim MyAng() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add UBC97 RS function
ret = SapModel.Func.FuncRS.SetUBC97("RS-1", 0.36, 0.54, 0.04)

'add response spectrum load case


ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set load data
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadName(0) = "U1"
MyFunc(0) = "RS-1"
MySF(0) = 386
MyCSys(0) = "Global"
MyAng(0) = 10
MyLoadName(1) = "U2"
MyFunc(1) = "RS-1"
MySF(1) = 386
ret = SapModel.LoadCases.ResponseSpectrum.SetLoads("LCASE1", 2, MyLoadName,
MyFunc, MySF, MyCSys, MyAng)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# SetModalCase

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetModalCase

## VB6 Procedure

Function SetModalCase(ByVal Name As String, ByVal ModalCase As String) As Long

## Parameters


Name

The name of an existing response spectrum load case.

ModalCase

This is the name of an existing modal load case. It specifies the modal load case on which any
mode-type load assignments to the specified load case are based.

## Remarks

This function sets the modal case for the specified analysis case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

If the specified modal case is not actually a modal case, the program automatically replaces it with
the first modal case it can find. If no modal load cases exist, an error is returned.

## VBA Example

Sub SetCaseResponseSpectrumModalCase()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set modal case
ret = SapModel.LoadCases.ResponseSpectrum.SetModalCase("LCASE1", "MODAL")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetModalCase

# SetModalComb_1

## Syntax

SapObject.SapModel.LoadCases.ResponseSpectrum.SetModalComb_1

## VB6 Procedure

Function SetModalComb_1(ByVal Name As String, ByVal MyType As Long, Optional ByVal F1
As Double = 1, Optional ByVal F2 As Double = 0, Optional ByVal PeriodicRigidCombType As
Long = 1, Optional ByVal td As Double = 60) As Long

## Parameters

Name

The name of an existing response spectrum load case.

MyType

This is 1, 2, 3, 4, 5 or 6, indicating the modal combination option.

```
1 = CQC
```
```
2 = SRSS
```
```
3 = Absolute
```
```
4 = GMC
```
```
5 = NRC 10 percent
```
```
6 = Double sum
```
F1


The GMC f1 factor. This item does not apply when MyType = 3. [cyc/s]

F2

The GMC f2 factor. This item does not apply when MyType = 3. [cyc/s]

PeriodicRigidCombType

This is 1 or 2, indicating the periodic plus rigid modal combination option.

```
1 = SRSS
```
```
2 = Absolute
```
td

This item applies only when MyType = 6. It is the factor td. [s]

## Remarks

This function sets the modal combination option for the specified load case.

The function returns zero if the option is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseResponseSpectrumModalComb_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.ResponseSpectrum.SetCase("LCASE1")

'set modal combination option
ret = SapModel.LoadCases.ResponseSpectrum.SetModalComb_1("LCASE1", 4, 0.5, 1.2, 1)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

This function supersedes SetModalComb.

## See Also

GetModalComb_1

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.StaticLinear.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing static linear load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetCaseStaticLinearInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get initial condition
ret = SapModel.LoadCases.StaticLinear.GetInitialCase("DEAD", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.StaticLinear.GetLoads


## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef SF() As Double) As Long

## Parameters

Name

The name of an existing static linear load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for
Accel UX UY and UZ; otherwise unitless

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseStaticLinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MySF() As Double
Dim NumberLoads As Long
Dim LoadType() As String


Dim LoadName() As String
Dim SF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static linear load case
ret = SapModel.LoadCases.StaticLinear.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MySF(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MySF(0) = 0.7
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MySF(1) = 1.2
ret = SapModel.LoadCases.StaticLinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MySF)

'get load data
ret = SapModel.LoadCases.StaticLinear.GetLoads("LCASE1", NumberLoads, LoadType,
LoadName, SF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

SetLoads

# SetCase

## Syntax

SapObject.SapModel.LoadCases.StaticLinear.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks

This function initializes a static linear load case. If this function is called for an existing load case,
all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticLinear()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static linear load case
ret = SapModel.LoadCases.StaticLinear.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.StaticLinear.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing static linear load case.

InitialCase

This is blank, None or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else then zero initial
conditions are assumed.


## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticLinearInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static linear load case
ret = SapModel.LoadCases.StaticLinear.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.StaticLinear.SetInitialCase("LCASE1", "None")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetInitialCase

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.StaticLinear.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef SF() As Double) As Long

## Parameters

Name

The name of an existing static linear load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for
Accel UX UY and UZ; otherwise unitless

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.


## VBA Example

Sub SetCaseStaticLinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MySF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static linear load case
ret = SapModel.LoadCases.StaticLinear.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MySF(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MySF(0) = 0.7
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MySF(1) = 1.2
ret = SapModel.LoadCases.StaticLinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MySF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.StaticLinearMultistep.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing static linear multistep analysis case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise, it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticLinearMultistepInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static linear multistep load case
ret = SapModel.LoadCases.StaticLinearMultistep.SetCase("LCASE1")

'get initial condition
ret = SapModel.LoadCases.StaticLinearMultistep.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoads_1

## Syntax

SapObject.SapModel.LoadCases.StaticLinearMultistep.GetLoads_1

## VB6 Procedure

Function GetLoads_1(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef SF() As Double, ByRef StepRange() as Integer,


ByRef FirstLoadStep() As Integer, ByRef LastLoadStep() As Integer, ByRef StartCaseStep() As
Integer, ByRef ExtrapolateOption() As Integer) As Long

## Parameters

Name

The name of an existing static linear multistep analysis case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for
Accel UX UY and UZ; otherwise unitless

StepRange

This is an array that identifies the step range type to consider for each load assigned to the load
case. The allowed values are:

```
0 = All
1 = User
```
FirstLoadStep

This is an array that specifies the first load step to consider for each load assigned to the load case.
This value is only applicable when StepRange = User.

LastLoadStep

This is an array that specifies the last load step to consider for each load assigned to the load case.
This value is only applicable when StepRange = User.

StartCaseStep

This is an array that specifies the load case step at which to start applying each load assigned to
the load case.


ExtrapolateOption

This is an array that identifies the extrapolation option for each load assigned to the load case. The
allowed values are:

```
0 = None
1 = Last Step
2 = Repeat Range
```
## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise, it returns a nonzero
value.

## VBA Example

Sub GetCaseStaticLinearMultistepLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MySF() As Double
Dim MyStepRange() As Long

Dim MyFirstLoadStep() As Long

Dim MyLastLoadStep() As Long

Dim MyStartCaseStep() As Long

Dim MyExtrapolateOption() As Long

Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim SF() As Double

Dim StepRange() As Long

Dim FirstLoadStep() As Long

Dim LastLoadStep() As Long

Dim StartCaseStep() As Long

Dim ExtrapolateOption() As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static linear multistep load case
ret = SapModel.LoadCases.StaticLinearMultistep.SetCase_1("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MySF(1)

ReDim MyStepRange(1)

ReDim MyFirstLoadStep(1)

ReDim MyLastLoadStep(1)

ReDim MyStartCaseStep(1)

ReDim MyExtrapolateOption(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MySF(0) = 0.7

MyStepRange(0) = 0

MyFirstLoadStep(0) = 1

MyLastLoadStep(0) = 1
MyStartCaseStep(0) = 1

MyExtrapolateOption(0) = 1

MyLoadType(1) = "Accel0"
MyLoadName(1) = "UZ"
MySF(1) = 1.2
ret = SapModel.LoadCases.StaticLinearMultistep.SetLoads_1("LCASE1", 2, MyLoadType,
MyLoadName, MySF, MyStepRange, MyFirstLoadStep, MyLastLoadStep, MyStartCaseStep,
MyExtrapolateOption)

'get load data
ret = SapModel.LoadCases.StaticLinearMultistep.GetLoads_1("LCASE1", NumberLoads,
LoadType, LoadName, SF, StepRange, FirstLoadStep, LastLoadStep, StartCaseStep,
ExtrapolateOption)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

This function supersedes GetLoads.

## See Also

SetLoads_1

# SetCase

## Syntax

SapObject.SapModel.LoadCases.StaticLinearMultistep.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks

This function initializes a static linear multistep analysis case. If this function is called for an
existing load case, all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise, it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticLinearMultistep()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static linear multistep load case
ret = SapModel.LoadCases.StaticLinearMultistep.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.StaticLinearMultistep.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters


Name

The name of an existing static linear multistep analysis case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticLinearMultistepInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static linear load case
ret = SapModel.LoadCases.StaticLinear.SetCase("SN1" )

'add static linear multistep load case
ret = SapModel.LoadCases.StaticLinearMultistep.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.StaticLinearMultistep.SetInitialCase("LCASE1", "SN1")


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase

# SetLoads_1

## Syntax

SapObject.SapModel.LoadCases.StaticLinearMultistep.SetLoads_1

## VB6 Procedure

Function SetLoads_1(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef SF() As Double, ByRef StepRange() as Integer,
ByRef FirstLoadStep() As Integer, ByRef LastLoadStep() As Integer, ByRef StartCaseStep() As
Integer, ByRef ExtrapolateOption() As Integer) As Long

## Parameters

Name

The name of an existing static linear multistep analysis case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.


If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for
Accel UX UY and UZ; otherwise unitless

StepRange

This is an array that identifies the step range type to consider for each load assigned to the load
case. The allowed values are:

```
0 = All
1 = User
```
FirstLoadStep

This is an array that specifies the first load step to consider for each load assigned to the load case.
This value is only applicable when StepRange = User.

LastLoadStep

This is an array that specifies the last load step to consider for each load assigned to the load case.
This value is only applicable when StepRange = User.

StartCaseStep

This is an array that specifies the load case step at which to start applying each load assigned to
the load case.

ExtrapolateOption

This is an array that identifies the extrapolation option for each load assigned to the load case. The
allowed values are:

```
0 = None
1 = Last Step
2 = Repeat Range
```
## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseStaticLinearMultistepLoads()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MySF() As Double

Dim MyStepRange() As Long

Dim MyFirstLoadStep() As Long

Dim MyLastLoadStep() As Long

Dim MyStartCaseStep() As Long

Dim MyExtrapolateOption() As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static linear multistep load case
ret = SapModel.LoadCases.StaticLinearMultistep.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MySF(1)

ReDim MyStepRange(1)

ReDim MyFirstLoadStep(1)

ReDim MyLastLoadStep(1)

ReDim MyStartCaseStep(1)

ReDim MyExtrapolateOption(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MySF(0) = 0.7


MyStepRange(0) = 0

MyFirstLoadStep(0) = 1

MyLastLoadStep(0) = 1
MyStartCaseStep(0) = 1

MyExtrapolateOption(0) = 1
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MySF(1) = 1.2
ret = SapModel.LoadCases.StaticLinearMultistep.SetLoads_1("LCASE1", 2, MyLoadType,
MyLoadName, MySF, MyStepRange, MyFirstLoadStep, MyLastLoadStep, MyStartCaseStep,
MyExtrapolateOption)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

This function supersedes Set Loads.

## See Also

GetLoads_1

# GetGeometricNonlinearity

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.GetGeometricNonlinearity

## VB6 Procedure

Function GetGeometricNonlinearity(ByVal Name As String, ByRef NLGeomType As Long) As
Long

## Parameters

Name

The name of an existing static nonlinear load case.

NLGeomType


This is 0, 1 or 2, indicating the geometric nonlinearity option selected for the load case.

```
0 = None
1 = P-delta
2 = P-delta plus large displacements
```
## Remarks

This function retrieves the geometric nonlinearity option for the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseStaticNonlinearGeometricNonlinearity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NLGeomType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'get geometric nonlinearity option
ret = SapModel.LoadCases.StaticNonlinear.GetGeometricNonlinearity("LCASE1",
NLGeomType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetGeometricNonlinearity

# GetHingeUnloading

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.GetHingeUnloading

## VB6 Procedure

Function GetHingeUnloading(ByVal Name As String, ByRef UnloadType As Long) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

UnloadType

This is 1, 2 or 3, indicating the hinge unloading option selected for the load case.

```
1 = Unload entire structure
2 = Apply local redistribution
3 = Restart using secant stiffness
```
## Remarks

This function retrieves the hinge unloading option for the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseStaticNonlinearHingeUnloading()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim UnloadType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'get hinge unloading option
ret = SapModel.LoadCases.StaticNonlinear.GetHingeUnloading("LCASE1", UnloadType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetHingeUnloading

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.GetInitialCase

## VB6 Procedure


Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts from the state at the end
of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the state at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")


'get initial condition
ret = SapModel.LoadCases.StaticNonlinear.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoadApplication

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.GetLoadApplication

## VB6 Procedure

Function GetLoadApplication(ByVal Name As String, ByRef LoadControl As Long, ByRef
DispType As Long, ByRef Displ As Double, ByRef Monitor As Long, ByRef DOF As Long,
ByRef PointName As String, ByRef GDispl As String) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

LoadControl

This is either 1 or 2, indicating the load application control method.

```
1 = Full load
2 = Displacement control
```
DispType

This is either 1 or 2, indicating the control displacement type.


```
1 = Conjugate displacement
2 = Monitored displacement
```
This item applies only when displacement control is used, that is, LoadControl = 2.

Displ

This item applies only when displacement control is used, that is, LoadControl = 2. The structure
is loaded to a monitored displacement of this magnitude. [L] when DOF = 1, 2 or 3 and [rad]
when DOF = 4, 5 or 6

Monitor

This is either 1 or 2, indicating the monitored displacement.

```
1 = Displacement at a specified point object
2 = Generalized displacement
```
DOF

This is 1, 2, 3, 4, 5 or 6, indicating the degree of freedom for which the displacement at a point
object is monitored.

```
1 = U1
2 = U2
3 = U3
4 = R1
5 = R2
6 = R3
```
This item applies only when Monitor = 1.

PointName

The name of the point object at which the displacement is monitored. This item applies only when
Monitor = 1.

GDispl

The name of the generalized displacement for which the displacement is monitored. This item
applies only when Monitor = 2.

## Remarks

This function retrieves the load application control parameters for the specified load case.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example


Sub GetCaseStaticNonlinearLoadApplication()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SF() As Double
Dim LoadControl As Long
Dim DispType As Long
Dim Displ As Double
Dim Monitor As Long
Dim DOF As Long
Dim PointName As String
Dim GDispl As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add generalized displacement
ret = SapModel.GDispl.Add("GD1", 1)

'add point to generalized displacement
ReDim SF(5)
SF(0) = 0.5
ret = SapModel.GDispl.SetPoint("GD1", "2", SF)
ret = SapModel.GDispl.SetPoint("GD1", "3", SF)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set load application parameters
ret = SapModel.LoadCases.StaticNonlinear.SetLoadApplication("LCASE1", 2, 1, 12, 2, 0, "",
"GD1")

'get load application parameters
ret = SapModel.LoadCases.StaticNonlinear.GetLoadApplication("LCASE1", LoadControl,
DispType, Displ, Monitor, DOF, PointName, GDispl)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoadApplication

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.GetLoads

## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef SF() As Double) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

SF


This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for
Accel UX UY and UZ; otherwise unitless

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MySF() As Double
Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim SF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MySF(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MySF(0) = 0.7
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"


MySF(1) = 1.2
ret = SapModel.LoadCases.StaticNonlinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MySF)

'get load data
ret = SapModel.LoadCases.StaticNonlinear.GetLoads("LCASE1", NumberLoads, LoadType,
LoadName, SF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoads

# GetMassSource

## Syntax

SapObject.SapModel.LoadCases.Static Nonlinear.GetMassSource

## VB6 Procedure

Function GetMassSource(ByVal Name As String, ByRef Source As String) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

Source

This is the name of an existing mass source or a blank string. Blank indicates to use the mass
source from the previous load case or the default mass source if the load case starts from zero
initial conditions.


## Remarks

This function sets the mass source to be used for the specified load case.

The function returns zero if the mass source is data is successfully set; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearMassSource()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim Source as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'get a mass source from the static nonlinear load case

ret = SapModel.LoadCases.StaticNonlinear.GetMassSource("LCASE1", "Source")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.20.


## See Also

SetMassSource

# GetModalCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.GetModalCase

## VB6 Procedure

Function GetModalCase(ByVal Name As String, ByRef ModalCase As String) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

ModalCase

This is either None or the name of an existing modal analysis case. It specifies the modal load case
on which any mode-type load assignments to the specified load case are based.

## Remarks

This function retrieves the modal case assigned to the specified load case.

The function returns zero if the modal case is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseStaticNonlinearModalCase()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ModalCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'get modal case
ret = SapModel.LoadCases.StaticNonlinear.GetModalCase("LCASE1", ModalCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetModalCase

# GetResultsSaved

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.GetResultsSaved

## VB6 Procedure

Function GetResultsSaved(ByVal Name As String, ByRef SaveMultipleSteps As Boolean, ByRef
MinSavedStates As Long, ByRef MaxSavedStates As Long, ByRef PositiveOnly As Boolean) As
Long

## Parameters

Name

The name of an existing static nonlinear load case.


SaveMultipleSteps

This item is True if multiple states are saved for the nonlinear analysis. It is False only if the final
state is saved.

MinSavedStates

This item applies only when SaveMultipleSteps = True. It is the minimum number of saved steps.

MaxSavedStates

This item applies only when SaveMultipleSteps = True. It is the maximum number of saved steps.

PositiveOnly

If this item is True, only positive displacement increments are saved. If it is False, all
displacement increments are saved.

## Remarks

This function retrieves the results saved parameters for the specified load case.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearResultsSaved()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SaveMultipleSteps As Boolean
Dim MinSavedStates As Long
Dim MaxSavedStates As Long
Dim PositiveOnly As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set results saved parameters
ret = SapModel.LoadCases.StaticNonlinear.SetResultsSaved("LCASE1", True, 12, 84, False)

'get results saved parameters
ret = SapModel.LoadCases.StaticNonlinear.GetResultsSaved("LCASE1", SaveMultipleSteps,
MinSavedStates, MaxSavedStates, PositiveOnly)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetResultsSaved

# GetSolControlParameters

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.GetSolControlParameters

## VB6 Procedure

Function GetSolControlParameters(ByVal Name As String, ByRef MaxTotalSteps As Long,
ByRef MaxFailedSubSteps As Long, ByRef MaxIterCS As Long, ByRef MaxIterNR As Long,
ByRef TolConvD As Double, ByRef UseEventStepping As Boolean, ByRef TolEventD As
Double, ByRef MaxLineSearchPerIter As Long, ByRef TolLineSearch As Double, ByRef
LineSearchStepFact As Double) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

MaxTotalSteps


The maximum total steps per stage.

MaxFailedSubSteps

The maximum null (zero) steps per stage.

MaxIterCS

The maximum constant-stiffness iterations per step.

MaxIterNR

The maximum Newton_Raphson iterations per step.

TolConvD

The relative iteration convergence tolerance.

UseEventStepping

This item is True if event-to-event stepping is used.

TolEventD

The relative event lumping tolerance.

MaxLineSearchPerIter

The maximum number of line searches per iteration.

TolLineSearch

The relative line-search acceptance tolerance.

LineSearchStepFact

The line-search step factor.

## Remarks

This function retrieves the solution control parameters for the specified load case.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearSolutionControlParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MaxTotalSteps As Long
Dim MaxFailedSubSteps As Long


Dim MaxIterCS As Long
Dim MaxIterNR As Long
Dim TolConvD As Double
Dim UseEventStepping As Boolean
Dim TolEventD As Double
Dim MaxLineSearchPerIter As Long
Dim TolLineSearch As Double
Dim LineSearchStepFact As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'get solution control parameters
ret = SapModel.LoadCases.StaticNonlinear.GetSolControlParameters("LCASE1",
MaxTotalSteps, MaxFailedSubSteps, MaxIterCS, MaxIterNR, TolConvD, UseEventStepping,
TolEventD, MaxLineSearchPerIter, TolLineSearch, LineSearchStepFact)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetSolControlParameters


# GetTargetForceParameters

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.GetTargetForceParameters

## VB6 Procedure

Function GetTargetForceParameters(ByVal Name As String, ByRef TolConvF As Double, ByRef
MaxIter As Long, ByRef AccelFact As Double, ByRef NoStop As Boolean) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

TolConvF

The relative convergence tolerance for target force iteration.

MaxIter

The maximum iterations per stage for target force iteration.

AccelFact

The acceleration factor.

NoStop

If this item is True, the analysis is continued when there is no convergence in the target force
iteration.

## Remarks

This function retrieves the target force iteration parameters for the specified load case.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearTargetForceParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim TolConvF As Double
Dim MaxIter As Long


Dim AccelFact As Double
Dim NoStop As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'get target force iteration parameters
ret = SapModel.LoadCases.StaticNonlinear.GetTargetForceParameters("LCASE1",
TolConvF, MaxIter, AccelFact, NoStop)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetTargetForceParameters

# SetCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetCase


## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks

This function initializes a static nonlinear analysis case. If this function is called for an existing
load case, all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinear()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetGeometricNonlinearity

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetGeometricNonlinearity

## VB6 Procedure

Function SetGeometricNonlinearity(ByVal Name As String, ByVal NLGeomType As Long) As
Long

## Parameters

Name

The name of an existing static nonlinear load case.

NLGeomType

This is 0, 1 or 2, indicating the geometric nonlinearity option selected for the load case.

```
0 = None
1 = P-delta
2 = P-delta plus large displacements
```
## Remarks

This function sets the geometric nonlinearity option for the specified load case.

The function returns zero if the option is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseStaticNonlinearGeometricNonlinearity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set geometric nonlinearity option
ret = SapModel.LoadCases.StaticNonlinear.SetGeometricNonlinearity("LCASE1", 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetGeometricNonlinearity

# SetHingeUnloading

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetHingeUnloading

## VB6 Procedure

Function SetHingeUnloading(ByVal Name As String, ByVal UnloadType As Long) As Long


## Parameters

Name

The name of an existing static nonlinear load case.

UnloadType

This is 1, 2 or 3, indicating the hinge unloading option selected for the load case.

```
1 = Unload entire structure
2 = Apply local redistribution
3 = Restart using secant stiffness
```
## Remarks

This function sets the hinge unloading option for the specified load case.

The function returns zero if the option is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseStaticNonlinearHingeUnloading()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set hinge unloading option
ret = SapModel.LoadCases.StaticNonlinear.SetHingeUnloading("LCASE1", 2)

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetHingeUnloading

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts from the state at the end
of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the state at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.


## VBA Example

Sub SetCaseStaticNonlinearInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add static nonlinear multistep load case
ret = SapModel.LoadCases.StaticNonlinearMultistep.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.StaticNonlinearMultistep.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase


# SetLoadApplication

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetLoadApplication

## VB6 Procedure

Function SetLoadApplication(ByVal Name As String, ByVal LoadControl As Long, ByVal
DispType As Long, ByVal Displ As Double, ByVal Monitor As Long, ByVal DOF As Long,
ByVal PointName As String, ByVal GDispl As String) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

LoadControl

This is either 1 or 2, indicating the load application control method.

```
1 = Full load
2 = Displacement control
```
DispType

This is either 1 or 2 indicating the control displacement type.

```
1 = Conjugate displacement
2 = Monitored displacement
```
This item applies only when displacement control is used, that is, LoadControl = 2.

Displ

This item applies only when displacement control is used, that is, LoadControl = 2. The structure
is loaded to a monitored displacement of this magnitude. [L] when DOF = 1, 2 or 3 and [rad]
when DOF = 4, 5 or 6

Monitor

This is either 1 or 2, indicating the monitored displacement.

```
1 = Displacement at a specified point object
2 = Generalized displacement
```
DOF

This is 1, 2, 3, 4, 5 or 6, indicating the degree of freedom for which the displacement at a point
object is monitored.


### 1 = U1

### 2 = U2

### 3 = U3

### 4 = R1

### 5 = R2

### 6 = R3

This item applies only when Monitor = 1.

PointName

The name of the point object at which the displacement is monitored. This item applies only when
Monitor = 1.

GDispl

The name of the generalized displacement for which the displacement is monitored. This item
applies only when Monitor = 2.

## Remarks

This function sets the load application control parameters for the specified load case.

The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearLoadApplication()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add generalized displacement


ret = SapModel.GDispl.Add("GD1", 1)

'add point to generalized displacement
ReDim SF(5)
SF(0) = 0.5
ret = SapModel.GDispl.SetPoint("GD1", "2", SF)
ret = SapModel.GDispl.SetPoint("GD1", "3", SF)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set load application parameters
ret = SapModel.LoadCases.StaticNonlinear.SetLoadApplication("LCASE1", 2, 1, 12, 2, 0, "",
"GD1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoadApplication

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef SF() As Double) As Long

## Parameters

Name

The name of an existing static nonlinear load case.


NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ indicating the direction of
the load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for
Accel UX UY and UZ; otherwise unitless

## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseStaticNonlinearLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MySF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MySF(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MySF(0) = 0.7
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MySF(1) = 1.2
ret = SapModel.LoadCases.StaticNonlinear.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MySF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# SetMassSource

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetMassSource

## VB6 Procedure

Function SetMassSource(ByVal Name As String, ByVal Source As String) As Long

## Parameters

Name


The name of an existing static nonlinear load case.

Source

This is the name of an existing mass source or a blank string. Blank indicates to use the mass
source from the previous load case or the default mass source if the load case starts from zero
initial conditions.

## Remarks

This function sets the mass source to be used for the specified load case.

The function returns zero if the mass source is data is successfully set; otherwise it returns a
nonzero value.

## VBA Example

Sub SetCaseStaticNonlinearMassSource()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'add a new mass source and make it the default mass source

LoadPat(0) = "DEAD"

SF(0) = 1.25

ret = SapModel.SourceMass.SetMassSource("MyMassSource", True, True, True, True, 1,
LoadPat, SF)


'assign a mass source to the static nonlinear load case

ret = SapModel.LoadCases.StaticNonlinear.SetMassSource("LCASE1", "MyMassSource")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.20.

## See Also

GetMassSource

# SetModalCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetModalCase

## VB6 Procedure

Function SetModalCase(ByVal Name As String, ByVal ModalCase As String) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

ModalCase

This is the name of an existing modal load case. It specifies the modal load case on which any
mode-type load assignments to the specified load case are based.

## Remarks

This function sets the modal case for the specified analysis case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.


If the specified modal case is not actually a modal case, the program automatically replaces it with
the first modal case it can find. If no modal load cases exist, an error is returned.

## VBA Example

Sub SetCaseStaticNonlinearModalCase()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set modal case
ret = SapModel.LoadCases.StaticNonlinear.SetModalCase("LCASE1", "MODAL")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetModalCase


# SetResultsSaved

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetResultsSaved

## VB6 Procedure

Function SetResultsSaved(ByVal Name As String, ByVal SaveMultipleSteps As Boolean,
Optional ByVal MinSavedStates As Long = 10, Optional ByVal MaxSavedStates As Long = 100,
Optional ByVal PositiveOnly As Boolean = True) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

SaveMultipleSteps

This item is True if multiple states are saved for the nonlinear analysis. It is False only if the final
state is saved.

MinSavedStates

This item only applies when SaveMultipleSteps = True. It is the minimum number of saved steps.

MaxSavedStates

This item only applies when SaveMultipleSteps = True. It is the maximum number of saved steps.

PositiveOnly

If this item is True, only positive displacement increments are saved. If it is False, all
displacement increments are saved.

## Remarks

This function sets the results saved parameters for the specified load case.

The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearResultsSaved()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set results saved parameters
ret = SapModel.LoadCases.StaticNonlinear.SetResultsSaved("LCASE1", True, 12, 84, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetResultsSaved

# SetSolControlParameters

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetSolControlParameters

## VB6 Procedure

Function SetSolControlParameters(ByVal Name As String, ByVal MaxTotalSteps As Long,
ByVal MaxFailedSubSteps As Long, ByVal MaxIterCS As Long, ByVal MaxIterNR As Long,


ByVal TolConvD As Double, ByVal UseEventStepping As Boolean, ByVal TolEventD As
Double, ByVal MaxLineSearchPerIter As Long, ByVal TolLineSearch As Double, ByVal
LineSearchStepFact As Double) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

MaxTotalSteps

The maximum total steps per stage.

MaxFailedSubSteps

The maximum null (zero) steps per stage.

MaxIterCS

The maximum constant-stiffness iterations per step.

MaxIterNR

The maximum Newton_Raphson iterations per step.

TolConvD

The relative iteration convergence tolerance.

UseEventStepping

This item is True if event-to-event stepping is used.

TolEventD

The relative event lumping tolerance.

MaxLineSearchPerIter

The maximum number of line searches per iteration.

TolLineSearch

The relative line-search acceptance tolerance.

LineSearchStepFact

The line-search step factor.

## Remarks

This function sets the solution control parameters for the specified load case.


The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearSolutionControlParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set solution control parameters
ret = SapModel.LoadCases.StaticNonlinear.SetSolControlParameters("LCASE1", 240, 40,
15, 50, 0.00005, False, 0.02, 10, 0.2, 1.7)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetSolControlParameters


# SetTargetForceParameters

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinear.SetTargetForceParameters

## VB6 Procedure

Function SetTargetForceParameters(ByVal Name As String, ByVal TolConvF As Double, ByVal
MaxIter As Long, ByVal AccelFact As Double, ByVal NoStop As Boolean) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

TolConvF

The relative convergence tolerance for target force iteration.

MaxIter

The maximum iterations per stage for target force iteration.

AccelFact

The acceleration factor.

NoStop

If this item is True, the analysis is continued when there is no convergence in the target force
iteration.

## Remarks

This function sets the target force iteration parameters for the specified load case.

The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearTargetForceParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")

'set target force iteration parameters
ret = SapModel.LoadCases.StaticNonlinear.SetTargetForceParameters("LCASE1", 0.008, 6,
5, True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetTargetForceParameters

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearMultistep.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long


## Parameters

Name

The name of an existing static nonlinear multistep load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the state at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearMultistepInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinearMultistep.SetCase("LCASE1")

'get initial condition


ret = SapModel.LoadCases.StaticNonlinearMultistep.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

## See Also

SetInitialCase

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearMultistep.GetLoads

## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef SF() As Double, ByRef StepRange() as Integer,
ByRef FirstLoadStep() As Integer, ByRef LastLoadStep() As Integer, ByRef StartCaseStep() As
Integer, ByRef ExtrapolateOption() As Integer ) As Long

## Parameters

Name

The name of an existing static nonlinear multistep load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.


If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for
Accel UX UY and UZ; otherwise unitless

StepRange

This is an array that identifies the step range type to consider for each load assigned to the load
case. The allowed values are:

```
0 = All
1 = User
```
FirstLoadStep

This is an array that specifies the first load step to consider for each load assigned to the load case.
This value is only applicable when StepRange = User.

LastLoadStep

This is an array that specifies the last load step to consider for each load assigned to the load case.
This value is only applicable when StepRange = User.

StartCaseStep

This is an array that specifies the load case step at which to start applying each load assigned to
the load case.

ExtrapolateOption

This is an array that identifies the extrapolation option for each load assigned to the load case. The
allowed values are:

```
0 = None
1 = Last Step
2 = Repeat Range
```
## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearMultistepLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MySF() As Double
Dim MyStepRange() As Long

Dim MyFirstLoadStep() As Long

Dim MyLastLoadStep() As Long

Dim MyStartCaseStep() As Long

Dim MyExtrapolateOption() As Long

Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim SF() As Double

Dim StepRange() As Long

Dim FirstLoadStep() As Long

Dim LastLoadStep() As Long

Dim StartCaseStep() As Long

Dim ExtrapolateOption() As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinearMultistep.SetCase("LCASE1")
'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MySF(1)

ReDim MyStepRange(1)

ReDim MyFirstLoadStep(1)


ReDim MyLastLoadStep(1)

ReDim MyStartCaseStep(1)

ReDim MyExtrapolateOption(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MySF(0) = 0.7

MyStepRange(0) = 0

MyFirstLoadStep(0) = 1

MyLastLoadStep(0) = 1
MyStartCaseStep(0) = 1

MyExtrapolateOption(0) = 1

MyLoadType(1) = "Accel0"
MyLoadName(1) = "UZ"
MySF(1) = 1.2
ret = SapModel.LoadCases.StaticNonlinearMultistep.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MySF, MyStepRange, MyFirstLoadStep, MyLastLoadStep, MyStartCaseStep,
MyExtrapolateOption )

'get load data
ret = SapModel.LoadCases.StaticNonlinearMultistep.GetLoads("LCASE1", NumberLoads,
LoadType, LoadName, SF, StepRange, FirstLoadStep, LastLoadStep, StartCaseStep,
ExtrapolateOption )

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

## See Also

SetLoads

# SetCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearMultistep.SetCase


## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified;
otherwise, a new case is added.

## Remarks

This function initializes a static nonlinear multistep analysis case. If this function is called for an
existing load case, all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise, it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearMultistep()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear multistep load case
ret = SapModel.LoadCases.StaticNonlinearMultistep.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 21.0.0.

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearMultistep.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing static nonlinear multistep load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts from the state at the end
of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearMultistepInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add static nonlinear multistep load case

ret = SapModel.LoadCases.StaticNonlinearMultistep.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.StaticNonlinearMultistep.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

## See Also

GetInitialCase

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearMultistep.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef SF() As Double, ByRef StepRange() as Integer,


ByRef FirstLoadStep() As Integer, ByRef LastLoadStep() As Integer, ByRef StartCaseStep() As
Integer, ByRef ExtrapolateOption() As Integer ) As Long

## Parameters

Name

The name of an existing static nonlinear multistep analysis case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the direction
of the load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for
Accel UX UY and UZ; otherwise unitless

StepRange

This is an array that identifies the step range type to consider for each load assigned to the load
case. The allowed values are:

```
0 = All
1 = User
```
FirstLoadStep

This is an array that specifies the first load step to consider for each load assigned to the load case.
This value is only applicable when StepRange = User.

LastLoadStep

This is an array that specifies the last load step to consider for each load assigned to the load case.
This value is only applicable when StepRange = User.

StartCaseStep

This is an array that specifies the load case step at which to start applying each load assigned to
the load case.


ExtrapolateOption

This is an array that identifies the extrapolation option for each load assigned to the load case. The
allowed values are:

```
0 = None
1 = Last Step
2 = Repeat Range
```
## Remarks

This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseStaticNonlinearMultistepLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MySF() As Double

Dim MyStepRange() As Long

Dim MyFirstLoadStep() As Long

Dim MyLastLoadStep() As Long

Dim MyStartCaseStep() As Long

Dim MyExtrapolateOption() As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear multistep load case


ret = SapModel.LoadCases.StaticNonlinearMultistep.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MySF(1)

ReDim MyStepRange(1)

ReDim MyFirstLoadStep(1)

ReDim MyLastLoadStep(1)

ReDim MyStartCaseStep(1)

ReDim MyExtrapolateOption(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MySF(0) = 0.7

MyStepRange(0) = 0

MyFirstLoadStep(0) = 1

MyLastLoadStep(0) = 1
MyStartCaseStep(0) = 1

MyExtrapolateOption(0) = 1
MyLoadType(1) = "Accel"
MyLoadName(1) = "UZ"
MySF(1) = 1.2
ret = SapModel.LoadCases.StaticNonlinearMultistep.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MySF, MyStepRange, MyFirstLoadStep, MyLastLoadStep, MyStartCaseStep,
MyExtrapolateOption)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0..

## See Also

GetLoads

# GetGeometricNonlinearity


## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.GetGeometricNonlinearity

## VB6 Procedure

Function GetGeometricNonlinearity(ByVal Name As String, ByRef NLGeomType As Long) As
Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

NLGeomType

This is 0, 1 or 2, indicating the geometric nonlinearity option selected for the load case.

```
0 = None
1 = P-delta
2 = P-delta plus large displacements
```
## Remarks

This function retrieves the geometric nonlinearity option for the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseStaticNonlinearStagedGeometricNonlinearity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NLGeomType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'get geometric nonlinearity option
ret = SapModel.LoadCases.StaticNonlinearStaged.GetGeometricNonlinearity("LCASE1",
NLGeomType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetGeometricNonlinearity

# GetHingeUnloading

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.GetHingeUnloading

## VB6 Procedure

Function GetHingeUnloading(ByVal Name As String, ByRef UnloadType As Long) As Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

UnloadType

This is 1, 2 or 3, indicating the hinge unloading option selected for the load case.

```
1 = Unload entire structure
```

```
2 = Apply local redistribution
3 = Restart using secant stiffness
```
## Remarks

This function retrieves the hinge unloading option for the specified load case.

The function returns zero if the option is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseStaticNonlinearStagedHingeUnloading()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim UnloadType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'get hinge unloading option
ret = SapModel.LoadCases.StaticNonlinearStaged.GetHingeUnloading("LCASE1",
UnloadType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetHingeUnloading

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.GetInitialCase

## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

InitialCase

This is blank, None or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts from the state at the end
of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the state at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearStagedInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'get initial condition
ret = SapModel.LoadCases.StaticNonlinearStaged.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetMassSource

## Syntax

SapObject.SapModel.LoadCases.Static NonlinearStaged.GetMassSource

## VB6 Procedure

Function GetMassSource(ByVal Name As String, ByRef Source As String) As Long


## Parameters

Name

The name of an existing static nonlinear staged load case.

Source

This is the name of an existing mass source or a blank string. Blank indicates to use the mass
source from the previous load case or the default mass source if the load case starts from zero
initial conditions.

## Remarks

This function sets the mass source to be used for the specified load case.

The function returns zero if the mass source is data is successfully set; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearStagedMassSource()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim Source as String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'get a mass source from the static nonlinear load case


ret = SapModel.LoadCases.StaticNonlinearStaged.GetMassSource("LCASE1", "Source")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.20.

## See Also

SetMassSource

# GetMaterialNonlinearity

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.GetMaterialNonlinearity

## VB6 Procedure

Function GetMaterialNonlinearity(ByVal Name As String, ByRef TimeDepMatProp As Boolean)
As Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

TimeDepMatProp

When this is True, any specified time dependent material properties are considered in the analysis.

## Remarks

This function retrieves the material nonlinearity options for the specified load case.

The function returns zero if the options are successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example


Sub GetCaseStaticNonlinearStagedMaterialNonlinearity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim TimeDepMatProp As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'get material nonlinearity options
ret = SapModel.LoadCases.StaticNonlinearStaged.GetMaterialNonlinearity("LCASE1",
TimeDepMatProp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetMaterialNonlinearity

# GetResultsSaved

## Syntax


SapObject.SapModel.LoadCases.StaticNonlinearStaged.GetResultsSaved

## VB6 Procedure

Function GetResultsSaved(ByVal Name As String, ByRef StagedSaveOption As Long, ByRef
StagedMinSteps As Long, ByRef StagedMinStepsTD As Long) As Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

StagedSaveOption

This is 0, 1, 2 or 3, indicating the results saved option for the load case.

```
0 = End of final stage
1 = End of each stage
2 = Start and end of each stage
3 = Two or more times in each stage
```
StagedMinSteps

The minimum number of steps for application of instantaneous load. This item applies only when
StagedSaveOption = 3.

StagedMinStepsTD

The minimum number of steps for analysis of time dependent items. This item applies only when
StagedSaveOption = 3.

## Remarks

This function retrieves the results saved parameters for the specified load case.

The function returns zero if the parameters are retrieved successfully; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearStagedResultsSaved()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim StagedSaveOption As Long
Dim StagedMinSteps As Long
Dim StagedMinStepsTD As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'set results saved parameters
ret = SapModel.LoadCases.StaticNonlinearStaged.SetResultsSaved("LCASE1", 3, 4, 10)

'get results saved parameters
ret = SapModel.LoadCases.StaticNonlinearStaged.GetResultsSaved("LCASE1",
StagedSaveOption , StagedMinSteps, StagedMinStepsTD)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetResultsSaved

# GetSolControlParameters

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.GetSolControlParameters

## VB6 Procedure


Function GetSolControlParameters(ByVal Name As String, ByRef MaxTotalSteps As Long,
ByRef MaxFailedSubSteps As Long, ByRef MaxIterCS As Long, ByRef MaxIterNR As Long,
ByRef TolConvD As Double, ByRef UseEventStepping As Boolean, ByRef TolEventD As
Double, ByRef MaxLineSearchPerIter As Long, ByRef TolLineSearch As Double, ByRef
LineSearchStepFact As Double) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

MaxTotalSteps

The maximum total steps per stage.

MaxFailedSubSteps

The maximum null (zero) steps per stage.

MaxIterCS

The maximum constant-stiffness iterations per step.

MaxIterNR

The maximum Newton_Raphson iterations per step.

TolConvD

The relative iteration convergence tolerance.

UseEventStepping

This item is True if event-to-event stepping is used.

TolEventD

The relative event lumping tolerance.

MaxLineSearchPerIter

The maximum number of line searches per iteration.

TolLineSearch

The relative line-search acceptance tolerance.

LineSearchStepFact

The line-search step factor.

## Remarks


This function retrieves the solution control parameters for the specified load case.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearStagedSolutionControlParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MaxTotalSteps As Long
Dim MaxFailedSubSteps As Long
Dim MaxIterCS As Long
Dim MaxIterNR As Long
Dim TolConvD As Double
Dim UseEventStepping As Boolean
Dim TolEventD As Double
Dim MaxLineSearchPerIter As Long
Dim TolLineSearch As Double
Dim LineSearchStepFact As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'get solution control parameters
ret = SapModel.LoadCases.StaticNonlinearStaged.GetSolControlParameters("LCASE1",
MaxTotalSteps, MaxFailedSubSteps, MaxIterCS, MaxIterNR, TolConvD, UseEventStepping,
TolEventD, MaxLineSearchPerIter, TolLineSearch, LineSearchStepFact)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetSolControlParameters

# GetStageData_2

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.GetStageData_2

## VB6 Procedure

Function GetStageData_2(ByVal Name As String, ByVal Stage As Long, ByRef
NumberOperations As Long, ByRef Operation() As Long, ByRef ObjectType() As String, ByRef
ObjectName() As String, ByRef Age() As Double, ByRef MyType() As String, ByRef MyName()
As String, ByRef SF() As Double) As Long

## Parameters

Name

The name of an existing static nonlinear staged load case.

Stage

The stage in the specified load case for which data is requested. Stages are numbered sequentially
starting from 1.

NumberOperations

The number of operations in the specified stage.

Operation

This is an array that includes 1, 2, 3, 4, 5, 6, 7, or 11, indicating an operation type.

```
1 = Add structure
2 = Remove structure
3 = Load objects if new
4 = Load objects
5 = Change section properties
6 = Change section property modifiers
```

```
7 = Change releases
11 = Change section properties and age
```
ObjectType

This is an array that includes the object type associated with the specified operation. The object
type may be one of the following:

```
Group
Frame
Cable
Tendon
Area
Solid
Link
Point
```
The following list shows which object types are applicable to each operation type:

```
Operation = 1 (Add structure): All object types
Operation = 2 (Remove structure): All object types
Operation = 3 (Load objects if new): All object types
Operation = 4 (Load objects): All object types
Operation = 5 (Change section properties): All object types except Point
Operation = 6 (Change section property modifiers): Group, Frame, Cable, Area
Operation = 7 (Change releases): Group, Frame
Operation = 11 (Change section properties and age): All object types except Point
```
ObjectName

This is an array that includes the name of the object associated with the specified operation. This
is the name of a Group, Frame object, Cable object, Tendon object, Area object, Solid object, Link
object or Point object, depending on the ObjectType item.

Age

This is an array that includes the age of the added structure, at the time it is added, in days. This
item applies only to operations with Operation = 1.

MyType

This is an array that includes a load type or an object type, depending on what is specified for the
Operation item. This item applies only to operations with Operation = 3, 4, 5, 6, 7, or 11.

When Operation = 3 or 4, this is an array that includes Load or Accel, indicating the load type of
an added load.

When Operation = 5 or 11, and the ObjectType item is Group, this is an array that includes Frame,
Cable, Tendon, Area, Solid or Link, indicating the object type for which the section property is
changed.

When Operation = 6 and the ObjectType item is Group, this is an array that includes Frame, Cable
or Area, indicating the object type for which the section property modifiers are changed.


When Operation = 7 and the ObjectType item is Group, this is an array that includes Frame,
indicating the object type for which the releases are changed.

When Operation = 5, 6, 7, or 11, and the ObjectType item is not Group and not Point, this item is
ignored and the type is picked up from the ObjectType item.

MyName

This is an array that includes a load assignment or an object name, depending on what is specified
for the Operation item. This item applies only to operations with Operation = 3, 4, 5, 6, 7, or 11.

When Operation = 3 or 4, this is an array that includes the name of the load assigned to the
operation. If the associated LoadType item is Load, this item is the name of a defined load pattern.
If the associated LoadType item is Accel , this item is UX, UY, UZ, RX, RY or RZ, indicating the
direction of the load.

When Operation = 5 or 11, this is the name of a Frame, Cable, Tendon, Area, Solid or Link object,
depending on the object type specified.

When Operation = 6, this is the name of a Frame, Cable or Area object, depending on the object
type specified.

When Operation = 7, this is the name of a Frame object.

SF

This is an array that includes the scale factor for the load assigned to the operation, if any. [L/s^2 ]
for Accel UX UY and UZ; otherwise unitless

This item applies only to operations with Operation = 3 or 4.

## Remarks

This function retrieves stage data for the specified stage in the specified load case.

The function returns zero if the data is successfully retrieved; otherwise, it returns a nonzero
value.

## VBA Example

Sub GetCaseStaticNonlinearStagedStageData_2()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDuration() As Double
Dim MyOutput() As Boolean
Dim MyOutputName() As String
Dim MyComment() As String
Dim MyOperation() As Long
Dim MyObjectType() As String
Dim MyObjectName() As String
Dim MyAge() As Double


Dim MyMyType() As String
Dim MyMyName() As String
Dim MySF() As Double
Dim NumberOperations As Long
Dim Operation() As Long
Dim ObjectType() As String
Dim ObjectName() As String
Dim Age() As Double
Dim MyType() As String
Dim MyName() As String
Dim SF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("ACASE1")

'initialize stage definitions
ReDim MyDuration(1)
ReDim MyOutput(1)
ReDim MyOutputName(1)
ReDim MyComment(1)
MyDuration(0) = 0
MyOutput(0) = False
MyComment(0) = "Build structure"
MyDuration(1) = 60
MyOutput(1) = True
MyOutputName(1) = "HBC2"
MyComment(1) = "Wait"
ret = SapModel.LoadCases.StaticNonlinearStaged.SetStageDefinitions_2("ACASE1", 2,
MyDuration, MyOutput, MyOutputName, MyComment)

'set stage data
ReDim MyOperation(1)
ReDim MyObjectType(1)
ReDim MyObjectName(1)
ReDim MyAge(1)
ReDim MyMyType(1)
ReDim MyMyName(1)
ReDim MySF(1)


MyOperation(0) = 1
MyObjectType(0) = "Group"
MyObjectName(0) = "ALL"
MyAge(0) = 3
MyOperation(1) = 4
MyObjectType(1) = "Frame"
MyObjectName(1) = "8"
MyMyType(1) = "Load"
MyMyName(1) = "DEAD"
MySF(1) = 0.85
ret = SapModel.LoadCases.StaticNonlinearStaged.SetStageData_2("ACASE1", 1, 2,
MyOperation, MyObjectType, MyObjectName, MyAge, MyMyType, MyMyName, MySF)

'get stage data
ret = SapModel.LoadCases.StaticNonlinearStaged.GetStageData_2("ACASE1", 1,
NumberOperations, Operation, ObjectType, ObjectName, Age, MyType, MyName, SF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

This function supersedes GetStageData_1.

## See Also

SetStageData_2

# GetStageDefinitions_2

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.GetStageDefinitions_2

## VB6 Procedure

Function GetStageDefinitions_2(ByVal Name As String, ByRef NumberStages As Long, ByRef
Duration() As Double, ByRef Output() As Boolean, ByRef OutputName() As String, ByRef
Comment() As String) As Long

## Parameters

Name


The name of an existing static nonlinear staged load case.

NumberStages

The number of stages defined for the specified load case.

Duration

This is an array that includes the duration in days for each stage.

Output

This is an array that includes True or False, indicating if analysis output is to be saved for each
stage.

OutputName

This is an array that includes a user-specified output name for each stage.

Comment

This is an array that includes a comment for each stage. The comment may be a blank string.

## Remarks

This function retrieves the stage definition data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearStagedStageDefinitions_2()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDuration() As Double
Dim MyOutput() As Boolean
Dim MyOutputName() As String
Dim MyComment() As String
Dim NumberStages As Long
Dim Duration() As Double
Dim Output() As Boolean
Dim OutputName() As String
Dim Comment() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("ACASE1")

'initialize stage definitions
ReDim MyDuration(1)
ReDim MyOutput(1)
ReDim MyOutputName(1)
ReDim MyComment(1)
MyDuration(0) = 0
MyOutput(0) = False
MyComment(0) = "Build structure"
MyDuration(1) = 60
MyOutput(1) = True
MyOutputName(1) = "HBC2"
MyComment(1) = "Wait"
ret = SapModel.LoadCases.StaticNonlinearStaged.SetStageDefinitions_2("ACASE1", 2,
MyDuration, MyOutput, MyOutputName, MyComment)

'get stage definitions
ret = SapModel.LoadCases.StaticNonlinearStaged.GetStageDefinitions_2("ACASE1",
NumberStages, Duration, Output, OutputName, Comment)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

This function supersedes GetStageDefinitions_1

## See Also

SetStageDefinitions_2

# GetTargetForceParameters

## Syntax


SapObject.SapModel.LoadCases.StaticNonlinearStaged.GetTargetForceParameters

## VB6 Procedure

Function GetTargetForceParameters(ByVal Name As String, ByRef TolConvF As Double, ByRef
MaxIter As Long, ByRef AccelFact As Double, ByRef NoStop As Boolean) As Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

TolConvF

The relative convergence tolerance for target force iteration.

MaxIter

The maximum iterations per stage for target force iteration.

AccelFact

The acceleration factor.

NoStop

If this item is True, the analysis is continued when there is no convergence in the target force
iteration.

## Remarks

This function retrieves the target force iteration parameters for the specified load case.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseStaticNonlinearStagedTargetForceParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim TolConvF As Double
Dim MaxIter As Long
Dim AccelFact As Double
Dim NoStop As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'get target force iteration parameters
ret = SapModel.LoadCases.StaticNonlinearStaged.GetTargetForceParameters("LCASE1",
TolConvF, MaxIter, AccelFact, NoStop)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetTargetForceParameters

# SetCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long


## Parameters

Name

The name of an existing or new load case. If this is an existing case, that case is modified,
otherwise, a new case is added.

## Remarks

This function initializes a static nonlinear staged analysis case. If this function is called for an
existing load case, all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearStaged()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetGeometricNonlinearity

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetGeometricNonlinearity

## VB6 Procedure

Function SetGeometricNonlinearity(ByVal Name As String, ByVal NLGeomType As Long) As
Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

NLGeomType

This is 0, 1 or 2, indicating the geometric nonlinearity option selected for the load case.

```
0 = None
1 = P-delta
2 = P-delta plus large displacements
```
## Remarks

This function sets the geometric nonlinearity option for the specified load case.

The function returns zero if the option is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseStaticNonlinearStagedGeometricNonlinearity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'set geometric nonlinearity option
ret = SapModel.LoadCases.StaticNonlinearStaged.SetGeometricNonlinearity("LCASE1", 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetGeometricNonlinearity

# SetHingeUnloading

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetHingeUnloading

## VB6 Procedure

Function SetHingeUnloading(ByVal Name As String, ByVal UnloadType As Long) As Long

## Parameters

Name


The name of an existing static nonlinear staged analysis case.

UnloadType

This is 1, 2 or 3, indicating the hinge unloading option selected for the load case.

```
1 = Unload entire structure
2 = Apply local redistribution
3 = Restart using secant stiffness
```
## Remarks

This function sets the hinge unloading option for the specified load case.

The function returns zero if the option is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseStaticNonlinearStagedHingeUnloading()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'set hinge unloading option
ret = SapModel.LoadCases.StaticNonlinearStaged.SetHingeUnloading("LCASE1", 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetHingeUnloading

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts from the state at the end
of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the state at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearStagedInitialCondition()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.StaticNonlinearStaged.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase

# SetMassSource

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetMassSource


## VB6 Procedure

Function SetMassSource(ByVal Name As String, ByVal Source As String) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

Source

This is the name of an existing mass source or a blank string. Blank indicates to use the mass
source from the previous load case or the default mass source if the load case starts from zero
initial conditions.

## Remarks

This function sets the mass source to be used for the specified load case.

The function returns zero if the mass source is data is successfully set; otherwise it returns a
nonzero value.

## VBA Example

Sub SetCaseStaticNonlinearStagedMassSource()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")


'add a new mass source and make it the default mass source

LoadPat(0) = "DEAD"

SF(0) = 1.25

ret = SapModel.SourceMass.SetMassSource("MyMassSource", True, True, True, True, 1,
LoadPat, SF)

'assign a mass source to the static nonlinear load case

ret = SapModel.LoadCases.StaticNonlinearStaged.SetMassSource("LCASE1",
"MyMassSource")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.20.

## See Also

GetMassSource

# SetMaterialNonlinearity

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetMaterialNonlinearity

## VB6 Procedure

Function SetMaterialNonlinearity(ByVal Name As String, ByVal TimeDepMatProp As Boolean)
As Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

TimeDepMatProp

When this is True, any specified time dependent material properties are considered in the analysis.


## Remarks

This function sets the material nonlinearity options for the specified load case.

The function returns zero if the options are successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseStaticNonlinearStagedMaterialNonlinearity()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'set geometric nonlinearity options
ret = SapModel.LoadCases.StaticNonlinearStaged.SetMaterialNonlinearity("LCASE1", True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also


GetMaterialNonlinearity

# SetResultsSaved

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetResultsSaved

## VB6 Procedure

Function SetResultsSaved(ByVal Name As String, ByVal StagedSaveOption As Long, Optional
ByVal StagedMinSteps As Long = 1, Optional ByVal StagedMinStepsTD As Long = 1) As Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

StagedSaveOption

This is 0, 1, 2 or 3, indicating the results saved option for the load case.

```
0 = End of final stage
1 = End of each stage
2 = Start and end of each stage
3 = Two or more times in each stage
```
StagedMinSteps

The minimum number of steps for application of instantaneous load. This item applies only when
StagedSaveOption = 3.

StagedMinStepsTD

The minimum number of steps for analysis of time dependent items. This item applies only when
StagedSaveOption = 3.

## Remarks

This function sets the results saved parameters for the specified load case.

The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearStagedResultsSaved()
'dimension variables|


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'set results saved parameters
ret = SapModel.LoadCases.StaticNonlinearStaged.SetResultsSaved("LCASE1", 3, 4, 10)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetResultsSaved

# SetStageData_2

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetStageData_2


## VB6 Procedure

Function SetStageData_2(ByVal Name As String, ByVal Stage As Long, ByVal
NumberOperations As Long, ByRef Operation() As Long, ByRef ObjectType() As String, ByRef
ObjectName() As String, ByRef Age() As Double, ByRef MyType() As String, ByRef MyName()
As String, ByRef SF() As Double) As Long

## Parameters

Name

The name of an existing static nonlinear staged load case.

Stage

The stage in the specified load case to which the data applies. Stages are numbered sequentially
starting from 1.

NumberOperations

The number of operations in the specified stage.

Operation

This is an array that includes 1, 2, 3, 4, 5, 6, 7, or 11, indicating an operation type.

```
1 = Add structure
2 = Remove structure
3 = Load objects if new
4 = Load objects
5 = Change section properties
6 = Change section property modifiers
7 = Change releases
11 = Change section properties and age
```
ObjectType

This is an array that includes the object type associated with the specified operation. The object
type may be one of the following:

```
Group
Frame
Cable
Tendon
Area
Solid
Link
Point
```
The following list shows which object types are applicable to each operation type:

```
Operation = 1 (Add structure): All object types
```

```
Operation = 2 (Remove structure): All object types
Operation = 3 (Load objects if new): All object types
Operation = 4 (Load objects): All object types
Operation = 5 (Change section properties): All object types except Point
Operation = 6 (Change section property modifiers): Group, Frame, Cable, Area
Operation = 7 (Change releases): Group, Frame
Operation = 11 (Change section properties and age): All object types except Point
```
ObjectName

This is an array that includes the name of the object associated with the specified operation. This
is the name of a Group, Frame object, Cable object, Tendon object, Area object, Solid object, Link
object or Point object, depending on the ObjectType item.

Age

This is an array that includes the age of the added structure, at the time it is added, in days. This
item applies only to operations with Operation = 1.

MyType

This is an array that includes a load type or an object type, depending on what is specified for the
Operation item. This item applies only to operations with Operation = 3, 4, 5, 6, 7, or 11.

When Operation = 3 or 4, this is an array that includes Load or Accel, indicating the load type of
an added load.

When Operation = 5 or 11, and the ObjectType item is Group, this is an array that includes Frame,
Cable, Tendon, Area, Solid or Link, indicating the object type for which the section property is
changed.

When Operation = 6 and the ObjectType item is Group, this is an array that includes Frame, Cable
or Area, indicating the object type for which the section property modifiers are changed.

When Operation = 7 and the ObjectType item is Group, this is an array that includes Frame,
indicating the object type for which the releases are changed.

When Operation = 5, 6, 7, or 11, and the ObjectType item is not Group and not Point, this item is
ignored and the type is picked up from the ObjectType item.

MyName

This is an array that includes a load assignment or an object name, depending on what is specified
for the Operation item. This item applies only to operations with Operation = 3, 4, 5, 6, 7 or 11.

When Operation = 3 or 4, this is an array that includes the name of the load assigned to the
operation. If the associated LoadType item is Load, this item is the name of a defined load pattern.
If the associated LoadType item is Accel, this item is UX, UY, UZ, RX, RY or RZ, indicating the
direction of the load.

When Operation = 5 or 11, this is the name of a Frame, Cable, Tendon, Area, Solid or Link object,
depending on the object type specified.

When Operation = 6, this is the name of a Frame, Cable or Area object, depending on the object
type specified.


When Operation = 7, this is the name of a Frame object.

SF

This is an array that includes the scale factor for the load assigned to the operation, if any. [L/s^2 ]
for Accel UX UY and UZ; otherwise unitless

This item applies only to operations with Operation = 3 or 4.

## Remarks

This function sets the stage data for the specified stage in the specified load case. All previous
stage data for the specified stage is cleared when this function is called.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseStaticNonlinearStagedStageData_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDuration() As Double
Dim MyOutput() As Boolean
Dim MyOutputName() As String
Dim MyComment() As String
Dim MyOperation() As Long
Dim MyObjectType() As String
Dim MyObjectName() As String
Dim MyAge() As Double
Dim MyMyType() As String
Dim MyMyName() As String
Dim MySF() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("ACASE1")


'initialize stage definitions
ReDim MyDuration(1)
ReDim MyOutput(1)
ReDim MyOutputName(1)
ReDim MyComment(1)
MyDuration(0) = 0
MyOutput(0) = False
MyComment(0) = "Build structure"
MyDuration(1) = 60
MyOutput(1) = True
MyOutputName(1) = "HBC2"
MyComment(1) = "Wait"
ret = SapModel.LoadCases.StaticNonlinearStaged.SetStageDefinitions_2("ACASE1", 2,
MyDuration, MyOutput, MyOutputName, MyComment)

'set stage data
ReDim MyOperation(1)
ReDim MyObjectType(1)
ReDim MyObjectName(1)
ReDim MyAge(1)
ReDim MyMyType(1)
ReDim MyMyName(1)
ReDim MySF(1)
MyOperation(0) = 1
MyObjectType(0) = "Group"
MyObjectName(0) = "ALL"
MyAge(0) = 3
MyOperation(1) = 4
MyObjectType(1) = "Frame"
MyObjectName(1) = "8"
MyMyType(1) = "Load"
MyMyName(1) = "DEAD"
MySF(1) = 0.85
ret = SapModel.LoadCases.StaticNonlinearStaged.SetStageData_2("ACASE1", 1, 2,
MyOperation, MyObjectType, MyObjectName, MyAge, MyMyType, MyMyName, MySF)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

This function supersedes SetStageData_1.

## See Also


GetStageData_2

# SetStageDefinitions_2

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetStageDefinitions_2

## VB6 Procedure

Function SetStageDefinitions_2(ByVal Name As String, ByVal NumberStages As Long, ByRef
Duration() As Double, ByRef Output() As Boolean, ByRef OutputName() As String, ByRef
Comment() As String) As Long

## Parameters

Name

The name of an existing static nonlinear staged load case.

NumberStages

The number of stages defined for the specified load case.

Duration

This is an array that includes the duration in days for each stage.

Output

This is an array that includes True or False, indicating if analysis output is to be saved for each
stage.

OutputName

This is an array that includes a user-specified output name for each stage.

Comment

This is an array that includes a comment for each stage. The comment may be a blank string.

## Remarks

This function initializes the stage definition data for the specified load case. All previous stage
definition data for the case is cleared when this function is called.

The function returns zero if the data is successfully initialized; otherwise, it returns a nonzero
value.


## VBA Example

Sub SetCaseStaticNonlinearStagedStageDefinitions_2()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDuration() As Double
Dim MyOutput() As Boolean
Dim MyOutputName() As String
Dim MyComment() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("ACASE1")

'initialize stage definitions
ReDim MyDuration(1)
ReDim MyOutput(1)
ReDim MyOutputName(1)
ReDim MyComment(1)
MyDuration(0) = 0
MyOutput(0) = False
MyComment(0) = "Build structure"
MyDuration(1) = 60
MyOutput(1) = True
MyOutputName(1) = "HBC2"
MyComment(1) = "Wait"
ret = SapModel.LoadCases.StaticNonlinearStaged.SetStageDefinitions_2("ACASE1", 2,
MyDuration, MyOutput, MyOutputName, MyComment)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 19.0.0.

This function supersedes GetStageDefinitions_1.

## See Also

GetStageDefinitions_2

# SetSolControlParameters

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetSolControlParameters

## VB6 Procedure

Function SetSolControlParameters(ByVal Name As String, ByVal MaxTotalSteps As Long,
ByVal MaxFailedSubSteps As Long, ByVal MaxIterCS As Long, ByVal MaxIterNR As Long,
ByVal TolConvD As Double, ByVal UseEventStepping As Boolean, ByVal TolEventD As
Double, ByVal MaxLineSearchPerIter As Long, ByVal TolLineSearch As Double, ByVal
LineSearchStepFact As Double) As Long

## Parameters

Name

The name of an existing static nonlinear load case.

MaxTotalSteps

The maximum total steps per stage.

MaxFailedSubSteps

The maximum null (zero) steps per stage.

MaxIterCS

The maximum constant-stiffness iterations per step.

MaxIterNR

The maximum Newton_Raphson iterations per step.

TolConvD

The relative iteration convergence tolerance.


UseEventStepping

This item is True if event-to-event stepping is used.

TolEventD

The relative event lumping tolerance.

MaxLineSearchPerIter

The maximum number of line searches per iteration.

TolLineSearch

The relative line-search acceptance tolerance.

LineSearchStepFact

The line-search step factor.

## Remarks

This function sets the solution control parameters for the specified load case.

The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearStagedSolutionControlParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")


'set solution control parameters
ret = SapModel.LoadCases.StaticNonlinearStaged.SetSolControlParameters("LCASE1", 240,
40, 15, 50, 0.00005, False, 0.02, 10, 0.2, 1.7)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetSolControlParameters

# SetTargetForceParameters

## Syntax

SapObject.SapModel.LoadCases.StaticNonlinearStaged.SetTargetForceParameters

## VB6 Procedure

Function SetTargetForceParameters(ByVal Name As String, ByVal TolConvF As Double, ByVal
MaxIter As Long, ByVal AccelFact As Double, ByVal NoStop As Boolean) As Long

## Parameters

Name

The name of an existing static nonlinear staged analysis case.

TolConvF

The relative convergence tolerance for target force iteration.

MaxIter

The maximum iterations per stage for target force iteration.

AccelFact

The acceleration factor.


NoStop

If this item is True, the analysis is continued when there is no convergence in the target force
iteration.

## Remarks

This function sets the target force iteration parameters for the specified load case.

The function returns zero if the parameters are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseStaticNonlinearStagedTargetForceParameters()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear staged load case
ret = SapModel.LoadCases.StaticNonlinearStaged.SetCase("LCASE1")

'set target force iteration parameters
ret = SapModel.LoadCases.StaticNonlinearStaged.SetTargetForceParameters("LCASE1",
0.008, 6, 5, True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetTargetForceParameters

# GetDampConstant

## Syntax

SapObject.SapModel.LoadCases.SteadyState.GetDampConstant

## VB6 Procedure

Function GetDampConstant(ByVal Name As String, ByRef HysConMassCoeff As Double,
ByRef HysConStiffCoeff As Double) As Long

## Parameters

Name

The name of an existing steady state load case that has constant damping.

HysConMassCoeff

The mass proportional damping coefficient.

HysConStiffCoeff

The stiffness proportional damping coefficient.

## Remarks

This function retrieves the constant hysteretic damping for all frequencies assigned to the
specified load case.

The function returns zero if the damping is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetCaseSteadyStateDampConstant()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long


Dim HysConMassCoeff As Double
Dim HysConStiffCoeff As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'set constant damping
ret = SapModel.LoadCases.SteadyState.SetDampConstant("LCASE1", 0.8, 0.04)

'get constant damping
ret = SapModel.LoadCases.SteadyState.GetDampType("LCASE1", DampType)
If DampType = 1 Then
ret = SapModel.LoadCases.SteadyState.GetDampConstant("LCASE1",HysConMassCoeff,
HysConStiffCoeff)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampConstant

# GetDampInterpolated


## Syntax

SapObject.SapModel.LoadCases.SteadyState.GetDampInterpolated

## VB6 Procedure

Function GetDampInterpolated(ByVal Name As String, ByRef HysIntFreqUnits As Long, ByRef
HysIntNumFreqs As Long, ByRef HysIntFreq() As Double, ByRef HysIntMassCoeff() As
Double, ByRef HysIntStiffCoeff() As Double) As Long

## Parameters

Name

The name of an existing steady state load case that has interpolated damping.

HysIntFreqUnits

This is 1 or 2, indicating the units for the frequency.

```
1 = Hz [cyc/s]
2 = RPM
```
HysIntNumFreqs

The number of sets of frequency, mass coefficient and stiffness coefficient data.

HysIntFreq

This is an array of frequencies. The frequency is in Hz or RPM, depending on the value of
HysIntFreqUnits.

HysIntMassCoeff

This is an array that includes the mass proportional damping coefficient.

HysIntStiffCoeff

This is an array that includes the stiffness proportional damping coefficient.

## Remarks

This function retrieves the interpolated hysteretic damping by frequency assigned to the specified
load case.

The function returns zero if the damping is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example


Sub GetCaseSteadyStateDampInterpolated()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyHysIntFreq() As Double
Dim MyHysIntMassCoeff() As Double
Dim MyHysIntStiffCoeff() As Double
Dim DampType As Long
Dim HysIntFreqUnits As Long
Dim HysIntNumFreqs As Long
Dim HysIntFreq() As Double
Dim HysIntMassCoeff() As Double
Dim HysIntStiffCoeff() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'set interpolated damping
ReDim MyHysIntFreq(2)
ReDim MyHysIntMassCoeff(2)
ReDim MyHysIntStiffCoeff(2)
MyHysIntFreq(0) = 1
MyHysIntMassCoeff(0) = 0.6
MyHysIntStiffCoeff(0) = 0.04
MyHysIntFreq(1) = 10
MyHysIntMassCoeff(1) = 0.7
MyHysIntStiffCoeff(1) = 0.05
MyHysIntFreq(2) = 100
MyHysIntMassCoeff(2) = 0.8
MyHysIntStiffCoeff(2) = 0.08
ret = SapModel.LoadCases.SteadyState.SetDampInterpolated("LCASE1", 2, 3,
MyHysIntFreq, MyHysIntMassCoeff, MyHysIntStiffCoeff)

'get interpolated damping
ret = SapModel.LoadCases.SteadyState.GetDampType("LCASE1", DampType)
If DampType = 2 Then
ret = SapModel.LoadCases.SteadyState.GetDampInterpolated("LCASE1",


HysIntFreqUnits, HysIntNumFreqs, HysIntFreq, HysIntMassCoeff, HysIntStiffCoeff)
End If

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDampInterpolated

# GetDampType

## Syntax

SapObject.SapModel.LoadCases.SteadyState.GetDampType

## VB6 Procedure

Function GetDampType(ByVal Name As String, ByRef DampType As Long) As Long

## Parameters

Name

The name of an existing steady state load case.

DampType

This is 1 or 2, indicating the hysteretic damping type for the load case.

```
1 = Constant hysteretic damping for all frequencies
2 = Interpolated hysteretic damping by frequency
```
## Remarks

This function retrieves the hysteretic damping type for the specified load case.

The function returns zero if the type is successfully retrieved; otherwise it returns a nonzero value.


## VBA Example

Sub GetCaseSteadyStateDampType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DampType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add response spectrum load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'get damping type
ret = SapModel.LoadCases.SteadyState.GetDampType("LCASE1", DampType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampConstant

GetDampInterpolated


# GetFreqData

## Syntax

SapObject.SapModel.LoadCases.SteadyState.GetFreqData

## VB6 Procedure

Function GetFreqData(ByVal Name As String, ByRef FreqFirst As Double, ByRef FreqLast As
Double, ByRef FreqNumIncs As Long, ByRef FreqAddModal As Boolean, ByRef
FreqAddModalDev As Boolean, ByRef FreqAddSpecified As Boolean, ByRef
FreqNumModalDev As Long, ByRef FreqModalDev() As Double, ByRef FreqNumSpecified As
Long, ByRef FreqSpecified() As Double) As Long

## Parameters

Name

The name of an existing steady state load case.

FreqFirst

The first frequency. [cyc/s]

FreqLast

The last frequency. [cyc/s]

FreqNumIncs

The number of frequency increments.

FreqAddModal

If this item is True then modal frequencies are added.

FreqAddModalDev

If this item is True then signed fractional deviations from modal frequencies are added.

FreqAddSpecified

If this item is True, specified frequencies are added.

ModalCase

This is the name of an existing modal load case. It specifies the modal load case on which modal
frequencies and modal frequency deviations are based.

FreqNumModalDev


The number of signed fractional deviations from modal frequencies that are added. This item
applies only when FreqAddModalDev = True.

FreqModalDev

This is an array that includes the added signed fractional deviations from modal frequencies. This
item applies only when FreqAddModalDev = True.

FreqNumSpecified

The number of specified frequencies that are added. This item applies only when
FreqAddSpecified = True.

FreqSpecified

This is an array that includes the added specified frequencies. This item applies only when
FreqAddModalDev = True.

## Remarks

This function retrieves the frequency data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseSteadyStateFreqData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyFreqModalDev() As Double
Dim MyFreqSpecified() As Double
Dim FreqFirst As Double
Dim FreqLast As Double
Dim FreqNumIncs As Long
Dim FreqAddModal As Boolean
Dim FreqAddModalDev As Boolean
Dim FreqAddSpecified As Boolean
Dim ModalCase As String
Dim FreqNumModalDev As Long
Dim FreqModalDev() As Double
Dim FreqNumSpecified As Long
Dim FreqSpecified() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'set frequency data
ReDim MyFreqModalDev(1)
ReDim MyFreqSpecified(1)
MyFreqModalDev(0) = -0.1
MyFreqModalDev(1) = 0.2
MyFreqSpecified(0) = 1.2
MyFreqSpecified(1) = 11.4
ret = SapModel.LoadCases.SteadyState.SetFreqData("LCASE1", .6, 20.6, 10, True, True,
True, "MODAL", 2, MyFreqModalDev, 2, MyFreqSpecified)

'get frequency data
ret = SapModel.LoadCases.SteadyState.GetFreqData("LCASE1", FreqFirst, FreqLast,
FreqNumIncs, FreqAddModal, FreqAddModalDev, FreqAddSpecified, ModalCase,
FreqNumModalDev, FreqModalDev, FreqNumSpecified, FreqSpecified)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetFreqData

# GetInitialCase

## Syntax

SapObject.SapModel.LoadCases.SteadyState.GetInitialCase


## VB6 Procedure

Function GetInitialCase(ByVal Name As String, ByRef InitialCase As String) As Long

## Parameters

Name

The name of an existing steady state load case.

InitialCase

This is blank, None, or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function retrieves the initial condition assumed for the specified load case.

The function returns zero if the initial condition is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCaseSteadyStateInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim InitialCase As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'get initial condition
ret = SapModel.LoadCases.SteadyState.GetInitialCase("LCASE1", InitialCase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetInitialCase

# GetLoads

## Syntax

SapObject.SapModel.LoadCases.SteadyState.GetLoads

## VB6 Procedure

Function GetLoads(ByVal Name As String, ByRef NumberLoads As Long, ByRef LoadType()
As String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef
PhaseAngle() As Double, ByRef CSys() As String, ByRef Ang() As Double) As Long

## Parameters

Name

The name of an existing steady state load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.


LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the steady state function associated with each load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

PhaseAngle

This is an array that includes the phase angle. [deg]

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.

Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks

This function retrieves the load data for the specified load case.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetCaseSteadyStateLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyFunc() As String


Dim MySF() As Double
Dim MyPhaseAngle() As Double
Dim MyCSys() As String
Dim MyAng() As Double
Dim NumberLoads As Long
Dim LoadType() As String
Dim LoadName() As String
Dim Func() As String
Dim SF() As Double
Dim PhaseAngle() As Double
Dim CSys() As String
Dim Ang() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyPhaseAngle(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "UNIFSS"
MySF(0) = 1.5
MyPhaseAngle(0) = 90
MyLoadType(1) = "Accel"
MyLoadName(1) = "U3"
MyFunc(1) = "UNIFSS"
MySF(1) = 1
MyPhaseAngle(1) = 90
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.SteadyState.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MyFunc, MySF, MyPhaseAngle, MyCSys, MyAng)


'get load data
ret = SapModel.LoadCases.SteadyState.GetLoads("LCASE1", NumberLoads, LoadType,
LoadName, Func, SF, PhaseAngle, CSys, Ang)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetLoads

# SetCase

## Syntax

SapObject.SapModel.LoadCases.SteadyState.SetCase

## VB6 Procedure

Function SetCase(ByVal Name As String) As Long

## Parameters

Name

The name of an existing or new load case. If this is an existing case then that case is modified,
otherwise, a new case is added.

## Remarks

This function initializes a steady state load case. If this function is called for an existing load case,
all items for the case are reset to their default value.

The function returns zero if the load case is successfully initialized; otherwise it returns a nonzero
value.


## VBA Example

Sub SetCaseSteadyState()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetDampConstant

## Syntax

SapObject.SapModel.LoadCases.SteadyState.SetDampConstant


## VB6 Procedure

Function SetDampConstant(ByVal Name As String, ByVal HysConMassCoeff As Double, ByVal
HysConStiffCoeff As Double) As Long

## Parameters

Name

The name of an existing steady state load case.

HysConMassCoeff

The mass proportional damping coefficient.

HysConStiffCoeff

The stiffness proportional damping coefficient.

## Remarks

This function sets constant hysteretic damping for all frequencies for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseSteadyStateDampConstant()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")


'set constant damping
ret = SapModel.LoadCases.SteadyState.SetDampConstant("LCASE1", 0.8, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampConstant

# SetDampInterpolated

## Syntax

SapObject.SapModel.LoadCases.SteadyState.SetDampInterpolated

## VB6 Procedure

Function SetDampInterpolated(ByVal Name As String, ByVal HysIntFreqUnits As Long, ByVal
HysIntNumFreqs As Long, ByRef HysIntFreq() As Double, ByRef HysIntMassCoeff() As
Double, ByRef HysIntStiffCoeff() As Double) As Long

## Parameters

Name

The name of an existing steady state load case.

HysIntFreqUnits

This is either 1 or 2, indicating the units for the frequency.

```
1 = Hz [cyc/s]
2 = RPM
```
HysIntNumFreqs

The number of sets of frequency, mass coefficient and stiffness coefficient data.


HysIntFreq

This is an array of frequencies. The frequency is either in Hz or RPM depending on the value of
HysIntFreqUnits.

HysIntMassCoeff

This is an array that includes the mass proportional damping coefficient.

HysIntStiffCoeff

This is an array that includes the stiffness proportional damping coefficient.

## Remarks

This function sets interpolated hysteretic damping by frequency for the specified load case.

The function returns zero if the damping is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseSteadyStateDampInterpolated()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyHysIntFreq() As Double
Dim MyHysIntMassCoeff() As Double
Dim MyHysIntStiffCoeff() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'set interpolated damping
ReDim MyHysIntFreq(2)
ReDim MyHysIntMassCoeff(2)
ReDim MyHysIntStiffCoeff(2)


MyHysIntFreq(0) = 1
MyHysIntMassCoeff(0) = 0.6
MyHysIntStiffCoeff(0) = 0.04
MyHysIntFreq(1) = 10
MyHysIntMassCoeff(1) = 0.7
MyHysIntStiffCoeff(1) = 0.05
MyHysIntFreq(2) = 100
MyHysIntMassCoeff(2) = 0.8
MyHysIntStiffCoeff(2) = 0.08
ret = SapModel.LoadCases.SteadyState.SetDampInterpolated("LCASE1", 2, 3,
MyHysIntFreq, MyHysIntMassCoeff, MyHysIntStiffCoeff)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetDampInterpolated

# SetFreqData

## Syntax

SapObject.SapModel.LoadCases.SteadyState.SetFreqData

## VB6 Procedure

Function SetFreqData(ByVal Name As String, ByVal FreqFirst As Double, ByVal FreqLast As
Double, ByVal FreqNumIncs As Long, ByVal FreqAddModal As Boolean, ByVal
FreqAddModalDev As Boolean, ByVal FreqAddSpecified As Boolean, ByVal
FreqNumModalDev As Long, ByRef FreqModalDev() As Double, ByVal FreqNumSpecified As
Long, ByRef FreqSpecified() As Double) As Long

## Parameters

Name

The name of an existing steady state load case.


FreqFirst

The first frequency. [cyc/s]

FreqLast

The last frequency. [cyc/s]

FreqNumIncs

The number of frequency increments.

FreqAddModal

If this item is True, modal frequencies are added.

FreqAddModalDev

If this item is True, signed fractional deviations from modal frequencies are added.

FreqAddSpecified

If this item is True, specified frequencies are added.

ModalCase

This is the name of an existing modal load case. It specifies the modal load case on which modal
frequencies and modal frequency deviations are based.

FreqNumModalDev

The number of signed fractional deviations from modal frequencies that are added. This item
applies only when FreqAddModalDev = True.

FreqModalDev

This is an array that includes the added signed fractional deviations from modal frequencies. This
item applies only when FreqAddModalDev = True.

FreqNumSpecified

The number of specified frequencies that are added. This item applies only when
FreqAddSpecified = True.

FreqSpecified

This is an array that includes the added specified frequencies. This item applies only when
FreqAddModalDev = True.

## Remarks

This function sets the frequency data for the specified load case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.


## VBA Example

Sub SetCaseSteadyStateFreqData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyFreqModalDev() As Double
Dim MyFreqSpecified() As Double

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'set frequency data
ReDim MyFreqModalDev(1)
ReDim MyFreqSpecified(1)
MyFreqModalDev(0) = -0.1
MyFreqModalDev(1) = 0.2
MyFreqSpecified(0) = 1.2
MyFreqSpecified(1) = 11.4
ret = SapModel.LoadCases.SteadyState.SetFreqData("LCASE1", .6, 20.6, 10, True, True,
True, "MODAL", 2, MyFreqModalDev, 2, MyFreqSpecified)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetFreqData

# SetInitialCase

## Syntax

SapObject.SapModel.LoadCases.SteadyState.SetInitialCase

## VB6 Procedure

Function SetInitialCase(ByVal Name As String, ByVal InitialCase As String) As Long

## Parameters

Name

The name of an existing steady state load case.

InitialCase

This is blank, None or the name of an existing analysis case. This item specifies if the load case
starts from zero initial conditions, that is, an unstressed state, or if it starts using the stiffness that
occurs at the end of a nonlinear static or nonlinear direct integration time history load case.

If the specified initial case is a nonlinear static or nonlinear direct integration time history load
case, the stiffness at the end of that case is used. If the initial case is anything else, zero initial
conditions are assumed.

## Remarks

This function sets the initial condition for the specified load case.

The function returns zero if the initial condition is successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCaseSteadyStateInitialCondition()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add static nonlinear load case
ret = SapModel.LoadCases.StaticNonlinear.SetCase("SN1")

'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'set initial condition
ret = SapModel.LoadCases.SteadyState.SetInitialCase("LCASE1", "SN1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetInitialCase

# SetLoads

## Syntax

SapObject.SapModel.LoadCases.SteadyState.SetLoads

## VB6 Procedure

Function SetLoads(ByVal Name As String, ByVal NumberLoads As Long, ByRef LoadType() As
String, ByRef LoadName() As String, ByRef Func() As String, ByRef SF() As Double, ByRef
PhaseAngle() As Double, ByRef CSys() As String, ByRef Ang() As Double) As Long


## Parameters

Name

The name of an existing steady state load case.

NumberLoads

The number of loads assigned to the specified analysis case.

LoadType

This is an array that includes either Load or Accel, indicating the type of each load assigned to the
load case.

LoadName

This is an array that includes the name of each load assigned to the load case.

If the LoadType item is Load, this item is the name of a defined load pattern.

If the LoadType item is Accel, this item is U1, U2, U3, R1, R2 or R3, indicating the direction of
the load.

Func

This is an array that includes the name of the steady state function associated with each load.

SF

This is an array that includes the scale factor of each load assigned to the load case. [L/s^2 ] for U1
U2 and U3; otherwise unitless

PhaseAngle

This is an array that includes the phase angle. [deg]

CSys

This is an array that includes the name of the coordinate system associated with each load. If this
item is a blank string, the Global coordinate system is assumed.

This item applies only when the LoadType item is Accel.

Ang

This is an array that includes the angle between the acceleration local 1 axis and the +X-axis of the
coordinate system specified by the CSys item. The rotation is about the Z-axis of the specified
coordinate system. [deg]

This item applies only when the LoadType item is Accel.

## Remarks


This function sets the load data for the specified analysis case.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetCaseSteadyStateLoads()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyLoadType() As String
Dim MyLoadName() As String
Dim MyFunc() As String
Dim MySF() As Double
Dim MyPhaseAngle() As Double
Dim MyCSys() As String
Dim MyAng() As Double

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add steady state load case
ret = SapModel.LoadCases.SteadyState.SetCase("LCASE1")

'set load data
ReDim MyLoadType(1)
ReDim MyLoadName(1)
ReDim MyFunc(1)
ReDim MySF(1)
ReDim MyPhaseAngle(1)
ReDim MyCSys(1)
ReDim MyAng(1)
MyLoadType(0) = "Load"
MyLoadName(0) = "DEAD"
MyFunc(0) = "UNIFSS"
MySF(0) = 1.5
MyPhaseAngle(0) = 90
MyLoadType(1) = "Accel"
MyLoadName(1) = "U3"


MyFunc(1) = "UNIFSS"
MySF(1) = 1
MyPhaseAngle(1) = 90
MyCSys(1) = "Global"
MyAng(1) = 10
ret = SapModel.LoadCases.SteadyState.SetLoads("LCASE1", 2, MyLoadType,
MyLoadName, MyFunc, MySF, MyPhaseAngle, MyCSys, MyAng)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetLoads

# GetASCE716_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetASCE716_1

## VB6 Procedure

Function GetASCE716_1(ByVal Name As String, ByRef nDir() As Boolean, ByRef Eccen As
Double, ByRef PeriodFlag As Integer, ByRef CtType As Integer, ByRef UserT As Double, ByRef
UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef R As Double,
ByRef Omega As Double, ByRef Cd As Double, ByRef I As Double, ByRef Ss As Double,
ByRef S1 As Double, ByRef TL As Double, ByRef SiteClass As Integer, ByRef Fa As Double,
ByRef Fv As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a ASCE 7-16 auto seismic load assignment.

nDir

This is an array with 2 inputs that indicate the seismic load direction.


```
nDir(1) = True = Global X
nDir(2) = True = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CtType

This is 0, 1, 2 or 3, indicating the values of Ct and x. This item is meaningful when the PeriodFlag
item is 1 or 2.

```
0 = Ct = 0.028 (ft), x = 0.8
1 = Ct = 0.016 (ft), x = 0.9
2 = Ct = 0.03 (ft), x = 0.75
3 = Ct = 0.02 (ft), x = 0.75
```
UserT

The user specified time period. This item is meaningful when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

R

The response modification factor.

Omega

The system overstrength factor.

Cd

The deflection amplification factor.


### I

The occupancy importance factor.

SS, S1

The seismic coefficients Ss and S1.

TL

The long-period transition period. [s]

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
Fa, Fv

The site coefficients Fa and Fv.

## Remarks

This function retrieves auto seismic loading parameters for the 2016 ASCE 7 code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersASCE716_1()

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(e3DFrameType.BeamSlab, 2, 144, 3, 336, 2, 432 )


'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", eLoadPatternType.Quake)

'dimension ASCE716 parameters

Dim nDir() As Boolean

Dim Eccen As Double

Dim PeriodFlag As Long

Dim CtType As Long

Dim UserT As Double

Dim UserZ As Boolean

Dim TopZ As Double

Dim BottomZ As Double

Dim R As Double

Dim Omega As Double

Dim Cd As Double

Dim I As Double

Dim SS As Double

Dim S1 As Double

Dim TL As Double

Dim SiteClass As Long

Dim Fa As Double

Dim Fv As Double

ReDim nDir(1)

nDir(0) = True

TopZ = 32

BottomZ = 14

'set ASCE716 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetASCE716_1("EQX", nDir, 0.04, 3, 1, 1.76,


True, TopZ, BottomZ, 6, 3.5, 6.5, 1.5, 1.9, 1.1, 8, 3, 0, 0)

'get ASCE716 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetASCE716_1("EQX", nDir, Eccen, PeriodFlag,
CtType, UserT, UserZ, TopZ, BottomZ, R, Omega, Cd, I, SS, S1, TL, SiteClass, Fa, Fv)

'close SAP2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.2.0.

This function replaced the obsolete function GetASCE16.

## See Also

SetASCE716

# GetAS11702007

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetAS11702007

## VB6 Procedure

Function GetAS11702007(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As
Double, ByRef PeriodFlag As Long, ByRef CT As Double, ByRef UserT As Double, ByRef
UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef AS2007SiteClass
As Long, ByRef AS2007kp As Double, ByRef AS2007Z As Double, ByRef AS2007Sp As
Double, ByRef AS2007Mu As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a AS 1170 2007 auto seismic load
assignment.

DirFlag

This is 1 or 2, indicating the seismic load direction.


```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified kt factor. This item applies when the PeriodFlag item is 1.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

AS2007SiteClass

This is 1, 2, 3, 4 or 5, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
AS2007kp

The probability factor, kp.

AS2007Z

The hazard factor, Z.


AS2007Sp

The structural performance factor, Sp.

AS2007Mu

The structural ductility factor, u.

## Remarks

This function retrieves auto seismic loading parameters for the AS 1170 2007 code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersAS11702007()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim CT As Double
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim AS2007SiteClass As Long
Dim AS2007kp As Double
Dim AS2007Z As Double
Dim AS2007Sp As Double
Dim AS2007Mu As Double

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern


ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign AS 1170 2007 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetAS11702007("EQX", 2, 0.1, 2, 0.075, 0, False,
0, 0, 3, 1.3, 0.09, 0.77, 2)

'get AS 1170 2007 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetAS11702007("EQX", DirFlag, Eccen,
PeriodFlag, CT, UserT, UserZ, TopZ, BottomZ, AS2007SiteClass, AS2007kp, AS2007Z,
AS2007Sp, AS2007Mu)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also

SetAS11702007

# GetBOCA96

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetBOCA96

## VB6 Procedure

Function GetBOCA96(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double,
ByRef PeriodFlag As Long, ByRef CT As Double, ByRef UserT As Double, ByRef UserZ As
Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef BOCA96Aa As Double,
ByRef BOCA96Av As Double, ByRef BOCA96S As Double, ByRef BOCA96R As Double) As
Long

## Parameters

Name

The name of an existing Quake-type load pattern with a BOCA96 auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.


```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor. This item applies when the PeriodFlag item is 1 or 2.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

BOCA96Aa

The effective peak acceleration coefficient.

BOCA96Av

The effective peak velocity-related coefficient.

BOCA96S

This is 1, 1.2, 1.5 or 2, indicating the site coefficient.

BOCA96R

The response modification factor.


## Remarks

This function retrieves auto seismic loading parameters for the 1996 BOCA code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersBOCA96()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim CT As Double
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim BOCA96Aa As Double
Dim BOCA96Av As Double
Dim BOCA96S As Double
Dim BOCA96R As Double

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign BOCA96 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetBOCA96("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 0.4, 0.4, 1.5, 8)

'get BOCA96 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetBOCA96("EQX", DirFlag, Eccen, PeriodFlag,
CT, UserT, UserZ, TopZ, BottomZ, BOCA96Aa, BOCA96Av, BOCA96S, BOCA96R)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetBOCA96

# GetChinese2010

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetChinese2010

## VB6 Procedure

Function GetChinese2010(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As
Double, ByRef PeriodFlag As Long, ByRef UserT As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef JGJ32010AlphaMax As Double, ByRef
JGJ32010SI As Long, ByRef JGJ32010DampRatio As Double, ByRef JGJ32010Tg As Double,
ByRef JGJ32010PTDF As Double, ByRef EnhancementFactor As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a Chinese 2010 auto seismic load
assignment.

DirFlag

This is 1, 2 or 3, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
3 = Global Z
```
Eccen


The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is either 2 or 3, indicating the time period option.

```
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

JGJ32010AlphaMax

The maximum influence factor.

JGJ32010SI

This is 1, 2, 3, 4, 5 or 6, indicating the seismic intensity.

```
1 = 6 (0.05g)
2 = 7 (0.10g)
3 = 7 (0.15g)
4 = 8 (0.20g)
5 = 8 (0.30g)
6 = 9 (0.40g)
```
JGJ32010DampRatio

The damping ratio.

JGJ32010Tg

The characteristic ground period. [s]

JGJ32010PTDF

The period time discount factor.

EnhancementFactor


The enhancement factor.

## Remarks

This function retrieves auto seismic loading parameters for the Chinese 2010 code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersChinese2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim JGJ32010AlphaMax As Double
Dim JGJ32010SI As Long
Dim JGJ32010DampRatio As Double
Dim JGJ32010Tg As Double
Dim JGJ32010PTDF As Double
Dim EnhancementFactor As Double

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign Chinese 2010 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetChinese2010("EQX", 1, 0.05, 2, 0, False, 0, 0,
0.16, 4, 0.06, 0.4, 1, 1)


'get Chinese 2010 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetChinese2010("EQX", DirFlag, Eccen,
PeriodFlag, UserT, UserZ, TopZ, BottomZ, JGJ32010AlphaMax, JGJ32010SI,
JGJ32010DampRatio, JGJ32010Tg, JGJ32010PTDF, EnhancementFactor)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.2.

## See Also

SetChinese2010

# GetDiaphragmEccentricityOverride

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetDiaphragmEccentricityOverride

## VB6 Procedure

Function GetDiaphragmEccentricityOverride(ByVal Name As String, ByRef Num As Long,
ByRef Diaph() As String, ByRef Eccen() As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern that has an auto seismic load assigned.

Num

The number of diaphragm eccentricity overrides for the specified load pattern.

Diaph

This is an array that includes the names of the diaphragms which have eccentricity overrides.

Eccen

This is an array that includes the eccentricity applied to each diaphragm. [L]


## Remarks

This function retrieves diaphragm eccentricity overrides for auto seismic loads. This function does
not apply for User Load type auto seismic loads.

The function returns zero if the overrides are successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetSeismicDiaphragmEccentricityOverride()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Num As Long
Dim Diaph() As String
Dim Eccen() As Double

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign BOCA96 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetBOCA96("EQX", 1, 0.05, 1, 0.035, 0, False, 0,


### 0, 0.4, 0.4, 1.5, 8)

'assign diaphragm eccentricity override
ret = SapModel.LoadPatterns.AutoSeismic.SetDiaphragmEccentricityOverride("EQX",
"Diaph1", 50)

'get diaphragm eccentricity override
ret = SapModel.LoadPatterns.AutoSeismic.GetDiaphragmEccentricityOverride("EQX", Num,
Diaph, Eccen)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetDiaphragmEccentricityOverride

GetSpecialRigidDiaphragmList

# GetEurocode82004_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetEurocode82004_1

## VB6 Procedure

Function GetEurocode82004_1(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen
As Double, ByRef PeriodFlag As Long, ByRef CT As Double, ByRef UserT As Double, ByRef
UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef
EURO2004Country As Long, ByRef EURO2004SpectrumType As Long, ByRef
EURO2004GroundType As Long, ByRef EURO2004ag As Double, ByRef EURO2004S As
Double, ByRef EURO2004Tb As Double, ByRef EURO2004Tc As Double, ByRef
EURO2004Td As Double, ByRef EURO2004Beta As Double, ByRef EURO2004q As Double,
ByRef EURO2004Lambda As Double) As Long


## Parameters

Name

The name of an existing Quake-type load pattern with a Eurocode 8 2004 auto seismic load
assignment.

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
```
```
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
```
```
2 = Program calculated
```
```
3 = User defined
```
CT

The code-specified Ct factor. This item applies when the PeriodFlag item is 1.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

EURO2004Country


This is 0, 1, 5, 6 or 10 indicating the country for which the Nationally Determined Parameters
(NDPs) are specified.

```
0 = Other (NDPs are user specified)
```
```
1 = CEN Default
```
```
5 = Norway
```
```
6 = Singapore
```
```
10 = Portugal
```
EURO2004SpectrumType

This is 1 or 2, indicating the spectrum type.

```
1 = Type 1
```
```
2 = Type 2 (Does not apply when EURO2004Country = 5 or 6)
```
EURO2004GroundType

This is 1, 2, 3, 4 or 5, or 6, indicating the ground type.

```
1 = A (Does not apply when EURO2004Country = 6)
```
```
2 = B (Does not apply when EURO2004Country = 6)
```
```
3 = C
```
```
4 = D
```
```
5 = E (Does not apply when EURO2004Country = 6)
```
```
6 = S1 (Only applies when EURO2004Country = 6)
```
EURO2004ag

The design ground acceleration in g, ag.

EURO2004S

The soil factor, S.

EURO2004Tb

The lower limit of period of the constant spectral acceleration branch, Tb.

EURO2004Tc

The upper limit of period of the constant spectral acceleration branch, Tc.

EURO2004Td

The period defining the start of the constant displacement range, Td.


EURO2004Beta

The lower bound factor, Beta.

EURO2004q

The behavior factor, q.

EURO2004Lambda

The correction factor, Lambda.

## Remarks

This function retrieves auto seismic loading parameters for the Eurocode 8 2004 code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersEurocode82004()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim CT As Double
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim EURO2004Country As Long
Dim EURO2004SpectrumType As Long
Dim EURO2004GroundType As Long
Dim EURO2004ag As Double
Dim EURO2004S As Double
Dim EURO2004Tb As Double
Dim EURO2004Tc As Double
Dim EURO2004Td As Double
Dim EURO2004Beta As Double
Dim EURO2004q As Double
Dim EURO2004Lambda As Double

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign Eurocode 8 2004 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetEurocode82004_1("EQX", 2, 0.1, 2, 0.075, 0,
False, 0, 0, 1, 1, 2, 0.4, 1, 1, 1, 1, 0.2, 2, 1)

'get Eurocode 8 2004 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetEurocode82004_1("EQX", DirFlag, Eccen,
PeriodFlag, CT, UserT, UserZ, TopZ, BottomZ, EURO2004Country, EURO2004SpectrumType,
EURO2004GroundType, EURO2004ag, EURO2004S, EURO2004Tb, EURO2004Tc,
EURO2004Td, EURO2004Beta, EURO2004q, EURO2004Lambda)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.1.0.

This function supersedes GetEurocode82004.

Added Portugal as a Country parameter in SAP2000 Version 15.0.0 and CSiBridge Version
15.1.0.

Added Singapore as a Country parameter in v20.1.0.

## See Also

SetEurocode82004_1

# GetIBC2003

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetIBC2003


## VB6 Procedure

Function GetIBC2003(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double,
ByRef PeriodFlag As Long, ByRef CT As Double, ByRef UserT As Double, ByRef UserZ As
Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef IBC2003SG As Long,
ByRef IBC2003SeismicCoeffFlag As Long, ByRef IBC2003Site As Long, ByRef IBC2003SS As
Double, ByRef IBC2003S1 As Double, ByRef IBC2003Fa As Double, ByRef IBC2003Fv As
Double, ByRef IBC2003R As Double, ByRef IBC2003Omega As Double, ByRef IBC2003Cd As
Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a IBC2003 auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor (ft). This item applies when the PeriodFlag item is 1 or 2.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

IBC2003SG

This is 1, 2 or 3, indicating the seismic group.

```
1 = I
2 = II
3 = III
```
IBC2003SeismicCoeffFlag

This is either 1 or 2, indicating the seismic coefficient option.

```
1 = Coefficients are per code
2 = Coefficients are user defined
```
IBC2003Site

This is either 1, 2, 3, 4 or 5, indicating the site class. This item is filled only when the
IBC2003SeismicCoeffFlag = 1.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
IBC2003SS

The response acceleration for short periods, (g).

IBC2003S1

The response acceleration for a one second period, (g).

IBC2003Fa

The site coefficient Fa.

IBC2003Fv

The site coefficient Fv.

IBC2003R

The response modification factor.

IBC2003Omega

The system overstrength factor.

IBC2003Cd

The deflection amplification factor.


## Remarks

This function retrieves auto seismic loading parameters for the 2003 IBC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersIBC2003()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim CT As Double
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim IBC2003SG As Long
Dim IBC2003SeismicCoeffFlag As Long
Dim IBC2003Site As Long
Dim IBC2003SS As Double
Dim IBC2003S1 As Double
Dim IBC2003Fa As Double
Dim IBC2003Fv As Double
Dim IBC2003R As Double
Dim IBC2003Omega As Double
Dim IBC2003Cd As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign IBC2003 parameters


ret = SapModel.LoadPatterns.AutoSeismic.SetIBC2003("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 1, 1, 3, 1, 0.4, 0, 0, 8, 3, 5.5)

'get IBC2003parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetIBC2003("EQX", DirFlag, Eccen, PeriodFlag,
CT, UserT, UserZ, TopZ, BottomZ, IBC2003SG, IBC2003SeismicCoeffFlag, IBC2003Site,
IBC2003SS, IBC2003S1, IBC2003Fa, IBC2003Fv, IBC2003R, IBC2003Omega, IBC2003Cd)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetIBC2003

# GetIBC2006

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetIBC2006

## VB6 Procedure

Function GetIBC2006(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double,
ByRef PeriodFlag As Long, ByRef IBC2006CtType As Long, ByRef UserT As Double, ByRef
UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef IBC2006R As
Double, ByRef IBC2006Omega As Double, ByRef IBC2006Cd As Double, ByRef IBC2006I As
Double, ByRef IBC2006Option As Long, ByRef IBC2006Latitude As Double, ByRef
IBC2006Longitude As Double, ByRef IBC2006ZipCode As String, ByRef IBC2006SS As
Double, ByRef IBC2006S1 As Double, ByRef IBC2006TL As Double, ByRef IBC2006SiteClass
As Long, ByRef IBC2006Fa As Double, ByRef IBC2006Fv As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a IBC2006 auto seismic load assignment.


DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
IBC2006CtType

This is 0, 1, 2 or 3, indicating the values of Ct and x. This item is meaningful when the PeriodFlag
item is 1 or 2.

```
0 = Ct = 0.028 (ft), x = 0.8
1 = Ct = 0.016 (ft), x = 0.9
2 = Ct = 0.03 (ft), x = 0.75
3 = Ct = 0.02 (ft), x = 0.75
```
UserT

The user specified time period. This item is meaningful when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

IBC2006R

The response modification factor.

IBC2006Omega

The system overstrength factor.


IBC2006Cd

The deflection amplification factor.

IBC2006I

The occupancy importance factor.

IBC2006Option

This is 0, 1 or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
IBC2006Latitude, IBC2006Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are
meaningful only when IBC2006Option = 0 or 1.

IBC2006ZipCode

The zip code for which the seismic coefficients are obtained. This item is meaningful only when
IBC2006Option = 1.

IBC2006SS, IBC2006S1

The seismic coefficients Ss and S1.

IBC2006TL

The long-period transition period. [s]

IBC2006SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
IBC2006Fa, IBC2006Fv

The site coefficients Fa and Fv.

## Remarks

This function retrieves auto seismic loading parameters for the 2006 IBC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetSeismicParametersIBC2006()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim IBC2006CtType As Long
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim IBC2006R As Double
Dim IBC2006Omega As Double
Dim IBC2006Cd As Double
Dim IBC2006I As Double
Dim IBC2006Option As Long
Dim IBC2006Latitude As Double
Dim IBC2006Longitude As Double
Dim IBC2006ZipCode As String
Dim IBC2006SS As Double
Dim IBC2006S1 As Double
Dim IBC2006TL As Double
Dim IBC2006SiteClass As Long
Dim IBC2006Fa As Double
Dim IBC2006Fv As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign IBC2006 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetIBC2006("EQX", 1, 0.05, 1, 1, 0, False, 0, 0, 8,
3, 5.5, 1, 1, 0, 0, "94704", 0, 0, 8, 3, 0, 0)


'get IBC2006 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetIBC2006("EQX", DirFlag, Eccen, PeriodFlag,
IBC2006CtType, UserT, UserZ, TopZ, BottomZ, IBC2006R, IBC2006Omega, IBC2006Cd,
IBC2006I, IBC2006Option, IBC2006Latitude, IBC2006Longitude, IBC2006ZipCode,
IBC2006SS, IBC2006S1, IBC2006TL, IBC2006SiteClass, IBC2006Fa, IBC2006Fv)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetIBC2006

# GetIBC2009

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetIBC2009

## VB6 Procedure

Function GetIBC2009(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double,
ByRef PeriodFlag As Long, ByRef CtType As Long, ByRef UserT As Double, ByRef UserZ As
Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef R As Double, ByRef
Omega As Double, ByRef Cd As Double, ByRef I As Double, ByRef IBC2009Option As Long,
ByRef Latitude As Double, ByRef Longitude As Double, ByRef ZipCode As String, ByRef SS As
Double, ByRef S1 As Double, ByRef TL As Double, ByRef SiteClass As Long, ByRef Fa As
Double, ByRef Fv As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a IBC2009 auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.


```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CtType

This is 0, 1, 2 or 3, indicating the values of Ct and x. This item is meaningful when the PeriodFlag
item is 1 or 2.

```
0 = Ct = 0.028 (ft), x = 0.8
1 = Ct = 0.016 (ft), x = 0.9
2 = Ct = 0.03 (ft), x = 0.75
3 = Ct = 0.02 (ft), x = 0.75
```
UserT

The user specified time period. This item is meaningful when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

R

The response modification factor.

Omega

The system overstrength factor.

Cd

The deflection amplification factor.


### I

The occupancy importance factor.

IBC2009Option

This is 0, 1 or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are
meaningful only when IBC2009Option = 0 or 1.

ZipCode

The zip code for which the seismic coefficients are obtained. This item is meaningful only when
IBC2009Option = 1.

SS, S1

The seismic coefficients Ss and S1.

TL

The long-period transition period. [s]

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
Fa, Fv

The site coefficients Fa and Fv.

## Remarks

This function retrieves auto seismic loading parameters for the 2009 IBC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example


Sub GetSeismicParametersIBC2009()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim CtType As Long
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim R As Double
Dim Omega As Double
Dim Cd As Double
Dim I As Double
Dim IBC2009Option As Long
Dim Latitude As Double
Dim Longitude As Double
Dim ZipCode As String
Dim SS As Double
Dim S1 As Double
Dim TL As Double
Dim SiteClass As Long
Dim Fa As Double
Dim Fv As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign IBC2009 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetIBC2009("EQX", 1, 0.05, 1, 1, 0, False, 0, 0, 8,
3, 5.5, 1, 1, 0, 0, "94704", 0, 0, 8, 3, 0, 0)

'get IBC2009 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetIBC2009("EQX", DirFlag, Eccen, PeriodFlag,
CtType, UserT, UserZ, TopZ, BottomZ, R, Omega, Cd, I, IBC2009Option, Latitude, Longitude,


ZipCode, SS, S1, TL, SiteClass, Fa, Fv)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.0.0.

## See Also

SetIBC2009

# GetIBC2012

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetIBC2012

## VB6 Procedure

Function GetIBC2012(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double,
ByRef PeriodFlag As Long, ByRef CtType As Long, ByRef UserT As Double, ByRef UserZ As
Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef R As Double, ByRef
Omega As Double, ByRef Cd As Double, ByRef I As Double, ByRef IBC2012Option As Long,
ByRef Latitude As Double, ByRef Longitude As Double, ByRef ZipCode As String, ByRef SS As
Double, ByRef S1 As Double, ByRef TL As Double, ByRef SiteClass As Long, ByRef Fa As
Double, ByRef Fv As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a IBC2012 auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.


PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CtType

This is 0, 1, 2 or 3, indicating the values of Ct and x. This item is meaningful when the PeriodFlag
item is 1 or 2.

```
0 = Ct = 0.028 (ft), x = 0.8
1 = Ct = 0.016 (ft), x = 0.9
2 = Ct = 0.03 (ft), x = 0.75
3 = Ct = 0.02 (ft), x = 0.75
```
UserT

The user specified time period. This item is meaningful when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

R

The response modification factor.

Omega

The system overstrength factor.

Cd

The deflection amplification factor.

I

The occupancy importance factor.

IBC2012Option

This is 0, 1 or 2, indicating the seismic coefficient option.


```
0 = Ss and S1 from USGS by latitude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are
meaningful only when IBC2012Option = 0 or 1.

ZipCode

The zip code for which the seismic coefficients are obtained. This item is meaningful only when
IBC2012Option = 1.

SS, S1

The seismic coefficients Ss and S1.

TL

The long-period transition period. [s]

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
Fa, Fv

The site coefficients Fa and Fv.

## Remarks

This function retrieves auto seismic loading parameters for the 2012 IBC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersIBC2012()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double


Dim PeriodFlag As Long
Dim CtType As Long
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim R As Double
Dim Omega As Double
Dim Cd As Double
Dim I As Double
Dim IBC2012Option As Long
Dim Latitude As Double
Dim Longitude As Double
Dim ZipCode As String
Dim SS As Double
Dim S1 As Double
Dim TL As Double
Dim SiteClass As Long
Dim Fa As Double
Dim Fv As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign IBC2012 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetIBC2012("EQX", 1, 0.05, 1, 1, 0, False, 0, 0, 8,
3, 5.5, 1, 1, 0, 0, "94704", 0, 0, 8, 3, 0, 0)

'get IBC2012 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetIBC2012("EQX", DirFlag, Eccen, PeriodFlag,
CtType, UserT, UserZ, TopZ, BottomZ, R, Omega, Cd, I, IBC2012Option, Latitude, Longitude,
ZipCode, SS, S1, TL, SiteClass, Fa, Fv)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 16.0.0.

## See Also

SetIBC2012

# GetIS1893_2002

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetIS1893_2002

## VB6 Procedure

Function GetIS1893_2002(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As
Double, ByRef PeriodFlag As Long, ByRef CT As Double, ByRef UserT As Double, ByRef
UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef INZFlag As
Long, ByRef INZ As Double, ByRef INS As Long, ByRef INI As Double, ByRef INR As
Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with an IS1893_2002 auto seismic load
assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT


The code-specified CT factor (m). This item applies when the PeriodFlag item is 1.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

INZFlag

This is either 1 or 2, indicating if the seismic zone factor is per code or user defined.

```
1 = Per code
2 = User defined
```
INZ

The seismic zone factor, Z.

If the seismic zone factor is per code (INZFlag = 1), this item should be one of the following:
0.10, 0.16, 0.24, 0.36.

INS

This is 1, 2 or 3, indicating the soil type.

```
1 = I
2 = II
3 = III
```
BOCA96R

The response modification factor.

INR

The importance factor.

INR

The response modification factor.


## Remarks

This function retrieves auto seismic loading parameters for the 2002 IS1893 code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersIS18932002()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim CT As Double
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim INZFlag As Long
Dim INZ As Double
Dim INS As Long
Dim INI As Double
Dim INR As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign IS1893_2002 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetIS1893_2002("EQX", 1, 0.05, 1, 0.075, 0,
False, 0, 0, 1, 0.36, 3, 1, 5)

'get IS1893_2002 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetIS1893_2002("EQX", DirFlag, Eccen,


PeriodFlag, CT, UserT, UserZ, TopZ, BottomZ, INZFlag, INZ, INS, INI, INR)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetIS1893_2002

# GetNBCC2015

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetNBCC2015

## VB6 Procedure

Function GetNBCC2015(ByVal Name As String, ByRef DirFlag As Long, ByRef eccen As
Double, ByRef CtType As Long, ByRef PeriodFlag As Long, ByRef UserT As Double, ByRef
UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef PGA As Double,
ByRef S02 As Double, ByRef S05 As Double, ByRef S1 As Double, ByRef S2 As Double, ByRef
S5 As Double, ByRef S10 As Double, ByRef SiteClass As Long, ByRef F02 As Double, ByRef
F05 As Double, ByRef F1 As Double, ByRef F2 As Double, ByRef F5 As Double, ByRef F10 As
Double, ByRef I As Double, ByRef Mv As Double, ByRef Rd As Double, ByRef Ro As Double)
As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a NBCC2015 auto seismic load assignment.

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```

Eccen

The eccentricity ratio that applies to all diaphragms.

CtType

This is 0, 1, 2, 3 or 4, indicating the structure type.

```
0 = Steel moment frame
1 = Concrete moment frame
2 = Other moment frame
3 = Braced frame
4 = Shear wall
```
PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Code
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

PGA

The peak ground acceleration.

S02

The spectral acceleration at a 0.2 second period.

S05

The spectral acceleration at a 0.5 second period.

S1

The spectral acceleration at a 1 second period.


### S2

The spectral acceleration at a 2 second period.

S5

The spectral acceleration at a 5 second period.

S10

The spectral acceleration at a 10 second period.

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
F02

The site coefficient at a 0.2 second period. This item is read when the site class is F only.

F05

The site coefficient at a 0.5 second period. This item is read when the site class is F only.

F1

The site coefficient at a 1 second period. This item is read when the site class is F only.

F2

The site coefficient at a 2 second period. This item is read when the site class is F only.

F5

The site coefficient at a 5 second period. This item is read when the site class is F only.

F10

The site coefficient at a 10 second period. This item is read when the site class is F only.

I

The importance factor.

Mv

The higher mode factor.

Rd


The ductility modifier.

Ro

The overstrength modifier.

## Remarks

This function retrieves auto seismic loading parameters for the 2015 NBCC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersNBCC2015()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim CtType As Long
Dim PeriodFlag As Long
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim PGA As Double
Dim S02 As Double
Dim S05 As Double
Dim S1 As Double
Dim S2 As Double

Dim S5 As Double

Dim S10 As Double
Dim SiteClass As Long
Dim F02 As Double
Dim F05 As Double

Dim F1 As Double

Dim F5 As Double

Dim F10 As Double
Dim I As Double
Dim Mv As Double
Dim Rd As Double
Dim Ro As Double

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NBCC2015 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNBCC2015("EQX", 2, 0.1, 2, 1, 0, False, 0, 0,
0.6, 1.1, 0.7, 0.35, 0.2, 0.03, 0.01, 6, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.5, 1.2, 6, 1.6)

'get NBCC2015 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetNBCC2015("EQX", DirFlag, Eccen, CtType,
PeriodFlag, UserT, UserZ, TopZ, BottomZ, PGA, S02, S05, S1, S2, S5, S10, SiteClass, F02, F05,
F1, F2, F5, F10, I, Mv, Rd, Ro)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

## See Also

SetNBCC2015

# GetNBCC2010

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetNBCC2010


## VB6 Procedure

Function GetNBCC2010(ByVal Name As String, ByRef DirFlag As Long, ByRef eccen As
Double, ByRef CtType As Long, ByRef PeriodFlag As Long, ByRef UserT As Double, ByRef
UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef PGA As Double,
ByRef S02 As Double, ByRef S05 As Double, ByRef S1 As Double, ByRef S2 As Double, ByRef
S4 As Double, ByRef SiteClass As Long, ByRef Fa As Double, ByRef Fv As Double, ByRef I As
Double, ByRef Mv As Double, ByRef Rd As Double, ByRef Ro As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a NBCC2010 auto seismic load assignment.

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

CtType

This is 0, 1, 2, 3 or 4, indicating the structure type.

```
0 = Steel moment frame
1 = Concrete moment frame
2 = Other moment frame
3 = Braced frame
4 = Shear wall
```
PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Code
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

PGA

The peak ground acceleration.

S02

The spectral acceleration at a 0.2 second period.

S05

The spectral acceleration at a 0.5 second period.

S1

The spectral acceleration at a 1 second period.

S2

The spectral acceleration at a 2 second period.

S4

The spectral acceleration at a 4 second period.

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
Fa

The site coefficient, Fa.

Fv

The site coefficient, Fv.

I

The importance factor.


Mv

The higher mode factor.

Rd

The ductility modifier.

Ro

The overstrength modifier.

## Remarks

This function retrieves auto seismic loading parameters for the 2010 NBCC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersNBCC2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim CtType As Long
Dim PeriodFlag As Long
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim PGA As Double
Dim S02 As Double
Dim S05 As Double
Dim S1 As Double
Dim S2 As Double

Dim S4 As Double
Dim SiteClass As Long
Dim Fa As Double
Dim Fv As Double
Dim I As Double
Dim Mv As Double
Dim Rd As Double
Dim Ro As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NBCC2010 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNBCC2010("EQX", 2, 0.1, 2, 1, 0, False, 0, 0,
0.6, 1.1, 0.7, 0.35, 0.2, 0.1, 6, 1.8, 2, 1.5, 1.2, 6, 1.6)

'get NBCC2010 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetNBCC2005("EQX", DirFlag, Eccen,
NBCC2005CtType, CtType, PeriodFlag, UserT, UserZ, TopZ, BottomZ, PGA, S02, S05, S1, S2,
S4, SiteClass, Fa, Fv, I, Mv, Rd, Ro)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

## See Also

SetNBCC2010

# GetNBCC2005

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetNBCC2005

## VB6 Procedure


Function GetNBCC2005(ByVal Name As String, ByRef DirFlag As Long, ByRef eccen As
Double, ByRef NBCC2005CtType As Long, ByRef PeriodFlag As Long, ByRef UserT As
Double, ByRef UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef
NBCC2005PGA As Double, ByRef NBCC2005S02 As Double, ByRef NBCC2005S05 As
Double, ByRef NBCC2005S1 As Double, ByRef NBCC2005S2 As Double, ByRef
NBCC2005SiteClass As Long, ByRef NBCC2005Fa As Double, ByRef NBCC2005Fv As
Double, ByRef NBCC2005I As Double, ByRef NBCC2005Mv As Double, ByRef NBCC2005Rd
As Double, ByRef NBCC2005Ro As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a NBCC2005 auto seismic load assignment.

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

NBCC2005CtType

This is 0, 1, 2, 3 or 4, indicating the structure type.

```
0 = Steel moment frame
1 = Concrete moment frame
2 = Other moment frame
3 = Braced frame
4 = Shear wall
```
NBCC95DS

This item applies only when the NBCCPFlag = 2. It is the dimension of the lateral load resisting
system in the direction of the applied forces. [L]

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Code
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ


This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

NBCC2005PGA

The peak ground acceleration.

NBCC2005S02

The spectral acceleration at a 0.2 second period.

NBCC2005S05

The spectral acceleration at a 0.52 second period.

NBCC2005S1

The spectral acceleration at a 1 second period.

NBCC2005S2

The spectral acceleration at a 2 second period.

NBCC2005SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
NBCC2005Fa

The site coefficient, Fa.

NBCC2005Fv

The site coefficient, Fv.

NBCC2005I

The importance factor.


NBCC2005Mv

The higher mode factor.

NBCC2005Rd

The ductility modifier.

NBCC2005Ro

The overstrength modifier.

## Remarks

This function retrieves auto seismic loading parameters for the 2005 NBCC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersNBCC2005()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim NBCC2005CtType As Long
Dim PeriodFlag As Long
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim NBCC2005PGA As Double
Dim NBCC2005S02 As Double
Dim NBCC2005S05 As Double
Dim NBCC2005S1 As Double
Dim NBCC2005S2 As Double
Dim NBCC2005SiteClass As Long
Dim NBCC2005Fa As Double
Dim NBCC2005Fv As Double
Dim NBCC2005I As Double
Dim NBCC2005Mv As Double
Dim NBCC2005Rd As Double
Dim NBCC2005Ro As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NBCC2005 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNBCC2005("EQX", 2, 0.1, 2, 1, 0, False, 0, 0,
0.6, 1.1, 0.7, 0.35, 0.2, 6, 1.8, 2, 1.5, 1.2, 6, 1.6)

'get NBCC2005 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetNBCC2005("EQX", DirFlag, Eccen,
NBCC2005CtType, PeriodFlag, UserT, UserZ, TopZ, BottomZ, NBCC2005PGA,
NBCC2005S02, NBCC2005S05, NBCC2005S1, NBCC2005S2, NBCC2005SiteClass,
NBCC2005Fa, NBCC2005Fv, NBCC2005I, NBCC2005Mv, NBCC2005Rd, NBCC2005Ro)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetNBCC2005

# GetNBCC95

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetNBCC95

## VB6 Procedure

Function GetNBCC95(ByVal Name As String, ByRef DirFlag As Long, ByRef eccen As Double,
ByRef NBCCPFlag As Long, ByRef NBCC95DS As Double, ByRef PeriodFlag As Long, ByRef
UserT As Double, ByRef UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As
Double, ByRef NBCC95ZA As Long, ByRef NBCC95ZV As Long, ByRef NBCC95ZVFlag As


Long, ByRef NBCC95ZVR As Double, ByRef NBCC95I As Double, ByRef NBCC95F As
Double, ByRef NBCC95R As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a NBCC95 auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

NBCCPFlag

This is either 1 or 2, indicating the structure type.

```
1 = Moment frame
2 = Other
```
NBCC95DS

This item applies only when the NBCCPFlag = 2. It is the dimension of the lateral load resisting
system in the direction of the applied forces. [L]

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Code
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

NBCC95ZA

This is 0, 1, 2, 3, 4, 5 or 6, indicating the acceleration related zone, Za.

NBCC95ZV

This is 0, 1, 2, 3, 4, 5 or 6, indicating the velocity related zone, Zv.

NBCC95ZVFlag

This is either 1 or 2, indicating how the zonal velocity ratio, V, is specified.

```
1 = From code based on Zv
2 = User specified
```
NBCC95ZVR

The zonal velocity ratio, V.

NBCC95I

The importance factor.

NBCC95F

The foundation factor.

NBCC95R

The force modification factor.

## Remarks

This function retrieves auto seismic loading parameters for the 1995 NBCC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersNBCC95()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim NBCCPFlag As Long
Dim NBCC95DS As Double
Dim PeriodFlag As Long


Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim NBCC95ZA As Long
Dim NBCC95ZV As Long
Dim NBCC95ZVFlag As Long
Dim NBCC95ZVR As Double
Dim NBCC95I As Double
Dim NBCC95F As Double
Dim NBCC95R As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NBCC95 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNBCC95("EQX", 1, 0.05, 1, 0, 1, 0, False, 0, 0,
4, 5, 1, 0, 1, 1.3, 4)

'get NBCC95 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetNBCC95("EQX", DirFlag, Eccen,
NBCCPFlag, NBCC95DS, PeriodFlag, UserT, UserZ, TopZ, BottomZ, NBCC95ZA,
NBCC95ZV, NBCC95ZVFlag, NBCC95ZVR, NBCC95I, NBCC95F, NBCC95R)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

SetNBCC95

# GetNEHRP97

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetNEHRP97

## VB6 Procedure

Function GetNEHRP97(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As
Double, ByRef PeriodFlag As Long, ByRef CT As Double, ByRef UserT As Double, ByRef
UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef NEHRP97SG As
Long, ByRef NEHRP97SeismicCoeffFlag As Long, ByRef NEHRP97Site As Long, ByRef
NEHRP97SS As Double, ByRef NEHRP97S1 As Double, ByRef NEHRP97Fa As Double, ByRef
NEHRP97Fv As Double, ByRef NEHRP97R As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a NEHRP97 auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor. This item applies when the PeriodFlag item is 1 or 2.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]


UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

NEHRP97SG

This is 1, 2 or 3, indicating the seismic group.

```
1 = I
2 = II
3 = III
```
NEHRP97SeismicCoeffFlag

This is 1 or 2, indicating the seismic coefficient option.

```
1 = Coefficients are per code
2 = Coefficients are user defined
```
NEHRP97Site

This is 1, 2, 3, 4 or 5, indicating the site class. This item is only filled when the
NEHRP97SeismicCoeffFlag = 1.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
NEHRP97SS

The response acceleration for short periods, (g).

NEHRP97S1

The response acceleration for a one second period, (g).

NEHRP97Fa

The site coefficient Fa.

NEHRP97Fv

The site coefficient Fv.


### NEHRP97R

The response modification factor.

## Remarks

This function retrieves auto seismic loading parameters for the 1997 NEHRP code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersNEHRP97()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim CT As Double
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim NEHRP97SG As Long
Dim NEHRP97SeismicCoeffFlag As Long
Dim NEHRP97Site As Long
Dim NEHRP97SS As Double
Dim NEHRP97S1 As Double
Dim NEHRP97Fa As Double
Dim NEHRP97Fv As Double
Dim NEHRP97R As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)


'assign NEHRP97 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNEHRP97("EQX", 1, 0.05, 1, 0.035, 0, False,
0, 0, 1, 1, 3, 1, 0.4, 0, 0, 8)

'get NEHRP97parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetNEHRP97("EQX", DirFlag, Eccen,
PeriodFlag, CT, UserT, UserZ, TopZ, BottomZ, NEHRP97SG, NEHRP97SeismicCoeffFlag,
NEHRP97Site, NEHRP97SS, NEHRP97S1, NEHRP97Fa, NEHRP97Fv, NEHRP97R)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetNEHRP97

# GetNTC2008

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetNTC2008

## VB6 Procedure

Function GetNTC2008(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As
Double, ByRef PeriodFlag As Long, ByRef C1Type As Long, ByRef UserT As Double, ByRef
UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef ParamsOption As
Long, ByRef Latitude As Double, ByRef Longitude As Double, ByRef Island As Long, ByRef
LimitState As Long, ByRef UsageClass As Long, ByRef NomLife As Double, ByRef PeakAccel
As Double, ByRef F0 As Double, ByRef Tcs As Double, ByRef SpecType As Long, ByRef
SoilType As Long, ByRef Topography As Long, ByRef hRatio As Double, ByRef Damping As
Double, ByRef q As Double, ByRef lambda As Double) As Long

## Parameters

Name


The name of an existing Quake-type load pattern with a NTC 2008 auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CIType

This is 0, 1, 2 or 3, indicating the values of C1. This item applies when the PeriodFlag item is 1 or
2.

```
1 = C1 = 0.085 (m)
2 = C1 = 0.075 (m)
3 = C1 = 0.05 (m)
```
UserT

The user specified time period. This item is meaningful when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

ParamsOption

This is 1, 2, or 3, indicating the option for defining the parameters.

```
1 = by latitude and longitude
2 = by island
3 = user specified
```

Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are
meaningful only when ParamsOption = 1.

Island

This is one of the following values. This item is used only when ParamsOption = 2.

```
1 = Alicudi
2 = Arcipelago Toscano
3 = Filcudi
4 = Isole Egadi
5 = Lampedusa
6 = Linosa
7 = Lipari
8 = Palmarola
9 = Panarea
10 = Pantelleria
11 = Ponza
12 = Salina
13 = Santo Stefano
14 = Sardegna
15 = Stromboli
16 = Tremiti
17 = Ustica
18 = Ventotene
19 = Vulcano
20 = Zannone
```
LimitState

This is 1, 2, 3, or 4, indicating the limit state.

```
1 = SLO
2 = SLD
3 = SLV
4 = SLC
```
UsageClass

This is 1, 2, 3, or 4, indicating the usage class.

```
1 = I
2 = II
3 = III
4 = IV
```
NomLife

The nominal life to be considered.

PeakAccel

The peak ground acceleration, ag/g.


### F0

The magnitude factor, F0.

Tcs

The reference period, Tc* [s].

SpecType

This is 1, 2, 3, or 4, indicating the type of spectrum to consider.

```
1 = Elastic horizontal
2 = Elastic vertical
3 = Design horizontal
4 = Design vertical
```
SoilType

This is 1, 2, 3, 4, or 5, indicating the subsoil type.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
Topography

This is 1, 2, 3, or 4, indicating the topography type.

```
1 = T1
2 = T2
3 = T3
4 = T4
```
hRatio

The ratio for the site altitude at the base of the hill to the height of the hill.

Damping

The damping, in percent. This is only applicable for SpecType 1 and 2.

q

The behavior correction factor. This is only applicable for SpecType 3 and 4.

lambda

A correction factor.

## Remarks


This function retrieves auto seismic loading parameters for the NTC 2008 code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersNTC2008()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim C1Type As Long
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim ParamsOption As Long
Dim Latitude As Double
Dim Longitude As Double
Dim Island As Long
Dim LimitState As Long
Dim UsageClass As Long
Dim NomLife As Double
Dim PeakAccel As Double
Dim F0 As Double
Dim Tcs As Double
Dim SpecType As Long
Dim SoilType As Long
Dim Topography As Long
Dim hRatio As Double
Dim Damping As Double
Dim q As Double
Dim lambda As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)


'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", eLoadPatternType_QUAKE)

'assign NTC2008 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNTC2008("EQX", 1, 0.05, 1, 1, 0, False, 0, 0,
3, 0, 0, 1, 1, 1, 50, 0.2, 2.4, 0.3, 3, 2, 1, 1, 5, 1, 0.85)

'get NTC2008 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetNTC2008("EQX", DirFlag, Eccen, PeriodFlag,
C1Type, UserT, UserZ, TopZ, BottomZ, ParamsOption, Latitude, Longitude, Island, LimitState,
UsageClass, NomLife, PeakAccel, F0, Tcs, SpecType, SoilType, Topography, hRatio, Damping,
q, lambda)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 18.1.0.

## See Also

SetNTC2008

# GetNTC2018

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetNTC2018

## VB6 Procedure

Function GetNTC2018(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As
Double, ByRef PeriodFlag As Long, ByRef UserT As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef ParamsOption As Long, ByRef Latitude As
Double, ByRef Longitude As Double, ByRef Island As Long, ByRef LimitState As Long, ByRef
UsageClass As Long, ByRef NomLife As Double, ByRef PeakAccel As Double, ByRef F0 As
Double, ByRef Tcs As Double, ByRef SpecType As Long, ByRef SoilType As Long, ByRef
Topography As Long, ByRef hRatio As Double, ByRef Damping As Double, ByRef q As Double,
ByRef lambda As Double) As Long

## Parameters

Name


The name of an existing Quake-type load pattern with a NTC 2018 auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item is meaningful when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

ParamsOption

This is 1, 2, or 3, indicating the option for defining the parameters.

```
1 = by latitude and longitude
2 = by island
3 = user specified
```
Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are
meaningful only when ParamsOption = 1.

Island

This is one of the following values. This item is used only when ParamsOption = 2.


```
1 = Alicudi
2 = Arcipelago Toscano
3 = Filcudi
4 = Isole Egadi
5 = Lampedusa
6 = Linosa
7 = Lipari
8 = Palmarola
9 = Panarea
10 = Pantelleria
11 = Ponza
12 = Salina
13 = Santo Stefano
14 = Sardegna
15 = Stromboli
16 = Tremiti
17 = Ustica
18 = Ventotene
19 = Vulcano
20 = Zannone
```
LimitState

This is 1, 2, 3, or 4, indicating the limit state.

```
1 = SLO
2 = SLD
3 = SLV
4 = SLC
```
UsageClass

This is 1, 2, 3, or 4, indicating the usage class.

```
1 = I
2 = II
3 = III
4 = IV
```
NomLife

The nominal life to be considered.

PeakAccel

The peak ground acceleration, ag/g.

F0

The magnitude factor, F0.

Tcs

The reference period, Tc* [s].


SpecType

This is 1, 2, 3, or 4, indicating the type of spectrum to consider.

```
1 = Elastic horizontal
2 = Elastic vertical
3 = Design horizontal
4 = Design vertical
```
SoilType

This is 1, 2, 3, 4, or 5, indicating the subsoil type.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
Topography

This is 1, 2, 3, or 4, indicating the topography type.

```
1 = T1
2 = T2
3 = T3
4 = T4
```
hRatio

The ratio for the site altitude at the base of the hill to the height of the hill.

Damping

The damping, in percent. This is only applicable for SpecType 1 and 2.

q

The behavior correction factor. This is only applicable for SpecType 3 and 4.

lambda

A correction factor.

## Remarks

This function retrieves auto seismic loading parameters for the NTC 2018 code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example


Sub GetSeismicParametersNTC2018()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim ParamsOption As Long
Dim Latitude As Double
Dim Longitude As Double
Dim Island As Long
Dim LimitState As Long
Dim UsageClass As Long
Dim NomLife As Double
Dim PeakAccel As Double
Dim F0 As Double
Dim Tcs As Double
Dim SpecType As Long
Dim SoilType As Long
Dim Topography As Long
Dim hRatio As Double
Dim Damping As Double
Dim q As Double
Dim lambda As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", eLoadPatternType_QUAKE)

'assign NTC2018 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNTC2018("EQX", 1, 0.05, 1, 0, False, 0, 0, 3,
0, 0, 1, 1, 1, 50, 0.2, 2.4, 0.3, 3, 2, 1, 1, 5, 1, 0.85 )

'get NTC2018 parameters


ret = SapModel.LoadPatterns.AutoSeismic.GetNTC2018("EQX", DirFlag, Eccen, PeriodFlag,
UserT, UserZ, TopZ, BottomZ, ParamsOption, Latitude, Longitude, Island, LimitState,
UsageClass, NomLife, PeakAccel, F0, Tcs, SpecType, SoilType, Topography, hRatio, Damping,
q, lambda)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v20.1.0.

## See Also

SetNTC2018

# GetNZS11702004_2

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetNZS11702004_2

## VB6 Procedure

Function GetNZS11702004_2(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As
Double, ByRef PeriodFlag As Long, ByRef UserT As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef NZS2004SiteClass As Long, ByRef
NZS2004Z As Double, ByRef NZS2004R As Double, ByRef NZS2004DIST As Double, ByRef
NZS2004Sp As Double, ByRef NZS2004Mu As Double, ByRef NZS2004ConsiderTSite As
Boolean, ByRef NZS2004TSite As Double, ByRef NZS2004ConsiderSingleStory) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a NZS 1170 2004 auto seismic load
assignment.

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen


The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

NZS2004SiteClass

This is 1, 2, 3, 4 or 5, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
NZS2004Z

The hazard factor, Z.

NZS2004R

The return period factor, R.

NZS2004DIST

Distance to the fault in km, used to calculate the near fault factor..

NZS2004Sp

The structural performance factor, Sp.

NZS2004Mu


The structural ductility factor, u.

NZS2004ConsiderTSite

Indicates whether to consider the site period for the spectral shape factor.

NZS2004TSite

The low amplitude site period.

NZS2004ConsiderSingleStory

Indicates whether to consider the structure as a single story, in which case F t = 0.

## Remarks

This function retrieves auto seismic loading parameters for the NZS 1170 2004 code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersNZS11702004_2()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim NZS2004SiteClass As Long
Dim NZS2004Z As Double
Dim NZS2004R As Double
Dim NZS2004DIST As Double
Dim NZS2004Sp As Double
Dim NZS2004Mu As Double
Dim NZS2004ConsiderTSite As Boolean
Dim NZS2004TSite As Double
Dim NZS2004ConsiderSingleStory As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NZS 1170 2004 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNZS11702004_2("EQX", 2, 0.1, 2, 0, False, 0,
0, 3, 0.4, 1.3, 20, 0.7, 3, True, 1, False)

'get NZS 1170 2004 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetNZS11702004_2("EQX", DirFlag, Eccen,
PeriodFlag, UserT, UserZ, TopZ, BottomZ, NZS2004SiteClass, NZS2004Z, NZS2004R,
NZS2004DIST, NZS2004Sp, NZS2004Mu, NZS2004ConsiderTSite, NZS2004TSite,
NZS2004ConsiderSingleStory)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v22.0.0.

This function supersedes GetNZS11702004_1.

## See Also

SetNZS11702004_2.

# GetUBC94

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetUBC94

## VB6 Procedure

Function GetUBC94(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double,
ByRef PeriodFlag As Long, ByRef CT As Double, ByRef UserT As Double, ByRef UserZ As
Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef UBC94ZFlag As Long,


ByRef UBC94Z As Double, ByRef UBC94S As Double, ByRef UBC94I As Double, ByRef
UBC94RW As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a UBC94 auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor. This item applies when the PeriodFlag item is 1 or 2.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

UBC94ZFlag

This is 1 or 2, indicating if the seismic zone factor is per code or user defined.


```
1 = Per code
2 = User defined
```
UBC94Z

The seismic zone factor, Z.

If the seismic zone factor is per code (UBC94ZFlag = 1), this item should be one of the following:
0.075, 0.15, 0.20, 0.30, 0.40.

UBC94S

This is 1, 1.2, 1.5 or 2, indicating the site coefficient.

UBC94I

The importance factor.

UBC94RW

The numerical coefficient, Rw.

## Remarks

This function retrieves auto seismic loading parameters for the 1994 UBC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersUBC94()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim CT As Double
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim UBC94ZFlag As Long
Dim UBC94Z As Double
Dim UBC94S As Double
Dim UBC94I As Double
Dim UBC94RW As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign UBC94 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetUBC94("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 1, 0.4, 1.2, 1.15, 8)

'get UBC94 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetUBC94("EQX", DirFlag, Eccen, PeriodFlag,
CT, UserT, UserZ, TopZ, BottomZ, UBC94ZFlag, UBC94Z, UBC94S, UBC94I, UBC94RW)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetUBC94

# GetUBC97

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetUBC97


## VB6 Procedure

Function GetUBC97(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double,
ByRef PeriodFlag As Long, ByRef CT As Double, ByRef UserT As Double, ByRef UserZ As
Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef UBC97SeismicCoeffFlag
As Long, ByRef UBC97SoilProfileType As Long, ByRef UBC97Z As Double, ByRef UBC97Ca
As Double, ByRef UBC97Cv As Double, ByRef UBC97NearSourceFlag As Long, ByRef
UBC97SourceType As Long, ByRef UBC97Dist As Double, ByRef UBC97Na As Double, ByRef
UBC97Nv As Double, ByRef UBC97I As Double, ByRef UBC97R As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a UBC97 auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor. This item applies when the PeriodFlag item is 1 or 2.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

UBC97SeismicCoeffFlag

This is either 1 or 2, indicating if the seismic coefficients Ca and Cv are per code or user defined.

```
1 = Per code
2 = User defined
```
UBC97SoilProfileType

This is 1, 2, 3, 4 or 5, indicating the soil profile type.

```
1 = SA
2 = SB
3 = SC
4 = SD
5 = SE
```
This item is applicable only when the seismic coefficients Ca and Cv are calculated per code
(UBC97SeismicCoeffFlag = 1).

UBC97Z

This is 0.075, 0.15, 0.2, 0.3 or 0.4, indicating the seismic zone factor.

This item is applicable only when the seismic coefficients Ca and Cv are calculated in accordance
with code (UBC97SeismicCoeffFlag = 1).

UBC97Ca

The seismic coefficient, Ca.

UBC97Cv

The seismic coefficient, Cv.

UBC97NearSourceFlag

This is 1 or 2, indicating if the near source factor coefficients Na and Nv are per code or user
defined.

```
1 = Per code
2 = User defined
```
This item is applicable only when the seismic coefficients Ca and Cv are calculated per code
(UBC97SeismicCoeffFlag = 1) and UBC97Z = 0.4.

UBC97SourceType

This is 1, 2 or 3, indicating the seismic source type.


### 1 = A

### 2 = B

### 3 = C

This item is applicable only when the seismic coefficients Ca and Cv are calculated per code
(UBC97SeismicCoeffFlag = 1), UBC97Z = 0.4, and the near source factor coefficients Na and Nv
are calculated per code (UBC97NearSourceFlag = 1).

UBC97Dist

This is the distance to the seismic source in kilometers.

This item is only applicable when the seismic coefficients Ca and Cv are calculated per code
(UBC97SeismicCoeffFlag = 1), UBC97Z = 0.4, and the near source factor coefficients Na and Nv
are calculated per code (UBC97NearSourceFlag = 1).

UBC97Na

The near source factor coefficient, Na.

This item is applicable only when the seismic coefficients Ca and Cv are user defined
(UBC97SeismicCoeffFlag = 2).

UBC97Nv

The near source factor coefficient, Nv.

This item is applicable only when the seismic coefficients Ca and Cv are user defined
(UBC97SeismicCoeffFlag = 2).

UBC97I

The importance factor.

UBC97R

The overstrength factor.

## Remarks

This function retrieves auto seismic loading parameters for the 1997 UBC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersUBC97()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim CT As Double
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim UBC97SeismicCoeffFlag As Long
Dim UBC97SoilProfileType As Long
Dim UBC97Z As Double
Dim UBC97Ca As Double
Dim UBC97Cv As Double
Dim UBC97NearSourceFlag As Long
Dim UBC97SourceType As Long
Dim UBC97Dist As Double
Dim UBC97Na As Double
Dim UBC97Nv As Double
Dim UBC97I As Double
Dim UBC97R As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign UBC97 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetUBC97("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 1, 3, 0.4, 0, 0, 1, 3, 5, 0, 0, 1.15, 6)

'get UBC97 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetUBC97("EQX", DirFlag, Eccen, PeriodFlag,
CT, UserT, UserZ, TopZ, BottomZ, UBC97SeismicCoeffFlag, UBC97SoilProfileType, UBC97Z,
UBC97Ca, UBC97Cv, UBC97NearSourceFlag, UBC97SourceType, UBC97Dist, UBC97Na,
UBC97Nv, UBC97I, UBC97R)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetUBC97

# GetUBC97Iso

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetUBC97Iso

## VB6 Procedure

Function GetUBC97Iso(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As
Double, ByRef UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef
UBC97IsoSeismicCoeffFlag As Long, ByRef UBC97IsoSoilProfileType As Long, ByRef
UBC97IsoZ As Double, ByRef UBC97IsoCv As Double, ByRef UBC97IsoNearSourceFlag As
Long, ByRef UBC97IsoSourceType As Long, ByRef UBC97IsoDist As Double, ByRef
UBC97IsoNv As Double, ByRef UBC97IsoRI As Double, ByRef UBC97IsoBD As Double,
ByRef UBC97IsoKDmax As Double, ByRef UBC97IsoKDmin As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a UBC97Iso auto seismic load assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

UserZ


This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

UBC97IsoSeismicCoeffFlag

This is either 1 or 2, indicating if the seismic coefficient Cv is per code or user defined.

```
1 = Per code
2 = User defined
```
UBC97IsoSoilProfileType

This is 1, 2, 3, 4 or 5, indicating the soil profile type.

```
1 = SA
2 = SB
3 = SC
4 = SD
5 = SE
```
This item is applicable only when the seismic coefficients Ca and Cv are calculated per code
(UBC97SeismicCoeffFlag = 1).

UBC97IsoZ

This is 0.075, 0.15, 0.2, 0.3 or 0.4, indicating the seismic zone factor.

This item is applicable only when the seismic coefficient Cv is calculated per code
(UBC97IsoSeismicCoeffFlag = 1).

UBC97IsoCv

The seismic coefficient, Cv.

UBC97IsoNearSourceFlag

This is either 1 or 2, indicating if the near source factor coefficient Nv is per code or user defined.

```
1 = Per code
2 = User defined
```
This item is applicable only when the seismic coefficient Cv is calculated per code
(UBC97IsoSeismicCoeffFlag = 1) and UBC97IsoZ = 0.4.


UBC97IsoSourceType

This is 1, 2 or 3, indicating the seismic source type.

```
1 = A
2 = B
3 = C
```
This item is applicable only when the seismic coefficient Cv is calculated per code
(UBC97IsoSeismicCoeffFlag = 1), UBC97IsoZ = 0.4, and the near source factor coefficient Nv is
calculated per code (UBC97IsoNearSourceFlag = 1).

UBC97IsoDist

This is the distance to the seismic source in kilometers.

This item is applicable only when the seismic coefficient Cv is calculated per code
(UBC97IsoSeismicCoeffFlag = 1), UBC97IsoZ = 0.4, and the near source factor coefficient Nv is
calculated per code (UBC97IsoNearSourceFlag = 1).

UBC97IsoNv

The near source factor coefficient, Nv.

This item is applicable only when the seismic coefficient Cv is user defined
(UBC97IsoSeismicCoeffFlag = 2).

UBC97IsoRI

The overstrength factor, Ri.

UBC97IsoBD

The coefficient for damping.

UBC97IsoKDmax

The maximum effective stiffness of the isolation system. [F/L]

UBC97IsoKDmin

The minimum effective stiffness of the isolation system. [F/L]

## Remarks

This function retrieves auto seismic loading parameters for seismically isolated buildings using the
1997 UBC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example


Sub GetSeismicParametersUBC97Iso()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim PeriodFlag As Long
Dim CT As Double
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim UBC97IsoSeismicCoeffFlag As Long
Dim UBC97IsoSoilProfileType As Long
Dim UBC97IsoZ As Double
Dim UBC97IsoCv As Double
Dim UBC97IsoNearSourceFlag As Long
Dim UBC97IsoSourceType As Long
Dim UBC97IsoDist As Double
Dim UBC97IsoNv As Double
Dim UBC97IsoRI As Double
Dim UBC97IsoBD As Double
Dim UBC97IsoKDmax As Double
Dim UBC97IsoKDmin As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign UBC97Iso parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetUBC97Iso("EQX", 1, 0.05, False, 0, 0, 1, 3,
0.4, 0, 1, 3, 5, 0, 2, 1.25, 200, 150)

'get UBC97Iso parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetUBC97Iso("EQX", DirFlag, Eccen, UserZ,
TopZ, BottomZ, UBC97IsoSeismicCoeffFlag, UBC97IsoSoilProfileType, UBC97IsoZ,
UBC97IsoCv, UBC97IsoNearSourceFlag, UBC97IsoSourceType, UBC97IsoDist, UBC97IsoNv,
UBC97IsoRI, UBC97IsoBD, UBC97IsoKDmax, UBC97IsoKDmin)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetUBC97Iso

# GetUserCoefficient

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetBOCA96

## VB6 Procedure

Function GetBOCA96(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double,
ByRef UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef c As
Double, ByRef k As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a User Coefficient auto seismic load
assignment.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

UserZ


This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

c

The base shear coefficient.

k

The building height exponent.

## Remarks

This function retrieves auto seismic loading parameters for User Coefficient type loading.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicParametersUserCoefficient()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DirFlag As Long
Dim Eccen As Double
Dim UserT As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim c As Double
Dim k As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign user coefficient parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetUserCoefficient("EQX", 1, 0.06, False, 0, 0,
0.15, 1.3)

'get user coefficient parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetUserCoefficient("EQX", DirFlag, Eccen,
UserZ, TopZ, BottomZ, c, k)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetUserCoefficient

# GetUserLoad

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.GetUserLoad

## VB6 Procedure

Function GetUserLoad(ByVal Name As String, ByRef MyType As Long, ByRef Eccen As
Double, ByRef Num As Long, ByRef Diaph() As String, ByRef Fx() As Double, ByRef Fy() As
Double, ByRef Mz() As Double, ByRef x() As Double, ByRef y() As Double) As Long

## Parameters


Name

The name of an existing Quake-type load pattern which has been assigned a User Load auto
seismic type.

MyType

This is either 1 or 2, indicating the application point type for the user load.

```
1 = User specified application point
2 = At center of mass with optional additional eccentricity
```
Eccen

The eccentricity ratio that applies to all diaphragms. This item is only applicable when MyType =
2.

Num

The number of diaphragms that can be loaded by the auto seismic load.

Diaph

This is an array that includes the names of the diaphragms that can be loaded by the auto seismic
load.

Fx

This is an array that includes the global X direction force assigned to each diaphragm. [F]

Fy

This is an array that includes the global Y direction force assigned to each diaphragm. [F]

Mz

This is an array that includes the moment about the global Z axis for each diaphragm. [FL]

x

This is an array that includes the global X-coordinate of the point where the seismic force is
applied to each diaphragm. [L]

This item is applicable only when MyType = 1.

y

This is an array that includes the global Y-coordinate of the point where the seismic force is
applied to each diaphragm. [L]

This item is applicable only when MyType = 1.

## Remarks

This function retrieves auto seismic loading parameters for User Load type auto seismic loads.


The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSeismicUserLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As Long
Dim Eccen As Double
Dim Num As Long
Dim Diaph() As String
Dim Fx() As Double
Dim Fy() As Double
Dim Mz() As Double
Dim x() As Double
Dim y() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'set to auto seismic user load


ret = SapModel.LoadPatterns.AutoSeismic.SetUserLoad("EQX", 1)

'set to auto seismic user load values
ret = SapModel.LoadPatterns.AutoSeismic.SetUserLoadValue("EQX", "Diaph1", 20, 4, 1000,
0, 0)
ret = SapModel.LoadPatterns.AutoSeismic.SetUserLoadValue("EQX", "Diaph2", 40, 8, 2000,
0, 0)

'get auto seismic user load parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetUserLoad("EQX", MyType, Eccen, Num,
Diaph, Fx, Fy, Mz, x, y)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetUserLoad

SetUserLoadValue

# SetASCE716_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetASCE716

## VB6 Procedure

Function SetASCE716_1(ByVal Name As String, ByRef nDir() As Boolean, ByRef Eccen As
Double, ByRef PeriodFlag As Long, ByRef CtType As Long, ByRef UserT As Double, ByRef
UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef R As Double,
ByRef Omega As Double, ByRef Cd As Double, ByRef I As Double, ByRef Ss As Double,
ByRef S1 As Double, ByRef TL As Double, ByRef SiteClass As Long, ByRef Fa As Double,
ByRef Fv As Double) As Long

## Parameters


Name

The name of an existing Quake-type load pattern.

nDir

This is an array with 2 inputs that indicate the seismic load direction.

```
nDir(1) = True = Global X
nDir(2) = True = Global Y
```
If nDir(1) and nDir(2) are both True or False, the default direction in Global X will be assigned.

Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CtType

This is 0, 1, 2 or 3, indicating the values of Ct and x. This item applies when the PeriodFlag item
is 1 or 2.

```
0 = Ct = 0.028 (ft), x = 0.8
1 = Ct = 0.016 (ft), x = 0.9
2 = Ct = 0.03 (ft), x = 0.75
3 = Ct = 0.02 (ft), x = 0.75
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

R


The response modification factor.

Omega

The system overstrength factor.

Cd

The deflection amplification factor.

I

The occupancy importance factor.

SS, S1

The seismic coefficients Ss and S1. This item is used only when ASCE716Option = 2.

TL

The long-period transition period. [s]

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
Fa, Fv

The site coefficients Fa and Fv. These items are used only when ASCE716SiteClass is 5 or 6.

## Remarks

This function assigns auto seismic loading parameters for the 2016 ASCE 7 code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicASCE716_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim nDir() As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(e3DFrameType.BeamSlab, 2, 144, 3, 336, 2, 432 )

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", eLoadPatternType.Quake)

'dimension ASCE716 parameters

Dim nDir() As Boolean

Dim Eccen As Double

Dim PeriodFlag As Long

Dim CtType As Long

Dim UserT As Double

Dim UserZ As Boolean

Dim TopZ As Double

Dim BottomZ As Double

Dim R As Double

Dim Omega As Double

Dim Cd As Double

Dim I As Double

Dim SS As Double

Dim S1 As Double

Dim TL As Double


Dim SiteClass As Long

Dim Fa As Double

Dim Fv As Double

ReDim nDir(1)

nDir(0) = True

TopZ = 32

BottomZ = 14

'set ASCE716 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetASCE716_1("EQX", nDir, 0.04, 3, 1, 1.76,
True, TopZ, BottomZ, 6, 3.5, 6.5, 1.5, 1.9, 1.1, 8, 3, 0, 0)

'get ASCE716 parameters
ret = SapModel.LoadPatterns.AutoSeismic.GetASCE716_1("EQX", nDir, Eccen, PeriodFlag,
CtType, UserT, UserZ, TopZ, BottomZ, R, Omega, Cd, I, SS, S1, TL, SiteClass, Fa, Fv)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.2.0.

This function replaced the obsolete function SetASCE16.

## See Also

GetASCE716_1

# SetAS11702007

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetAS11702007


## VB6 Procedure

Function SetAS11702007(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As
Double, ByVal PeriodFlag As Long, ByVal CT As Double, ByVal UserT As Double, ByVal
UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal AS2007SiteClass
As Long, ByVal AS2007kp As Double, ByVal AS2007Z As Double, ByVal AS2007Sp As
Double, ByVal AS2007Mu As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified kt factor. This item applies when the PeriodFlag item is 1.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

AS2007SiteClass

This is 1, 2, 3, 4 or 5, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
AS2007kp

The probability factor, kp.

AS2007Z

The hazard factor, Z.

AS2007Sp

The structural performance factor, Sp.

AS2007Mu

The structural ductility factor, u.

## Remarks

This function assigns auto seismic loading parameters for the AS 1170.4 2007 code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicAS11702007()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign AS 1170 2007 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetAS11702007("EQX", 2, 0.1, 2, 0.075, 0, False,
0, 0, 3, 1.3, 0.09, 0.77, 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

## See Also

GetAS11702007

# SetBOCA96

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetBOCA96

## VB6 Procedure

Function SetBOCA96(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double,
ByVal PeriodFlag As Long, ByVal CT As Double, ByVal UserT As Double, ByVal UserZ As
Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal BOCA96Aa As Double,
ByVal BOCA96Av As Double, ByVal BOCA96S As Double, ByVal BOCA96R As Double) As
Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag


This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor. This item applies when the PeriodFlag item is 1 or 2.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

BOCA96Aa

The effective peak acceleration coefficient.

BOCA96Av

The effective peak velocity-related coefficient.

BOCA96S

This is 1, 1.2, 1.5 or 2, indicating the site coefficient.

BOCA96R

The response modification factor.


## Remarks

This function assigns auto seismic loading parameters for the 1996 BOCA code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicBOCA96()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign BOCA96 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetBOCA96("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 0.4, 0.4, 1.5, 8)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetBOCA96

# SetChinese2010

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetChinese2010

## VB6 Procedure

Function SetChinese2010(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As
Double, ByVal PeriodFlag As Long, ByVal UserT As Double, ByVal UserZ As Boolean, ByVal
TopZ As Double, ByVal BottomZ As Double, ByVal JGJ32010AlphaMax As Double, ByVal
JGJ32010SI As Long, ByVal JGJ32010DampRatio As Double, ByVal JGJ32010Tg As Double,
ByVal JGJ32010PTDF As Double, ByVal EnhancementFactor As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is 1, 2 or 3, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
3 = Global Z
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is either 2 or 3, indicating the time period option.

```
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.


TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

JGJ32010AlphaMax

The maximum influence factor.

JGJ32010SI

This is 1, 2, 3, 4, 5 or 6, indicating the seismic intensity.

```
1 = 6 (0.05g)
2 = 7 (0.10g)
3 = 7 (0.15g)
4 = 8 (0.20g)
5 = 8 (0.30g)
6 = 9 (0.40g)
```
JGJ32010DampRatio

The damping ratio.

JGJ32010Tg

The characteristic ground period. [s]

JGJ32010PTDF

The period time discount factor.

EnhancementFactor

The enhancement factor.

## Remarks

This function assigns auto seismic loading parameters for the Chinese 2010 code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicChinese2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign Chinese 2010 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetChinese2010("EQX", 1, 0.05, 2, 0, False, 0, 0,
0.16, 4, 0.06, 0.4, 1, 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.2.

## See Also

GetChinese2010

# SetDiaphragmEccentricityOverride

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetDiaphragmEccentricityOverride

## VB6 Procedure

Function SetDiaphragmEccentricityOverride(ByVal Name As String, ByVal Diaph As String,
ByVal Eccen As Double, Optional ByVal Delete As Boolean = False) As Long


## Parameters

Name

The name of an existing Quake-type load pattern that has an auto seismic load assigned.

Diaph

The name of an existing special rigid diaphragm constraint, that is, a diaphragm constraint with
the following features:

1. The constraint type is CONSTRAINT_DIAPHRAGM = 2.
2. The constraint coordinate system is Global.
3. The constraint axis is Z.

Eccen

The eccentricity applied to the specified diaphragm. [L]

Delete

If this item is True, the eccentricity override for the specified diaphragm is deleted.

## Remarks

This function assigns diaphragm eccentricity overrides for auto seismic loads. This function does
not apply for User Load type auto seismic loads.

The function returns zero if the overrides are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignSeismicDiaphragmEccentricityOverride()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign BOCA96 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetBOCA96("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 0.4, 0.4, 1.5, 8)

'assign diaphragm eccentricity override
ret = SapModel.LoadPatterns.AutoSeismic.SetDiaphragmEccentricityOverride("EQX",
"Diaph1", 50)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Modified optional argument Delete to be ByVal in version 12.0.1.

## See Also

GetDiaphragmEccentricityOverride

GetSpecialRigidDiaphragmList


# SetEurocode82004_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetEurocode82004_1

## VB6 Procedure

Function SetEurocode82004_1(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As
Double, ByVal PeriodFlag As Long, ByVal CT As Double, ByVal UserT As Double, ByVal
UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal
EURO2004Country As Long, ByVal EURO2004SpectrumType As Long, ByVal
EURO2004GroundType As Long, ByVal EURO2004ag As Double, ByVal EURO2004S As
Double, ByVal EURO2004Tb As Double, ByVal EURO2004Tc As Double, ByVal
EURO2004Td As Double, ByVal EURO2004Beta As Double, ByVal EURO2004q As Double,
ByVal EURO2004Lambda As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
```
```
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
```
```
2 = Program calculated
```
```
3 = User defined
```
CT

The code-specified Ct factor. This item applies when the PeriodFlag item is 1.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3.[s]


UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

EURO2004Country

This is 0, 1, 5, 6, or 10 indicating the country for which the Nationally Determined Parameters
(NDPs) are specified.

```
0 = Other (NDPs are user specified)
```
```
1 = CEN Default
```
```
5 = Norway
```
```
6 = Singapore
10 = Portugal
```
EURO2004SpectrumType

This is 1 or 2, indicating the spectrum type.

```
1 = Type 1
```
```
2 = Type 2 (Does not apply when EURO2004Country = 6)
```
EURO2004GroundType

This is 1, 2, 3, 4, 5, or 6, indicating the ground type.

```
1 = A (Does not apply when EURO2004Country = 6)
```
```
2 = B (Does not apply when EURO2004Country = 6)
```
```
3 = C
```
```
4 = D
```
```
5 = E (Does not apply when EURO2004Country = 6)
```
```
6 = S1 (Only applies when EURO2004Country = 6)
```

EURO2004ag

The design ground acceleration in g, ag.

EURO2004S

The soil factor, S. If the EURO2004Country item is not 0, the input value for this item is ignored.

EURO2004Tb

The lower limit of period of the constant spectral acceleration branch, Tb. If the
EURO2004Country item is not 0, the input value for this item is ignored.

EURO2004Tc

The upper limit of period of the constant spectral acceleration branch, Tc. If the
EURO2004Country item is not 0, the input value for this item is ignored.

EURO2004Td

The period defining the start of the constant displacement range, Td. If the EURO2004Country
item is not 0, the input value for this item is ignored.

EURO2004Beta

The lower bound factor, Beta. If the EURO2004Country item is not 0, the input value for this item
is ignored.

EURO2004q

The behavior factor, q.

EURO2004Lambda

The correction factor, Lambda.

## Remarks

This function assigns auto seismic loading parameters for the Eurocode 8 2004 code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicEurocode82004()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign Eurocode 8 2004 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetEurocode82004_1("EQX", 2, 0.1, 2, 0.075, 0,
False, 0, 0, 1, 1, 2, 0.4, 1, 1, 1, 1, 0.2, 2, 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.1.0.

This function supersedes SetEurocode82004.

Added Portugal as a Country parameter in SAP2000 Version 15.0.0 and CSiBridge Version
15.1.0.

Added Singapore as a Country parameter in v20.1.0.

## See Also

GetEurocode82004_1

# SetIBC2003

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetIBC2003

## VB6 Procedure

Function SetIBC2003(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double,
ByVal PeriodFlag As Long, ByVal CT As Double, ByVal UserT As Double, ByVal UserZ As


Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal IBC2003SG As Long,
ByVal IBC2003SeismicCoeffFlag As Long, ByVal IBC2003Site As Long, ByVal IBC2003SS As
Double, ByVal IBC2003S1 As Double, ByVal IBC2003Fa As Double, ByVal IBC2003Fv As
Double, ByVal IBC2003R As Double, ByVal IBC2003Omega As Double, ByVal IBC2003Cd As
Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor (ft). This item applies when the PeriodFlag item is 1 or 2.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

IBC2003SG


This is 1, 2 or 3, indicating the seismic group.

```
1 = I
2 = II
3 = III
```
IBC2003SeismicCoeffFlag

This is either 1 or 2, indicating the seismic coefficient option.

```
1 = Coefficients are per code
2 = Coefficients are user defined
```
IBC2003Site

This is 1, 2, 3, 4 or 5, indicating the site class. This item is only used when the
IBC2003SeismicCoeffFlag = 1.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
IBC2003SS

The response acceleration for short periods, (g).

IBC2003S1

The response acceleration for a one second period, (g).

IBC2003Fa

The site coefficient Fa. This item is used only when the IBC2003SeismicCoeffFlag = 2.

IBC2003Fv

The site coefficient Fv. This item is used only when the IBC2003SeismicCoeffFlag = 2

IBC2003R

The response modification factor.

IBC2003Omega

The system overstrength factor.

IBC2003Cd

The deflection amplification factor.

## Remarks

This function assigns auto seismic loading parameters for the 2003 IBC code.


The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicIBC2003()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign IBC2003 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetIBC2003("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 1, 1, 3, 1, 0.4, 0, 0, 8, 3, 5.5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetIBC2003


# SetIBC2006

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetIBC2006

## VB6 Procedure

Function SetIBC2006(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double,
ByVal PeriodFlag As Long, ByVal IBC2006CtType As Long, ByVal UserT As Double, ByVal
UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal IBC2006R As
Double, ByVal IBC2006Omega As Double, ByVal IBC2006Cd As Double, ByVal IBC2006I As
Double, ByVal IBC2006Option As Long, ByVal IBC2006Latitude As Double, ByVal
IBC2006Longitude As Double, ByVal IBC2006ZipCode As String, ByVal IBC2006SS As
Double, ByVal IBC2006S1 As Double, ByVal IBC2006TL As Double, ByVal IBC2006SiteClass
As Long, ByVal IBC2006Fa As Double, ByVal IBC2006Fv As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
IBC2006CtType

This is 0, 1, 2 or 3, indicating the values of Ct and x. This item applies when the PeriodFlag item
is 1 or 2.

```
0 = Ct = 0.028 (ft), x = 0.8
1 = Ct = 0.016 (ft), x = 0.9
2 = Ct = 0.03 (ft), x = 0.75
3 = Ct = 0.02 (ft), x = 0.75
```

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

IBC2006R

The response modification factor.

IBC2006Omega

The system overstrength factor.

IBC2006Cd

The deflection amplification factor.

IBC2006I

The occupancy importance factor.

IBC2006Option

This is 0, 1 or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
IBC2006Latitude, IBC2006Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are used
only when IBC2006Option = 0.

IBC2006ZipCode

The zip code for which the seismic coefficients are obtained. This item is used only when
IBC2006Option = 1.

IBC2006SS, IBC2006S1

The seismic coefficients Ss and S1. This item is used only when IBC2006Option = 2.


### IBC2006TL

The long-period transition period. [s]

IBC2006SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
IBC2006Fa, IBC2006Fv

The site coefficients Fa and Fv. These items are used only when IBC2006SiteClass= 6.

## Remarks

This function assigns auto seismic loading parameters for the 2006 IBC code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicIBC2006()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)


'assign IBC2006 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetIBC2006("EQX", 1, 0.05, 1, 1, 0, False, 0, 0, 8,
3, 5.5, 1, 1, 0, 0, "94704", 0, 0, 8, 3, 0, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetIBC2006

# SetIBC2009

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetIBC2009

## VB6 Procedure

Function SetIBC2009(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double,
ByVal PeriodFlag As Long, ByVal CtType As Long, ByVal UserT As Double, ByVal UserZ As
Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal R As Double, ByVal
Omega As Double, ByVal Cd As Double, ByVal I As Double, ByVal IBC2009Option As Long,
ByVal Latitude As Double, ByVal Longitude As Double, ByVal ZipCode As String, ByVal SS As
Double, ByVal S1 As Double, ByVal TL As Double, ByVal SiteClass As Long, ByVal Fa As
Double, ByVal Fv As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```

Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CtType

This is 0, 1, 2 or 3, indicating the values of Ct and x. This item applies when the PeriodFlag item
is 1 or 2.

```
0 = Ct = 0.028 (ft), x = 0.8
1 = Ct = 0.016 (ft), x = 0.9
2 = Ct = 0.03 (ft), x = 0.75
3 = Ct = 0.02 (ft), x = 0.75
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

R

The response modification factor.

Omega

The system overstrength factor.

Cd

The deflection amplification factor.

I

The occupancy importance factor.


IBC2009Option

This is 0, 1 or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are used
only when IBC2009Option = 0.

ZipCode

The zip code for which the seismic coefficients are obtained. This item is used only when
IBC2009Option = 1.

SS, S1

The seismic coefficients Ss and S1. This item is used only when IBC2009Option = 2.

TL

The long-period transition period. [s]

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
Fa, Fv

The site coefficients Fa and Fv. These items are used only when IBC2009SiteClass= 6.

## Remarks

This function assigns auto seismic loading parameters for the 2009 IBC code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicIBC2009()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign IBC2009 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetIBC2009("EQX", 1, 0.05, 1, 1, 0, False, 0, 0, 8,
3, 5.5, 1, 1, 0, 0, "94704", 0, 0, 8, 3, 0, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.0.0.

## See Also

GetIBC2009

# SetIBC2012

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetIBC2012

## VB6 Procedure

Function SetIBC2012(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double,
ByVal PeriodFlag As Long, ByVal CtType As Long, ByVal UserT As Double, ByVal UserZ As


Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal R As Double, ByVal
Omega As Double, ByVal Cd As Double, ByVal I As Double, ByVal IBC2012Option As Long,
ByVal Latitude As Double, ByVal Longitude As Double, ByVal ZipCode As String, ByVal SS As
Double, ByVal S1 As Double, ByVal TL As Double, ByVal SiteClass As Long, ByVal Fa As
Double, ByVal Fv As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CtType

This is 0, 1, 2 or 3, indicating the values of Ct and x. This item applies when the PeriodFlag item
is 1 or 2.

```
0 = Ct = 0.028 (ft), x = 0.8
1 = Ct = 0.016 (ft), x = 0.9
2 = Ct = 0.03 (ft), x = 0.75
3 = Ct = 0.02 (ft), x = 0.75
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]


BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

R

The response modification factor.

Omega

The system overstrength factor.

Cd

The deflection amplification factor.

I

The occupancy importance factor.

IBC2012Option

This is 0, 1 or 2, indicating the seismic coefficient option.

```
0 = Ss and S1 from USGS by latitude and longitude
1 = Ss and S1 from USGS by zip code
2 = Ss and S1 are user defined
```
Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are used
only when IBC2012Option = 0.

ZipCode

The zip code for which the seismic coefficients are obtained. This item is used only when
IBC2012Option = 1.

SS, S1

The seismic coefficients Ss and S1. This item is used only when IBC2012Option = 2.

TL

The long-period transition period. [s]

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```

### 6 = F

Fa, Fv

The site coefficients Fa and Fv. These items are used only when IBC2012SiteClass= 6.

## Remarks

This function assigns auto seismic loading parameters for the 2012 IBC code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicIBC2012()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign IBC2012 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetIBC2012("EQX", 1, 0.05, 1, 1, 0, False, 0, 0, 8,
3, 5.5, 1, 1, 0, 0, "94704", 0, 0, 8, 3, 0, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 16.0.0.

## See Also

GetIBC2012

# SetIS1893_2002

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetIS1893_2002

## VB6 Procedure

Function SetIS1893_2002(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As
Double, ByVal PeriodFlag As Long, ByVal CT As Double, ByVal UserT As Double, ByVal
UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal INZFlag As
Long, ByVal INZ As Double, ByVal INS As Long, ByVal INI As Double, ByVal INR As
Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor (m). This item applies when the PeriodFlag item is 1.

UserT


The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

INZFlag

This is either 1 or 2, indicating if the seismic zone factor is per code or user defined.

```
1 = Per code
2 = User defined
```
INZ

The seismic zone factor, Z.

If the seismic zone factor is per code (INZFlag = 1), this item should be one of the following:
0.10, 0.16, 0.24, 0.36.

INS

This is 1, 2 or 3, indicating the soil type.

```
1 = I
2 = II
3 = III
```
BOCA96R

The response modification factor.

INR

The importance factor.

INR

The response modification factor.

## Remarks

This function assigns auto seismic loading parameters for the 2002 IS1893 code.


The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicIS18932002()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign IS1893_2002 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetIS1893_2002("EQX", 1, 0.05, 1, 0.075, 0,
False, 0, 0, 1, 0.36, 3, 1, 5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetIS1893_2002


# SetNBCC2015

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetNBCC2015

## VB6 Procedure

Function SetNBCC2015(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As
Double, ByVal CtType As Long, ByVal PeriodFlag As Long, ByVal UserT As Double, ByVal
UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal PGA As Double,
ByVal S02 As Double, ByVal S05 As Double, ByVal S1 As Double, ByVal S2 As Double, ByVal
S5 As Double, ByVal S10 As Double, ByVal SiteClass As Long, ByVal F02 As Double, ByVal
F05 As Double, ByVal F1 As Double, ByVal F2 As Double, ByVal F5 As Double, ByVal F10 As
Double, ByVal I As Double, ByVal Mv As Double, ByVal Rd As Double, ByVal Ro As Double)
As Long

## Parameters

Name

The name of an existing Quake-type load pattern

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

CtType

This is 0, 1, 2, 3 or 4, indicating the structure type.

```
0 = Steel moment frame
1 = Concrete moment frame
2 = Other moment frame
3 = Braced frame
4 = Shear wall
```
PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Code
2 = Program calculated
3 = User defined
```

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

PGA

The peak ground acceleration.

S02

The spectral acceleration at a 0.2 second period.

S05

The spectral acceleration at a 0.5 second period.

S1

The spectral acceleration at a 1 second period.

S2

The spectral acceleration at a 2 second period.

S5

The spectral acceleration at a 5 second period.

S10

The spectral acceleration at a 10 second period.

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```

### 6 = F

### F02

The site coefficient at a 0.2 second period. This item is read when the site class is F only.

F05

The site coefficient at a 0.5 second period. This item is read when the site class is F only.

F1

The site coefficient at a 1 second period. This item is read when the site class is F only.

F2

The site coefficient at a 2 second period. This item is read when the site class is F only.

F5

The site coefficient at a 5 second period. This item is read when the site class is F only.

F10

The site coefficient at a 10 second period. This item is read when the site class is F only.

I

The importance factor.

Mv

The higher mode factor.

Rd

The ductility modifier.

Ro

The overstrength modifier.

## Remarks

This function retrieves auto seismic loading parameters for the 2015 NBCC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicNBCC2015()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NBCC2015 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNBCC2015("EQX", 2, 0.1, 2, 1, 0, False, 0, 0,
0.6, 1.1, 0.7, 0.35, 0.2, 0.03, 0.01, 6, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.5, 1.2, 6, 1.6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

## See Also

GetNBCC2015

# SetNBCC2010

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetNBCC2010


## VB6 Procedure

Function SetNBCC2010(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As
Double, ByVal CtType As Long, ByVal PeriodFlag As Long, ByVal UserT As Double, ByVal
UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal PGA As Double,
ByVal S02 As Double, ByVal S05 As Double, ByVal S1 As Double, ByVal S2 As Double, ByVal
S4 As Double, ByVal SiteClass As Long, ByVal Fa As Double, ByVal Fv As Double, ByVal I As
Double, ByVal Mv As Double, ByVal Rd As Double, ByVal Ro As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern with a NBCC2010 auto seismic load assignment.

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

CtType

This is 0, 1, 2, 3 or 4, indicating the structure type.

```
0 = Steel moment frame
1 = Concrete moment frame
2 = Other moment frame
3 = Braced frame
4 = Shear wall
```
PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Code
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

PGA

The peak ground acceleration.

S02

The spectral acceleration at a 0.2 second period.

S05

The spectral acceleration at a 0.5 second period.

S1

The spectral acceleration at a 1 second period.

S2

The spectral acceleration at a 2 second period.

S4

The spectral acceleration at a 4 second period.

SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
Fa

The site coefficient, Fa. This item is read when the site class is F only.

Fv

The site coefficient, Fv. This item is read when the site class is F only.

I

The importance factor.


Mv

The higher mode factor.

Rd

The ductility modifier.

Ro

The overstrength modifier.

## Remarks

This function retrieves auto seismic loading parameters for the 2010 NBCC code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicNBCC2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NBCC2010 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNBCC2010("EQX", 2, 0.1, 2, 1, 0, False, 0, 0,
0.6, 1.1, 0.7, 0.35, 0.2, 0.1, 6, 1.8, 2, 1.5, 1.2, 6, 1.6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

## See Also

GetNBCC2010

# SetNBCC2005

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetNBCC2005

## VB6 Procedure

Function SetNBCC2005(ByVal Name As String, ByVal DirFlag As Long, ByVal eccen As
Double, ByVal NBCC2005CtType As Long, ByVal PeriodFlag As Long, ByVal UserT As
Double, ByVal UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal
NBCC2005PGA As Double, ByVal NBCC2005S02 As Double, ByVal NBCC2005S05 As
Double, ByVal NBCC2005S1 As Double, ByVal NBCC2005S2 As Double, ByVal
NBCC2005SiteClass As Long, ByVal NBCC2005Fa As Double, ByVal NBCC2005Fv As
Double, ByVal NBCC2005I As Double, ByVal NBCC2005Mv As Double, ByVal NBCC2005Rd
As Double, ByVal NBCC2005Ro As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.


NBCC2005CtType

This is 0, 1, 2, 3 or 4, indicating the structure type.

```
0 = Steel moment frame
1 = Concrete moment frame
2 = Other moment frame
3 = Braced frame
4 = Shear wall
```
NBCC95DS

This item applies only when the NBCCPFlag = 2. It is the dimension of the lateral load resisting
system in the direction of the applied forces. [L]

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Code
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

NBCC2005PGA

The peak ground acceleration.

NBCC2005S02

The spectral acceleration at a 0.2 second period.

NBCC2005S05

The spectral acceleration at a 0.52 second period.

NBCC2005S1


The spectral acceleration at a 1 second period.

NBCC2005S2

The spectral acceleration at a 2 second period.

NBCC2005SiteClass

This is 1, 2, 3, 4, 5 or 6, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
6 = F
```
NBCC2005Fa

The site coefficient, Fa. This item is read when the site class is F only.

NBCC2005Fv

The site coefficient, Fv. This item is read when the site class is F only.

NBCC2005I

The importance factor.

NBCC2005Mv

The higher mode factor.

NBCC2005Rd

The ductility modifier.

NBCC2005Ro

The overstrength modifier.

## Remarks

This function assigns auto seismic loading parameters for the 2005 NBCC code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicNBCC2005()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NBCC2005 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNBCC2005("EQX", 2, 0.1, 2, 1, 0, False, 0, 0,
0.6, 1.1, 0.7, 0.35, 0.2, 6, 1.8, 2, 1.5, 1.2, 6, 1.6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetNBCC2005

# SetNBCC95

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetNBCC95

## VB6 Procedure

Function SetNBCC95(ByVal Name As String, ByVal DirFlag As Long, ByVal eccen As Double,
ByVal NBCCPFlag As Long, ByVal NBCC95DS As Double, ByVal PeriodFlag As Long, ByVal
UserT As Double, ByVal UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As


Double, ByVal NBCC95ZA As Long, ByVal NBCC95ZV As Long, ByVal NBCC95ZVFlag As
Long, ByVal NBCC95ZVR As Double, ByVal NBCC95I As Double, ByVal NBCC95F As
Double, ByVal NBCC95R As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

NBCCPFlag

This is either 1 or 2, indicating the structure type.

```
1 = Moment frame
2 = Other
```
NBCC95DS

This item applies only when the NBCCPFlag = 2. It is the dimension of the lateral load resisting
system in the direction of the applied forces. [L]

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Code
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]


BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

NBCC95ZA

This is 0, 1, 2, 3, 4, 5 or 6, indicating the acceleration related zone, Za.

NBCC95ZV

This is 0, 1, 2, 3, 4, 5 or 6, indicating the velocity related zone, Zv.

NBCC95ZVFlag

This is either 1 or 2, indicating how the zonal velocity ratio, V, is specified.

```
1 = From code based on Zv
2 = User specified
```
NBCC95ZVR

The zonal velocity ratio, V. This item is used only when NBCC95ZVFlag = 2.

NBCC95I

The importance factor.

NBCC95F

The foundation factor.

NBCC95R

The force modification factor.

## Remarks

This function assigns auto seismic loading parameters for the 1995 NBCC code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicNBCC95()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NBCC95 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNBCC95("EQX", 1, 0.05, 1, 0, 1, 0, False, 0, 0,
4, 5, 1, 0, 1, 1.3, 4)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetNBCC95

# SetNEHRP97

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetNEHRP97

## VB6 Procedure

Function SetNEHRP97(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As
Double, ByVal PeriodFlag As Long, ByVal CT As Double, ByVal UserT As Double, ByVal
UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal NEHRP97SG As
Long, ByVal NEHRP97SeismicCoeffFlag As Long, ByVal NEHRP97Site As Long, ByVal


NEHRP97SS As Double, ByVal NEHRP97S1 As Double, ByVal NEHRP97Fa As Double, ByVal
NEHRP97Fv As Double, ByVal NEHRP97R As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor. This item applies when the PeriodFlag item is 1 or 2.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

NEHRP97SG

This is 1, 2 or 3, indicating the seismic group.


### 1 = I

### 2 = II

### 3 = III

NEHRP97SeismicCoeffFlag

This is either 1 or 2, indicating the seismic coefficient option.

```
1 = Coefficients are per code
2 = Coefficients are user defined
```
NEHRP97Site

This is 1, 2, 3, 4 or 5, indicating the site class. This item is used only when the
NEHRP97SeismicCoeffFlag = 1.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
NEHRP97SS

The response acceleration for short periods, (g).

NEHRP97S1

The response acceleration for a one second period, (g).

NEHRP97Fa

The site coefficient Fa. This item is used only when the NEHRP97SeismicCoeffFlag = 2.

NEHRP97Fv

The site coefficient Fv. This item is used only when the NEHRP97SeismicCoeffFlag = 2

NEHRP97R

The response modification factor.

## Remarks

This function assigns auto seismic loading parameters for the 1997 NEHRP code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicNEHRP97()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NEHRP97 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNEHRP97("EQX", 1, 0.05, 1, 0.035, 0, False,
0, 0, 1, 1, 3, 1, 0.4, 0, 0, 8)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetNEHRP97

# SetNone

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetNone


## VB6 Procedure

Function SetNone(ByVal Name As String) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

## Remarks

This function sets the auto seismic loading type for the specified load pattern to None.

The function returns zero if the loading type is successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicNone()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign BOCA96 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetBOCA96("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 0.4, 0.4, 1.5, 8)

'set auto seismic loading type to None
ret = SapModel.LoadPatterns.AutoSeismic.SetNone("EQX")


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# SetNTC2008

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetNTC2008

## VB6 Procedure

Function SetNTC2008(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double,
ByVal PeriodFlag As Long, ByVal C1Type As Long, ByVal UserT As Double, ByVal UserZ As
Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal ParamsOption As Long,
ByVal Latitude As Double, ByVal Longitude As Double, ByVal Island As Long, ByVal
LimitState As Long, ByVal UsageClass As Long, ByVal NomLife As Double, ByVal PeakAccel
As Double, ByVal F0 As Double, ByVal Tcs As Double, ByVal SpecType As Long, ByVal
SoilType As Long, ByVal Topography As Long, ByVal hRatio As Double, ByVal Damping As
Double, ByVal q As Double, ByVal lambda As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.


PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CIType

This is 0, 1, 2 or 3, indicating the values of C1. This item applies when the PeriodFlag item is 1 or
2.

```
1 = C1 = 0.085 (m)
2 = C1 = 0.075 (m)
3 = C1 = 0.05 (m)
```
UserT

The user specified time period. This item is meaningful when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

ParamsOption

This is 1, 2, or 3, indicating the option for defining the parameters.

```
1 = by latitude and longitude
2 = by island
3 = user specified
```
Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are
meaningful only when ParamsOption = 1.

Island

This is one of the following values. This item is used only when ParamsOption = 2.

```
1 = Alicudi
2 = Arcipelago Toscano
```

```
3 = Filcudi
4 = Isole Egadi
5 = Lampedusa
6 = Linosa
7 = Lipari
8 = Palmarola
9 = Panarea
10 = Pantelleria
11 = Ponza
12 = Salina
13 = Santo Stefano
14 = Sardegna
15 = Stromboli
16 = Tremiti
17 = Ustica
18 = Ventotene
19 = Vulcano
20 = Zannone
```
LimitState

This is 1, 2, 3, or 4, indicating the limit state.

```
1 = SLO
2 = SLD
3 = SLV
4 = SLC
```
UsageClass

This is 1, 2, 3, or 4, indicating the usage class.

```
1 = I
2 = II
3 = III
4 = IV
```
NomLife

The nominal life to be considered.

PeakAccel

The peak ground acceleration, ag/g.

F0

The magnitude factor, F0.

Tcs

The reference period, Tc* [s].

SpecType


This is 1, 2, 3, or 4, indicating the type of spectrum to consider.

```
1 = Elastic horizontal
2 = Elastic vertical
3 = Design horizontal
4 = Design vertical
```
SoilType

This is 1, 2, 3, 4, or 5, indicating the subsoil type.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
Topography

This is 1, 2, 3, or 4, indicating the topography type.

```
1 = T1
2 = T2
3 = T3
4 = T4
```
hRatio

The ratio for the site altitude at the base of the hill to the height of the hill.

Damping

The damping, in percent. This is only applicable for SpecType 1 and 2.

q

The behavior correction factor. This is only applicable for SpecType 3 and 4.

lambda

A correction factor.

## Remarks

This function assigns auto seismic loading parameters for the NTC 2008 code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example


Sub AssignSeismicNTC2008()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", eLoadPatternType_QUAKE)

'assign NTC2008 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNTC2008("EQX", 1, 0.05, 1, 1, 0, False, 0, 0,
3, 0, 0, 1, 1, 1, 50, 0.2, 2.4, 0.3, 3, 2, 1, 1, 5, 1, 0.85)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 18.1.0.

## See Also

GetNTC2008

# SetNTC2018

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetNTC2018


## VB6 Procedure

Function SetNTC2018(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double,
ByVal PeriodFlag As Long, ByVal UserT As Double, ByVal UserZ As Boolean, ByVal TopZ As
Double, ByVal BottomZ As Double, ByVal ParamsOption As Long, ByVal Latitude As Double,
ByVal Longitude As Double, ByVal Island As Long, ByVal LimitState As Long, ByVal
UsageClass As Long, ByVal NomLife As Double, ByVal PeakAccel As Double, ByVal F0 As
Double, ByVal Tcs As Double, ByVal SpecType As Long, ByVal SoilType As Long, ByVal
Topography As Long, ByVal hRatio As Double, ByVal Damping As Double, ByVal q As Double,
ByVal lambda As Double ) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item is meaningful when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]


ParamsOption

This is 1, 2, or 3, indicating the option for defining the parameters.

```
1 = by latitude and longitude
2 = by island
3 = user specified
```
Latitude, Longitude

The latitude and longitude for which the seismic coefficients are obtained. These items are
meaningful only when ParamsOption = 1.

Island

This is one of the following values. This item is used only when ParamsOption = 2.

```
1 = Alicudi
2 = Arcipelago Toscano
3 = Filcudi
4 = Isole Egadi
5 = Lampedusa
6 = Linosa
7 = Lipari
8 = Palmarola
9 = Panarea
10 = Pantelleria
11 = Ponza
12 = Salina
13 = Santo Stefano
14 = Sardegna
15 = Stromboli
16 = Tremiti
17 = Ustica
18 = Ventotene
19 = Vulcano
20 = Zannone
```
LimitState

This is 1, 2, 3, or 4, indicating the limit state.

```
1 = SLO
2 = SLD
3 = SLV
4 = SLC
```
UsageClass

This is 1, 2, 3, or 4, indicating the usage class.

```
1 = I
2 = II
3 = III
```

### 4 = IV

NomLife

The nominal life to be considered.

PeakAccel

The peak ground acceleration, ag/g.

F0

The magnitude factor, F0.

Tcs

The reference period, Tc* [s].

SpecType

This is 1, 2, 3, or 4, indicating the type of spectrum to consider.

```
1 = Elastic horizontal
2 = Elastic vertical
3 = Design horizontal
4 = Design vertical
```
SoilType

This is 1, 2, 3, 4, or 5, indicating the subsoil type.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
Topography

This is 1, 2, 3, or 4, indicating the topography type.

```
1 = T1
2 = T2
3 = T3
4 = T4
```
hRatio

The ratio for the site altitude at the base of the hill to the height of the hill.

Damping

The damping, in percent. This is only applicable for SpecType 1 and 2.

q


The behavior correction factor. This is only applicable for SpecType 3 and 4.

lambda

A correction factor.

## Remarks

This function assigns auto seismic loading parameters for the NTC 2018 code.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicNTC2018()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", eLoadPatternType_QUAKE)

'assign NTC2018 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNTC2018("EQX", 1, 0.05, 1, 0, False, 0, 0, 3,
0, 0, 1, 1, 1, 50, 0.2, 2.4, 0.3, 3, 2, 1, 1, 5, 1, 0.85)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in v20.1.0.

## See Also

GetNTC2018

# SetUBC94

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetUBC94

## VB6 Procedure

Function SetUBC94(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double,
ByVal PeriodFlag As Long, ByVal CT As Double, ByVal UserT As Double, ByVal UserZ As
Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal UBC94ZFlag As Long,
ByVal UBC94Z As Double, ByVal UBC94S As Double, ByVal UBC94I As Double, ByVal
UBC94RW As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor. This item applies when the PeriodFlag item is 1 or 2.


UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

UBC94ZFlag

This is either 1 or 2, indicating if the seismic zone factor is per code or user defined.

```
1 = Per code
2 = User defined
```
UBC94Z

The seismic zone factor, Z.

If the seismic zone factor is per code (UBC94ZFlag = 1), this item should be one of the following:
0.075, 0.15, 0.20, 0.30, 0.40.

UBC94S

This is 1, 1.2, 1.5 or 2, indicating the site coefficient.

UBC94I

The importance factor.

UBC94RW

The numerical coefficient, Rw.

## Remarks

This function assigns auto seismic loading parameters for the 1994 UBC code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example


Sub AssignSeismicUBC94()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign UBC94 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetUBC94("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 1, 0.4, 1.2, 1.15, 8)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetUBC94

# SetNZS11702004_2

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetNZS11702004_2


## VB6 Procedure

Function SetNZS11702004_2(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As
Double, ByVal PeriodFlag As Long, ByVal UserT As Double, ByVal UserZ As Boolean, ByVal
TopZ As Double, ByVal BottomZ As Double, ByVal NZS2004SiteClass As Long, ByVal
NZS2004Z As Double, ByVal NZS2004R As Double, ByVal NZS2004DIST As Double, ByVal
NZS2004Sp As Double, ByVal NZS2004Mu As Double, ByVal NZS2004ConsiderTSite As
Boolean, ByVal NZS2004TSite As Double, ByVal NZS2004ConsiderSingleStory As Boolean) As
Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

**UserZ**

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]


NZS2004SiteClass

This is 1, 2, 3, 4 or 5, indicating the site class.

```
1 = A
2 = B
3 = C
4 = D
5 = E
```
NZS2004Z

The hazard factor, Z.

NZS2004R

The return period factor, R.

NZS2004DIST

Distance to the fault in km, used to calculate the near fault factor.

NZS2004Sp

The structural performance factor, Sp.

NZS2004Mu

The structural ductility factor, u.

NZS2004ConsiderTSite

Indicates whether to consider the site period for the spectral shape factor.

NZS2004TSite

The low amplitude site period.

NZS2004ConsiderSingleStory

Indicates whether to consider the structure as a single story, in which case F t = 0.

## Remarks

This function assigns auto seismic loading parameters for the NZS 1170.5 2004 code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicNZS11702004_2()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign NZS 1170 2004 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetNZS11702004_2("EQX", 2, 0.1, 2, 0, False, 0,
0, 3, 0.4, 1.3, 20, 0.7, 3, True, 1, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v22.0.0.

This function supersedes SetNZS11702004_1.

## See Also

GetNZS11702004_2

# SetUBC97

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetUBC97


## VB6 Procedure

Function SetUBC97(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double,
ByVal PeriodFlag As Long, ByVal CT As Double, ByVal UserT As Double, ByVal UserZ As
Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal UBC97SeismicCoeffFlag
As Long, ByVal UBC97SoilProfileType As Long, ByVal UBC97Z As Double, ByVal UBC97Ca
As Double, ByVal UBC97Cv As Double, ByVal UBC97NearSourceFlag As Long, ByVal
UBC97SourceType As Long, ByVal UBC97Dist As Double, ByVal UBC97Na As Double, ByVal
UBC97Nv As Double, ByVal UBC97I As Double, ByVal UBC97R As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

PeriodFlag

This is 1, 2 or 3, indicating the time period option.

```
1 = Approximate
2 = Program calculated
3 = User defined
```
CT

The code-specified CT factor. This item applies when the PeriodFlag item is 1 or 2.

UserT

The user specified time period. This item applies when the PeriodFlag item is 3. [s]

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

UBC97SeismicCoeffFlag

This is either 1 or 2, indicating if the seismic coefficients Ca and Cv are per code or user defined.

```
1 = Per code
2 = User defined
```
UBC97SoilProfileType

This is 1, 2, 3, 4 or 5, indicating the soil profile type.

```
1 = SA
2 = SB
3 = SC
4 = SD
5 = SE
```
This item is applicable only when the seismic coefficients Ca and Cv are calculated in accordance
with the code (UBC97SeismicCoeffFlag = 1).

UBC97Z

This is 0.075, 0.15, 0.2, 0.3 or 0.4, indicating the seismic zone factor.

This item is applicable only when the seismic coefficients Ca and Cv are calculated in accordance
with code (UBC97SeismicCoeffFlag = 1).

UBC97Ca

The seismic coefficient, Ca.

This item is applicable only when the seismic coefficients Ca and Cv are user defined
(UBC97SeismicCoeffFlag = 2).

UBC97Cv

The seismic coefficient, Cv.

This item is applicable only when the seismic coefficients Ca and Cv are user defined
(UBC97SeismicCoeffFlag = 2).

UBC97NearSourceFlag

This is either 1 or 2, indicating if the near source factor coefficients Na and Nv are per code or
user defined.

```
1 = Per code
2 = User defined
```

This item is applicable only when the seismic coefficients Ca and Cv are calculated in accordance
with the code (UBC97SeismicCoeffFlag = 1) and UBC97Z = 0.4.

UBC97SourceType

This is 1, 2 or 3, indicating the seismic source type.

```
1 = A
2 = B
3 = C
```
This item is applicable only when the seismic coefficients Ca and Cv are calculated in accordance
with code (UBC97SeismicCoeffFlag = 1), UBC97Z = 0.4, and the near source factor coefficients
Na and Nv are calculated in accordance with code (UBC97NearSourceFlag = 1).

UBC97Dist

This is the distance to the seismic source in kilometers.

This item is applicable only when the seismic coefficients Ca and Cv are calculated in accordance
with code (UBC97SeismicCoeffFlag = 1), UBC97Z = 0.4, and the near source factor coefficients
Na and Nv are calculated in accordance with code (UBC97NearSourceFlag = 1).

UBC97Na

The near source factor coefficient, Na.

This item is applicable only when the seismic coefficients Ca and Cv are user defined
(UBC97SeismicCoeffFlag = 2) and the near source factor coefficients Na and Nv are user defined
(UBC97NearSourceFlag = 2).

UBC97Nv

The near source factor coefficient, Nv.

This item is applicable only when the seismic coefficients Ca and Cv are user defined
(UBC97SeismicCoeffFlag = 2) and the near source factor coefficients Na and Nv are user defined
(UBC97NearSourceFlag = 2).

UBC97I

The importance factor.

UBC97R

The overstrength factor.

## Remarks

This function assigns auto seismic loading parameters for the 1997 UBC code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.


## VBA Example

Sub AssignSeismicUBC97()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign UBC97 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetUBC97("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 1, 3, 0.4, 0, 0, 1, 3, 5, 0, 0, 1.15, 6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetUBC97

# SetUBC97Iso


## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetUBC97Iso

## VB6 Procedure

Function SetUBC97Iso(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As
Double, ByVal UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal
UBC97IsoSeismicCoeffFlag As Long, ByVal UBC97IsoSoilProfileType As Long, ByVal
UBC97IsoZ As Double, ByVal UBC97IsoCv As Double, ByVal UBC97IsoNearSourceFlag As
Long, ByVal UBC97IsoSourceType As Long, ByVal UBC97IsoDist As Double, ByVal
UBC97IsoNv As Double, ByVal UBC97IsoRI As Double, ByVal UBC97IsoBD As Double,
ByVal UBC97IsoKDmax As Double, ByVal UBC97IsoKDmin As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

UBC97IsoSeismicCoeffFlag

This is either 1 or 2, indicating if the seismic coefficient Cv is per code or user defined.

```
1 = Per code
2 = User defined
```

UBC97IsoSoilProfileType

This is 1, 2, 3, 4 or 5, indicating the soil profile type.

```
1 = SA
2 = SB
3 = SC
4 = SD
5 = SE
```
This item is applicable only when the seismic coefficients Ca and Cv are calculated in accordance
with code (UBC97SeismicCoeffFlag = 1).

UBC97IsoZ

This is 0.075, 0.15, 0.2, 0.3 or 0.4, indicating the seismic zone factor.

This item is applicable only when the seismic coefficient Cv is calculated in accordance with code
(UBC97IsoSeismicCoeffFlag = 1).

UBC97IsoCv

The seismic coefficient, Cv.

This item is applicable only when the seismic coefficient Cv is user defined
(UBC97IsoSeismicCoeffFlag = 2).

UBC97IsoNearSourceFlag

This is either 1 or 2, indicating if the near source factor coefficient Nv is per code or user defined.

```
1 = Per code
2 = User defined
```
This item is applicable only when the seismic coefficient Cv is calculated per code
(UBC97IsoSeismicCoeffFlag = 1) and UBC97IsoZ = 0.4.

UBC97IsoSourceType

This is 1, 2 or 3, indicating the seismic source type.

```
1 = A
2 = B
3 = C
```
This item is applicable only when the seismic coefficient Cv is calculated in accordance with code
(UBC97IsoSeismicCoeffFlag = 1), UBC97IsoZ = 0.4, and the near source factor coefficient Nv is
calculated in accordance with code (UBC97IsoNearSourceFlag = 1).

UBC97IsoDist

This is the distance to the seismic source in kilometers.


This item is only applicable when the seismic coefficient Cv is calculated in accordance with code
(UBC97IsoSeismicCoeffFlag = 1), UBC97IsoZ = 0.4, and the near source factor coefficient Nv is
calculated in accordance with code (UBC97IsoNearSourceFlag = 1).

UBC97IsoNv

The near source factor coefficient, Nv.

This item is applicable only when the seismic coefficient Cv is user defined
(UBC97IsoSeismicCoeffFlag = 2) and the near source factor coefficient Nv is user defined
(UBC97IsoNearSourceFlag = 2).

UBC97IsoRI

The overstrength factor, Ri.

UBC97IsoBD

The coefficient for damping.

UBC97IsoKDmax

The maximum effective stiffness of the isolation system. [F/L]

UBC97IsoKDmin

The minimum effective stiffness of the isolation system. [F/L]

## Remarks

This function assigns auto seismic loading parameters for seismically isolated buildings using the
1997 UBC code.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicUBC97Iso()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign UBC97Iso parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetUBC97Iso("EQX", 1, 0.05, False, 0, 0, 1, 3,
0.4, 0, 1, 3, 5, 0, 2, 1.25, 200, 150)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetUBC97Iso

# SetUserCoefficient

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetUserCoefficient

## VB6 Procedure

Function SetUserCoefficient(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As
Double, ByVal UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal c
As Double, ByVal k As Double) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.


DirFlag

This is either 1 or 2, indicating the seismic load direction.

```
1 = Global X
2 = Global Y
```
Eccen

The eccentricity ratio that applies to all diaphragms.

UserZ

This item is True if the top and bottom elevations of the seismic load are user specified. It is False
if the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto seismic loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto seismic loads are applied. [L]

c

The base shear coefficient.

k

The building height exponent.

## Remarks

This function assigns auto seismic loading parameters for User Coefficient type loading.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignSeismicUserCoefficient()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign user coefficient parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetUserCoefficient("EQX", 1, 0.06, False, 0, 0,
0.15, 1.3)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetUserCoefficient

# SetUserLoad

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetUserLoad

## VB6 Procedure

Function SetUserLoad(ByVal Name As String, ByVal MyType As Long, Optional ByVal Eccen
As Double = 0.05) As Long

## Parameters


Name

The name of an existing Quake-type load pattern.

MyType

This is either 1 or 2, indicating the application point type for the user load.

```
1 = User specified application point
2 = At center of mass with optional additional eccentricity
```
Eccen

The eccentricity ratio that applies to all diaphragms. This item is only applicable when MyType =
2.

## Remarks

This function sets the auto seismic load type to User Load. User load values are assigned using the
SetUserLoadValue function.

The function returns zero if the load type is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub AssignSeismicUserLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection


ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'set to auto seismic user load
ret = SapModel.LoadPatterns.AutoSeismic.SetUserLoad("EQX", 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetUserLoadValue

GetUserLoad

# SetUserLoadValue

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeismic.SetUserLoadValue

## VB6 Procedure

Function SetUserLoadValue(ByVal Name As String, ByVal Diaph As String, ByVal Fx As
Double, ByVal Fy As Double, ByVal Mz As Double, Optional ByVal x As Double = 0, Optional
ByVal y As Double = 0) As Long

## Parameters

Name


The name of an existing Quake-type load pattern that has been assigned a User Load auto seismic
type.

Diaph

The name of an existing special rigid diaphragm constraint, that is, a diaphragm constraint with
the following features:

1. The constraint type is CONSTRAINT_DIAPHRAGM = 2.
2. The constraint coordinate system is Global.
3. The constraint axis is Z.

Fx

The global X direction force assigned to the specified diaphragm. [F]

Fy

The global Y direction force assigned to the specified diaphragm. [F]

Mz

The moment about the global Z axis assigned to the specified diaphragm. [FL]

x

The global X-coordinate of the point where the seismic force is applied. [L]

This item is applicable only when the auto seismic load is specified to have a user specified
application point (see the SetUserLoad function).

y

The global Y-coordinate of the point where the seismic force is applied. [L]

This item is applicable only when the auto seismic load is specified to have a user specified
application point (see the SetUserLoad function).

## Remarks

This function assigns loading to an auto seismic load that is a User Load type. The SetUserLoad
function is used to specify that an auto seismic load is a User Load type

The function returns zero if the loading is successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignSeismicUserLoadValue()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'set to auto seismic user load
ret = SapModel.LoadPatterns.AutoSeismic.SetUserLoad("EQX", 1)

'set to auto seismic user load values
ret = SapModel.LoadPatterns.AutoSeismic.SetUserLoadValue("EQX", "Diaph1", 20, 4, 1000,
0, 0)
ret = SapModel.LoadPatterns.AutoSeismic.SetUserLoadValue("EQX", "Diaph2", 40, 8, 2000,
0, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetUserLoad

GetUserLoad

# GetAASHTO2018

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.GetAASHTO2018

## VB6 Procedure

Function GetAASHTO2018(ByVal Name As String, ByRef LimitState As Long, ByRef
Superstructure As Boolean, ByRef Substructure As Boolean, ByRef Vertical As Boolean, ByRef
GroundElevation As Double, ByRef SuperZProgCalc As Boolean, ByRef SuperstructureZ As
Double, ByRef SubZProgCalc As Boolean, ByRef SubstructureZ As Double, ByRef WindSpeed
As Double, ByRef ExposureCategory As Long, ByRef G As Double, ByRef CdSuper As Double,
ByRef CdSub As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

LimitState

The limit state associated with the wind load.

```
1 = Strength III
```
```
2 = Strength V
```
```
3 = Service I
```
```
4 = Service IV
```
Superstructure

This item is True if wind on the superstructure should be considered, otherwise it is false.

Substructure


This item is True if wind on the substructure should be considered, otherwise it is false.

Vertical

This item is True if vertical wind should be considered, otherwise it is false

GroundElevation

The ground elevation used for determining heights used for wind pressure values. [L]

SuperZProgCalc

This item is True if the superstructure height, Z, should be program calculated, otherwise it is
false.

SuperstructureZ

The superstructure height Z. This item applies only when SuperProgCalc = False. [L]

SubZProgCalc

This item is True if the substructure height, Z, should be program calculated, otherwise it is false.

SuperstructureZ

The substructure height Z. This item applies only when SubProgCalc = False. [L]

WindSpeed

The wind speed in mph.

Exposure Category

The wind exposure category.

```
1 = B
```
```
2 = C
```
```
3 = D
```
### G

The gust effect factor, G.

CdSuper

The drag coefficient for the superstructure.

CdSub

The drag coefficient for the substructure.


## Remarks

This function retrieves bridge auto wind loading parameters for AASHTO 2018.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetBridgeWindAASHTO2018()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim LimitState As Long
Dim Superstructure As Boolean
Dim Substructure As Boolean
Dim Vertical As Boolean
Dim GroundElevation As Double
Dim SuperZProgCalc As Boolean

Dim SuperstructureZ As Double
Dim SubZProgCalc As Boolean

Dim SubstructureZ As Double
Dim WindSpeed As Double
Dim ExposureCategory As Long

Dim G As Double

Dim CdSuper As Double

Dim CdSub As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern


ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign AASHTO2018 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.SetAASHTO2018("WIND", 1, True, True,
True, -100, True, 10, True, 10, 100, 2, 1, 1.3, 1.6)

'get AASHTO 2018 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.GetAASHTO2018("WIND", LimitState,
Superstructure, Substructure, Vertical, GroundElevation, SuperZProgCalc, SuperstructureZ,
SubZProgCalc, SubstructureZ, WindSpeed, ExposureCategory, G, CdSuper, CdSub)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

## See Also

SetAASHTO2018

# GetAASHTO2020

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.GetAASHTO2020

## VB6 Procedure

Function GetAASHTO2020(ByVal Name As String, ByRef LimitState As Long, ByRef
Superstructure As Boolean, ByRef Substructure As Boolean, ByRef Vertical As Boolean, ByRef
GroundElevation As Double, ByRef SuperZProgCalc As Boolean, ByRef SuperstructureZ As
Double, ByRef SubZProgCalc As Boolean, ByRef SubstructureZ As Double, ByRef WindSpeed
As Double, ByRef ExposureCategory As Long, ByRef G As Double, ByRef CdSuper As Double,
ByRef CdSub As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.


LimitState

The limit state associated with the wind load.

```
1 = Strength III
```
```
2 = Strength V
```
```
3 = Service I
```
```
4 = Service IV
```
Superstructure

This item is True if wind on the superstructure should be considered, otherwise it is false.

Substructure

This item is True if wind on the substructure should be considered, otherwise it is false.

Vertical

This item is True if vertical wind should be considered, otherwise it is false

GroundElevation

The ground elevation used for determining heights used for wind pressure values. [L]

SuperZProgCalc

This item is True if the superstructure height, Z, should be program calculated, otherwise it is
false.

SuperstructureZ

The superstructure height Z. This item applies only when SuperProgCalc = False. [L]

SubZProgCalc

This item is True if the substructure height, Z, should be program calculated, otherwise it is false.

SuperstructureZ

The substructure height Z. This item applies only when SubProgCalc = False. [L]

WindSpeed

The wind speed in mph.

Exposure Category

The wind exposure category.

```
1 = B
```

### 2 = C

### 3 = D

### G

The gust effect factor, G.

CdSuper

The drag coefficient for the superstructure.

CdSub

The drag coefficient for the substructure.

## Remarks

This function retrieves bridge auto wind loading parameters for AASHTO 2020.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetBridgeWindAASHTO2020()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim LimitState As Long
Dim Superstructure As Boolean
Dim Substructure As Boolean
Dim Vertical As Boolean
Dim GroundElevation As Double
Dim SuperZProgCalc As Boolean

Dim SuperstructureZ As Double
Dim SubZProgCalc As Boolean

Dim SubstructureZ As Double
Dim WindSpeed As Double
Dim ExposureCategory As Long

Dim G As Double

Dim CdSuper As Double


Dim CdSub As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign AASHTO2020 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.SetAASHTO2020("WIND", 1, True, True,
True, -100, True, 10, True, 10, 100, 2, 1, 1.3, 1.6)

'get AASHTO 2020 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.GetAASHTO2020("WIND", LimitState,
Superstructure, Substructure, Vertical, GroundElevation, SuperZProgCalc, SuperstructureZ,
SubZProgCalc, SubstructureZ, WindSpeed, ExposureCategory, G, CdSuper, CdSub)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v25.3.0.

## See Also

SetAASHTO2020

# GetAngles

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.GetAngles


## VB6 Procedure

Function GetAngles(ByVal Name As String, ByRef SymmetricTran As Boolean, ByRef
SymmetricLong As Boolean, ByRef UserDefined As Boolean, ByRef NumberAngles As Long,
ByRef Angles() As Double, ByRef TranCoeff() As Double, ByRef LongCoeff() As Double) As
Long

## Parameters

Name

The name of an existing bridge wind load pattern.

SymmetricTran

This is True if the angles are symmetric about the transverse axis, otherwise False.

SymmetricLong

This is True if the angles are symmetric about the longitudinal axis, otherwise False.

UserDefined

This is True if the angles are user defined, otherwise False.

NumberAngles

The number of angles specified for the load pattern. This is only used if UserDefined = True.

Angles

This is an array containing the wind angles. All angles are returned, including those generated due
to the symmetry options.

TranCoeff

This is an array containing the transverse coefficients corresponding with the angles. This is only
used if UserDefined = True.

LongCoeff

This is an array containing the longitudinal coefficients corresponding with the angles. This is
only used if UserDefined = True.

## Remarks

This function retrieves the bridge wind angle data for a specified load pattern.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetAngles()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim Angles() As Double

Dim TranCoeff() As Double

Dim LongCoeff() As Double

Dim MySymTran As Boolean

Dim MySymLong As Boolean

Dim MyUserDefined As Boolean

Dim MyNumberAngles As Long

Dim MyAngles() As Double

Dim MyTranCoeff() As Double

Dim MyLongCoeff() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign AASHTO2018 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.SetAASHTO2018("WIND", 1, True, True,
True, -100, True, 10, True, 10, 100, 2, 1, 1.3, 1.6)


'set angle data

ReDim Angles(4)

ReDim TranCoeff(4)

ReDim LongCoeff(4)

Angles(0) = 0

TranCoeff(0) = 1

LongCoeff(0) = 0

Angles(1) = 20

TranCoeff(1) = 0.85

LongCoeff(1) = 0.18

Angles(2) = 40

TranCoeff(2) = 0.7

LongCoeff(2) = 0.26

Angles(3) = 60

TranCoeff(3) = 0.34

LongCoeff(3) = 0.38

Angles(4) = 80

TranCoeff(4) = 0.12

LongCoeff(4) = 0.42

ret = SapModel.LoadPatterns.AutoWindBridge.SetAngles("WIND", False, False, True, 5,
Angles, TranCoeff, LongCoeff)

'get angle data
ret = SapModel.LoadPatterns.AutoWindBridge.GetAngles("WIND", MySymTran,
MySymLong, MyUserDefined, MyNumberAngles, MyAngles, MyTranCoeff, MyLongCoeff)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in v21.0.0.

## See Also

SetAngles

# GetAutoLiveLoad_1 {Bridge Wind Load}

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.GetAutoLiveLoad_1

## VB6 Procedure

Function GetAutoLiveLoad_1(ByVal Name As String, ByRef RefLoadPat As String, ByRef
Height As Double, ByRef LLHeight As Double) As Long

## Parameters

Name

The name of an existing bridge wind - live load type pattern.

RefLoadPat

The name of an existing bridge wind load pattern that is referenced from this wind on live load
pattern.

Height

The height above the roadway surface at which the wind on live load should be applied. [L]

LLHeight

The height of the live load surface to which the wind should be applied. This parameter does not
apply for AASHTO 2018 or AASHTO 2020. [L]

## Remarks

This function retrieves auto wind on live load parameters.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetAutoWindLiveLoad_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim RefLoadPat As String

Dim Height As Double

Dim LLHeight As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WINDONLIVELOAD)

'set auto wind live load loading type to Auto
ret = SapModel.LoadPatterns.AutoWindBridge.SetAutoLiveLoad_1("WINDLIVE", "WIND",
0, 2.5)

'get auto wind live load parameters

ret = SapModel.LoadPatterns.AutoWindBridge.GetAutoLiveLoad_1("WINDLIVE",
RefLoadPat, Height, LLHeight)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v25.2.0.

This function supersedes GetAutoLiveLoad.

## See Also

SetAutoLiveLoad_1

# GetCSAS614

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.GetCSAS614

## VB6 Procedure

Function GetCSAS614(ByVal Name As String, ByRef Superstructure As Boolean, ByRef
Substructure As Boolean, ByRef Vertical As Boolean, ByRef GroundElevation As Double, ByRef
SuperZProgCalc As Boolean, ByRef SuperstructureZ As Double, ByRef q As Double, ByRef Cg
As Double, ByRef CeProgCalc As Boolean, ByRef Ce As Double, ByRef ChStructure As Double,
ByRef ChLiveLoad As Double, ByRef Cv As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

Superstructure

This item is True if wind on the superstructure should be considered, otherwise it is false.

Substructure

This item is True if wind on the substructure should be considered, otherwise it is false.

Vertical

This item is True if vertical wind should be considered, otherwise it is false

GroundElevation


The ground elevation used for determining heights used for wind pressure values. [L]

SuperZProgCalc

This item is True if the superstructure height, Z, should be program calculated, otherwise it is
false.

SuperstructureZ

The superstructure height Z. This item applies only when SuperProgCalc = False. [L]

q

The reference wind pressure, q. [F/L^2 ]

Cg

The gust effect factor.

CeProgCalc

This item is True if the wind exposure factor, Ce, should be program calculated, otherwise it is
false.

Ce

The wind exposure factor. This item applies only when CeProgCalc = False.

ChStructure

The Ch factor for wind acting on the structure.

ChLiveLoad

The Ch factor for wind acting on the live load.

Cv

The Cv factor for vertical wind.

## Remarks

This function retrieves bridge auto wind loading parameters for CSA S6-14.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetBridgeWindCSAS614()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long

Dim Superstructure As Boolean
Dim Substructure As Boolean
Dim Vertical As Boolean
Dim GroundElevation As Double
Dim SuperZProgCalc As Boolean

Dim SuperstructureZ As Double
Dim q As Double

Dim Cg As Double
Dim CeProgCalc As Boolean
Dim Ce As Double

Dim ChStructure As Double

Dim ChLiveLoad As Double

Dim Cv As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign CSA S6-14 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.SetCSAS614("WIND", True, True, True, -
100, True, 10, 1, 2, True, 1, 2, 1.2, 1)

'get CSA S6-14 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.GetCSAS614("WIND", Superstructure,
Substructure, Vertical, GroundElevation, SuperZProgCalc, SuperstructureZ, q, Cg, CeProgCalc,
Ce, ChStructure, ChLiveLoad, Cv)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

## See Also

SetCSAS614

# GetEurocode12005

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.GetEurocode12005

## VB6 Procedure

Function GetEurocode12005(ByVal Name As String, ByRef Superstructure As Boolean, ByRef
Substructure As Boolean, ByRef Vertical As Boolean, ByRef GroundElevation As Double, ByRef
SuperZProgCalc As Boolean, ByRef SuperstructureZ As Double, ByRef SubZProgCalc As
Boolean, ByRef SubstructureZ As Double, ByRef WindSpeed As Double, ByRef Terrain As
Long, ByRef Orography As Double, ByRef k1 As Double, ByRef Rho As Double, ByRef Cfx As
Double, ByRef CfzUp As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

Superstructure

This item is True if wind on the superstructure should be considered, otherwise it is false.

Substructure

This item is True if wind on the substructure should be considered, otherwise it is false.

Vertical

This item is True if vertical wind should be considered, otherwise it is false

GroundElevation

The ground elevation used for determining heights used for wind pressure values. [L]


SuperZProgCalc

This item is True if the superstructure height, Z, should be program calculated, otherwise it is
false.

SuperstructureZ

The superstructure height Z. This item applies only when SuperProgCalc = False. [L]

SubZProgCalc

This item is True if the substructure height, Z, should be program calculated, otherwise it is false.

SuperstructureZ

The substructure height Z. This item applies only when SubProgCalc = False. [L]

WindSpeed

The basic wind speed, vb, in meters per second.

Terrain

The terrain category.

```
0 = 0
```
```
1 = I
```
```
2 = II
```
```
3 = III
```
```
4 = IV
```
Orography

The orography factor, Co.

k1

The turbulence factor, k1.

Rho

The air density in kg/m^3 , Rho.

Cfx

The force coefficient, Cf, in the horizontal direction.

CfzUp

The force coefficient, Cf, in the vertical up direction.


## Remarks

This function retrieves bridge auto wind loading parameters for Eurocode 1-2005.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetBridgeWindEurocode12005()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim Superstructure As Boolean
Dim Substructure As Boolean
Dim Vertical As Boolean
Dim GroundElevation As Double
Dim SuperZProgCalc As Boolean

Dim SuperstructureZ As Double

Dim SubZProgCalc As Boolean

Dim SubstructureZ As Double
Dim WindSpeed As Double

Dim Terrain As Long
Dim Orography As Double
Dim k1 As Double

Dim Rho As Double

Dim Cfx As Double

Dim CfzUp As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )


'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign Eurocode 1-2005 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.SetEurocode12005("WIND", True, True,
True, -100, True, 10, True, 10, 35, 2, 1, 1.25, 1.3, 0.9)

'get Eurocode 1-2005 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.GetEurocode12005("WIND", Superstructure,
Substructure, Vertical, GroundElevation, SuperZProgCalc, SuperstructureZ, SubZProgCalc,
SubstructureZ, WindSpeed, Terrain, Orography, k1, Rho, Cfx, CfzUp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

## See Also

SetEurocode12005

# SetAngles {Bridge Wind Load}

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.SetAngles

## VB6 Procedure

Function SetAngles(ByVal Name As String, ByVal SymmetricTran As Boolean, ByVal
SymmetricLong As Boolean, ByVal UserDefined As Boolean, ByVal NumberAngles As Long,
ByRef Angles() As Double, ByRef TranCoeff() As Double, ByRef LongCoeff() As Double) As
Long

## Parameters

Name

The name of an existing bridge wind load pattern.


SymmetricTran

This is True if the angles are symmetric about the transverse axis, otherwise False.

SymmetricLong

This is True if the angles are symmetric about the longitudinal axis, otherwise False.

UserDefined

This is True if the angles are user defined, otherwise False.

NumberAngles

The number of angles specified for the load pattern. This is only used if UserDefined = True.

Angles

This is an array containing the wind angles. If duplicates are included, only the first one will be
used. If SymmetricTran = True and/or SymmetricLong = True, only angles between 0 and 90
degrees will be used. Additional angles will be generated via the symmetry conditions. This is
only used if UserDefined = True.

TranCoeff

This is an array containing the transverse coefficients corresponding with the angles. This is only
used if UserDefined = True.

LongCoeff

This is an array containing the longitudinal coefficients corresponding with the angles. This is
only used if UserDefined = True.

## Remarks

This function sets the bridge wind angle data for a specified load pattern.

The function returns zero if the data is successfully set; otherwise it returns a nonzero value.

## VBA Example

Sub SetAngles()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim Angles() As Double

Dim TranCoeff() As Double

Dim LongCoeff() As Double


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign AASHTO2018 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.SetAASHTO2018("WIND", 1, True, True,
True, -100, True, 10, True, 10, 100, 2, 1, 1.3, 1.6)

'set angle data

ReDim Angles(4)

ReDim TranCoeff(4)

ReDim LongCoeff(4)

Angles(0) = 0

TranCoeff(0) = 1

LongCoeff(0) = 0

Angles(1) = 20

TranCoeff(1) = 0.85

LongCoeff(1) = 0.18

Angles(2) = 40

TranCoeff(2) = 0.7

LongCoeff(2) = 0.26

Angles(3) = 60

TranCoeff(3) = 0.34


LongCoeff(3) = 0.38

Angles(4) = 80

TranCoeff(4) = 0.12

LongCoeff(4) = 0.42

ret = SapModel.LoadPatterns.AutoWindBridge.SetAngles("WIND", False, False, True, 5,
Angles, TranCoeff, LongCoeff)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

## See Also

GetAngles

# SetAASHTO2018

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.SetAASHTO2018

## VB6 Procedure

Function SetAASHTO2018(ByVal Name As String, ByVal LimitState As Long, ByVal
Superstructure As Boolean, ByVal Substructure As Boolean, ByVal Vertical As Boolean, ByVal
GroundElevation As Double, ByVal SuperZProgCalc As Boolean, ByVal SuperstructureZ As
Double, ByVal SubZProgCalc As Boolean, ByVal SubstructureZ As Double, ByVal WindSpeed
As Double, ByVal ExposureCategory As Long, ByVal G As Double, ByVal CdSuper As Double,
ByVal CdSub As Double) As Long

## Parameters

Name


The name of an existing Wind-type load pattern.

LimitState

The limit state associated with the wind load.

```
1 = Strength III
```
```
2 = Strength V
```
```
3 = Service I
```
```
4 = Service IV
```
Superstructure

This item is True if wind on the superstructure should be considered, otherwise it is false.

Substructure

This item is True if wind on the substructure should be considered, otherwise it is false.

Vertical

This item is True if vertical wind should be considered, otherwise it is false

GroundElevation

The ground elevation used for determining heights used for wind pressure values. [L]

SuperZProgCalc

This item is True if the superstructure height, Z, should be program calculated, otherwise it is
false.

SuperstructureZ

The superstructure height Z. This item applies only when SuperProgCalc = False. [L]

SubZProgCalc

This item is True if the substructure height, Z, should be program calculated, otherwise it is false.

SuperstructureZ

The substructure height Z. This item applies only when SubProgCalc = False. [L]

WindSpeed

The wind speed in mph.

Exposure Category

The wind exposure category.


### 1 = B

### 2 = C

### 3 = D

### G

The gust effect factor, G.

CdSuper

The drag coefficient for the superstructure.

CdSub

The drag coefficient for the substructure.

## Remarks

This function sets bridge auto wind loading parameters for AASHTO 2018.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub SetBridgeWindAASHTO2018()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign AASHTO2018 parameters


ret = SapModel.LoadPatterns.AutoWindBridge.SetAASHTO2018("WIND", 1, True, True,
True, -100, True, 10, True, 10, 100, 2, 1, 1.3, 1.6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

## See Also

GetAASHTO2018

# SetAASHTO2020

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.SetAASHTO2020

## VB6 Procedure

Function SetAASHTO2020(ByVal Name As String, ByVal LimitState As Long, ByVal
Superstructure As Boolean, ByVal Substructure As Boolean, ByVal Vertical As Boolean, ByVal
GroundElevation As Double, ByVal SuperZProgCalc As Boolean, ByVal SuperstructureZ As
Double, ByVal SubZProgCalc As Boolean, ByVal SubstructureZ As Double, ByVal WindSpeed
As Double, ByVal ExposureCategory As Long, ByVal G As Double, ByVal CdSuper As Double,
ByVal CdSub As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

LimitState

The limit state associated with the wind load.

```
1 = Strength III
```
```
2 = Strength V
```
```
3 = Service I
```
```
4 = Service IV
```

Superstructure

This item is True if wind on the superstructure should be considered, otherwise it is false.

Substructure

This item is True if wind on the substructure should be considered, otherwise it is false.

Vertical

This item is True if vertical wind should be considered, otherwise it is false

GroundElevation

The ground elevation used for determining heights used for wind pressure values. [L]

SuperZProgCalc

This item is True if the superstructure height, Z, should be program calculated, otherwise it is
false.

SuperstructureZ

The superstructure height Z. This item applies only when SuperProgCalc = False. [L]

SubZProgCalc

This item is True if the substructure height, Z, should be program calculated, otherwise it is false.

SuperstructureZ

The substructure height Z. This item applies only when SubProgCalc = False. [L]

WindSpeed

The wind speed in mph.

Exposure Category

The wind exposure category.

```
1 = B
```
```
2 = C
```
```
3 = D
```
G

The gust effect factor, G.

CdSuper

The drag coefficient for the superstructure.


CdSub

The drag coefficient for the substructure.

## Remarks

This function sets bridge auto wind loading parameters for AASHTO 2020.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub SetBridgeWindAASHTO2020()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign AASHTO2020 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.SetAASHTO2020("WIND", 1, True, True,
True, -100, True, 10, True, 10, 100, 2, 1, 1.3, 1.6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v25.3.0.


## See Also

GetAASHTO2020

# SetAutoLiveLoad_1 {Bridge Wind Load}

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.SetAutoLiveLoad_1

## VB6 Procedure

Function SetAutoLiveLoad_1(ByVal Name As String, ByVal RefLoadPat As String, ByVal
Height As Double, ByVal LLHeight As Double) As Long

## Parameters

Name

The name of an existing bridge wind - live load type pattern.

RefLoadPat

The name of an existing bridge wind load pattern that is referenced from this wind on live load
pattern.

Height

The height above the roadway surface at which the wind on live load should be applied. [L]

LLHeight

The height of the live load surface to which the wind should be applied. This parameter does not
apply for AASHTO 2018 or AASHTO 2020. [L]

## Remarks

This function applies auto wind on live load parameters.

The function returns zero if the parameters are successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub SetAutoWindLiveLoad_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WINDONLIVELOAD)

'set auto wind live load loading type to Auto
ret = SapModel.LoadPatterns.AutoWindBridge.SetAutoLiveLoad_1("WINDLIVE", "WIND",
0, 2.5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v25.2.0.

This function supersedes SetAutoLiveLoad.

## See Also

GetAutoLiveLoad_1

# SetCSAS614 {Bridge Wind Load}

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.SetCSAS614


## VB6 Procedure

Function SetCSAS614(ByVal Name As String, ByVal Superstructure As Boolean, ByVal
Substructure As Boolean, ByVal Vertical As Boolean, ByVal GroundElevation As Double, ByVal
SuperZProgCalc As Boolean, ByVal SuperstructureZ As Double, ByVal q As Double, ByVal Cg
As Double, ByVal CeProgCalc As Boolean, ByVal Ce As Double, ByVal ChStructure As Double,
ByVal ChLiveLoad As Double, ByVal Cv As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

Superstructure

This item is True if wind on the superstructure should be considered, otherwise it is false.

Substructure

This item is True if wind on the substructure should be considered, otherwise it is false.

Vertical

This item is True if vertical wind should be considered, otherwise it is false

GroundElevation

The ground elevation used for determining heights used for wind pressure values. [L]

SuperZProgCalc

This item is True if the superstructure height, Z, should be program calculated, otherwise it is
false.

SuperstructureZ

The superstructure height Z. This item applies only when SuperProgCalc = False. [L]

q

The reference wind pressure, q. [F/L^2 ]

Cg

The gust effect factor.

CeProgCalc

This item is True if the wind exposure factor, Ce, should be program calculated, otherwise it is
false.

Ce


The wind exposure factor. This item applies only when CeProgCalc = False.

ChStructure

The Ch factor for wind acting on the structure.

ChLiveLoad

The Ch factor for wind acting on the live load.

Cv

The Cv factor for vertical wind.

## Remarks

This function sets bridge auto wind loading parameters for CSA S6-14.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub SetBridgeWindCSAS614()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign CSA S6-14 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.SetCSAS614("WIND", True, True, True, -
100, True, 10, 1, 2, True, 1, 2, 1.2, 1)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

## See Also

GetCSAS614

# SetEurocode12005

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.SetEurocode12005

## VB6 Procedure

Function SetEurocode12005(ByVal Name As String, ByVal Superstructure As Boolean, ByVal
Substructure As Boolean, ByVal Vertical As Boolean, ByVal GroundElevation As Double, ByVal
SuperZProgCalc As Boolean, ByVal SuperstructureZ As Double, ByVal SubZProgCalc As
Boolean, ByVal SubstructureZ As Double, ByVal WindSpeed As Double, ByVal Terrain As
Long, ByVal Orography As Double, ByVal k1 As Double, ByVal Rho As Double, ByVal Cfx As
Double, ByVal CfzUp As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

Superstructure

This item is True if wind on the superstructure should be considered, otherwise it is false.

Substructure

This item is True if wind on the substructure should be considered, otherwise it is false.

Vertical

This item is True if vertical wind should be considered, otherwise it is false

GroundElevation


The ground elevation used for determining heights used for wind pressure values. [L]

SuperZProgCalc

This item is True if the superstructure height, Z, should be program calculated, otherwise it is
false.

SuperstructureZ

The superstructure height Z. This item applies only when SuperProgCalc = False. [L]

SubZProgCalc

This item is True if the substructure height, Z, should be program calculated, otherwise it is false.

SuperstructureZ

The substructure height Z. This item applies only when SubProgCalc = False. [L]

WindSpeed

The basic wind speed, vb, in meters per second.

Terrain

The terrain category.

```
0 = 0
```
```
1 = I
```
```
2 = II
```
```
3 = III
```
```
4 = IV
```
Orography

The orography factor, Co.

k1

The turbulence factor, k1.

Rho

The air density in kg/m^3 , Rho.

Cfx

The force coefficient, Cf, in the horizontal direction.

CfzUp


The force coefficient, Cf, in the vertical up direction.

## Remarks

This function sets bridge auto wind loading parameters for Eurocode 1-2005.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub SetBridgeWindEurocode12005()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign Eurocode 1-2005 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.SetEurocode12005("WIND", True, True,
True, -100, True, 10, True, 10, 35, 2, 1, 1.25, 1.3, 0.9)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.


## See Also

GetEurocode12005

# GetIRC62017

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.GetIRC62017

## VB6 Procedure

Function GetIRC62017(ByVal Name As String, ByRef Superstructure As Boolean, ByRef
Substructure As Boolean, ByRef Vertical As Boolean, ByRef GroundElevation As Double,
ByRef SuperZProgCalc As Boolean, ByRef SuperstructureZ As Double, ByRef
SubZProgCalc As Boolean, ByRef SubstructureZ As Double, ByRef vb As Double, ByRef
Terrain As Long, ByRef G As Double, ByRef CDSuper As Double, ByRef CDSub As
Double, ByRef CL As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

Superstructure

This item is True if wind on the superstructure should be considered, otherwise it is false.

Substructure

This item is True if wind on the substructure should be considered, otherwise it is false.

Vertical

This item is True if vertical wind should be considered, otherwise it is false

GroundElevation

The ground elevation used for determining heights used for wind pressure values. [L]

SuperZProgCalc

This item is True if the superstructure height, Z, should be program calculated, otherwise it is
false.

SuperstructureZ

The superstructure height Z. This item applies only when SuperProgCalc = False. [L]

SubZProgCalc


This item is True if the substructure height, Z, should be program calculated, otherwise it is false.

SubstructureZ

The substructure height Z. This item applies only when SubProgCalc = False. [L]

vb

The basic wind speed. [m/s]

Terrain

The terrain type.

```
0 = Plain
```
```
1 = Obstructions
```
### G

The gust factor, G.

CDSuper

The drag coefficient for the superstructure, C D.

CDSub

The drag coefficient for the substructure, C D.

CL

The lift coefficient, C L, for vertical wind.

## Remarks

This function retrieves bridge auto wind loading parameters for IRC:6-2017.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindIRC62017()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Superstructure As Boolean
Dim Substructure As Boolean
Dim Vertical As Boolean
Dim GroundElevation As Double


Dim SuperZProgCalc As Boolean
Dim SuperstructureZ As Double
Dim SubZProgCalc As Boolean
Dim SubstructureZ As Double
Dim vb As Double

Dim Terrain As Long
Dim G As Double
Dim CDSuper As Double
Dim CDSub As Double
Dim CL As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign IRC62017 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.SetIRC62017("WIND", True, True, True, -
100, True, 10, True, 10, 33, 0, 2, 1.5, 1.5, 0.75)

'get IRC62017 parameters
ret = SapModel.LoadPatterns.AutoWindBridge.GetIRC62017("WIND", Superstructure,
Substructure, Vertical, GroundElevation, SuperZProgCalc, SuperstructureZ, SubZProgCalc,
SubstructureZ, vb, Terrain, G, CDSuper, CDSub, CL)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v23.1.0.

## See Also


SetIRC62017

# SetIRC62017

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.SetIRC62017

## VB6 Procedure

Function SetIRC62017(ByVal Name As String, ByVal Superstructure As Boolean, ByVal
Substructure As Boolean, ByVal Vertical As Boolean, ByVal GroundElevation As Double,
ByVal SuperZProgCalc As Boolean, ByVal SuperstructureZ As Double, ByVal
SubZProgCalc As Boolean, ByVal SubstructureZ As Double, ByVal vb As Double, ByVal
Terrain As Long, ByVal G As Double, ByVal CDSuper As Double, ByVal CDSub As
Double, ByVal CL As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

Superstructure

This item is True if wind on the superstructure should be considered, otherwise it is false.

Substructure

This item is True if wind on the substructure should be considered, otherwise it is false.

Vertical

This item is True if vertical wind should be considered, otherwise it is false

GroundElevation

The ground elevation used for determining heights used for wind pressure values. [L]

SuperZProgCalc

This item is True if the superstructure height, Z, should be program calculated, otherwise it is
false.

SuperstructureZ

The superstructure height Z. This item applies only when SuperProgCalc = False. [L]

SubZProgCalc


This item is True if the substructure height, Z, should be program calculated, otherwise it is false.

SubstructureZ

The substructure height Z. This item applies only when SubProgCalc = False. [L]

vb

The basic wind speed. [m/s]

Terrain

The terrain type.

```
0 = Plain
```
```
1 = Obstructions
```
### G

The gust factor, G.

CDSuper

The drag coefficient for the superstructure, C D.

CDSub

The drag coefficient for the substructure, C D.

CL

The lift coefficient, C L, for vertical wind.

## Remarks

This function sets bridge auto wind loading parameters for IRC:6-2017.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindIRC62017()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign CSA S6-14 parameters
ret = SapModel.LoadPatterns.AutoWindBridge. SetIRC62017("WIND", True, True, True, -
100, True, 10, True, 10, 33, 0, 2, 1.5, 1.5, 0.75)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing

End Sub

## Release Notes

Initial release in v23.1.0.

## See Also

GetIRC62017

# SetNoneLiveLoad

## Syntax

SapObject.SapModel.LoadPatterns.AutoWindBridge.SetNoneLiveLoad

## VB6 Procedure

Function SetNoneLiveLoad(ByVal Name As String) As Long

## Parameters


Name

The name of an existing bridge wind - live load type pattern.

## Remarks

This function sets the auto wind – live load type for the specified load pattern to None.

The function returns zero if the loading type is successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindLiveLoadNone()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'open existing model containing a bridge object
ret = SapModel.File.OpenFile(“C:\Temp\BridgeModel.bdb” )

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WINDONLIVELOAD)

'set auto wind live load loading type to None
ret = SapModel.LoadPatterns.AutoWindBridge.SetNoneLiveLoad("WINDLIVE")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in v21.0.0.

# GetAPI4F2008_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetAPI4F2008_1

## VB6 Procedure

Function GetAPI4F2008_1(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByRef UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As
Double, ByRef WindSpeed As Double, ByRef SSLFactor As Double, ByRef ShieldingFactor As
Double) As Long

## Parameters

Name

The name of an existing Wind-type load case with an API 4F 2008 auto wind assignment.

ExposureFrom

This is 2, 3, or 4, indicating the source of the wind exposure.

```
2 = From area objects
```
```
3 = From frame objects (open structure)
```
```
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 3 or 4.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified.

It is False if the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ


This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The design reference wind velocity, Vref, in knots.

SSLFactor

The structural safety level multiplier.

ShieldingFactor

The shielding factor.

## Remarks

This function retrieves auto wind loading parameters for API 4F 2008.

The function returns zero if the parameters are successfully assigned; otherwise, it returns a
nonzero value.

## VBA Example

Sub GetWindAPI4F2008()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim SSLFactor As Double
Dim ShieldingFactor As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)


'add new load case
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign API 4F 2008 parameters
ret = SapModel.LoadPatterns.AutoWind.SetAPI4F2008_1("WIND", 3, 0, False, 0, 0,93, 1.1,
0.85)

'get API 4F 2008 parameters
ret = SapModel.LoadPatterns.AutoWind.GetAPI4F2008_1("WIND", ExposureFrom,
DirAngle, UserZ, TopZ, BottomZ, WindSpeed, SSLFactor, ShieldingFactor)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.1.0.

This function supersedes GetAPI4F2008.

## See Also

SetAPI4F2008_1

# GetAPI4F2013

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetAPI4F2013

## VB6 Procedure

Function GetAPI4F2013(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByRef UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As
Double, ByRef WindSpeed As Double, ByRef SSLFactor As Double, ByRef ShieldingFactor As
Double) As Long

## Parameters

Name

The name of an existing Wind-type load case with an API 4F 2013 auto wind assignment.

ExposureFrom

This is 2, 3, or 4, indicating the source of the wind exposure.


```
2 = From area objects
```
```
3 = From frame objects (open structure)
```
```
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 3 or 4.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified.

It is False if the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The design reference wind velocity, Vref, in knots.

SSLFactor

The structural safety level multiplier.

ShieldingFactor

The shielding factor.

## Remarks

This function retrieves auto wind loading parameters for API 4F 2013.

The function returns zero if the parameters are successfully assigned; otherwise, it returns a
nonzero value.

## VBA Example

Sub GetWindAPI4F2013()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim UserZ As Boolean
Dim TopZ As Double


Dim BottomZ As Double
Dim WindSpeed As Double
Dim SSLFactor As Double
Dim ShieldingFactor As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load case
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign API 4F 2013 parameters
ret = SapModel.LoadPatterns.AutoWind.SetAPI4F2013("WIND", 3, 0, False, 0, 0,93, 1.1,
0.85)

'get API 4F 2013 parameters
ret = SapModel.LoadPatterns.AutoWind.GetAPI4F2013("WIND", ExposureFrom, DirAngle,
UserZ, TopZ, BottomZ, WindSpeed, SSLFactor, ShieldingFactor)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.1.0.

## See Also

SetAPI4F2013

# GetASCE702

## Syntax


SapObject.SapModel.LoadPatterns.AutoWind.GetASCE702

## VB6 Procedure

Function GetASCE702(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef ASCECase As Long, ByRef
ASCEe1 As Double, ByRef ASCEe2 As Double, ByRef UserZ As Boolean, ByRef TopZ As
Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef ExposureType As
Long, ByRef ImportanceFactor As Double, ByRef Kzt As Double, ByRef GustFactor As Double,
ByRef Kd As Double, ByRef SolidGrossRatio As Double, ByRef UserExposure As Boolean) As
Long

## Parameters

Name

The name of an existing Wind-type load pattern with an ASCE7-02 auto wind assignment.

ExposureFrom

This is 1, 2, 3 or 4, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
3 = From frame objects (open structure)
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1, 3, or 4.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

ASCECase

This is 1, 2, 3, 4 or 5, indicating the desired case from ASCE7-02 Figure 6-9. 1, 2, 3 and 4 refer to
cases 1 through 4 in the figure. 5 means to create all cases. This item applies only when
ExposureFrom = 1.

ASCEe1

This is the value e1 in ASCE7-02 Figure 6-9. This item applies only when ExposureFrom = 1.

ASCEe2

This is the value e2 in ASCE7-02 Figure 6-9. This item applies only when ExposureFrom = 1.

UserZ


This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2, 3 or 4, indicating the exposure category.

```
1 = A
2 = B
3 = C
4 = D
```
ImportanceFactor

The importance factor.

Kzt

The topographical factor.

GustFactor

The gust factor.

Kd

The directionality factor.

SolidGrossRatio

The solid area divided by gross area ratio for open frame structure loading. This item applies only
when the loading is from open structure wind loading (ExposureFrom = 3 or ExposureFrom = 4).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for ASCE 7-02.


The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindASCE702()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim ASCECase As Long
Dim ASCEe1 As Double
Dim ASCEe2 As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim ExposureType As Long
Dim ImportanceFactor As Double
Dim Kzt As Double
Dim GustFactor As Double
Dim Kd As Double
Dim SolidGrossRatio As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)


ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE702 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE702("WIND", 1, 0, 0.8, 0.5, 2, 0.15, 0.18,
False, 0, 0, 80, 3, 1, 1.1, 0.85, 0.88)

'get ASCE702 parameters
ret = SapModel.LoadPatterns.AutoWind.GetASCE702("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, ASCECase, ASCEe1, ASCEe2, UserZ, TopZ, BottomZ, WindSpeed, ExposureType,
ImportanceFactor, Kzt, GustFactor, Kd, SolidGrossRatio, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetASCE702

# GetASCE705

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetASCE705

## VB6 Procedure

Function GetASCE705(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef ASCECase As Long, ByRef
ASCEe1 As Double, ByRef ASCEe2 As Double, ByRef UserZ As Boolean, ByRef TopZ As
Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef ExposureType As
Long, ByRef ImportanceFactor As Double, ByRef Kzt As Double, ByRef GustFactor As Double,
ByRef Kd As Double, ByRef SolidGrossRatio As Double, ByRef UserExposure As Boolean) As
Long


## Parameters

Name

The name of an existing Wind-type load pattern with an ASCE7-05 auto wind assignment.

ExposureFrom

This is 1, 3 or 4, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
3 = From frame objects (open structure)
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1, 3, or 4.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

ASCECase

This is 1, 2, 3, 4 or 5, indicating the desired case from ASCE7-05 Figure 6-9. 1, 2, 3 and 4 refer to
cases 1 through 4 in the figure. 5 means to create all cases. This item applies only when
ExposureFrom = 1.

ASCEe1

This is the value e1 in ASCE7-05 Figure 6-9. This item applies only when ExposureFrom = 1.

ASCEe2

This is the value e2 in ASCE7-05 Figure 6-9. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed


The wind speed in miles per hour.

ExposureType

This is 1, 2 or 3, indicating the exposure category.

```
1 = B
2 = C
3 = D
```
ImportanceFactor

The importance factor.

Kzt

The topographical factor.

GustFactor

The gust factor.

Kd

The directionality factor.

SolidGrossRatio

The solid area divided by the gross area ratio for open frame structure loading. This item applies
only when the loading is from open structure wind loading (ExposureFrom = 3 or ExposureFrom
= 4).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for ASCE 7-05.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindASCE705()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double


Dim Cpw As Double
Dim Cpl As Double
Dim ASCECase As Long
Dim ASCEe1 As Double
Dim ASCEe2 As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim ExposureType As Long
Dim ImportanceFactor As Double
Dim Kzt As Double
Dim GustFactor As Double
Dim Kd As Double
Dim SolidGrossRatio As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE705 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE705("WIND", 1, 0, 0.8, 0.5, 2, 0.15, 0.18,
False, 0, 0, 80, 3, 1, 1.1, 0.85, 0.88)

'get ASCE705 parameters


ret = SapModel.LoadPatterns.AutoWind.GetASCE705("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, ASCECase, ASCEe1, ASCEe2, UserZ, TopZ, BottomZ, WindSpeed, ExposureType,
ImportanceFactor, Kzt, GustFactor, Kd, SolidGrossRatio, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetASCE705

# GetASCE788

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetASCE788

## VB6 Procedure

Function GetASCE788(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef
ExposureType As Long, ByRef ImportanceFactor As Double, ByRef GustFactor As Double,
ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an ASCE7-88 auto wind assignment.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle


The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2, 3 or 4, indicating the exposure category.

```
1 = A
2 = B
3 = C
4 = D
```
ImportanceFactor

The importance factor.

GustFactor

The gust factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for ASCE 7-88.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.


## VBA Example

Sub GetWindASCE788()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim ExposureType As Long
Dim ImportanceFactor As Double
Dim GustFactor As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE788 parameters


ret = SapModel.LoadPatterns.AutoWind.SetASCE788("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80,
3, 1, 0.85)

'get ASCE788 parameters
ret = SapModel.LoadPatterns.AutoWind.GetASCE788("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, WindSpeed, ExposureType, ImportanceFactor, GustFactor,
UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetASCE788

# GetASCE795

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetASCE795

## VB6 Procedure

Function GetASCE795(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef
ExposureType As Long, ByRef ImportanceFactor As Double, ByRef Kzt As Double, ByRef
GustFactor As Double, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an ASCE7-95 auto wind assignment.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.


```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2, 3 or 4, indicating the exposure category.

```
1 = A
2 = B
3 = C
4 = D
```
ImportanceFactor

The importance factor.

Kzt

The topographical factor.

GustFactor

The gust factor.

UserExposure


If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for ASCE 7-95.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindASCE795()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim ExposureType As Long
Dim ImportanceFactor As Double
Dim Kzt As Double
Dim GustFactor As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm


ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE795 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE795("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80,
3, 1, 1.1, 0.85)

'get ASCE795 parameters
ret = SapModel.LoadPatterns.AutoWind.GetASCE795("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, WindSpeed, ExposureType, ImportanceFactor, Kzt,
GustFactor, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetASCE795

# GetASCE710

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetASCE710

## VB6 Procedure

Function GetASCE710(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef ASCECase As Long, ByRef
ASCEe1 As Double, ByRef ASCEe2 As Double, ByRef UserZ As Boolean, ByRef TopZ As
Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef ExposureType As


Long, ByRef ImportanceFactor As Double, ByRef Kzt As Double, ByRef GustFactor As Double,
ByRef Kd As Double, ByRef SolidGrossRatio As Double, ByRef UserExposure As Boolean) As
Long

## Parameters

Name

The name of an existing Wind-type load pattern with an ASCE7-10 auto wind assignment.

ExposureFrom

This is 1, 2, 3 or 4, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
3 = From frame objects (open structure)
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1, 3, or 4.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

ASCECase

This is 1, 2, 3, 4 or 5, indicating the desired case from ASCE7-10 Figure 27.4-8. 1, 2, 3 and 4 refer
to cases 1 through 4 in the figure. 5 means to create all cases. This item applies only when
ExposureFrom = 1.

ASCEe1

This is the value e1 in ASCE7-10 Figure 27.4-8. This item applies only when ExposureFrom = 1.

ASCEe2

This is the value e2 in ASCE7-10 Figure 27.4-8. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ


This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2 or 3, indicating the exposure category.

```
1 = B
2 = C
3 = D
```
ImportanceFactor

The importance factor.

Kzt

The topographical factor.

GustFactor

The gust factor.

Kd

The directionality factor.

SolidGrossRatio

The solid area divided by the gross area ratio for open frame structure loading. This item applies
only when the loading is from open structure wind loading (ExposureFrom = 3 or ExposureFrom
= 4).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for ASCE 7-10.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindASCE710()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim ASCECase As Long
Dim ASCEe1 As Double
Dim ASCEe2 As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim ExposureType As Long
Dim ImportanceFactor As Double
Dim Kzt As Double
Dim GustFactor As Double
Dim Kd As Double
Dim SolidGrossRatio As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE710 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE710("WIND", 1, 0, 0.8, 0.5, 2, 0.15, 0.18,


False, 0, 0, 80, 3, 1, 1.1, 0.85, 0.88)

'get ASCE710 parameters
ret = SapModel.LoadPatterns.AutoWind.GetASCE710("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, ASCECase, ASCEe1, ASCEe2, UserZ, TopZ, BottomZ, WindSpeed, ExposureType,
ImportanceFactor, Kzt, GustFactor, Kd, SolidGrossRatio, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0

## See Also

SetASCE710

# GetASCE716

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetASCE716

## VB6 Procedure

Function GetASCE716(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef ASCECase As Long, ByRef
ASCEe1 As Double, ByRef ASCEe2 As Double, ByRef UserZ As Boolean, ByRef TopZ As
Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef ExposureType As
Long, ByRef Kzt As Double, ByRef GustFactor As Double, ByRef Kd As Double, ByRef
SolidGrossRatio As Double, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an ASCE7-16 auto wind assignment.

ExposureFrom

This is 1, 2, 3 or 4, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
3 = From frame objects (open structure)
```

```
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1, 3, or 4.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

ASCECase

This is 1, 2, 3, 4 or 5, indicating the desired case from ASCE7-16 Figure 27.3-8. 1, 2, 3 and 4 refer
to cases 1 through 4 in the figure. 5 means to create all cases. This item applies only when
ExposureFrom = 1.

ASCEe1

This is the value e1 in ASCE7-16 Figure 27.3-8. This item applies only when ExposureFrom = 1.

ASCEe2

This is the value e2 in ASCE7-16 Figure 27.3-8. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2 or 3, indicating the exposure category.

```
1 = B
2 = C
3 = D
```
Kzt

The topographical factor.


GustFactor

The gust factor.

Kd

The directionality factor.

SolidGrossRatio

The solid area divided by the gross area ratio for open frame structure loading. This item applies
only when the loading is from open structure wind loading (ExposureFrom = 3 or ExposureFrom
= 4).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for ASCE 7-16.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindASCE716()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim ASCECase As Long
Dim ASCEe1 As Double
Dim ASCEe2 As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim ExposureType As Long
Dim Kzt As Double
Dim GustFactor As Double
Dim Kd As Double
Dim SolidGrossRatio As Double
Dim UserExposure As Boolean

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE716 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE716("WIND", 1, 0, 0.8, 0.5, 2, 0.15, 0.18,
False, 0, 0, 80, 3, 1.1, 0.85, 0.88)

'get ASCE716 parameters
ret = SapModel.LoadPatterns.AutoWind.GetASCE716("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, ASCECase, ASCEe1, ASCEe2, UserZ, TopZ, BottomZ, WindSpeed, ExposureType,
Kzt, GustFactor, Kd, SolidGrossRatio, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 23.2.0

## See Also


SetASCE716

# GetASNZS117022002

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetASNZS117022002

## VB6 Procedure

Function GetASNZS117022002(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByRef Ka As Double,
ByRef Kc As Double, ByRef Kl As Double, ByRef Kp As Double, ByRef UserZ As Boolean,
ByRef TopZ As Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef Cat
As Long, ByRef CycloneRegion As Boolean, ByRef Md As Double, ByRef Ms As Double,
ByRef Mt As Double, ByRef Cdyn As Double, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load case with an AS/NZS 1170.2:2002 auto wind assignment.

ExposureFrom

This is 1, or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
```
```
2 = From area objects
```
DirAngle

The direction angle for the wind load.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

Ka

The area reduction factor, Ka.

Kc

The combination factor, Kc.

Kl


The local pressure factor, Kl.

Kp

The porous cladding factor, Kp.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The regional wind speed, Vr, in m/s.

Cat

This is 1, 2, 3 or 4, indicating the terrain category.

CycloneRegion

This is True or False, indicating if the structure is in a cyclone region.

Md

The directional multiplier, Md.

Ms

The shielding multiplier, Ms.

Mt

The topographic multiplier, Mt.

Cdyn

The dynamic response factor, Cdyn.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for AS/NZS 1170.2:2002.


The function returns zero if the parameters are successfully assigned; otherwise, it returns a
nonzero value.

## VBA Example

Sub GetWindASNZS117022002()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim Ka As Double
Dim Kc As Double
Dim Kl As Double
Dim Kp As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim Cat As Long
Dim CycloneRegion As Boolean
Dim Md As Double
Dim Ms As Double
Dim Mt As Double
Dim Cdyn As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load case
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign AS/NZS 1170.2:2002 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASNZS117022002("WIND", 1, 0, 0.8, 0.5, 1, 1,
1, 1, False, 0, 0, 50, 2, False, 1, 1, 1, 1)


'get AS/NZS 1170.2:2002 parameters
ret = SapModel.LoadPatterns.AutoWind.GetASNZS117022002("WIND", ExposureFrom,
DirAngle, Cpw, Cpl, Ka, Kc, Kl, Kp, UserZ, TopZ, BottomZ, WindSpeed, Cat, CycloneRegion,
Md, Ms, Mt, Cdyn, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.1.0.

## See Also

SetASNZS117022002

# GetBOCA96

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetBOCA96

## VB6 Procedure

Function GetBOCA96(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef
ExposureType As Long, ByRef ImportanceFactor As Double, ByRef UserGust As Boolean,
ByRef GustFactor As Double, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an BOCA 96 auto wind assignment.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.


Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2, 3 or 4, indicating the exposure category.

```
1 = A
2 = B
3 = C
4 = D
```
ImportanceFactor

The importance factor.

UserGust

If this item is True, the gust factor is user defined. If it is False, the gust factor is determined from
the code specified values.

GustFactor

The user defined gust factor. This item applies only when UserGust is True.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for BOCA 96.


The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindBOCA96()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim ExposureType As Long
Dim ImportanceFactor As Double
Dim UserGust As Boolean
Dim GustFactor As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection


'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign BOCA96 parameters
ret = SapModel.LoadPatterns.AutoWind.SetBOCA96("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80,
3, 1, 0.85, True, False)

'get BOCA96 parameters
ret = SapModel.LoadPatterns.AutoWind.GetBOCA96("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, WindSpeed, ExposureType, ImportanceFactor, UserGust,
GustFactor, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetBOCA96

# GetBS639995

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetBS639995

## VB6 Procedure

Function GetBS639995(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef Ve As Double, ByRef Ca As Double, ByRef
Cr As Double, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an BS6399-95 auto wind assignment.


ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The front coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The rear coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

Ve

The effective wind speed in meters per second.

Ca

The size effect factor.

Cr

The dynamic augmentation factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for BS6399-95.


The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindBS639995()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim Ve As Double
Dim Ca As Double
Dim Cr As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)


'assign BS639995 parameters
ret = SapModel.LoadPatterns.AutoWind.SetBS639995("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 32,
1.1,0.28)

'get BS639995 parameters
ret = SapModel.LoadPatterns.AutoWind.GetBS639995("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, Ve, Ca, Cr, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetBS639995

# GetChinese2010

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetChinese2010

## VB6 Procedure

Function GetChinese2010_1(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByRef BuildingWidth As Double, ByRef Us As Double, ByRef
UniformTaper As Boolean, ByRef BHoverB0 As Double, ByRef UserZ As Boolean, ByRef TopZ
As Double, ByRef BottomZ As Double, ByRef wzero As Double, ByRef Rt As Long, ByRef
PhiZOpt As Long, ByRef T1Opt As Long, ByRef UserT As Double, ByRef DampRatio As
Double, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an Chinese 2010 auto wind assignment.

ExposureFrom


This is 1 or 2 indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

BuildingWidth

The building width. [L]

Us

The shape coefficient. This item applies only when ExposureFrom = 1.

UniformTaper

This item is True if a correction is to be applied to the wind load for a uniform taper.

BHoverB0

The taper ratio, Bh/B0. This item applies only when UniformTaper = True.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

wzero

The basic wind pressure in kN/m^2.

Rt

This is 1, 2, 3 or 4, indicating the ground roughness.

```
1 = A
2 = B
3 = C
4 = D
```
PhiZOpt

This is 0 or 1, indicating the Phi Z source.


```
0 = Modal analysis
1 = Z/H ratio
```
T1Opt

This is 0 or 1, indicating the T1 source.

```
0 = Modal analysis
1 = User defined
```
UserT

This item only applies when the T1 source is user defined (T1Opt = 1). It is the user defined T1
period. [s]

DampRatio

The damping ratio.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for Chinese 2010.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindChinese2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim BuildingWidth As Double
Dim Us As Double
Dim UniformTaper As Boolean
Dim BHoverB0 As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim wzero As Double
Dim Rt As Long
Dim PhiZOpt As Long
Dim T1Opt As Long
Dim UserT As Double
Dim DampRatio As Double


Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign Chinese2010 parameters
ret = SapModel.LoadPatterns.AutoWind.SetChinese2010("WIND", 1, 0, 1200, 0.5, False, 1,
False, 0, 0, 0.48, 3, 1, 1, 0.6, 0.04)

'get Chinese2010 parameters
ret = SapModel.LoadPatterns.AutoWind.GetChinese2010("WIND", ExposureFrom,
DirAngle, BuildingWidth, Us, UniformTaper, BHoverB0, UserZ, TopZ, BottomZ, wzero, Rt,
PhiZOpt, T1Opt, UserT, DampRatio, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.2.


## See Also

SetChinese2010

# GetEurocode12005_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetEurocode12005_1

## VB6 Procedure

Function GetEurocode12005_1(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean,
ByRef TopZ As Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef
Terrain As Long, ByRef Orography As Double, ByRef k1 As Double, ByRef CsCd As Double,
ByRef Rho As Double, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with a Eurocode 1 2005 auto wind assignment.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]


BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The basic wind speed, vb, in meters per second.

Terrain

This is 0, 1, 2, 3 or 4, indicating the terrain category.

```
0 = 0
1 = I
2 = II
3 = III
4 = IV
```
Orography

The orography factor, Co.

k1

The turbulence factor, k1.

CsCd

The structural factor, CsCd.

Rho

The air density in kg/m^3 , Rho.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for Eurocode 1 2005.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindEurocode12005()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim Terrain As Long
Dim Orography As Double
Dim k1 As Double
Dim CsCd As Double
Dim Rho As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign Eurocode 1 2005 parameters
ret = SapModel.LoadPatterns.AutoWind.SetEurocode12005_1("WIND", 1, 0, 0.8, 0.5, False,
0, 0, 35, 2, 1, 1, 1)

'get Eurocode 1 2005 parameters
ret = SapModel.LoadPatterns.AutoWind.GetEurocode12005_1("WIND", ExposureFrom,
DirAngle, Cpw, Cpl, UserZ, TopZ, BottomZ, WindSpeed, Terrain, Orography, k1, CsCd,


UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.1.0.

This function supersedes GetEurocode12005.

## See Also

SetEurocode12005_1

# GetExposure_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetExposure_1

## VB6 Procedure

Function GetExposure_1(ByVal Name As String, ByRef Num As Long, ByRef Diaph() As String,
ByRef x() As Double, ByRef y() As Double, ByRef MyWidth() As Double, ByRef MyDepth() As
Double, ByRef Height() As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern that has an auto wind load assigned.

Num

The number of diaphragms at which exposure data is reported.

Diaph

This is an array that includes the names of the diaphragms that have eccentricity overrides.

x


This is an array that includes the global X-coordinate of the point where the wind force load is
applied to the diaphragm. [L]

y

This is an array that includes the global Y-coordinate of the point where the wind force load is
applied to the diaphragm. [L]

MyWidth

This is an array that includes the exposure width for the wind load applied to the specified
diaphragm. [L]

MyDepth

This is an array that includes the exposure depth for the wind load applied to the specified
diaphragm. [L]

Height

This is an array that includes the exposure height for the wind load applied to the specified
diaphragm. [L]

## Remarks

This function retrieves exposure parameters for auto wind loads determined from extents of rigid
diaphragms. This function does not apply for User-type auto wind loads.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindExposure_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Num As Long
Dim Diaph() As String
Dim x() As Double
Dim y() As Double
Dim MyWidth() As Double
Dim MyDepth() As Double
Dim Height() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE788 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE788("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80,
3, 1, 0.85, True)

'assign user exposure data
ret = SapModel.LoadPatterns.AutoWind.SetExposure_1("WIND", "Diaph2", 0, 0, 900, 90,
125)

'get exposure data
ret = SapModel.LoadPatterns.AutoWind.GetExposure_1("WIND", Num, Diaph, x, y,
MyWidth, MyDepth, Height)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.3.0.

This function supersedes GetExposure.

## See Also

SetExposure_1


# GetIS8751987

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetIS8751987

## VB6 Procedure

Function GetIS8751987(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef Terrain As
Long, ByRef Class As Long, ByRef K1 As Double, ByRef K3 As Double, ByRef UserExposure
As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an Indian IS875-1987 auto wind assignment.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in meters per second.

Terrain

This is 1, 2, 3 or 4, indicating the terrain category.

Class

This is 1, 2 or 3, indicating the terrain category.

```
1 = A
2 = B
3 = C
```
K1

The risk coefficient (k1 factor).

K3

The topography factor (k3 factor).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for Indian IS875-1987.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindIS8751987()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double


Dim WindSpeed As Double
Dim Terrain As Long
Dim Class As Long
Dim K1 As Double
Dim K3 As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign IS8751987 parameters
ret = SapModel.LoadPatterns.AutoWind.SetIS8751987("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
60, 3, 3, 1.1, 1.2)

'get IS8751987 parameters
ret = SapModel.LoadPatterns.AutoWind.GetIS8751987("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, WindSpeed, Terrain, Class, K1, K3, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetIS8751987

# GetIS8752015

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetIS8752015

## VB6 Procedure

Function GetIS8752015(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef
TerrainCategory As Long, ByRef ImportanceFactor As Long, ByRef k1 As Double, ByRef k3 As
Double, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an Indian IS 875:2015 auto wind
assignment.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.


UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in meters per second.

TerrainCategory

This is 1, 2, 3 or 4, indicating the terrain category.

ImportanceFactor

This is 1, 2 or 3, depending on the importance factor.

```
1 = 1.00
2 = 1.15
3 = 1.30
```
k1

The risk coefficient (k1 factor).

k3

The topography factor (k3 factor).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for Indian IS875-2015.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example


Sub GetWindIS8752015()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim TerrainCategory As Long
Dim ImportanceFactor As Long
Dim k1 As Double
Dim k3 As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign IS8752015 parameters
ret = SapModel.LoadPatterns.AutoWind.SetIS8752015("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
60, 3, 3, 1.1, 1.2)


'get IS8752015 parameters
ret = SapModel.LoadPatterns.AutoWind.GetIS8752015("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, WindSpeed, TerrainCategory, ImportanceFactor, k1, k3,
UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.2.0.

## See Also

SetIS8752015

# GetMexican

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetMexican

## VB6 Procedure

Function GetMexican(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef
UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an Indian IS875-1987 auto wind assignment.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.


Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in meters per second.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves the Mexican auto wind loading parameters.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindMexican()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double


Dim WindSpeed As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign Mexican parameters
ret = SapModel.LoadPatterns.AutoWind.SetMexican("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 40)

'get Mexican parameters
ret = SapModel.LoadPatterns.AutoWind.GetMexican("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, WindSpeed, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetMexican

# GetNBCC2015{Wind Load}

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetNBCC2015

## VB6 Procedure

Function GetNBCC2015(ByVal Name As String, ByVal ExposureFrom As Long, ByRef
DirAngle As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByVal NBCCCase As Long,
ByVal e1 As Double, ByVal e2 As Double, ByVal UserZ As Boolean, ByVal TopZ As Double,
ByVal BottomZ As Double, ByRef q As Double, ByRef GustFactor As Double, ByVal
TopographicFactor As Double, ByRef ImportanceFactor As Double, ByRef TerrainType As
Long, ByRef CeWindward As Double, ByRef CeLeeward As Double, ByRef UserExposure As
Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an NBCC 2015 auto wind assignment..

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

NBCCCase


This is 1, 2, 3, 4, or 5, indicating the desired case from NBCC 2105 Figure A-4.1.7.9(1). 1,2,3, and
4 refer to cases 1 through 4 in the figure, while 5 means all cases. This item applies only when
ExposureFrom = 1.

**e1**

This is the value e1 in the NBCC 2015 Figure A-4.1.7.9(1). This item applies only when
ExposureFrom = 1.

**e2**

This is the value e2 in the NBCC 2015 Figure A-4.1.7.9(1). This item applies only when
ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

q

The velocity pressure in kPa.

GustFactor

The gust effect factor, Cg.

TopographicFactor

The importance factor, Ct.

ImportanceFactor

The importance Factor, Iw.

TerrainType

This is 1, 2, or 3, indicating the terrain type.

```
1 = Open
```
```
2 = Rough
```
```
3 = User
```
CeWindward


The windward exposure factor, Ce. This item applies only when TerrainType = 3.

CeLeeward

The windward exposure factor, Ce. This item applies only when TerrainType = 3.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for NBCC 2015.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindNBCC2015()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim ExposureFrom As Long

Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim NBCCCase As Long

Dim e1 As Double

Dim e2 As Double

Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim q As Double
Dim GustFactor As Double
Dim ImportanceFactor As Double

Dim TerrainType As Long

Dim CeWindward As Double

Dim CeLeeward As Double
Dim UserExposure As Boolean

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign NBCC2015 parameters
ret = SapModel.LoadPatterns.AutoWind.SetNBCC2015("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
0.75, 2.1, 1.1, 1, 0, 0)

'get NBCC2015 parameters
ret = SapModel.LoadPatterns.AutoWind.GetNBCC2015("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, Case, e1, e2, UserZ, TopZ, BottomZ, q, GustFactor, TopographicFactor,
ImportanceFactor, TerrainType, CeWindward, CeLeeward, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

## See Also


Set NBCC2015

# GetNBCC2010_1 {Wind Load}

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetNBCC2010_1

## VB6 Procedure

Function GetNBCC2010_1(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean,
ByRef TopZ As Double, ByRef BottomZ As Double, ByRef q As Double, ByRef GustFactor As
Double, ByRef ImportanceFactor As Double, ByRef TerrainType As Long, ByRef CeWindward
As Double, ByRef CeLeeward As Double, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an NBCC 2010 auto wind assignment.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

q

The velocity pressure in kPa.

GustFactor

The gust effect factor.

ImportanceFactor

The importance factor.

TerrainType

This is 1, 2, or 3, indicating the terrain type.

```
1 = Open
```
```
2 = Rough
```
```
3 = User
```
CeWindward

The windward exposure factor, Ce. This item applies only when TerrainType = 3.

CeLeeward

The windward exposure factor, Ce. This item applies only when TerrainType = 3.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for NBCC 2010.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindNBCC2010()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim q As Double
Dim GustFactor As Double
Dim ImportanceFactor As Double

Dim TerrainType As Long

Dim CeWindward As Double

Dim CeLeeward As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign NBCC2010 parameters


ret = SapModel.LoadPatterns.AutoWind.SetNBCC2010_1("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
0.75, 2.1, 1.1, 1, 0, 0)

'get NBCC2010 parameters
ret = SapModel.LoadPatterns.AutoWind.GetNBCC2010_1("WIND", ExposureFrom,
DirAngle, Cpw, Cpl, UserZ, TopZ, BottomZ, q, GustFactor, ImportanceFactor, TerrainType,
CeWindward, CeLeeward, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

This function supersedes GetNBCCC2010.

## See Also

SetNBCC2010_1

# GetNBCC2005

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetNBCC2005

## VB6 Procedure

Function GetNBCC2005(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean,
ByRef TopZ As Double, ByRef BottomZ As Double, ByRef q As Double, ByRef GustFactor As
Double, ByRef ImportanceFactor As Double, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an NBCC 2005 auto wind assignment.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```

DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

q

The velocity pressure in kPa.

GustFactor

The gust effect factor.

ImportanceFactor

The importance factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for NBCC 2005.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindNBCC2005()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim q As Double
Dim GustFactor As Double
Dim ImportanceFactor As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign NBCC2005 parameters
ret = SapModel.LoadPatterns.AutoWind.SetNBCC2005("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
0.75, 2.1, 1.1)

'get NBCC2005 parameters
ret = SapModel.LoadPatterns.AutoWind.GetNBCC2005("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, q, GustFactor, ImportanceFactor, UserExposure)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetNBCC2005

# GetNBCC95

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetNBCC95

## VB6 Procedure

Function GetNBCC95(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle
As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean, ByRef
TopZ As Double, ByRef BottomZ As Double, ByRef q As Double, ByRef GustFactor As Double,
ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an NBCC 95 auto wind assignment.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl


The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

q

The velocity pressure in kPa.

GustFactor

The gust effect factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for NBCC 95.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindNBCC95()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim q As Double
Dim GustFactor As Double
Dim UserExposure As Boolean


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign NBCC95 parameters
ret = SapModel.LoadPatterns.AutoWind.SetNBCC95("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
0.75, 2.1)

'get NBCC95 parameters
ret = SapModel.LoadPatterns.AutoWind.GetNBCC95("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, q, GustFactor, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

SetNBCC95

# GetNTC2008_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetNTC2008_1

## VB6 Procedure

Function GetNTC2008_1(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean,
ByRef TopZ As Double, ByRef BottomZ As Double, ByRef vr As Double, ByRef
ExposureCategory As Long, ByRef ct As Double, ByRef cd As Double, ByRef UserExposure As
Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an NTC 2008 auto wind assignment.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]


BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

vr

The wind velocity in m/s.

ExposureCategory

This is 1, 2, 3, 4, or 5, indicating the exposure category.

```
1 = I
2 = II
3 = III
4 = IV
5 = V
```
ct

The topography factor, ct.

cd

The dynamic coefficient, cd.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for NTC 2008.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindNTC2008()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double


Dim vr As Double
Dim ExposureCategory As Long

Dim ct As Double

Dim cd As Double

Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", eLoadPatternType_WIND)

'assign NTC2008 parameters
ret = SapModel.LoadPatterns.AutoWind.SetNTC2008_1("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 35, 3,
1, 1, False)

'get NTC2008 parameters
ret = SapModel.LoadPatterns.AutoWind.GetNTC2008_1("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, vr, ExposureCategory, ct, cd, UserExposure )

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 25.2.0.

This function supersedes GetNTC2008.

## See Also

SetNTC2008_1

# GetNTC2018_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetNTC2018_1

## VB6 Procedure

Function GetNTC2018_1(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean,
ByRef TopZ As Double, ByRef BottomZ As Double, ByRef vr As Double, ByRef
ExposureCategory As Long, ByRef ct As Double, ByRef cd As Double, ByRef UserExposure As
Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an NTC 2018 auto wind assignment.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ


This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

Vr

The wind velocity in m/s.

ExposureCategory

This is 1, 2, 3, 4, or 5, indicating the exposure category.

```
1 = I
2 = II
3 = III
4 = IV
5 = V
```
ct

The topography factor, ct.

cd

The dynamic coefficient, cd.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for NTC 2018.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindNTC2018()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long


Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim vr As Double
Dim ExposureCategory As Long

Dim ct As Double

Dim cd As Double

Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", eLoadPatternType_WIND)

'assign NTC2018 parameters
ret = SapModel.LoadPatterns.AutoWind.SetNTC2018_1("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 35, 3,
1, 1, False)

'get NTC2018 parameters
ret = SapModel.LoadPatterns.AutoWind.GetNTC2018_1("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, vr, ExposureCategory, ct, cd, UserExposure )


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.2.0.

This function supersedes GetNTC2018.

## See Also

SetNTC2018_1

# GetSP20133302016

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetSP20133302016

## VB6 Procedure

Function GetSP20133302016 (ByVal Name As String, ByRef LoadingType As Long, ByRef
ExposureFrom As Long, ByRef DirAngle As Double, ByRef Cp As Double, ByRef UserZ As
Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef StructureType As Integer,
ByRef LogDecrement As Integer, ByRef BuildingWidth As Double, ByRef BuildingDepth As
Double, ByRef Zeq As Double, ByRef WindDistrict As Long, ByRef WindPressure As Double,
ByRef TerrainType As Long, ByRef LimitFreq As Double, ByRef ModalCase As String, ByRef
FirstValMode As Long, ByRef UserExposure As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with a SP 20.13330.2016 auto wind assignment.

LoadingType

This indicates whether the loads should be calculated as static or dynamic.

```
1 = Static
2 = Dynamic
```
ExposureFrom


This is 1 or 2, indicating the source of the wind exposure. This item applies only when
LoadingType = 1.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item does not apply when ExposureFrom = 2.

Cp

The wind coefficient, Cp. This item applies only when LoadingType = 1 and ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

StructureType

This indicates the structure type for calculating the wind pressure.

```
1 = Building
2 = Other
```
LogDecrement

This specifies a value for the logarithmic decrement. This item applies only when LoadingType =
2.

```
1 = 0.15
2 = 0.30
```
BuildingWidth

This is the building width, normal to the wind direction. [L]

BuildingDepth

This is the building depth, in the direction of the wind. This item applies only when LoadingType
= 2. [L]

Zeq


This is the equivalent height, Zeq, of the structure. This item applies only when LoadingType = 2.
[L]

WindDistrict

This is the wind district to consider.

```
0 = Ia
1 = I
2 = II
3 = III
4 = IV
5 = V
6 = VI
7 = VII
8 = User Defined
```
WindPressure

This is the wind pressure. This item applies only when WindDistrict = 8. [F/L^2 ]

TerrainType

This is the terrain type being considered.

```
1 = A
2 = B
3 = C
```
LimitFreq

The limit frequency. This item applies only when LoadingType = 2 and WindDistrict = 8.

ModalCase

The name of an existing modal load case to be used in determining dynamic wind loads. This item
applies only when LoadingType = 2.

FirstValMode

The first valuable mode number from the specified modal case. This item applies only when
LoadingType = 2.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms. This item
applies only when LoadingType = 1.

## Remarks

This function retrieves auto wind loading parameters for SP 20.13330.2016.


The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindSP20133302016()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim LoadingType As Long

Dim ExposureFrom As Long

Dim DirAngle As Double

Dim Cp As Double

Dim UserZ As Boolean

Dim TopZ As Double

Dim BottomZ As Double

Dim StructureType As Long

Dim LogDecrement As Long

Dim BuildingWidth As Double

Dim Building Depth As Double

Dim Zeq As Double

Dim WindDistrict As Long

Dim WindPressure As Double

Dim TerrainType As Long

Dim LimitFreq As Double

Dim ModalCase As String

Dim FirstValMode As Long

Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection

ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign SP 20.13330.2016 parameters
ret = SapModel.LoadPatterns.AutoWind.SetSP20133302016("WIND", 1, 1, 0, 0.8, False, 0,
0, 1, 1, 10, 10, 10, 3, 0.1, 2, 10, “MODAL”, 1)

'get SP 20.13330.2016 parameters

ret = SapModel.LoadPatterns.AutoWind.GetSP20133302016("WIND", LoadingType,
ExposureFrom, DirAngle, Cp, UserZ, TopZ, BottomZ, StructureType, LogDecrement,
BuildingWidth, BuildingDepth, Zeq, WindDistrict, WindPressure, TerrainType, LimitFreq,
ModalCase, FirstValMode, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in v21.0.0.

## See Also

SetSP20133302016

# GetUBC94

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetUBC94

## VB6 Procedure

Function GetUBC94(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle As
Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean, ByRef TopZ
As Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef ExposureType As
Long, ByRef ImportanceFactor As Double, ByRef GustFactor As Double, ByRef UserExposure
As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an UBC94 auto wind assignment.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.


UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2 or 3, indicating the exposure category.

```
1 = B
2 = C
3 = D
```
ImportanceFactor

The importance factor.

GustFactor

The gust factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for 1994 UBC.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindUBC94()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double


Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim ExposureType As Long
Dim ImportanceFactor As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign UBC94 parameters
ret = SapModel.LoadPatterns.AutoWind.SetUBC94("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80, 3,
1.15)

'get UBC94 parameters
ret = SapModel.LoadPatterns.AutoWind.GetUBC94("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, WindSpeed, ExposureType, ImportanceFactor, UserExposure)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetUBC94

# GetUBC97

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetUBC97

## VB6 Procedure

Function GetUBC97(ByVal Name As String, ByRef ExposureFrom As Long, ByRef DirAngle As
Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean, ByRef TopZ
As Double, ByRef BottomZ As Double, ByRef WindSpeed As Double, ByRef ExposureType As
Long, ByRef ImportanceFactor As Double, ByRef GustFactor As Double, ByRef UserExposure
As Boolean) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an UBC97 auto wind assignment.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.


Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2 or 3, indicating the exposure category.

```
1 = B
2 = C
3 = D
```
ImportanceFactor

The importance factor.

GustFactor

The gust factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for 1997 UBC.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindUBC97()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim ExposureFrom As Long
Dim DirAngle As Double
Dim Cpw As Double
Dim Cpl As Double
Dim UserZ As Boolean
Dim TopZ As Double
Dim BottomZ As Double
Dim WindSpeed As Double
Dim ExposureType As Long
Dim ImportanceFactor As Double
Dim UserExposure As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign UBC97 parameters
ret = SapModel.LoadPatterns.AutoWind.SetUBC97("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80, 3,
1.15)

'get UBC97 parameters
ret = SapModel.LoadPatterns.AutoWind.GetUBC97("WIND", ExposureFrom, DirAngle,
Cpw, Cpl, UserZ, TopZ, BottomZ, WindSpeed, ExposureType, ImportanceFactor, UserExposure)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetUBC97

# GetUserLoad

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.GetUserLoad

## VB6 Procedure

Function GetUserLoad(ByVal Name As String, ByRef Num As Long, ByRef Diaph() As String,
ByRef Fx() As Double, ByRef Fx() As Double, ByRef Mz() As Double, ByRef x() As Double,
ByRef y() As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern that has a User-type auto wind load assigned.

Num

The number of diaphragms at which user wind loads are reported.

Diaph

This is an array that includes the names of the diaphragms that have user wind loads.

Fx

This is an array that includes the global X direction force assigned to the specified diaphragm. [F]

Fy


This is an array that includes the global Y direction force assigned to the specified diaphragm. [F]

Mz

This is an array that includes the moment about the global Z axis assigned to the specified
diaphragm. [FL]

x

This is an array that includes the global X-coordinate of the point where the wind force load is
applied to the diaphragm. [L]

y

This is an array that includes the global Y-coordinate of the point where the wind force load is
applied to the diaphragm. [L]

## Remarks

This function retrieves auto wind loading parameters for User-type wind loading.

The function returns zero if the parameters are successfully assigned, otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindUser()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Num As Long
Dim Diaph() As String
Dim Fx() As Double
Dim Fy() As Double
Dim Mz() As Double
Dim x() As Double
Dim y() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign user wind load parameters
ret = SapModel.LoadPatterns.AutoWind.SetUserLoad("WIND", "Diaph1", 100, 20, 5000, 0,
0)
ret = SapModel.LoadPatterns.AutoWind.SetUserLoad("WIND", "Diaph2", 50, 10, 2500, 0, 0)

'get user wind load parameters
ret = SapModel.LoadPatterns.AutoWind.GetUserLoad("WIND", Num, Diaph, Fx, Fy, Mz, x,
y)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetUserLoad

GetSpecialRigidDiaphragmList

# SetAPI4F2008_1

## Syntax


SapObject.SapModel.LoadPatterns.AutoWind.SetAPI4F2008_1

## VB6 Procedure

Function SetAPI4F2008_1(ByVal Name As String, ByVal ExposureFrom As Long, ByVal
DirAngle As Double, ByVal UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As
Double, ByVal WindSpeed As Double, ByVal SSLFactor As Double, ByVal ShieldingFactor As
Double) As Long

## Parameters

Name

The name of an existing Wind-type load case.

ExposureFrom

This is 2, 3, or 4, indicating the source of the wind exposure.

```
2 = From area objects
```
```
3 = From frame objects (open structure)
```
```
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 3 or 4.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The design reference wind velocity, Vref, in knots.

SSLFactor

The structural safety level multiplier.

ShieldingFactor

The shielding factor.


## Remarks

This function assigns auto wind loading parameters for API 4F 2008.

The function returns zero if the parameters are successfully assigned; otherwise, it returns a
nonzero value.

## VBA Example

Sub AssignWindAPI4F2008()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load case
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign API 4F 2008 parameters
ret = SapModel.LoadPatterns.AutoWind.SetAPI4F2008_1("WIND", 3, 0, False, 0, 0, 93, 1.1,
0.85)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.1.0.

This function supersedes SetAPI4F2008.


## See Also

GetAPI4F2008_1

# SetAPI4F2013

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetAPI4F2013

## VB6 Procedure

Function SetAPI4F2013(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double,
ByVal WindSpeed As Double, ByVal SSLFactor As Double, ByVal ShieldingFactor As Double)
As Long

## Parameters

Name

The name of an existing Wind-type load case.

ExposureFrom

This is 2, 3, or 4, indicating the source of the wind exposure.

```
2 = From area objects
```
```
3 = From frame objects (open structure)
```
```
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 3 or 4.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed


The design reference wind velocity, Vref, in knots.

SSLFactor

The structural safety level multiplier.

ShieldingFactor

The shielding factor.

## Remarks

This function assigns auto wind loading parameters for API 4F 2013.

The function returns zero if the parameters are successfully assigned; otherwise, it returns a
nonzero value.

## VBA Example

Sub AssignWindAPI4F2013()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load case
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign API 4F 2013 parameters
ret = SapModel.LoadPatterns.AutoWind.SetAPI4F2013("WIND", 3, 0, False, 0, 0, 93, 1.1,
0.85)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 16.1.0.

## See Also

GetAPI4F2013

# SetASCE702

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetASCE702

## VB6 Procedure

Function SetASCE702(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal ASCECase As Long, ByVal
ASCEe1 As Double, ByVal ASCEe2 As Double, ByVal UserZ As Boolean, ByVal TopZ As
Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal ExposureType As
Long, ByVal ImportanceFactor As Double, ByVal Kzt As Double, ByVal GustFactor As Double,
ByVal Kd As Double, Optional ByVal SolidGrossRatio As Double = 0.2, Optional ByVal
UserExposure As Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is 1, 2, 3 or 4, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
3 = From frame objects (open structure)
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1, 3, or 4.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl


The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

ASCECase

This is either 1, 2, 3, 4 or 5, indicating the desired case from ASCE7-02 Figure 6-9. 1, 2, 3 and 4
refer to cases 1 through 4 in the figure. 5 means to create all cases. This item applies only when
ExposureFrom = 1.

ASCEe1

This is the value e1 in ASCE7-02 Figure 6-9. This item applies only when ExposureFrom = 1.

ASCEe2

This is the value e2 in ASCE7-02 Figure 6-9. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies pnly when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2, 3 or 4, indicating the exposure category.

```
1 = A
2 = B
3 = C
4 = D
```
ImportanceFactor

The importance factor.

Kzt

The topographical factor.

GustFactor

The gust factor.


Kd

The directionality factor.

SolidGrossRatio

The solid area divided by gross area ratio for open frame structure loading. This item applies only
when the loading is from open structure wind loading (ExposureFrom = 3 or ExposureFrom = 4).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for ASCE 7-02.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindASCE702()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)


ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE702 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE702("WIND", 1, 0, 0.8, 0.5, 2, 0.15, 0.18,
False, 0, 0, 80, 3, 1, 1.1, 0.85, 0.88)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetASCE702

# SetASCE705

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetASCE705

## VB6 Procedure

Function SetASCE705(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal ASCECase As Long, ByVal
ASCEe1 As Double, ByVal ASCEe2 As Double, ByVal UserZ As Boolean, ByVal TopZ As
Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal ExposureType As
Long, ByVal ImportanceFactor As Double, ByVal Kzt As Double, ByVal GustFactor As Double,
ByVal Kd As Double, Optional ByVal SolidGrossRatio As Double = 0.2, Optional ByVal
UserExposure As Boolean = False) As Long

## Parameters

Name


The name of an existing Wind-type load pattern.

ExposureFrom

This is 1, 2, 3 or 4, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
3 = From frame objects (open structure)
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1, 3, or 4.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

ASCECase

This is 1, 2, 3, 4 or 5, indicating the desired case from ASCE7-05 Figure 6-9. 1, 2, 3 and 4 refer to
cases 1 through 4 in the figure. 5 means to create all cases. This item applies only when
ExposureFrom = 1.

ASCEe1

This is the value e1 in ASCE7-05 Figure 6-9. This item applies only when ExposureFrom = 1.

ASCEe2

This is the value e2 in ASCE7-05 Figure 6-9. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.


ExposureType

This is 1, 2 or 3, indicating the exposure category.

```
1 = B
2 = C
3 = D
```
ImportanceFactor

The importance factor.

Kzt

The topographical factor.

GustFactor

The gust factor.

Kd

The directionality factor.

SolidGrossRatio

The solid area divided by gross area ratio for open frame structure loading. This item applies only
when the loading is from open structure wind loading (ExposureFrom = 3 or ExposureFrom = 4).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for ASCE 7-05.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindASCE705()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE705 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE705("WIND", 1, 0, 0.8, 0.5, 2, 0.15, 0.18,
False, 0, 0, 80, 3, 1, 1.1, 0.85, 0.88)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetASCE705

# SetASCE788


## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetASCE788

## VB6 Procedure

Function SetASCE788(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean, ByVal
TopZ As Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal
ExposureType As Long, ByVal ImportanceFactor As Double, ByVal GustFactor As Double,
Optional ByVal UserExposure As Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed


The wind speed in miles per hour.

ExposureType

This is 1, 2, 3 or 4, indicating the exposure category.

```
1 = A
2 = B
3 = C
4 = D
```
ImportanceFactor

The importance factor.

GustFactor

The gust factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for ASCE 7-88.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindASCE788()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)


'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE788 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE788("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80,
3, 1, 0.85)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetASCE788

# SetASCE795

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetASCE795

## VB6 Procedure

Function SetASCE795(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean, ByVal
TopZ As Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal


ExposureType As Long, ByVal ImportanceFactor As Double, ByVal Kzt As Double, ByVal
GustFactor As Double, Optional ByVal UserExposure As Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2, 3 or 4, indicating the exposure category.

```
1 = A
2 = B
3 = C
4 = D
```

ImportanceFactor

The importance factor.

Kzt

The topographical factor.

GustFactor

The gust factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for ASCE 7-95.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindASCE795()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm


ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE795 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE795("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80,
3, 1, 1.1, 0.85)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetASCE795

# SetASCE710

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetASCE710

## VB6 Procedure

Function SetASCE710(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal ASCECase As Long, ByVal
ASCEe1 As Double, ByVal ASCEe2 As Double, ByVal UserZ As Boolean, ByVal TopZ As
Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal ExposureType As
Long, ByVal ImportanceFactor As Double, ByVal Kzt As Double, ByVal GustFactor As Double,
ByVal Kd As Double, Optional ByVal SolidGrossRatio As Double = 0.2, Optional ByVal
UserExposure As Boolean = False) As Long


## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is 1, 2, 3 or 4, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
3 = From frame objects (open structure)
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1, 3, or 4.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

ASCECase

This is 1, 2, 3, 4 or 5, indicating the desired case from ASCE7-10 Figure 27.4-8. 1, 2, 3 and 4 refer
to cases 1 through 4 in the figure. 5 means to create all cases. This item applies only when
ExposureFrom = 1.

ASCEe1

This is the value e1 in ASCE7-10 Figure 27.4-8. This item applies only when ExposureFrom = 1.

ASCEe2

This is the value e2 in ASCE7-10 Figure 27.4-8. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]


WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2 or 3, indicating the exposure category.

```
1 = B
2 = C
3 = D
```
ImportanceFactor

The importance factor.

Kzt

The topographical factor.

GustFactor

The gust factor.

Kd

The directionality factor.

SolidGrossRatio

The solid area divided by gross area ratio for open frame structure loading. This item applies only
when the loading is from open structure wind loading (ExposureFrom = 3 or ExposureFrom = 4).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for ASCE 7-10.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindASCE710()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE710 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE710("WIND", 1, 0, 0.8, 0.5, 2, 0.15, 0.18,
False, 0, 0, 80, 3, 1, 1.1, 0.85, 0.88)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.0

## See Also

GetASCE710

# SetASCE716


## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetASCE716

## VB6 Procedure

Function SetASCE716(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal ASCECase As Long, ByVal
ASCEe1 As Double, ByVal ASCEe2 As Double, ByVal UserZ As Boolean, ByVal TopZ As
Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal ExposureType As
Long, ByVal Kzt As Double, ByVal GustFactor As Double, ByVal Kd As Double, Optional
ByVal SolidGrossRatio As Double = 0.2, Optional ByVal UserExposure As Boolean =
False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is 1, 2, 3 or 4, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
3 = From frame objects (open structure)
4 = From area objects and frame objects (open structure)
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1, 3, or 4.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

ASCECase

This is 1, 2, 3, 4 or 5, indicating the desired case from ASCE7-16 Figure 27.3-8. 1, 2, 3 and 4
refer to cases 1 through 4 in the figure. 5 means to create all cases. This item applies only when
ExposureFrom = 1.

ASCEe1

This is the value e1 in ASCE7-16 Figure 27.3-8. This item applies only when ExposureFrom = 1.

ASCEe2


This is the value e2 in ASCE7-16 Figure 27.3-8. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2 or 3, indicating the exposure category.

```
1 = B
2 = C
3 = D
```
Kzt

The topographical factor.

GustFactor

The gust factor.

Kd

The directionality factor.

SolidGrossRatio

The solid area divided by gross area ratio for open frame structure loading. This item applies only
when the loading is from open structure wind loading (ExposureFrom = 3 or ExposureFrom = 4).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for ASCE 7-16.


The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindASCE716()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE716 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE716("WIND", 1, 0, 0.8, 0.5, 2, 0.15, 0.18,
False, 0, 0, 80, 3, 1.1, 0.85, 0.88)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 23.2.0

## See Also

GetASCE716

# SetASNZS117022002

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetASNZS117022002

## VB6 Procedure

Function SetASNZS117022002(ByVal Name As String, ByVal ExposureFrom As Long, ByVal
DirAngle As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal Ka As Double,
ByVal Kc As Double, ByVal Kl As Double, ByVal Kp As Double, ByVal UserZ As Boolean,
ByVal TopZ As Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal Cat
As Long, ByVal CycloneRegion As Boolean, ByVal Md As Double, ByVal Ms As Double,
ByVal Mt As Double, ByVal Cdyn As Double, Optional ByVal UserExposure As Boolean =
False) As Long

## Parameters

Name

The name of an existing Wind-type load case.

ExposureFrom

This is 1, or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
```
```
2 = From area objects
```
DirAngle

The direction angle for the wind load.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.


Ka

The area reduction factor, Ka.

Kc

The combination factor, Kc.

Kl

The local pressure factor, Kl.

Kp

The porous cladding factor, Kp.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item is the global Z-coordinate at the highest level where auto wind loads are applied. [L]

BottomZ

This item is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]

WindSpeed

The regional wind speed, Vr, in m/s.

Cat

This is 1, 2, 3 or 4, indicating the terrain category.

CycloneRegion

This is True or False, indicating if the structure is in a cyclone region.

Md

The directional multiplier, Md.

Ms

The shielding multiplier, Ms.

Mt

The topographic multiplier, Mt.

Cdyn

The dynamic response factor, Cdyn.


UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for AS/NZS 1170.2:2002.

The function returns zero if the parameters are successfully assigned; otherwise, it returns a
nonzero value.

## VBA Example

Sub AssignWindASNZS117022002()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'add new load case
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign AS/NZS 1170.2:2002 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASNZS117022002("WIND", 1, 0, 0.8, 0.5, 1, 1,
1, 1, False, 0, 0, 50, 2, False, 1, 1, 1, 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.1.0.


## See Also

GetASNZS117022002

# SetBOCA96

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetBOCA96

## VB6 Procedure

Function SetBOCA96(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean, ByVal
TopZ As Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal
ExposureType As Long, ByVal ImportanceFactor As Double, ByVal GustFactor As Double,
Optional ByVal UserGust As Boolean = False, Optional ByVal UserExposure As Boolean =
False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2, 3 or 4, indicating the exposure category.

```
1 = A
2 = B
3 = C
4 = D
```
ImportanceFactor

The importance factor.

GustFactor

The user defined gust factor. This item applies only when UserGust is True.

UserGust

If this item is True, the gust factor is user defined. If it is False, the gust factor is determined from
the code specified values.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for BOCA 96.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindBOCA96()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign BOCA96 parameters
ret = SapModel.LoadPatterns.AutoWind.SetBOCA96("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80,
3, 1, 0.85, True, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also


GetBOCA96

# SetBS639995

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetBS639995

## VB6 Procedure

Function SetBS639995(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean, ByVal
TopZ As Double, ByVal BottomZ As Double, ByVal Ve As Double, ByVal Ca As Double, ByVal
Cr As Double, Optional ByVal UserExposure As Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The front coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The rear coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

Ve

The effective wind speed in meters per second.

Ca

The size effect factor.

Cr

The dynamic augmentation factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for BS6399-95.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindBS639995()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)


'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign BS639995 parameters
ret = SapModel.LoadPatterns.AutoWind.SetBS639995("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 32,
1.1, 0.28)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetBS639995

# SetChinese2010

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetChinese2010

## VB6 Procedure

Function SetChinese2010(ByVal Name As String, ByVal ExposureFrom As Long, ByVal
DirAngle As Double, ByVal BuildingWidth As Double, ByVal Us As Double, ByVal
UniformTaper As Boolean, ByVal BHoverB0 As Double, ByVal UserZ As Boolean, ByVal TopZ
As Double, ByVal BottomZ As Double, ByVal wzero As Double, ByVal Rt As Long, ByVal
PhiZOpt As Long, ByVal T1Opt As Long, ByVal UserT As Double, ByVal DampRatio As
Double, Optional ByVal UserExposure As Boolean = False) As Long


## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item only applies when ExposureFrom = 1.

BuildingWidth

The building width. [L]

Us

The shape coefficient. This item applies only when ExposureFrom = 1.

UniformTaper

This item is True if a correction is to be applied to the wind load for a uniform taper.

BHoverB0

The taper ratio, Bh/B0. This item applies only when UniformTaper = True.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

wzero

The basic wind pressure in kN/m^2.

Rt

This is 1, 2, 3 or 4, indicating the ground roughness.


### 1 = A

### 2 = B

### 3 = C

### 4 = D

PhiZOpt

This is 0 or 1, indicating the Phi Z source.

```
0 = Modal analysis
1 = Z/H ratio
```
T1Opt

This is 0 or 1, indicating the T1 source.

```
0 = Modal analysis
1 = User defined
```
UserT

This item applies only when the T1 source is user defined (T1Opt = 1). It is the user defined T1
period. [s]

DampRatio

The damping ratio.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for Chinese 2010.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindChinese2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign Chinese2010 parameters
ret = SapModel.LoadPatterns.AutoWind.SetChinese2010("WIND", 1, 0, 1200, 0.5, False, 1,
False, 0, 0, 0.48, 3, 1, 1, 0.6, 0.04)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 15.0.2.

## See Also

GetChinese2010

# SetEurocode12005_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetEurocode12005_1


## VB6 Procedure

Function SetEurocode12005_1(ByVal Name As String, ByVal ExposureFrom As Long, ByVal
DirAngle As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean,
ByVal TopZ As Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal
Terrain As Long, ByVal Orography As Double, ByVal k1 As Double, ByVal CsCd As Double,
ByVal Rho As Double, Optional ByVal UserExposure As Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The basic wind speed, vb, in meters per second.

Terrain


This is 0, 1, 2, 3 or 4, indicating the terrain category.

```
0 = 0
1 = I
2 = II
3 = III
4 = IV
```
Orography

The orography factor, Co.

k1

The turbulence factor, k1.

CsCd

The structural factor, CsCd.

Rho

The air density in kg/m^3 , Rho.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for Eurocode 1 2005.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindEurocode12005()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign Eurocode 1 2005 parameters
ret = SapModel.LoadPatterns.AutoWind.SetEurocode12005_1("WIND", 1, 0, 0.8, 0.5, False,
0, 0, 35, 2, 1, 1, 1, 1.25)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.1.0.

This function supersedes SetEurocode12005.

## See Also

GetEurocode12005_1

# SetExposure_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetExposure_1


## VB6 Procedure

Function SetExposure_1(ByVal Name As String, ByVal Diaph As String, ByVal x As Double,
ByVal y As Double, ByVal Width As Double, ByVal Depth As Double, ByVal Height As
Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern that has an auto wind load assigned.

Diaph

The name of an existing special rigid diaphragm constraint, that is, a diaphragm constraint with
the following features:

1. The constraint type is CONSTRAINT_DIAPHRAGM = 2.
2. The constraint coordinate system is Global.
3. The constraint axis is Z.

x

The global X-coordinate of the point where the wind force is applied. [L]

y

The global Y-coordinate of the point where the wind force is applied. [L]

Width

The exposure width for the wind load applied to the specified diaphragm. [L]

Depth

The exposure depth for the wind load applied to the specified diaphragm. [L]

Height

The exposure height for the wind load applied to the specified diaphragm. [L]

## Remarks

This function assigns exposure parameters for auto wind loads determined from extents of rigid
diaphragms. This function does not apply for User-type auto wind loads.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value. The function returns an error if the auto wind load is not specified to have user
exposure parameters.

## VBA Example


Sub AssignWindUserExposure()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE788 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE788("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80,
3, 1, 0.85, True)

'assign user exposure data
ret = SapModel.LoadPatterns.AutoWind.SetExposure_1("WIND", "Diaph2", 0, 0, 900, 90,
124)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 17.3.0.

## See Also

GetExposure_1

# SetIS8751987

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetIS8751987

## VB6 Procedure

Function SetIS8751987(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean, ByVal
TopZ As Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal Terrain As
Long, ByVal Class As Long, ByVal K1 As Double, ByVal K3 As Double, Optional ByVal
UserExposure As Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ


This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in meters per second.

Terrain

This is 1, 2, 3 or 4, indicating the terrain category.

Class

This is 1, 2 or 3, indicating the terrain category.

```
1 = A
2 = B
3 = C
```
K1

The risk coefficient (k1 factor).

K3

The topography factor (k3 factor).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for Indian IS875-1987.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindIS8751987()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign IS8751987 parameters
ret = SapModel.LoadPatterns.AutoWind.SetIS8751987("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
60, 3, 3, 1.1, 1.2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

GetIS8751987

# SetIS8752015

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetIS8752015

## VB6 Procedure

Function SetIS8752015(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean, ByVal
TopZ As Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal
TerrainCategory As Long, ByVal ImportanceFactor As Long, ByVal k1 As Double, ByVal k3 As
Double, Optional ByVal UserExposure As Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern with an Indian IS 875:2015 auto wind
assignment.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ


This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in meters per second.

TerrainCategory

This is 1, 2, 3 or 4, indicating the terrain category.

ImportanceFactor

This is 1, 2 or 3, depending on the importance factor.

```
1 = 1.00
2 = 1.15
3 = 1.30
```
k1

The risk coefficient (k1 factor).

k3

The topography factor (k3 factor).

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for Indian IS875:2015.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindIS8752015()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign IS8752015 parameters
ret = SapModel.LoadPatterns.AutoWind.SetIS8752015("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
60, 3, 3, 1.1, 1.2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.2.0.

## See Also

GetIS8752015

# SetMexican


## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetMexican

## VB6 Procedure

Function SetMexican(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean, ByVal
TopZ As Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, Optional ByVal
UserExposure As Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed


The wind speed in meters per second.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns the Mexican auto wind loading parameters.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindMexican()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)


'assign Mexican parameters
ret = SapModel.LoadPatterns.AutoWind.SetMexican("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 40)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetMexican

# SetNBCC2015 {Wind Load}

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetNBCC2015

## VB6 Procedure

Function SetNBCC2015(ByVal Name As String, ByVal ExposureFrom As Long, ByVal
DirAngle As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal NBCCCase As Long,
ByVal e1 As Double, ByVal e2 As Double, ByVal UserZ As Boolean, ByVal TopZ As Double,
ByVal BottomZ As Double, ByVal q As Double, ByVal GustFactor As Double, ByVal
TopographicFactor As Double, ByVal ImportanceFactor As Double, ByVal TerrainType As
Long, ByVal CeWindward As Double, ByVal CeLeeward As Double, Optional ByVal
UserExposure As Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```

DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

NBCCCase

This is 1, 2, 3, 4, or 5, indicating the desired case from NBCC 2105 Figure A-4.1.7.9(1). 1,2,3, and
4 refer to cases 1 through 4 in the figure, while 5 means all cases. This item applies only when
ExposureFrom = 1.

**e1**

This is the value e1 in the NBCC 2015 Figure A-4.1.7.9(1). This item applies only when
ExposureFrom = 1.

**e2**

This is the value e2 in the NBCC 2015 Figure A-4.1.7.9(1). This item applies only when
ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

q

The velocity pressure in kPa.

GustFactor

The gust effect factor, Cg.

ImportanceFactor

The importance factor, Ct.

ImportanceFactor


The importance Factor, Iw.

TerrainType

This is 1, 2, or 3, indicating the terrain type.

```
1 = Open
```
```
2 = Rough
```
```
3 = User
```
CeWindward

The windward exposure factor, Ce. This item applies only when TerrainType = 3.

CeLeeward

The windward exposure factor, Ce. This item applies only when TerrainType = 3.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for NBCC 2015.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub GetWindNBCC2015()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign NBCC2015 parameters
ret = SapModel.LoadPatterns.AutoWind.SetNBCC2015("WIND", 1, 0, 0.8, 0.5, 2, 0.15, 0.18,
False, 0, 0, 0.75, 2.1, 1.1, 1.1, 1, 0, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

## See Also

Get NBCC2015

# SetNBCC2010_1 {Wind Load}

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetNBCC2010_1

## VB6 Procedure

Function SetNBCC2010_1(ByVal Name As String, ByVal ExposureFrom As Long, ByVal
DirAngle As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean,
ByVal TopZ As Double, ByVal BottomZ As Double, ByVal q As Double, ByVal GustFactor As
Double, ByVal ImportanceFactor As Double, ByVal TerrainType As Long, ByVal CeWindward


As Double, ByVal CeLeeward As Double, Optional ByVal UserExposure As Boolean = False) As
Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

q

The velocity pressure in kPa.

GustFactor

The gust effect factor.

ImportanceFactor

The importance factor.


TerrainType

This is 1, 2, or 3, indicating the terrain type.

```
1 = Open
```
```
2 = Rough
```
```
3 = User
```
CeWindward

The windward exposure factor, Ce. This item applies only when TerrainType = 3.

CeLeeward

The windward exposure factor, Ce. This item applies only when TerrainType = 3.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for NBCC 2010.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindNBCC2010()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)


'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign NBCC2010 parameters
ret = SapModel.LoadPatterns.AutoWind.SetNBCC2010_1("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
0.75, 2.1, 1.1, 1, 0, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.0.0.

This function supersedes SetNBCCC2010.

## See Also

GetNBCC2010_1

# SetNBCC2005

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetNBCC2005

## VB6 Procedure

Function SetNBCC2005(ByVal Name As String, ByVal ExposureFrom As Long, ByVal
DirAngle As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean,
ByVal TopZ As Double, ByVal BottomZ As Double, ByVal q As Double, ByVal GustFactor As


Double, ByVal ImportanceFactor As Double, Optional ByVal UserExposure As Boolean = False)
As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

q

The velocity pressure in kPa.

GustFactor

The gust effect factor.

ImportanceFactor

The importance factor.


UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for NBCC 2005.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindNBCC2005()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign NBCC2005 parameters


ret = SapModel.LoadPatterns.AutoWind.SetNBCC2005("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
0.75, 2.1, 1.1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetNBCC2005

# SetNBCC95

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetNBCC95

## VB6 Procedure

Function SetNBCC95(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle
As Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean, ByVal
TopZ As Double, ByVal BottomZ As Double, ByVal q As Double, ByVal GustFactor As Double,
Optional ByVal UserExposure As Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw


The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

q

The velocity pressure in kPa.

GustFactor

The gust effect factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for NBCC 95.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindNBCC95()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign NBCC95 parameters
ret = SapModel.LoadPatterns.AutoWind.SetNBCC95("WIND", 1, 0, 0.8, 0.5, False, 0, 0,
0.75, 2.1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetNBCC95

# SetNTC2008_1


## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetNTC2008_1

## VB6 Procedure

Function SetNTC2008_1(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean,
ByRef TopZ As Double, ByRef BottomZ As Double, ByRef vr As Double, ByRef
ExposureCategory As Long, ByRef ct As Double, ByRef cd As Double, ByRef UserExposure As
Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

vr


The wind velocity in m/s.

ExposureCategory

This is 1, 2, 3, 4, or 5, indicating the exposure category.

```
1 = I
2 = II
3 = III
4 = IV
5 = V
```
ct

The topography factor, ct.

cd

The dynamic coefficient, cd.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for NTC 2008.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub SetWindNTC2008()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", eLoadPatternType_WIND)

'assign NTC2008 parameters
ret = SapModel.LoadPatterns.AutoWind.SetNTC2008_1("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 35, 3,
1, 1, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.2.0.

This function supersedes SetNTC2008.

## See Also

GetNTC2008_1

# SetNTC2018_1

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetNTC2018_1

## VB6 Procedure


Function SetNTC2018_1(ByVal Name As String, ByRef ExposureFrom As Long, ByRef
DirAngle As Double, ByRef Cpw As Double, ByRef Cpl As Double, ByRef UserZ As Boolean,
ByRef TopZ As Double, ByRef BottomZ As Double, ByRef vr As Double, ByRef
ExposureCategory As Long, ByRef ct As Double, ByRef cd As Double, ByRef UserExposure As
Boolean = False) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cp. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cp. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

vr

The wind velocity in m/s.

ExposureCategory

This is 1, 2, 3, 4, or 5, indicating the exposure category.

```
1 = I
```

### 2 = II

### 3 = III

### 4 = IV

### 5 = V

ct

The topography factor, ct.

cd

The dynamic coefficient, cd.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function retrieves auto wind loading parameters for NTC 2018.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub SetWindNTC2018()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)


'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", eLoadPatternType_WIND)

'assign NTC2018 parameters
ret = SapModel.LoadPatterns.AutoWind.SetNTC2018_1("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 35, 3,
1, 1, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.2.0.

This function supersedes SetNTC2018.

## See Also

GetNTC2018_1

# SetSP20133302016

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetSP20133302016

## VB6 Procedure

Function SetSP20133302016 (ByVal Name As String, ByVal LoadingType As Long, ByVal
ExposureFrom As Long, ByVal DirAngle As Double, ByVal Cp As Double, ByVal UserZ As
Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal StructureType As Integer,
ByVal LogDecrement As Integer, ByVal BuildingWidth As Double, ByVal BuildingDepth As
Double, ByVal Zeq As Double, ByVal WindDistrict As Long, ByVal WindPressure As Double,
ByVal TerrainType As Long, ByVal LimitFreq As Double, ByVal ModalCase As String, ByVal
FirstValMode As Long, Optional ByVal UserExposure As Boolean = False) As Long


## Parameters

Name

The name of an existing Wind-type load pattern with a SP 20.13330.2016 auto wind assignment.

LoadingType

This indicates whether the loads should be calculated as static or dynamic.

```
1 = Static
2 = Dynamic
```
ExposureFrom

This is 1 or 2, indicating the source of the wind exposure. This item applies only when
LoadingType = 1.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item does not apply when ExposureFrom = 2.

Cp

The wind coefficient, Cp. This item applies only when LoadingType = 1 and ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

StructureType

This indicates the structure type for calculating the wind pressure.

```
1 = Building
2 = Other
```
LogDecrement

This specifies a value for the logarithmic decrement. This item applies only when LoadingType =
2.


### 1 = 0.15

### 2 = 0.30

BuildingWidth

This is the building width, normal to the wind direction. [L]

BuildingDepth

This is the building depth, in the direction of the wind. This item applies only when LoadingType
= 2. [L]

Zeq

This is the equivalent height, Zeq, of the structure. This item applies only when LoadingType = 2.
[L]

WindDistrict

This is the wind district to consider.

```
0 = Ia
1 = I
2 = II
3 = III
4 = IV
5 = V
6 = VI
7 = VII
8 = User Defined
```
WindPressure

This is the wind pressure. This item applies only when WindDistrict = 8. [F/L^2 ]

TerrainType

This is the terrain type being considered.

```
1 = A
2 = B
3 = C
```
LimitFreq

The limit frequency. This item applies only when LoadingType = 2 and WindDistrict = 8.

ModalCase

The name of an existing modal load case to be used in determining dynamic wind loads. This item
applies only when LoadingType = 2.

FirstValMode


The first valuable mode number from the specified modal case. This item applies only when
LoadingType = 2.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms. This item
applies only when LoadingType = 1.

## Remarks

This function assigns auto wind loading parameters for SP 20.13330.2016.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub SetWindSP20133302016()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection

ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection


ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign SP 20.13330.2016 parameters
ret = SapModel.LoadPatterns.AutoWind.SetSP20133302016("WIND", 1, 1, 0, 0.8, False, 0,
0, 1, 1, 10, 10, 10, 3, 0.1, 2, 10, “MODAL”, 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.0.0.

## See Also

GetSP20133302016

# SetUBC94

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetUBC94

## VB6 Procedure

Function SetUBC94(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle As
Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean, ByVal TopZ
As Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal ExposureType As
Long, ByVal ImportanceFactor As Double, Optional ByVal UserExposure As Boolean = False)
As Long

## Parameters

Name


The name of an existing Wind-type load pattern.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cq. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cq. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]

BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2 or 3, indicating the exposure category.

```
1 = B
2 = C
3 = D
```
ImportanceFactor

The importance factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.


## Remarks

This function assigns auto wind loading parameters for 1994 UBC.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindUBC94()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign UBC94 parameters
ret = SapModel.LoadPatterns.AutoWind.SetUBC94("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80, 3,
1.15)

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetUBC94

# SetNone

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetNone

## VB6 Procedure

Function SetNone(ByVal Name As String) As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

## Remarks

This function set the auto wind loading type for the specified load pattern to None.

The function returns zero if the loading type is successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindNone()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign ASCE788 parameters
ret = SapModel.LoadPatterns.AutoWind.SetASCE788("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80,
3, 1, 0.85)

'set auto wind loading type to None
ret = SapModel.LoadPatterns.AutoWind.SetNone("WIND")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.


## See Also

# SetUBC97

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetUBC97

## VB6 Procedure

Function SetUBC97(ByVal Name As String, ByVal ExposureFrom As Long, ByVal DirAngle As
Double, ByVal Cpw As Double, ByVal Cpl As Double, ByVal UserZ As Boolean, ByVal TopZ
As Double, ByVal BottomZ As Double, ByVal WindSpeed As Double, ByVal ExposureType As
Long, ByVal ImportanceFactor As Double, Optional ByVal UserExposure As Boolean = False)
As Long

## Parameters

Name

The name of an existing Wind-type load pattern.

ExposureFrom

This is either 1 or 2, indicating the source of the wind exposure.

```
1 = From extents of rigid diaphragms
2 = From area objects
```
DirAngle

The direction angle for the wind load. This item applies only when ExposureFrom = 1.

Cpw

The windward coefficient, Cq. This item applies only when ExposureFrom = 1.

Cpl

The leeward coefficient, Cq. This item applies only when ExposureFrom = 1.

UserZ

This item is True if the top and bottom elevations of the wind load are user specified. It is False if
the elevations are determined by the program.

TopZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest
level where auto wind loads are applied. [L]


BottomZ

This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest
level where auto wind loads are applied. [L]

WindSpeed

The wind speed in miles per hour.

ExposureType

This is 1, 2 or 3, indicating the exposure category.

```
1 = B
2 = C
3 = D
```
ImportanceFactor

The importance factor.

UserExposure

If this item is True, the wind exposure widths are provided by the user. If it is False, the wind
exposure widths are calculated by the program from the extents of the diaphragms.

## Remarks

This function assigns auto wind loading parameters for 1997 UBC.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindUBC97()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign UBC97 parameters
ret = SapModel.LoadPatterns.AutoWind.SetUBC97("WIND", 1, 0, 0.8, 0.5, False, 0, 0, 80, 3,
1.15)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetUBC97

# SetUserLoad

## Syntax

SapObject.SapModel.LoadPatterns.AutoWind.SetUserLoad

## VB6 Procedure


Function SetUserLoad(ByVal Name As String, ByVal Diaph As String, ByVal Fx As Double,
ByVal Fy As Double, ByVal Mz As Double, ByVal x As Double, ByVal y As Double) As Long

## Parameters

Name

The name of an existing Wind-type load pattern that has an auto wind load assigned.

Diaph

The name of an existing special rigid diaphragm constraint, that is, a diaphragm constraint with
the following features:

1. The constraint type is CONSTRAINT_DIAPHRAGM = 2.
2. The constraint coordinate system is Global.
3. The constraint axis is Z.

Fx

The global X direction force assigned to the specified diaphragm. [F]

Fy

The global Y direction force assigned to the specified diaphragm. [F]

Mz

The moment about the global Z axis assigned to the specified diaphragm. [FL]

x

The global X-coordinate of the point where the wind force is applied. [L]

y

The global Y-coordinate of the point where the wind force is applied. [L]

## Remarks

This function assigns auto wind loading parameters for User-type wind loads.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub AssignWindUserLoad()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)
ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("2")
ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection
ret = SapModel.SelectObj.PlaneXY("3")
ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)
ret = SapModel.SelectObj.ClearSelection

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'assign user wind load parameters
ret = SapModel.LoadPatterns.AutoWind.SetUserLoad("WIND", "Diaph1", 100, 20, 5000, 0,
0)
ret = SapModel.LoadPatterns.AutoWind.SetUserLoad("WIND", "Diaph2", 50, 10, 2500, 0, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also


GetUserLoad

GetSpecialRigidDiaphragmList

# GetAuto

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeastate.GetAuto

## VB6 Procedure

Function GetAuto(ByVal Name As String, ByRef LoadMethod As Long, ByRef CSys As String,
ByRef AdjustGravityLat As Boolean, ByRef AdjustGravityLatFactor As Double, ByRef
AdjustGravityVert As Boolean, ByRef AdjustGravityVertFactor As Double, ByRef
CenterRotation() As Double, ByRef Parameters() As Double, ByRef IgnorePhase As Boolean) As
Long

## Parameters

Name

The name of an existing seastate-type load pattern.

LoadMethod

This is one of the following three options defining what parameters are being specified.

```
1 = Rotation / Translations Vertical Input
```
```
2 = Rotations / Translations Full Input
```
```
3 = Accelerations / Velocities
```
CSys

The coordinate system used as a reference for specifying the center of rotation location and the
inertia load parameters.

AdjustGravityLat

This item only applies when using LoadMethod 1 or 2. It is True if generated lateral loads should
include the effects of the rotated structure, otherwise it is False.

AdjustGravityLatFactor

This item only applies when using LoadMethod 1 or 2. This is a scale factor on the lateral effects
generated as a result of the rotated structure.

AdjustGravityVert


This item only applies when using LoadMethod 1 or 2. It is True if generated vertical loads should
include the effects of the rotated structure, otherwise it is False.

AdjustGravityVertFactor

This item only applies when using LoadMethod 1 or 2. This is a scale factor on the vertical effects
generated as a result of the rotated structure.

CenterRotation

This is an array dimensioned to 2 (3 doubles) that defines the coordinates of the center of rotation,
with respect to the selected coordinate system.

Parameters

This is an array of the inertia load parameters, based on the specified LoadMethod, as described
below.

If LoadMethod = 1, the following 9 parameters should be input:

```
Parameters(0) - UZ amplitude
```
```
Parameters(1) - UZ period
```
```
Parameters(2) - UZ phase
```
```
Parameters(3) - RX amplitude
```
```
Parameters(4) - RX period
```
```
Parameters(5) - RX phase
```
```
Parameters(6) - RY amplitude
```
```
Parameters(7) - RY period
```
```
Parameters(8) - RY phase
```
If the LoadMethod = 2, the following 18 parameters should be input:

```
Parameters(0) - UX amplitude
```
```
Parameters(1) - UX period
```
```
Parameters(2) - UX phase
```
```
Parameters(3) - UY amplitude
```
```
Parameters(4) - UY period
```
```
Parameters(5) - UY phase
```
```
Parameters(6) - UZ amplitude
```
```
Parameters(7) - UZ period
```

```
Parameters(8) - UZ phase
```
```
Parameters(9) - RX amplitude
```
```
Parameters(10) - RX period
```
```
Parameters(11) - RX phase
```
```
Parameters(12) - RY amplitude
```
```
Parameters(13) - RY period
```
```
Parameters(14) - RY phase
```
```
Parameters(15) - RZ amplitude
```
```
Parameters(16) - RZ period
```
```
Parameters(17) - RZ phase
```
If the LoadMethod = 3, the following 9 parameters should be input:

```
Parameters(0) - Acceleration UX
```
```
Parameters(1) - Acceleration UY
```
```
Parameters(2) - Acceleration UZ
```
```
Parameters(3) - Acceleration RX
```
```
Parameters(4) - Acceleration RY
```
```
Parameters(5) - Acceleration RZ
```
```
Parameters(6) - Velocity RX
```
```
Parameters(7) - Velocity RY
```
```
Parameters(8) - Velocity RZ
```
IgnorePhase

This item only applies when using LoadMethod 1 or 2. It is True if the input phases should be
ignored, otherwise it is False.

## Remarks

This function retrieves auto seastate loading parameters.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example


Sub GetAutoSeastate()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim MyCenter(2) As Double

Dim MyParams(8) As Double

Dim LoadMethod As Long

Dim CSys As String

Dim AdjustGravityLat As Boolean

Dim LatScaleFactor As Double

Dim AdjustGravityVert As Boolean

Dim VertScaleFactor As Double

Dim Center() As Double

Dim Params() As Double

Dim IgnorePhase As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints

ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)

ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'add new load pattern
ret = SapModel.LoadPatterns.Add("SEASTATE", LTYPE_SEASTATE)


'assign seastate parameters

MyCenter(0) = 0

MyCenter(1) = 0

MyCenter(2) = 0

MyParams(0) = 0

MyParams(1) = 0

MyParams(2) = 0

MyParams(3) = 0.5

MyParams(4) = 0

MyParams(5) = 0

MyParams(6) = 0

MyParams(7) = 0

MyParams(8) = 0

ret = SapModel.LoadPatterns.AutoSeastate.SetAuto("SEASTATE", 3, "Global", True, 1, True,
1, MyCenter, MyParms, False)

'get seastate parameters

ret = SapModel.LoadPatterns.AutoSeastate.GetAuto("SEASTATE", LoadMethod, CSys,
AdjustGravityLat, LatScaleFactor, AdjustGravityVert, VertScaleFactor, Center, Params,
IgnorePhase)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.

## See Also

SetAuto


# SetAuto

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeastate.SetAuto

## VB6 Procedure

Function SetAuto(ByVal Name As String, ByVal LoadMethod As Long, ByVal CSys As String,
ByVal AdjustGravityLat As Boolean, ByVal AdjustGravityLatFactor As Double, ByVal
AdjustGravityVert As Boolean, ByVal AdjustGravityVertFactor As Double, ByVal
CenterRotation() As Double, ByVal Parameters() As Double, ByVal IgnorePhase As Boolean) As
Long

## Parameters

Name

The name of an existing seastate-type load pattern.

LoadMethod

This is one of the following three options defining what parameters are being specified.

```
1 = Rotation / Translations Vertical Input
```
```
2 = Rotations / Translations Full Input
```
```
3 = Accelerations / Velocities
```
CSys

The coordinate system used as a reference for specifying the center of rotation location and the
inertia load parameters.

AdjustGravityLat

This item only applies when using LoadMethod 1 or 2. It is True if generated lateral loads should
include the effects of the rotated structure, otherwise it is False.

AdjustGravityLatFactor

This item only applies when using LoadMethod 1 or 2. This is a scale factor on the lateral effects
generated as a result of the rotated structure.

AdjustGravityVert

This item only applies when using LoadMethod 1 or 2. It is True if generated vertical loads should
include the effects of the rotated structure, otherwise it is False.

AdjustGravityVertFactor


This item only applies when using LoadMethod 1 or 2. This is a scale factor on the vertical effects
generated as a result of the rotated structure.

CenterRotation

This is an array dimensioned to 2 (3 doubles) that defines the coordinates of the center of rotation,
with respect to the selected coordinate system.

Parameters

This is an array of the inertia load parameters, based on the specified LoadMethod, as described
below.

If LoadMethod = 1, the following 9 parameters should be input:

```
Parameters(0) - UZ amplitude
```
```
Parameters(1) - UZ period
```
```
Parameters(2) - UZ phase
```
```
Parameters(3) - RX amplitude
```
```
Parameters(4) - RX period
```
```
Parameters(5) - RX phase
```
```
Parameters(6) - RY amplitude
```
```
Parameters(7) - RY period
```
```
Parameters(8) - RY phase
```
If the LoadMethod = 2, the following 18 parameters should be input:

```
Parameters(0) - UX amplitude
```
```
Parameters(1) - UX period
```
```
Parameters(2) - UX phase
```
```
Parameters(3) - UY amplitude
```
```
Parameters(4) - UY period
```
```
Parameters(5) - UY phase
```
```
Parameters(6) - UZ amplitude
```
```
Parameters(7) - UZ period
```
```
Parameters(8) - UZ phase
```
```
Parameters(9) - RX amplitude
```
```
Parameters(10) - RX period
```

```
Parameters(11) - RX phase
```
```
Parameters(12) - RY amplitude
```
```
Parameters(13) - RY period
```
```
Parameters(14) - RY phase
```
```
Parameters(15) - RZ amplitude
```
```
Parameters(16) - RZ period
```
```
Parameters(17) - RZ phase
```
If the LoadMethod = 3, the following 9 parameters should be input:

```
Parameters(0) - Acceleration UX
```
```
Parameters(1) - Acceleration UY
```
```
Parameters(2) - Acceleration UZ
```
```
Parameters(3) - Acceleration RX
```
```
Parameters(4) - Acceleration RY
```
```
Parameters(5) - Acceleration RZ
```
```
Parameters(6) - Velocity RX
```
```
Parameters(7) - Velocity RY
```
```
Parameters(8) - Velocity RZ
```
IgnorePhase

This item only applies when using LoadMethod 1 or 2. It is True if the input phases should be
ignored, otherwise it is False.

## Remarks

This function retrieves auto seastate loading parameters.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub SetAutoSeastate()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim MyCenter(2) As Double

Dim MyParams(8) As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints

ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)

ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'add new load pattern
ret = SapModel.LoadPatterns.Add("SEASTATE", LTYPE_SEASTATE)

'assign seastate parameters

MyCenter(0) = 0

MyCenter(1) = 0

MyCenter(2) = 0

MyParams(0) = 0

MyParams(1) = 0

MyParams(2) = 0

MyParams(3) = 0.5

MyParams(4) = 0

MyParams(5) = 0

MyParams(6) = 0


MyParams(7) = 0

MyParams(8) = 0

ret = SapModel.LoadPatterns.AutoSeastate.SetAuto("SEASTATE", 3, "Global", True, 1, True,
1, MyCenter, MyParms, False)

'get seastate parameters

ret = SapModel.LoadPatterns.AutoSeastate.GetAuto("SEASTATE", LoadMethod, CSys,
AdjustGravity, Center, Params)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.

## See Also

GetAuto

# SetNone

## Syntax

SapObject.SapModel.LoadPatterns.AutoSeastate.SetNone

## VB6 Procedure

Function SetNone(ByVal Name As String) As Long

## Parameters

Name

The name of an existing seastate-type load pattern.

## Remarks

This function sets the auto seastate loading type for the specified load pattern to None.


The function returns zero if the loading type is successfully assigned; otherwise it returns a
nonzero vale.

## VBA Example

Sub AssignSeastateNone()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim MyCenter(2) As Double

Dim MyParams(8) As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)

'define diaphragm constraints

ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)

ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)

'assign points to diaphragm

ret = SaModel.SelectObj.ClearSelection

ret = SapModel.SelectObj.PlaneXY("2)

ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)

ret = SapModel.SelectObj.ClearsSelection

ret = SapModel.SelectObj.PlaneXY("3")

ret = SapModel.PointObject.SetConstraint("", Diaph2", SelectedObjects)

ret = SapModel.SelectObj.ClearSelection


'add new load pattern
ret = SapModel.LoadPatterns.Add("SEASTATE", LTYPE_SEASTATE)

'assign seastate parameters

MyCenter(0) = 0

MyCenter(1) = 0

MyCenter(2) = 0

MyParams(0) = 0

MyParams(1) = 0

MyParams(2) = 0

MyParams(3) = 0.5

MyParams(4) = 0

MyParams(5) = 0

MyParams(6) = 0

MyParams(7) = 0

MyParams(8) = 0

ret = SapModel.LoadPatterns.AutoSeastate.SetAuto("SEASTATE", 3, "Global", True,
MyCenter, MyParms)

'set auto seastate loading type to None

ret = SapModel.LoadPatterns.AutoSWind.SetNone("SEASTATE")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.

## See Also


# Add

## Syntax

SapObject.SapModel.LoadPatterns.Add

## VB6 Procedure

Function Add(ByVal Name As String, ByVal MyType As eLoadPatternType, Optional ByVal
SelfWTMultiplier As Double = 0, Optional ByVal AddLoadCase As Boolean = True) As Long

## Parameters

Name

The name for the new load pattern.

MyType

This is one of the following items in the eLoadPatternType enumeration:

```
LTYPE_DEAD = 1
LTYPE_SUPERDEAD = 2
LTYPE_LIVE = 3
LTYPE_REDUCELIVE = 4
LTYPE_QUAKE = 5
LTYPE_WIND= 6
LTYPE_SNOW = 7
LTYPE_OTHER = 8
LTYPE_MOVE = 9
LTYPE_TEMPERATURE = 10
LTYPE_ROOFLIVE = 11
LTYPE_NOTIONAL = 12
LTYPE_PATTERNLIVE = 13
LTYPE_WAVE= 14
LTYPE_BRAKING = 15
LTYPE_CENTRIFUGAL = 16
LTYPE_FRICTION = 17
LTYPE_ICE = 18
LTYPE_WINDONLIVELOAD = 19
LTYPE_HORIZONTALEARTHPRESSURE = 20
LTYPE_VERTICALEARTHPRESSURE = 21
LTYPE_EARTHSURCHARGE = 22
LTYPE_DOWNDRAG = 23
LTYPE_VEHICLECOLLISION = 24
LTYPE_VESSELCOLLISION = 25
LTYPE_TEMPERATUREGRADIENT = 26
LTYPE_SETTLEMENT = 27
LTYPE_SHRINKAGE = 28
LTYPE_CREEP = 29
```

### LTYPE_WATERLOADPRESSURE = 30

### LTYPE_LIVELOADSURCHARGE = 31

### LTYPE_LOCKEDINFORCES = 32

### LTYPE_PEDESTRIANLL = 33

### LTYPE_PRESTRESS = 34

### LTYPE_HYPERSTATIC = 35

### LTYPE_BOUYANCY = 36

### LTYPE_STREAMFLOW = 37

### LTYPE_IMPACT = 38

### LTYPE_CONSTRUCTION = 39

SelfWTMultiplier

The self weight multiplier for the new load pattern.

AddLoadCase

If this item is True, a linear static load case corresponding to the new load pattern is added.

## Remarks

This function adds a new load pattern.

The function returns 0 if the load pattern is successfully added; otherwise it returns nonzero. An
error is returned if the Name item is already used for an existing load pattern.

## VBA Example

Sub AddNewLoadPattern()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberAreas As Long
Dim AreaName() As String

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new load pattern


ret = SapModel.LoadPatterns.Add("LIVE", LTYPE_LIVE)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Added three items to the eLoadPatternType enumeration in version 12.00.

## See Also

# ChangeName

## Syntax

SapObject.SapModel.LoadPatterns.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The name of a defined load pattern.

NewName

The new name for the load pattern.

## Remarks

This function applies a new name to a load pattern.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example


Sub ChangeLoadPatternName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'change name
ret = SapModel.LoadPatterns.ChangeName("DEAD", "DL")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# Count

## Syntax

SapObject.SapModel.LoadPatterns.Count

## VB6 Procedure

Function Count() As Long


## Parameters

None

## Remarks

The function returns the number of defined load patterns.

## VBA Example

Sub CountLoadPatterns()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get number of defined load patterns
ret = SapModel.LoadPatterns.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also


# Delete

## Syntax

SapObject.SapModel.LoadPatterns.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing load pattern.

## Remarks

The function deletes the specified load pattern.

The function returns zero if the load pattern is successfully deleted, otherwise it returns a nonzero
value.

The load pattern is not deleted and the function returns an error if the load pattern is assigned to an
load case or if it is the only defined load pattern.

## VBA Example

Sub DeleteLoadPattern()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret as Long

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)


'delete load case
'Note: ret in the above line returns 1, indicating an error.
'This is the case because the load pattern DEAD is assigned to
'load case DEAD. This is also the case because the load
'case DEAD is the only load pattern defined.
ret = SapModel.LoadPatterns.Delete("DEAD")

'Note: ret in the above line returns 1, indicating an error. This is the case because the load
pattern DEAD is assigned to load case DEAD. This is also the case because the load pattern
DEAD is the only load pattern defined.

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# GetAutoSeismicCode

## Syntax

SapObject.SapModel.LoadPatterns.GetAutoSeismicCode

## VB6 Procedure

Function GetAutoSeismicCode(ByVal Name As String, ByRef CodeName As String) As Long

## Parameters

Name

The name of an existing Quake-type load pattern.

CodeName

This is either blank or the name code used for the auto seismic parameters. Blank means no auto
seismic load is specified for the Quake-type load pattern.


## Remarks

This function retrieves the code name used for auto seismic parameters in Quake-type load
patterns.

The function returns zero if the code is successfully retrieved; otherwise it returns a nonzero value.
An error is returned if the specified load pattern is not a Quake-type load pattern.

## VBA Example

Sub GetAutoSeismicType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim CodeName As String

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new load pattern
ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)

'assign BOCA96 parameters
ret = SapModel.LoadPatterns.AutoSeismic.SetBOCA96("EQX", 1, 0.05, 1, 0.035, 0, False, 0,
0, 0.4, 0.4, 1.5, 8)

'get auto seismic code
ret = SapModel.LoadPatterns.GetAutoSeismicCode("EQX", CodeName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetAutoWindCode

GetAutoWaveCode

# GetAutoWaveCode

## Syntax

SapObject.SapModel.LoadPatterns.GetAutoWaveCode

## VB6 Procedure

Function GetAutoWaveCode(ByVal Name As String, ByRef CodeName As String) As Long

## Parameters

Name

The name of an existing Wave-type load pattern.

CodeName

This is either blank or the name code used for the auto wave parameters. Blank means no auto
wave load is specified for the Wave-type load pattern.

## Remarks

This function retrieves the code name used for auto wave parameters in Wave-type load patterns.

The function returns zero if the code is successfully retrieved; otherwise it returns a nonzero value.
An error is returned if the specified load pattern is not a Wave-type load pattern.

## VBA Example

Sub GetAutoWaveType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim CodeName As String

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new load pattern
ret = SapModel.LoadPatterns.Add("WAVE", LTYPE_WAVE)

'get auto wave code
ret = SapModel.LoadPatterns.GetAutoWaveCode("WAVE", CodeName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetAutoSeismicCode

GetAutoWindCode

# GetAutoWindCode

## Syntax

SapObject.SapModel.LoadPatterns.GetAutoWindCode

## VB6 Procedure

Function GetAutoWindCode(ByVal Name As String, ByRef CodeName As String) As Long


## Parameters

Name

The name of an existing Wind-type load pattern.

CodeName

This is either blank or the name code used for the auto wind parameters. Blank means no auto
wind load is specified for the Wind-type load pattern.

## Remarks

This function retrieves the code name used for auto wind parameters in Wind-type load patterns.

The function returns zero if the code is successfully retrieved; otherwise it returns a nonzero value.
An error is returned if the specified load pattern is not a Wind-type load pattern.

## VBA Example

Sub GetAutoWindType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim CodeName As String

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new load pattern
ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)

'get auto wind code
ret = SapModel.LoadPatterns.GetAutoWindCode("WIND", CodeName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetAutoSeismicCode

GetAutoWaveCode

# GetLoadType

## Syntax

SapObject.SapModel.LoadPatterns.GetLoadType

## VB6 Procedure

Function GetLoadType(ByVal Name As String, ByRef MyType As eLoadPatternType) As Long

## Parameters

Name

The name of an existing load pattern.

MyType

This is one of the following items in the eLoadPatternType enumeration:

```
LTYPE_DEAD = 1
LTYPE_SUPERDEAD = 2
LTYPE_LIVE = 3
LTYPE_REDUCELIVE = 4
LTYPE_QUAKE = 5
LTYPE_WIND= 6
LTYPE_SNOW = 7
LTYPE_OTHER = 8
LTYPE_MOVE = 9
LTYPE_TEMPERATURE = 10
LTYPE_ROOFLIVE = 11
LTYPE_NOTIONAL = 12
LTYPE_PATTERNLIVE = 13
```

### LTYPE_WAVE= 14

### LTYPE_BRAKING = 15

### LTYPE_CENTRIFUGAL = 16

### LTYPE_FRICTION = 17

### LTYPE_ICE = 18

### LTYPE_WINDONLIVELOAD = 19

### LTYPE_HORIZONTALEARTHPRESSURE = 20

### LTYPE_VERTICALEARTHPRESSURE = 21

### LTYPE_EARTHSURCHARGE = 22

### LTYPE_DOWNDRAG = 23

### LTYPE_VEHICLECOLLISION = 24

### LTYPE_VESSELCOLLISION = 25

### LTYPE_TEMPERATUREGRADIENT = 26

### LTYPE_SETTLEMENT = 27

### LTYPE_SHRINKAGE = 28

### LTYPE_CREEP = 29

### LTYPE_WATERLOADPRESSURE = 30

### LTYPE_LIVELOADSURCHARGE = 31

### LTYPE_LOCKEDINFORCES = 32

### LTYPE_PEDESTRIANLL = 33

### LTYPE_PRESTRESS = 34

### LTYPE_HYPERSTATIC = 35

### LTYPE_BOUYANCY = 36

### LTYPE_STREAMFLOW = 37

### LTYPE_IMPACT = 38

### LTYPE_CONSTRUCTION = 39

## Remarks

This function retrieves the load type for a specified load pattern.

The function returns zero if the load type is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetLoadPatternType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As eLoadPatternType

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get load pattern type
ret = SapModel.LoadPatterns.GetLoadType("DEAD", MyType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Added three items to the eLoadPatternType enumeration in version 12.00.

## See Also

SetLoadType

# GetNameList

## Syntax

SapObject.SapModel.LoadPatterns.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of load pattern names retrieved by the program.

MyName

This is a one-dimensional array of load pattern names. The MyName array is created as a
dynamic, zero-based, array by the API user:


Dim MyName() as String

The array is dimensioned to (NumberNames – 1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined load cases.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetLoadPatternNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'get load pattern names
ret = SapModel.LoadPatterns.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.00.


Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

# GetSelfWtMultiplier

## Syntax

SapObject.SapModel.LoadPatterns.GetSelfWtMultiplier

## VB6 Procedure

Function GetSelfWtMultiplier(ByVal Name As String, ByRef SelfWTMultiplier As Double) As
Long

## Parameters

Name

The name of an existing load pattern.

SelfWTMultiplier

The self weight multiplier for the specified load pattern.

## Remarks

This function retrieves the self weight multiplier for a specified load pattern.

The function returns zero if the multiplier is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetSelfWeightMultiplier()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SelfWTMultiplier As Double

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get self weight multiplier
ret = SapModel.LoadPatterns.GetSelfWtMultiplier("DEAD", SelfWTMultiplier)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

SetSelfWtMultiplier

# SetLoadType

## Syntax

SapObject.SapModel.LoadPatterns.SetLoadType

## VB6 Procedure

Function SetLoadType(ByVal Name As String, ByVal MyType As eLoadPatternType) As Long

## Parameters

Name

The name of an existing load pattern.

MyType

This is one of the following items in the eLoadPatternType enumeration:


### LTYPE_DEAD = 1

### LTYPE_SUPERDEAD = 2

### LTYPE_LIVE = 3

### LTYPE_REDUCELIVE = 4

### LTYPE_QUAKE = 5

### LTYPE_WIND= 6

### LTYPE_SNOW = 7

### LTYPE_OTHER = 8

### LTYPE_MOVE = 9

### LTYPE_TEMPERATURE = 10

### LTYPE_ROOFLIVE = 11

### LTYPE_NOTIONAL = 12

### LTYPE_PATTERNLIVE = 13

### LTYPE_WAVE= 14

### LTYPE_BRAKING = 15

### LTYPE_CENTRIFUGAL = 16

### LTYPE_FRICTION = 17

### LTYPE_ICE = 18

### LTYPE_WINDONLIVELOAD = 19

### LTYPE_HORIZONTALEARTHPRESSURE = 20

### LTYPE_VERTICALEARTHPRESSURE = 21

### LTYPE_EARTHSURCHARGE = 22

### LTYPE_DOWNDRAG = 23

### LTYPE_VEHICLECOLLISION = 24

### LTYPE_VESSELCOLLISION = 25

### LTYPE_TEMPERATUREGRADIENT = 26

### LTYPE_SETTLEMENT = 27

### LTYPE_SHRINKAGE = 28

### LTYPE_CREEP = 29

### LTYPE_WATERLOADPRESSURE = 30

### LTYPE_LIVELOADSURCHARGE = 31

### LTYPE_LOCKEDINFORCES = 32

### LTYPE_PEDESTRIANLL = 33

### LTYPE_PRESTRESS = 34

### LTYPE_HYPERSTATIC = 35

### LTYPE_BOUYANCY = 36

### LTYPE_STREAMFLOW = 37

### LTYPE_IMPACT = 38

### LTYPE_CONSTRUCTION = 39

## Remarks

This function assigns a load type to a load pattern.

The function returns zero if the load type is successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignLoadType()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'assign load type
ret = SapModel.LoadPatterns.SetLoadType("DEAD", LTYPE_SUPERDEAD)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

Added three items to the eLoadPatternType enumeration in version 12.00.

## See Also

GetLoadType

# SetSelfWtMultiplier

## Syntax

SapObject.SapModel.LoadPatterns.SetSelfWtMultiplier

## VB6 Procedure


Function SetSelfWtMultiplier(ByVal Name As String, ByVal SelfWTMultiplier As Double) As
Long

## Parameters

Name

The name of an existing load pattern.

SelfWTMultiplier

The self weight multiplier for the specified load pattern.

## Remarks

This function assigns a self weight multiplier to a load case.

The function returns zero if the multiplier is successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignSelfWeightMultiplier()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = New Sap2000v16.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'assign self weight multiplier
ret = SapModel.LoadPatterns.SetSelfWtMultiplier("DEAD", 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.01.

Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load
Patterns, Load Cases and Load Combinations, respectively, in version 12.00.

## See Also

GetSelfWtMultiplier

# Change Name {Mass Source}

## Syntax

SapObject.SapModel.SourceMass.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The name of an existing mass source.

NewName

The new name for the mass source.

## Remarks

This function changes the name of an existing mass source.

The function returns zero if the mass source is successfully changed, otherwise it returns a
nonzero value. If the new name already exists, a nonzero value is returned and the mass source
name is not changed.

## VBA Example

Sub ChangeMassSourceName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'change mass source name from MSSSRC1 to MyMassSource
ret = SapModel.SourceMass.ChangeName("MSSSRC1", "MyMassSource")
'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.0.0..

## See Also

# Count {Mass Source}

## Syntax

SapObject.SapModel.SourceMass.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns the number of defined mass sources.


## VBA Example

Sub CountMassSources()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

Dim LoadPat(0) As String

Dim SF(0) As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add a new mass source and make it the default mass sourc

LoadPat(0) = "DEAD"

SF(0) = 1.25

ret = SapModel.SourceMass.SetMassSource("MyMassSource", True, True, True, True, 1,
LoadPat, SF)

'get mass source count
Count = SapModel.SourceMass.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.0.0.


## See Also

# Delete {Mass Source}

## Syntax

SapObject.SapModel.SourceMass.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of the mass source to be deleted.

## Remarks

This function deletes an existing mass source.

The function returns zero if the mass source is successfully deleted; otherwise it returns a nonzero
value. If the mass source to be deleted is the default mass source, a nonzero value is returned and
th mass source is not deleted.

## VBA Example

Sub DeleteMassSource()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long
Dim LoadPat(0) As String

Dim SF(0) As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add a new mass source and make it the default mass source

LoadPat(0) = "DEAD"

SF(0) = 1.25

ret = SapModel.SourceMass.SetMassSource("MyMassSource", True, True, True, True, 1,
LoadPat, SF)

'delete mass source MSSSRC1
ret = SapModel.SourceMass.Delete("MSSSRC1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.0.0.

## See Also

# Get Default {Mass Source}

## Syntax

SapObject.SapModel.SourceMass.GetDefault

## VB6 Procedure

Function GetDefault(ByRef Name As String) As Long

## Parameters

Name

The name of the default mass source.


## Remarks

This function retrieves the default mass source.

The function returns zero if the default mass source is successfully retrieved, otherwise it returns
nonzero.

## VBA Example

Sub GetDefaultMassSource()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim LoadPat(0) As String
```
```
Dim SF(0) As Double
```
```
Dim DefaultMassSource As String
```
```
'create Sap2000 object
```
```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```

```
'add a new mass source and make it the default mass source
```
```
LoadPat(0) = "DEAD"
```
```
SF(0) = 1.25
```
```
ret = SapModel.SourceMass.SetMassSource("MyMassSource", True, True, True,
True, 1, LoadPat, SF)
```
```
'get the default mass source
```
```
ret = SapModel.SourceMass.GetDefault(DefaultMassSource)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.0.0.

## See Also

# Get Mass Source

## Syntax

SapObject.SapModel.SourceMass.GetMassSource

## VB6 Procedure

Function GetMassSource (ByVal Name As String, ByRef MassFromElements As Boolean, ByRef
MassFromMasses As Boolean, ByRef MassFromLoads As Boolean, ByRef IsDefault As Boolean,
ByRef NumberLoads As Long, ByRef LoadPat() As String, ByRef SF() As Double) As Long

## Parameters

Name


The mass source name.

MassFromElements

If this item is True then element self mass is included in the mass.

MassFromMasses

If this item is True then assigned masses are included in the mass.

MassFromLoads

If this item is True then specified load patterns are included in the mass.

IsDefault

If this item is True then the mass source is the default mass source.

NumberLoads

The number of load patterns specified for the mass source. This item is only applicable when the
MassFromLoads item is True.

LoadPat

This is an array of load pattern names specified for the mass source.

SF

This is an array of load pattern multipliers specified for the mass source.

## Remarks

This function gets the mass source data for an existing mass source.

The function returns zero if the mass source data is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

Sub GetMassSource()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim MassFromElements As Boolean
```
```
Dim MassFromMasses As Boolean
```

```
Dim MassFromLoads As Boolean
```
```
Dim IsDefault As Boolean
```
```
Dim NumberLoads As Long
```
```
Dim LoadPat() As String
```
```
Dim SF() As Double
```
'create Sap2000 object

```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
'get data for mass source MSSSRC1

```
ret = SapModel.SourceMass.GetMassSource("MSSSRC1", MassFromElements,
MassFromMasses, MassFromLoads, IsDefault, NumberLoads, LoadPat, SF)
```
'close Sap2000

```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```

End Sub

## Release Notes

Initial release in version 16.0.0.

## See Also

# Get Name List

## Syntax

SapObject.SapModel.SourceMass.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of mass source names retrieved by the program.

MyName

This is a one-dimensional array of mass source names. The MyName array is created as a
dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames – 1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined mass sources.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

Sub GetMassSourceNames()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```

```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim NumberNames As Long
```
```
Dim MyName() As String
```
```
'create Sap2000 object
```
```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
```
'get mass source names
```
```
ret = SapModel.SourceMass.GetNameList(NumberNames, MyName)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub


## Release Notes

Initial release in version 16.0.0.

## See Also

# Set Default

## Syntax

SapObject.SapModel.SourceMass.SetDefault

## VB6 Procedure

Function SetDefault(ByVal Name As String) As Long

## Parameters

Name

The name of the mass source to be flagged as the default mass source.

## Remarks

This function sets the default mass source.

The function returns zero if the mass source is successfully flagged as default, otherwise it returns
nonzero. Only one mass source can be the default mass source so when this assignment is set all
other mass sources are automatically set to have their IsDefault flag False.

## VBA Example

Sub SetDefaultMassSource()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim LoadPat(0) As String
```
```
Dim SF(0) As Double
```

```
'create Sap2000 object
```
```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
```
'add a new mass source and do NOT make it the default mass source
```
```
LoadPat(0) = "DEAD"
```
```
SF(0) = 1.25
```
```
ret = SapModel.SourceMass.SetMassSource("MyMassSource", True, True, True,
False, 1, LoadPat, SF)
```
```
'set MyMassSource as the default mass source
```
```
ret = SapModel.SourceMass.SetDefault("MyMassSource")
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub


## Release Notes

Initial release in version 16.0.0.

## See Also

# Set Mass Source

## Syntax

SapObject.SapModel.SourceMass.SetMassSource

## VB6 Procedure

Function SetMassSource(ByVal Name As String, ByVal MassFromElements As Boolean, ByVal
MassFromMasses As Boolean, ByVal MassFromLoads As Boolean, ByVal IsDefault As Boolean,
ByVal NumberLoads As Long, ByRef LoadPat() As String, ByRef SF() As Double) As Long

## Parameters

Name

The mass source name. If a mass source with this name already exists then the mass source is
reinitialized with the new data. All previous data assigned to the mass source is lost. If a mass
source with this name does not exist then a new mass source is added.

MassFromElements

If this item is True then element self mass is included in the mass.

MassFromMasses

If this item is True then assigned masses are included in the mass.

MassFromLoads

If this item is True then specified load patterns are included in the mass.

IsDefault

If this item is True then the mass source is the default mass source. Only one mass source can be
the default mass source so when this assignment is True all other mass sources are automatically
set to have the IsDefault flag False.

NumberLoads

The number of load patterns specified for the mass source. This item is only applicable when the
MassFromLoads item is True.

LoadPat


This is an array of load pattern names specified for the mass source.

SF

This is an array of load pattern multipliers specified for the mass source.

## Remarks

This function adds a new mass source to the model or reinitializes an existing mass source.

The function returns zero if the mass source is successfully added or initialized, otherwise it
returns a nonzero value.

## VBA Example

Sub SetMassSource()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim LoadPat(0) As String
```
```
Dim SF(0) As Double
```
```
'create Sap2000 object
```
```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```

```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
```
'add a new mass source and make it the default mass source
```
```
LoadPat(0) = "DEAD"
```
```
SF(0) = 1.25
```
```
ret = SapModel.SourceMass.SetMassSource("MyMassSource", True, True, True,
True, 1, LoadPat, SF)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.0.0.

## See Also

# ChangeName

## Syntax

SapObject.SapModel.NamedAssign.ModifierArea.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined area stiffness modifier.

NewName


The new name for the area stiffness modifier.

## Remarks

This function changes the name of an existing area stiffness modifier.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeAreaStiffnessModifierName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'add new stiffness modifier
ReDim Value(9)
For i = 0 To 9
Value(i) = 1
Next i
Value(5) = 100
ret = SapModel.NamedAssign.ModifierArea.SetModifiers("AMOD1", Value)

'change name of stiffness modifier
ret = SapModel.NamedAssign.ModifierArea.ChangeName("AMOD1", "MyModifier")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

## See Also

# Count

## Syntax

SapObject.SapModel.NamedAssign.ModifierArea.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns the total number of defined area stiffness modifiers in the model.

## VBA Example

Sub CountAreaStiffnessModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'add new stiffness modifier
ReDim Value(9)
For i = 0 To 9
Value(i) = 1
Next i
Value(5) = 2
ret = SapModel.NamedAssign.ModifierArea.SetModifiers("AMOD1", Value)
Value(5) = 1.5
ret = SapModel.NamedAssign.ModifierArea.SetModifiers("AMOD2", Value)

'return number of defined stiffness modifiers
Count = SapModel.NamedAssign.ModifierArea.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.NamedAssign.ModifierArea.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing area stiffness modifier.

## Remarks

The function deletes a specified area stiffness modifier.


The function returns zero if the modifier is successfully deleted; otherwise it returns a nonzero
value. It returns an error if the specified modifier can not be deleted; for example, if it is currently
used by a staged construction load case.

## VBA Example

Sub DeleteAreaStiffnessModifier()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'add new stiffness modifier
ReDim Value(9)
For i = 0 To 9
Value(i) = 1
Next i
Value(5) = 2
ret = SapModel.NamedAssign.ModifierArea.SetModifiers("AMOD1", Value)
Value(5) = 1.5
ret = SapModel.NamedAssign.ModifierArea.SetModifiers("AMOD2", Value)

'delete stiffness modifier
ret = SapModel.NamedAssign.ModifierArea.Delete("AMOD1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.


## See Also

# GetModifiers

## Syntax

SapObject.SapModel.NamedAssign.ModifierArea.GetModifiers

## VB6 Procedure

Function GetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing area stiffness modifier.

Value

This is an array of ten unitless modifiers.

```
Value(0) = Membrane f11 modifier
Value(1) = Membrane f22 modifier
Value(2) = Membrane f12 modifier
Value(3) = Bending m11 modifier
Value(4) = Bending m22 modifier
Value(5) = Bending m12 modifier
Value(6) = Shear v13 modifier
Value(7) = Shear v23 modifier
Value(8) = Mass modifier
Value(9) = Weight modifier
```
## Remarks

This function retrieves the modifier assignments for an area stiffness modifier. The default value
for all modifier values is one.

The function returns zero if the modifier assignments are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetAreaPropModifierValues()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'define modifiers
ReDim Value(9)
For i = 0 To 9
Value(i) = 1
Next i
Value(5) = 2
ret = SapModel.NamedAssign.ModifierArea.SetModifiers("AMOD1", Value)

'get modifier values
ReDim Value(9)
ret = SapModel.NamedAssign.ModifierArea.GetModifiers("AMOD1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetModifiers

# GetNameList

## Syntax

SapObject.SapModel.NamedAssign.ModifierArea.GetNameList


## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of area stiffness modifier names retrieved by the program.

MyName

This is a one-dimensional array of area stiffness modifier names. The MyName array is created as
a dynamic, zero-based array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined area stiffness modifiers.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero
values.

## VBA Example

Sub GetAreaStiffnessModifierNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'add new stiffness modifier
ReDim Value(9)
For i = 0 To 9
Value(i) = 1
Next i
Value(5) = 2
ret = SapModel.NamedAssign.ModifierArea.SetModifiers("AMOD1", Value)
Value(5) = 1.5
ret = SapModel.NamedAssign.ModifierArea.SetModifiers("AMOD2", Value)

'get area stiffness modifier names
ret = SapModel.NamedAssign.ModifierArea.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# SetModifiers

## Syntax

SapObject.SapModel.NamedAssign.ModifierArea.SetModifiers

## VB6 Procedure

Function SetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of a new or existing area stiffness modifier.

Value

This is an array of ten unitless modifiers.

```
Value(0) = Membrane f11 modifier
```

```
Value(1) = Membrane f22 modifier
Value(2) = Membrane f12 modifier
Value(3) = Bending m11 modifier
Value(4) = Bending m22 modifier
Value(5) = Bending m12 modifier
Value(6) = Shear v13 modifier
Value(7) = Shear v23 modifier
Value(8) = Mass modifier
Value(9) = Weight modifier
```
## Remarks

This function defines a named area stiffness modifier. The default value for all modifier values is
one.

The function returns zero if the modifier is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub DefineAreaStiffnessModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'define modifiers
ReDim Value(9)
For i = 0 To 9
Value(i) = 1
Next i
Value(5) = 2
ret = SapModel.NamedAssign.ModifierArea.SetModifiers("AMOD1", Value)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetModifiers

# ChangeName

## Syntax

SapObject.SapModel.NamedAssign.ModifierCable.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined cable property modifier.

NewName

The new name for the cable property modifier.

## Remarks

This function changes the name of an existing cable property modifier.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeCablePropModifierName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add new property modifier
ReDim Value(2)
For i = 0 To 2
Value(i) = 1
Next i
Value(1) = 2
ret = SapModel.NamedAssign.ModifierCable.SetModifiers("CMOD1", Value)

'change name of property modifier
ret = SapModel.NamedAssign.ModifierCable.ChangeName("CMOD1", "MyModifier")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# Count

## Syntax

SapObject.SapModel.NamedAssign.ModifierCable.Count


## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns the total number of defined cable property modifiers in the model.

## VBA Example

Sub CountCablePropModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add new property modifier
ReDim Value(2)
For i = 0 To 2
Value(i) = 1
Next i
Value(1) = 2
ret = SapModel.NamedAssign.ModifierCable.SetModifiers("CMOD1", Value)
Value(1) = 1.5
ret = SapModel.NamedAssign.ModifierCable.SetModifiers("CMOD2", Value)

'return number of defined property modifiers
Count = SapModel.NamedAssign.ModifierCable.Count


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.NamedAssign.ModifierCable.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing cable property modifier.

## Remarks

The function deletes a specified cable property modifier.

The function returns zero if the modifier is successfully deleted; otherwise it returns a nonzero
value. It returns an error if the specified modifier can not be deleted, for example, if it is currently
used by a staged construction load case.

## VBA Example

Sub DeleteCablePropModifier()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add new property modifier
ReDim Value(2)
For i = 0 To 2
Value(i) = 1
Next i
Value(1) = 2
ret = SapModel.NamedAssign.ModifierCable.SetModifiers("CMOD1", Value)
Value(1) = 1.5
ret = SapModel.NamedAssign.ModifierCable.SetModifiers("CMOD2", Value)

'delete property modifier
ret = SapModel.NamedAssign.ModifierCable.Delete("CMOD1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# GetModifiers

## Syntax

SapObject.SapModel.NamedAssign.ModifierCable.GetModifiers

## VB6 Procedure

Function GetModifiers(ByVal Name As String, ByRef Value() As Double) As Long


## Parameters

Name

The name of an existing cable property modifier.

Value

This is an array of three unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Mass modifier
Value(2) = Weight modifier
```
## Remarks

This function retrieves the modifier assignments for a cable property modifier. The default value
for all modifier values is one.

The function returns zero if the modifier assignments are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetCablePropModifierValues()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define modifiers
ReDim Value(2)
For i = 0 To 2
Value(i) = 1


Next i
Value(1) = 100
ret = SapModel.NamedAssign.ModifierCable.SetModifiers("CMOD1", Value)

'get modifier values
ReDim Value(2)
ret = SapModel.NamedAssign.ModifierCable.GetModifiers("CMOD1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetModifiers

# GetNameList

## Syntax

SapObject.SapModel.NamedAssign.ModifierCable.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of cable property modifier names retrieved by the program.

MyName

This is a one-dimensional array of cable property modifier names. The MyName array is created
as a dynamic, zero-based array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.


## Remarks

This function retrieves the names of all defined cable property modifiers.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetCablePropModifierNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new property modifier
ReDim Value(2)
For i = 0 To 2
Value(i) = 1
Next i
Value(1) = 2
ret = SapModel.NamedAssign.ModifierCable.SetModifiers("CMOD1", Value)
Value(1) = 1.5
ret = SapModel.NamedAssign.ModifierCable.SetModifiers("CMOD2", Value)

'get cable property modifier names
ret = SapModel.NamedAssign.ModifierCable.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

## See Also

# SetModifiers

## Syntax

SapObject.SapModel.NamedAssign.ModifierCable.SetModifiers

## VB6 Procedure

Function SetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of a new or existing cable property modifier.

Value

This is an array of three unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Mass modifier
Value(2) = Weight modifier
```
## Remarks

This function defines a named cable property modifier. The default value for all modifier values is
one.

The function returns zero if the modifier is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub DefineCablePropModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define modifiers
ReDim Value(2)
For i = 0 To 2
Value(i) = 1
Next i
Value(1) = 2
ret = SapModel.NamedAssign.ModifierCable.SetModifiers("CMOD1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetModifiers

# ChangeName

## Syntax

SapObject.SapModel.NamedAssign.ModifierFrame.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long


## Parameters

Name

The existing name of a defined frame property modifier.

NewName

The new name for the frame property modifier.

## Remarks

This function changes the name of an existing frame property modifier.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeFramePropModifierName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add new property modifier
ReDim Value(7)
For i = 0 To 7
Value(i) = 1
Next i
Value(5) = 100
ret = SapModel.NamedAssign.ModifierFrame.SetModifiers("FMOD1", Value)

'change name of property modifier


ret = SapModel.NamedAssign.ModifierFrame.ChangeName("FMOD1", "MyModifier")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# Count

## Syntax

SapObject.SapModel.NamedAssign.ModifierFrame.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns the total number of defined frame property modifiers in the model.

## VBA Example

Sub CountFramePropModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add new property modifier
ReDim Value(7)
For i = 0 To 7
Value(i) = 1
Next i
Value(5) = 100
ret = SapModel.NamedAssign.ModifierFrame.SetModifiers("FMOD1", Value)
Value(5) = 10
ret = SapModel.NamedAssign.ModifierFrame.SetModifiers("FMOD2", Value)

'return number of defined property modifiers
Count = SapModel.NamedAssign.ModifierFrame.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.NamedAssign.ModifierFrame.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters


Name

The name of an existing frame property modifier.

## Remarks

The function deletes a specified frame property modifier.

The function returns zero if the modifier is successfully deleted; otherwise it returns a nonzero
value. It returns an error if the specified modifier can not be deleted; for example, if it is currently
used by a staged construction load case.

## VBA Example

Sub DeleteFramePropModifier()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add new property modifier
ReDim Value(7)
For i = 0 To 7
Value(i) = 1
Next i
Value(5) = 100
ret = SapModel.NamedAssign.ModifierFrame.SetModifiers("FMOD1", Value)
Value(5) = 10
ret = SapModel.NamedAssign.ModifierFrame.SetModifiers("FMOD2", Value)

'delete property modifier
ret = SapModel.NamedAssign.ModifierFrame.Delete("FMOD1")

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# GetModifiers

## Syntax

SapObject.SapModel.NamedAssign.ModifierFrame.GetModifiers

## VB6 Procedure

Function GetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing frame property modifier.

Value

This is an array of eight unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Shear area in local 2 direction modifier
Value(2) = Shear area in local 3 direction modifier
Value(3) = Torsional constant modifier
Value(4) = Moment of inertia about local 2 axis modifier
Value(5) = Moment of inertia about local 3 axis modifier
Value(6) = Mass modifier
Value(7) = Weight modifier
```
## Remarks

This function retrieves the modifier assignments for a frame property modifier. The default value
for all modifier values is one.

The function returns zero if the modifier assignments are successfully retrieved; otherwise it
returns a nonzero value.


## VBA Example

Sub GetFramePropModifierValues()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define modifiers
ReDim Value(7)
For i = 0 To 7
Value(i) = 1
Next i
Value(5) = 100
ret = SapModel.NamedAssign.ModifierFrame.SetModifiers("FMOD1", Value)

'get modifier values
ReDim Value(7)
ret = SapModel.NamedAssign.ModifierFrame.GetModifiers("FMOD1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetModifiers


# GetNameList

## Syntax

SapObject.SapModel.NamedAssign.ModifierFrame.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of frame property modifier names retrieved by the program.

MyName

This is a one-dimensional array of frame property modifier names. The MyName array is created
as a dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined frame property modifiers.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetFramePropModifierNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new property modifier
ReDim Value(7)
For i = 0 To 7
Value(i) = 1
Next i
Value(5) = 100
ret = SapModel.NamedAssign.ModifierFrame.SetModifiers("FMOD1", Value)
Value(5) = 10
ret = SapModel.NamedAssign.ModifierFrame.SetModifiers("FMOD2", Value)

'get frame property modifier names
ret = SapModel.NamedAssign.ModifierFrame.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# SetModifiers

## Syntax

SapObject.SapModel.NamedAssign.ModifierFrame.SetModifiers

## VB6 Procedure

Function SetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name


The name of a new or existing frame property modifier.

Value

This is an array of eight unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Shear area in local 2 direction modifier
Value(2) = Shear area in local 3 direction modifier
Value(3) = Torsional constant modifier
Value(4) = Moment of inertia about local 2 axis modifier
Value(5) = Moment of inertia about local 3 axis modifier
Value(6) = Mass modifier
Value(7) = Weight modifier
```
## Remarks

This function defines a named frame property modifier. The default value for all modifier values
is one.

The function returns zero if the modifier is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub DefineFramePropModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define modifiers
ReDim Value(7)
For i = 0 To 7
Value(i) = 1


Next i
Value(5) = 100
ret = SapModel.NamedAssign.ModifierFrame.SetModifiers("FMOD1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing

End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetModifiers

# ChangeName

## Syntax

SapObject.SapModel.NamedAssign.ReleaseFrame.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined frame end release.

NewName

The new name for the frame end release.

## Remarks

This function changes the name of an existing frame end release.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.


## VBA Example

Sub ChangeFrameEndReleaseName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ii() As Boolean
Dim jj() As Boolean
Dim StartValue() As Double
Dim EndValue() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add new end release
ReDim ii(5)
ReDim jj(5)
ReDim StartValue(5)
ReDim EndValue(5)
ii(0) = True
StartValue(0) = 10
ret = SapModel.NamedAssign.ReleaseFrame.SetReleases("FREL1", ii, jj, StartValue,
EndValue)

'change name of end release
ret = SapModel.NamedAssign.ReleaseFrame.ChangeName("FREL1", "MyRelease")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.


## See Also

# Count

## Syntax

SapObject.SapModel.NamedAssign.ReleaseFrame.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns the total number of defined frame end releases in the model.

## VBA Example

Sub CountFrameEndReleases()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long
Dim ii() As Boolean
Dim jj() As Boolean
Dim StartValue() As Double
Dim EndValue() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)


'add new end release
ReDim ii(5)
ReDim jj(5)
ReDim StartValue(5)
ReDim EndValue(5)
ii(0) = True
StartValue(0) = 10
ret = SapModel.NamedAssign.ReleaseFrame.SetReleases("FREL1", ii, jj, StartValue,
EndValue)
ii(0) = False
StartValue(0) = 0
ii(5) = True
jj(5) = True
ret = SapModel.NamedAssign.ReleaseFrame.SetReleases("FREL2", ii, jj, StartValue,
EndValue)

'return number of defined end releases
Count = SapModel.NamedAssign.ReleaseFrame.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# Delete

## Syntax

SapObject.SapModel.NamedAssign.ReleaseFrame.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing frame end release.


## Remarks

The function deletes a specified frame end release.

The function returns zero if the end release is successfully deleted; otherwise it returns a nonzero
value. It returns an error if the specified end release can not be deleted; for example, if it is
currently used by a staged construction load case.

## VBA Example

Sub DeleteFrameEndRelease()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ii() As Boolean
Dim jj() As Boolean
Dim StartValue() As Double
Dim EndValue() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add new end release
ReDim ii(5)
ReDim jj(5)
ReDim StartValue(5)
ReDim EndValue(5)
ii(0) = True
StartValue(0) = 10
ret = SapModel.NamedAssign.ReleaseFrame.SetReleases("FREL1", ii, jj, StartValue,
EndValue)
ii(0) = False
StartValue(0) = 0
ii(5) = True
jj(5) = True
ret = SapModel.NamedAssign.ReleaseFrame.SetReleases("FREL2", ii, jj, StartValue,
EndValue)

'delete end release


ret = SapModel.NamedAssign.ReleaseFrame.Delete("FREL1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# GetNameList

## Syntax

SapObject.SapModel.NamedAssign.ReleaseFrame.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of frame end release names retrieved by the program.

MyName

This is a one-dimensional array of frame end release names. The MyName array is created as a
dynamic, zero-based array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined frame end releases.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero
values.


## VBA Example

Sub GetFrameEndReleaseNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ii() As Boolean
Dim jj() As Boolean
Dim StartValue() As Double
Dim EndValue() As Double
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new end release
ReDim ii(5)
ReDim jj(5)
ReDim StartValue(5)
ReDim EndValue(5)
ii(0) = True
StartValue(0) = 10
ret = SapModel.NamedAssign.ReleaseFrame.SetReleases("FREL1", ii, jj, StartValue,
EndValue)
ii(0) = False
StartValue(0) = 0
ii(5) = True
jj(5) = True
ret = SapModel.NamedAssign.ReleaseFrame.SetReleases("FREL2", ii, jj, StartValue,
EndValue)

'get frame end release names
ret = SapModel.NamedAssign.ReleaseFrame.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

# GetReleases

## Syntax

SapObject.SapModel.NamedAssign.ReleaseFrame.GetReleases

## VB6 Procedure

Function GetReleases(ByVal Name As String, ByRef ii() As Boolean, ByRef jj() As Boolean,
ByRef StartValue() As Double, ByRef EndValue() As Double) As Long

## Parameters

Name

The name of an existing frame end release.

ii, jj

These are arrays of six booleans indicating the I-End and J-End releases.

```
ii(0) and jj(0) = U1 release
ii(1) and jj(1) = U2 release
ii(2) and jj(2) = U3 release
ii(3) and jj(3) = R1 release
ii(4) and jj(4) = R2 release
ii(5) and jj(5) = R3 release
```
StartValue, EndValue

These are arrays of six values indicating the I-End and J-End partial fixity springs.

```
StartValue(0) and EndValue(0) = U1 partial fixity [F/L]
StartValue(1) and EndValue(1) = U2 partial fixity [F/L]
StartValue(2) and EndValue(2) = U3 partial fixity [F/L]
StartValue(3) and EndValue(3) = R1 partial fixity [FL/rad]
StartValue(4) and EndValue(4) = R2 partial fixity [FL/rad]
StartValue(5) and EndValue(5) = R3 partial fixity [FL/rad]
```

## Remarks

This function retrieves the release assignments for a frame end release.

The function returns zero if the release assignments are successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFrameEndReleaseValues()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim ii() As Boolean
Dim jj() As Boolean
Dim StartValue() As Double
Dim EndValue() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define releases
ReDim ii(5)
ReDim jj(5)
ReDim StartValue(5)
ReDim EndValue(5)
ii(0) = True
StartValue(0) = 10
ret = SapModel.NamedAssign.ReleaseFrame.SetReleases("FREL1", ii, jj, StartValue,
EndValue)

'clear variables
For i = 0 to 5
ii(i) = False
jj(i) = False
StartValue(i) = 0
EndValue(i) = 0
Next i


'get release values
ret = SapModel.NamedAssign.ReleaseFrame.GetReleases("FREL1", ii, jj, StartValue,
EndValue)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetReleases

# SetReleases

## Syntax

SapObject.SapModel.NamedAssign.ReleaseFrame.SetReleases

## VB6 Procedure

Function SetReleases(ByVal Name As String, ByRef ii() As Boolean, ByRef jj() As Boolean,
ByRef StartValue() As Double, ByRef EndValue() As Double) As Long

## Parameters

Name

The name of a new or existing frame end release.

ii, jj

These are arrays of six booleans indicating the I-End and J-End releases.

```
ii(0) and jj(0) = U1 release
ii(1) and jj(1) = U2 release
ii(2) and jj(2) = U3 release
ii(3) and jj(3) = R1 release
ii(4) and jj(4) = R2 release
ii(5) and jj(5) = R3 release
```
StartValue, EndValue


These are arrays of six values indicating the I-End and J-End partial fixity springs.

```
StartValue(0) and EndValue(0) = U1 partial fixity [F/L]
StartValue(1) and EndValue(1) = U2 partial fixity [F/L]
StartValue(2) and EndValue(2) = U3 partial fixity [F/L]
StartValue(3) and EndValue(3) = R1 partial fixity [FL/rad]
StartValue(4) and EndValue(4) = R2 partial fixity [FL/rad]
StartValue(5) and EndValue(5) = R3 partial fixity [FL/rad]
```
## Remarks

This function defines a named frame end release.

The function returns zero if the release is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub DefineFrameEndReleases()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ii() As Boolean
Dim jj() As Boolean
Dim StartValue() As Double
Dim EndValue() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'define releases
ReDim ii(5)
ReDim jj(5)
ReDim StartValue(5)
ReDim EndValue(5)
ii(0) = True
StartValue(0) = 10
ret = SapModel.NamedAssign.ReleaseFrame.SetReleases("FREL1", ii, jj, StartValue,
EndValue)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetReleases

# GetJointRespSpec

## Syntax

SapObject.SapModel.NamedSet.GetJointRespSpec

## VB6 Procedure

Function GetJointRespSpec(ByVal Name As String, ByRef LoadCase As String, ByRef
NumberJoints As Long, ByRef JointNames() As String, ByRef CoordSys As String, ByRef
Direction As Long, ByRef Abscissa As Long, ByRef Ordinate As Long, ByRef DefaultFreq As
Boolean, ByRef StructuralFreq As Boolean, ByRef NumberUserFreq As Long, ByRef
UserFreqValues() As Double, ByRef NumberDampValues As Long, ByRef DampingValues() As
Double, ByRef AbscissaPlotType As Long, ByRef SpectrumWidening As Double, ByRef
OrdinatePlotType As Long, ByRef OrdinateScaleFactor As Double) As Long

## Parameters

Name

The name of an existing joint response spectrum named set..

Load Case

The name of a time history load case for which results will be extracted.

NumberJoints

The number of joints for which to generate response spectra.

JointNames

This is an array of joint names for which to generate response spectra.


CoordSys

The name of a coordinate system in which the direction for results is defined. This can be Global,
Local, or any other user-defined coordinate system.

Direction

This specifies the direction, in the specified coordinate system, in which the results are to be
retrieved. Valid values for the direction are:

```
1 = Local 1, Global X, or user-defined coordinate system X
2 = Local 2, Global Y, or user-defined coordinate system Y
3 = Local 3, Global Z, or user-defined coordinate system Z
```
Abscissa

This is one of the following, specifying the abscissa data type.

```
1 = Frequency
2 = Period
```
Ordinate

This is one of the following, specifying the ordinate data type.

```
1 = Spectral displacement
2 = Spectral velocity
3 = Pseudo-spectral velocity
4 = Spectral acceleration
5 = Pseudo-spectral acceleration
```
DefaultFreq

If this item is True, the default frequencies are used for output.

StructuralFreq

If this item is True, the structural frequencies are used for output.

NumberUserFreq

The number of user-defined frequencies, which may be 0.

UserFreqValues

This is an array that includes the user-defined frequencies. Values are returned using indices 0 to
NumberUserFreq-1 if NumberUserFreq > 0. [1/s]

NumberDampValues

The number of critical damping ratio values.

Damping Values

This is an array that includes the critical damping ratios to be used for extracting results. Values
are supplied using indices 0 to NumberDampValues-1.


Abscissa Plot Type

This is one of the following, specifying the abscissa axis scale type.

```
1 = Arithmetic
```
```
2 = Log
```
Spectrum Widening

This specifies the percentage by which to widen the peaks of the spectrum.

OrdinatePlotType

This is one of the following, specifying the ordinate axis scale type.

```
1 = Arithmetic
```
```
2 = Log
```
OrdinateScaleFactor

This is the scale factor used to linearly scale the response spectrum ordinate values.

## Remarks

This function gets a joint response spectrum named set definition.

The function returns zero if the named set is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetJointRSNamedSet()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim InJoints() As String
Dim InUserFreq() As Double

Dim InDampValues() As Double
Dim LoadCase As String

Dim NumJoints As Long

Dim Joints() As String

Dim CoordSys As String

Dim Direction As Long


Dim Abscissa As Long
Dim Ordinate As Long
Dim DefaultFreq As Boolean
Dim StructuralFreq As Boolean
Dim NumUserFreq As Long
Dim UserFreqValues() As Double
Dim NumDampValues As Long
Dim DampingValues() As Double
Dim AbscissaPlotType As Long
Dim SpectrumWidening As Double
Dim OrdinatePlotType As Long
Dim OrdinateScaleFactor As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'define named set
ReDim InJoints(1)
InJoints(0) = "3"
InJoints(1) = "6"
ReDim InDampValues(1)
InDampValues(0) = 0
InDampValues(1) = 0.05

ret = SapModel.NamedSet.SetJointRespSpec("Sample", "LCASE1", 2, InJoints, "Global", 1, 1,
4, True, True, 0, InUserFreq, 2, InDampValues)

'get named set
ret = SapModel.NamedSet.GetJointRespSpec("Sample", LoadCase, NumJoints, Joints,
CoordSys, Direction, Abscissa, Ordinate, DefaultFreq, StructuralFreq, NumUserFreq,
UserFreqValues, NumDampValues, DampingValues, AbscissaPlotType, SpectrumWidening,
OrdinatePlotType, OrdinateScaleFactor)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.3.0.

## See Also

SetJointRespSpec

# SetJointRespSpec

## Syntax

SapObject.SapModel.NamedSet.SetJointRespSpec

## VB6 Procedure

Function SetJointRespSpec(ByVal Name As String, ByVal LoadCase As String, ByVal
NumberJoints As Long, ByVal JointNames() As String, ByVal CoordSys As String, ByVal
Direction As Long, ByVal Abscissa As Long, ByVal Ordinate As Long, ByVal DefaultFreq As
Boolean, ByVal StructuralFreq As Boolean, ByVal NumberUserFreq As Long, ByVal
UserFreqValues() As Double, ByVal NumberDampValues As Long, ByVal DampingValues() As
Double, Optional ByVal AbscissaPlotType As Long = 2, Optional ByVal SpectrumWidening As
Double = 0, Optional ByVal OrdinatePlotType As Long = 1, Optional ByVal OrdinateScaleFactor
As Double = 1) As Long

## Parameters

Name

The name of a new or existing joint response spectrum named set. If the named set already exists,
it will be modified, otherwise a new named set will be created.

Load Case

The name of a time history load case for which results will be extracted.

NumberJoints

The number of joints for which to generate response spectra.

JointNames

This is an array of joint names for which to generate response spectra.


CoordSys

The name of a coordinate system in which the direction for results is defined. This can be Global,
Local, or any other user-defined coordinate system.

Direction

This is a value specifying the direction, in the specified coordinate system, in which the results are
to be retrieved. Valid values for the direction are:

```
1 = Local 1, Global X, or user-defined coordinate system X
2 = Local 2, Global Y, or user-defined coordinate system Y
3 = Local 3, Global Z, or user-defined coordinate system Z
```
Abscissa

This is one of the following, specifying the abscissa data type.

```
1 = Frequency
2 = Period
```
Ordinate

This is one of the following, specifying the ordinate data type.

```
1 = Spectral displacement
2 = Spectral velocity
3 = Pseudo-spectral velocity
4 = Spectral acceleration
5 = Pseudo-spectral acceleration
```
DefaultFreq

If this item is True, the default frequencies are used for output.

StructuralFreq

If this item is True, the structural frequencies are used for output.

NumberUserFreq

The number of user-defined frequencies, which may be 0.

UserFreqValues

This is an array that includes the user-defined frequencies. Values are returned using indices 0 to
NumberUserFreq-1 if NumberUserFreq > 0. [1/s]

NumberDampValues

The number of critical damping ratio values, which must be at least 1..

Damping Values

This is an array that includes the critical damping ratios to be used for extracting results. Values
are supplied using indices 0 to NumberDampValues-1.


Abscissa Plot Type

This is one of the following, specifying the abscissa axis scale type.

```
1 = Arithmetic
```
```
2 = Log
```
Spectrum Widening

This specifies the percentage by which to widen the peaks of the spectrum.

OrdinatePlotType

This is one of the following, specifying the ordinate axis scale type.

```
1 = Arithmetic
```
```
2 = Log
```
OrdinateScaleFactor

This is the scale factor used to linearly scale the response spectrum ordinate values.

## Remarks

This function defines a joint response spectrum named set.

The function returns zero if the named set is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub DefineJointRSNamedSet()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim Joints() As String
Dim UserFreq() As Double

Dim DampValues() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add linear modal history load case
ret = SapModel.LoadCases.ModHistLinear.SetCase("LCASE1")

'define named set
ReDim InJoints(1)
Joints(0) = "3"
Joints(1) = "6"
ReDim DampValues(1)
DampValues(0) = 0
DampValues(1) = 0.05

ret = SapModel.NamedSet.SetJointRespSpec("Sample", "LCASE1", 2, Joints, "Global", 1, 1, 4,
True, True, 0, UserFreq, 2, DampValues)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.3.0.

## See Also

```
GetJointRespSpec
```
# ChangeName

## Syntax

SapObject.SapModel.PropArea.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long


## Parameters

Name

The existing name of a defined area property.

NewName

The new name for the area property.

## Remarks

This function changes the name of an existing area property.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeAreaPropName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'change name of area property
ret = SapModel.PropArea.ChangeName("ASEC1", "MyArea")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.02.

## See Also

# Count

## Syntax

SapObject.SapModel.PropArea.Count

## VB6 Procedure

Function Count(Optional ByVal PropType As Long = 0) As Long

## Parameters

PropType

This optional value is 0, 1, 2 or 3, indicating the type of area properties included in the count.

```
0 = All
1 = Shell
2 = Plane
3 = Asolid
```
## Remarks

This function returns the total number of defined area properties in the model. If desired, counts
can be returned for all area properties of a specified type in the model.

## VBA Example

Sub CountAreaProps()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'return number of defined area properties of all types
Count = SapModel.PropArea.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# Delete

## Syntax

SapObject.SapModel.PropArea.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing area property.

## Remarks

The function deletes a specified area property.

The function returns zero if the area property is successfully deleted; otherwise it returns a
nonzero value. It returns an error if the specified area property can not be deleted, for example, if
it is being used by an area object.

## VBA Example


Sub DeleteAreaProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set new area property
ret = SapModel.PropArea.SetShell("A1", 1, "4000Psi", 0, 16, 16)

'get area object names
ret = SapModel.AreaObj.GetNameList(NumberNames, MyName)

'assign area property
For i = 1 to NumberNames
ret = SapModel.AreaObj.SetProperty(MyName(i - 1), "A1")
Next i

'delete area property
ret = SapModel.PropArea.Delete("ASEC1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also


# GetAsolid

## Syntax

SapObject.SapModel.PropArea.GetAsolid

## VB6 Procedure

Function GetAsolid(ByVal Name As String, ByRef MatProp As String, ByRef MatAng As
Double, ByRef Arc As Double, ByRef Incompatible As Boolean, ByRef CSys As String, ByRef
Color As Long, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing asolid-type area property.

MatProp

The name of the material property for the area property.

MatAng

The material angle. [deg]

Arc

The arc angle through which the area object is passed to define the asolid element. [deg]

A value of zero means 1 radian (approximately 57.3 degrees).

Incompatible

If this item is True, incompatible bending modes are included in the stiffness formulation. In
general, incompatible modes significantly improve the bending behavior of the object.

CSys

The area object is rotated about the Z-axis in this coordinate system to define the asolid element.

Color

The display color assigned to the property.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.


## Remarks

This function retrieves area property data for an asolid-type area section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaPropAsolid()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim MatAng As Double
Dim Arc As Double
Dim Incompatible As Boolean
Dim CSys As String
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set new area property
ret = SapModel.PropArea.SetAsolid("AS1", "4000Psi", 0, 45, True)

'get area property data
ret = SapModel.PropArea.GetAsolid("AS1", MatProp, MatAng, Arc, Incompatible, CSys,
Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

SetAsolid

# GetModifiers

## Syntax

SapObject.SapModel.PropArea.GetModifiers

## VB6 Procedure

Function GetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing area property.

Value

This is an array of 10 unitless modifiers.

```
Value(0) = Membrane f11 modifier
Value(1) = Membrane f22 modifier
Value(2) = Membrane f12 modifier
Value(3) = Bending m11 modifier
Value(4) = Bending m22 modifier
Value(5) = Bending m12 modifier
Value(6) = Shear v13 modifier
Value(7) = Shear v23 modifier
Value(8) = Mass modifier
Value(9) = Weight modifier
```
## Remarks

This function retrieves the modifier assignments for an area property. The default value for all
modifiers is one.

The function returns zero if the modifier assignments are successfully retrieved; otherwise it
returns a nonzero value.


## VBA Example

Sub GetAreaPropModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim MyValue() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign modifiers
ReDim MyValue(9)
For i = 0 To 9
MyValue(i) = 1
Next i
MyValue(0) = 0.1
ret = SapModel.PropArea.SetModifiers("ASEC1", MyValue)

'get modifiers
ret = SapModel.PropArea.GetModifiers("ASEC1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetModifiers


# GetNameList

## Syntax

SapObject.SapModel.PropArea.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String, Optional
ByVal PropType As Long = 0) As Long

## Parameters

NumberNames

The number of area property names retrieved by the program.

MyName

This is a one-dimensional array of area property names. The MyName array is created as a
dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

PropType

This optional value is 0, 1, 2 or 3, indicating the type of area properties included in the name list.

```
0 = All
1 = Shell
2 = Plane
3 = Asolid
```
## Remarks

This function retrieves the names of all defined area properties of the specified type.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetAreaPropNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'get area property names
ret = SapModel.PropArea.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# GetPlane

## Syntax

SapObject.SapModel.PropArea.GetPlane

## VB6 Procedure

Function GetPlane(ByVal Name As String, ByRef MyType As Long, ByRef MatProp As String,
ByRef MatAng As Double, ByRef Thickness As Double, ByRef Incompatible As Boolean, ByRef
Color As Long, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name


The name of an existing plane-type area property.

MyType

This is either 1 or 2, indicating the plane type.

```
1 = Plane-stress
2 = Plane-strain
```
MatProp

The name of the material property for the area property.

MatAng

The material angle. [deg]

Thickness

The plane thickness. [L]

Incompatible

If this item is True, incompatible bending modes are included in the stiffness formulation. In
general, incompatible modes significantly improve the bending behavior of the object.

Color

The display color assigned to the property.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves area property data for a plane-type area section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaPropPlane()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As Long
Dim MatProp As String


Dim MatAng As Double
Dim Thickness As Double
Dim Incompatible As Boolean
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set new area property
ret = SapModel.PropArea.SetPlane("P1", 1, "4000Psi", 0, 9, True)

'get area property data
ret = SapModel.PropArea.GetPlane("P1", MyType, MatProp, MatAng, Thickness,
Incompatible, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetPlane

# GetShell_1

## Syntax

SapObject.SapModel.PropArea.GetShell


## VB6 Procedure

Function GetShell_1(ByVal Name As String, ByRef ShellType As Long, ByRef
IncludeDrillingDOF As Boolean, ByRef MatProp As String, ByRef MatAng As Double, ByRef
Thickness As Double, ByRef Bending As Double, ByRef Color As Long, ByRef Notes As String,
ByRef GUID As String) As Long

## Parameters

Name

The name of an existing shell-type area property.

ShellType

This is 1, 2, 3, 4, 5 or 6, indicating the shell type.

```
1 = Shell - thin
2 = Shell - thick
3 = Plate - thin
4 = Plate - thick
5 = Membrane
6 = Shell layered/nonlinear
```
IncludeDrillingDOF

This item is True if drilling degrees of freedom are included in the element formulation in the
analysis model. This item does not apply when ShellType = 3, 4 or 6.

MatProp

The name of the material property for the area property. This item does not apply when ShellType
= 6.

MatAng

The material angle. [deg]

This item does not apply when ShellType = 6.

Thickness

The membrane thickness. [L]

This item does not apply when ShellType = 6.

Bending

The bending thickness. [L]

This item does not apply when ShellType = 6.

Color


The display color assigned to the property.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves area property data for a shell-type area section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaPropShell_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ShellType As Long
Dim IncludeDrillingDOF As Boolean
Dim MatProp As String
Dim MatAng As Double
Dim Thickness As Double
Dim Bending As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set new area property
ret = SapModel.PropArea.SetShell("A1", 1, "4000Psi", 0, 16, 16)


'get area property data
ret = SapModel.PropArea.GetShell_1("A1", ShellType, IncludeDrillingDOF, MatProp,
MatAng, Thickness, Bending, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

This function supersedes GetShell.

## See Also

SetShell_1

# GetShellDesign

## Syntax

SapObject.SapModel.PropArea.GetShellDesign

## VB6 Procedure

Function GetShellDesign(ByVal Name As String, ByRef MatProp As String, ByRef
SteelLayoutOption As Long, ByRef DesignCoverTopDir1 As Double, ByRef
DesignCoverTopDir2 As Double, ByRef DesignCoverBotDir1 As Double, ByRef
DesignCoverBotDir2 As Double) As Long

## Parameters

Name

The name of an existing shell-type area property.

MatProp

The name of the material property for the area property.

SteelLayoutOption

This is 0, 1 or 2 indicating, the rebar layout option.

```
0 = Default
1 = One layer
```

```
2 = Two layers
```
DesignCoverTopDir1, DesignCoverTopDir2

The cover to the centroid of the top reinforcing steel running in the local 1 and 2 axes directions of
the area object, respectively. [L]

This item applies only when SteelLayoutOption = 1 or 2.

DesignCoverBotDir1, DesignCoverBotDir2

The cover to the centroid of the bottom reinforcing steel running in the local 1 and 2 axes
directions of the area object, respectively. [L]

This item applies only when SteelLayoutOption = 2.

## Remarks

This function retrieves area property design parameters for a shell-type area section.

The function returns zero if the parameters are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetAreaPropShellDesign()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MatProp As String
Dim SteelLayoutOption As Long
Dim DesignCoverTopDir1 As Double
Dim DesignCoverTopDir2 As Double
Dim DesignCoverBotDir1 As Double
Dim DesignCoverBotDir2 As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)


'set new area property
ret = SapModel.PropArea.SetShell("A1", 1, "4000Psi", 0, 16, 16)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'set area property design parameters
ret = SapModel.PropArea.SetShellDesign("A1", Name, 2, 2, 3, 2.5, 3.5)

'get area property design parameters
ret = SapModel.PropArea.GetShellDesign("A1", MatProp, SteelLayoutOption,
DesignCoverTopDir1, DesignCoverTopDir2, DesignCoverBotDir1, DesignCoverBotDir2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetShellDesign

# GetShellLayer_2

## Syntax

SapObject.SapModel.PropArea.GetShellLayer_2

## VB6 Procedure

Function GetShellLayer_2(ByVal Name As String, ByRef NumberLayers As Long, ByRef
LayerName() As String, ByRef Dist() As Double, ByRef Thickness() As Double, ByRef MyType
() As Long, ByRef NumIntegrationPts() As Long, ByRef MatProp() As String, ByRef Matang()
As Double, ByRef MatBehavior() As Long, ByRef S11Type() As Long, ByRef S22Type() As
Long, ByRef S12Type() As Long) As Long

## Parameters

Name

The name of an existing shell-type area property that is specified to be a layered shell property.


NumberLayers

The number of layers in the area property.

LayerName

This is an array that includes the name of each layer.

Dist

This is an array that includes the distance from the area reference surface (area object joint
location plus offsets) to the mid-height of the layer. [L]

Thickness

This is an array that includes the thickness of each layer. [L]

Type

This is an array that includes 1, 2 or 3, indicating the layer type.

```
1 = Shell
```
```
2 = Membrane
```
```
3 = Plate
```
NumIntegrationPts

The number of integration points in the thickness direction for the layer. The locations are
determined by the program using standard Guass-quadrature rules.

MatProp

This is an array that includes the name of the material property for the layer.

MatAng

This is an array that includes the material angle for the layer. [deg]

MatBehavior

This is an array that includes 0 or 1,indicating the material behavior for the layer.

```
0 = Directional
```
```
1 = Coupled
```
S11Type, S22Type, S12Type

These are arrays that include 0, 1 or 2, indicating the material component behavior.


```
0 = Inactive
```
```
1 = Linear
```
```
2 = Nonlinear
```
## Remarks

This function retrieves area property layer parameters for a shell-type area section.

The function returns zero if the parameters are successfully retrieved, otherwise it returns a
nonzero value.

The function returns an error if the specified area property is not a shell-type property specified to
be a layered shell.

## VBA Example

Sub GetAreaPropShellLayer2()

'dimension variables

Dim SapObject as cOAPI

Dim SapModel As cSapModel

Dim ret As Long

Dim Name As String

Dim MyNumberLayers As Long

Dim MyLayerName() As String

Dim MyDist() As Double

Dim MyThickness() As Double

Dim MyType() As Long

Dim MyNumIntegrationPts() As Long

Dim MyMatProp() As String

Dim MyMatAng() As Double

Dim MyMatBehavior() As Long

Dim MyS11Type() As Long

Dim MyS22Type() As Long

Dim MyS12Type() As Long


Dim NumberLayers As Long

Dim LayerName() As String

Dim Dist() As Double

Dim Thickness() As Double

Dim SType() As Long

Dim MatProp() As String

Dim MatAng() As Double

Dim MatBehavior() As Long

Dim S11Type() As Long

Dim S22Type() As Long

Dim S12Type() As Long

Dim NumIntegrationPts() As Long

'create Sap2000 object

Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application

SapObject.ApplicationStart

'create SapModel object

Set SapModel = SapObject.SapModel

'initialize model

ret = SapModel.InitializeNewModel

'create model from template

ret = SapModel.File.NewWall(2, 48, 2, 48)


'set new area property

ret = SapModel.PropArea.SetShell("A1", 6, "", 0, 0, 0)

'add A615Gr60 rebar material

ret = SapModel.PropMaterial.AddMaterial(Name, eMatType_Rebar, "United States", "ASTM
A706", "Grade 60")

'set area property layer parameters

MyNumberLayers = 5

ReDim MyLayerName(4)

ReDim MyDist(4)

ReDim MyThickness(4)

ReDim MyType(4)

ReDim MyNumIntegrationPts(4)

ReDim MyMatProp(4)

ReDim MyMatAng(4)

ReDim MyMatBehavior(4)

ReDim MyS11Type(4)

ReDim MyS22Type(4)

ReDim MyS12Type(4)

MyLayerName(0) = "Concrete"

MyDist(0) = 0

MyThickness(0) = 16

MyType(0) = 1

MyNumIntegrationPts(0) = 2

MyMatProp(0) = "4000Psi"

MyMatAng(0) = 0

MyMatBehavior(0) = 1


MyS11Type(0) = 1

MyS22Type(0) = 1

MyS12Type(0) = 1

MyLayerName(1) = "Top Bar 1"

MyDist(1) = 6

MyThickness(1) = 0.03

MyType(1) = 1

MyNumIntegrationPts(1) = 1

MyMatProp(1) = Name

MyMatAng(1) = 0

MyMatBehavior(1) = 0

MyS11Type(1) = 1

MyS22Type(1) = 1

MyS12Type(1) = 1

MyLayerName(2) = "Top Bar 2"

MyDist(2) = 6

MyThickness(2) = 0.03

MyType(2) = 1

MyNumIntegrationPts(2) = 1

MyMatProp(2) = Name

MyMatAng(2) = 90

MyMatBehavior(2) = 0

MyS11Type(2) = 1

MyS22Type(2) = 1

MyS12Type(2) = 1


MyLayerName(3) = "Bot Bar 1"

MyDist(3) = -6

MyThickness(3) = 0.03

MyType(3) = 1

MyNumIntegrationPts(3) = 1

MyMatProp(3) = Name

MyMatAng(3) = 0

MyMatBehavior(3) = 0

MyS11Type(3) = 1

MyS22Type(3) = 1

MyS12Type(3) = 1

MyLayerName(4) = "Bot Bar 2"

MyDist(4) = -6

MyThickness(4) = 0.03

MyType(4) = 1

MyNumIntegrationPts(4) = 1

MyMatProp(4) = Name

MyMatAng(4) = 90

MyMatBehavior(4) = 0

MyS11Type(4) = 1

MyS22Type(4) = 1

MyS12Type(4) = 1

ret = SapModel.PropArea.SetShellLayer_2("A1", MyNumberLayers, MyLayerName, MyDist,
MyThickness, MyType, MyNumIntegrationPts, MyMatProp, MyMatAng, MyMatBehavior,
MyS11Type, MyS22Type, MyS12Type)

'get area property layer parameters


ret = SapModel.PropArea.GetShellLayer_2("A1", NumberLayers, LayerName, Dist,
Thickness, SType, NumIntegrationPts, MatProp, MatAng, MatBehavior, S11Type, S22Type,
S12Type)

'close Sap2000

SapObject.ApplicationExit False

Set SapModel = Nothing

Set SapObject = Nothing

End Sub

## Release Notes

Initial release in version 22.1.0

This function supersedes GetShellLayer_1

## See Also

SetShellLayer_2

# GetTypeOAPI

## Syntax

SapObject.SapModel.PropArea.GetTypeOAPI

## VB6 Procedure

Function GetTypeOAPI(ByVal Name As String, ByRef PropType As Long) As Long

## Parameters

Name

The name of an existing area property.

PropType

This is 1, 2 or 3, indicating the type of area property.


```
1 = Shell
2 = Plane
3 = Asolid
```
## Remarks

This function retrieves the property type for the specified area property.

The function returns zero if the type is successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetAreaPropType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PropType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'get area property type
ret = SapModel.PropArea.GetTypeOAPI("ASEC1", PropType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed function name to GetTypeOAPI in v17.0.0.


## See Also

# SetAsolid

## Syntax

SapObject.SapModel.PropArea.SetAsolid

## VB6 Procedure

Function SetAsolid(ByVal Name As String, ByVal MatProp As String, ByVal MatAng As
Double, ByVal Arc As Double, ByVal Incompatible As Boolean, Optional ByVal CSys As String
= "Global", Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional
ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new area property. If this is an existing property, that property is
modified; otherwise, a new property is added.

MatProp

The name of the material property for the area property.

MatAng

The material angle. [deg]

Arc

The arc angle through which the area object is passed to define the asolid element. [deg]

A value of zero means 1 radian (approximately 57.3 degrees).

Incompatible

If this item is True, incompatible bending modes are included in the stiffness formulation. In
general, incompatible modes significantly improve the bending behavior of the object.

CSys

The area object is rotated about the Z-axis in this coordinate system to define the asolid element.

Color

The display color assigned to the property. If Color is specified as -1, the program will
automatically assign a color.

Notes


The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes an asolid-type area property. If this function is called for an existing area
property, all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetAreaPropAsolid()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set new area property
ret = SapModel.PropArea.SetAsolid("AS1", "4000Psi", 0, 45, True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

GetAsolid

# SetModifiers

## Syntax

SapObject.SapModel.PropArea.SetModifiers

## VB6 Procedure

Function SetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing area property.

Value

This is an array of 10 unitless modifiers.

```
Value(0) = Membrane f11 modifier
Value(1) = Membrane f22 modifier
Value(2) = Membrane f12 modifier
Value(3) = Bending m11 modifier
Value(4) = Bending m22 modifier
Value(5) = Bending m12 modifier
Value(6) = Shear v13 modifier
Value(7) = Shear v23 modifier
Value(8) = Mass modifier
Value(9) = Weight modifier
```
## Remarks

This function assigns property modifiers to an area property. The default value for all modifiers is
one.

The function returns zero if the modifiers are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignAreaPropModifiers()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim MyValue() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'assign modifiers
ReDim MyValue(9)
For i = 0 To 9
MyValue(i) = 1
Next i
MyValue(0) = 0.1
ret = SapModel.PropArea.SetModifiers("ASEC1", MyValue)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetModifiers

# SetPlane

## Syntax

SapObject.SapModel.PropArea.SetPlane


## VB6 Procedure

Function SetPlane(ByVal Name As String, ByVal MyType As Long, ByVal MatProp As String,
ByVal MatAng As Double, ByVal Thickness As Double, ByVal Incompatible As Boolean,
Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID
As String = "") As Long

## Parameters

Name

The name of an existing or new area property. If this is an existing property, that property is
modified; otherwise, a new property is added.

MyType

This is either 1 or 2, indicating the plane type.

```
1 = Plane-stress
2 = Plane-strain
```
MatProp

The name of the material property for the area property.

MatAng

The material angle. [deg]

Thickness

The plane thickness. [L]

Incompatible

If this item is True, incompatible bending modes are included in the stiffness formulation. In
general, incompatible modes significantly improve the bending behavior of the object.

Color

The display color assigned to the property. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.


## Remarks

This function initializes a plane-type area property. If this function is called for an existing area
property, all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetAreaPropPlane()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set new area property
ret = SapModel.PropArea.SetPlane("P1", 1, "4000Psi", 0, 9, True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetPlane


# SetShell_1

## Syntax

SapObject.SapModel.PropArea.SetShell_1

## VB6 Procedure

Function SetShell(ByVal Name As String, ByVal ShellType As Long, ByVal IncludeDrillingDOF
As Boolean, ByVal MatProp As String, ByVal MatAng As Double, ByVal Thickness As Double,
ByVal Bending As Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As String
= "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new area property. If this is an existing property, that property is
modified; otherwise, a new property is added.

ShellType

This is 1, 2, 3, 4, 5 or 6, indicating the shell type.

```
1 = Shell - thin
2 = Shell - thick
3 = Plate - thin
4 = Plate - thick
5 = Membrane
6 = Shell layered/nonlinear
```
IncludeDrillingDOF

This item is True if drilling degrees of freedom are included in the element formulation in the
analysis model. This item does not apply when ShellType = 3, 4 or 6.

MatProp

The name of the material property for the area property. This item does not apply when ShellType
= 6.

MatAng

The material angle. [deg]

This item does not apply when ShellType = 6.

Thickness

The membrane thickness. [L]


This item does not apply when ShellType = 6.

Bending

The bending thickness. [L]

This item does not apply when ShellType = 6.

Color

The display color assigned to the property. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, then the program assigns a GUID to the property.

## Remarks

This function initializes a shell-type area property. If this function is called for an existing area
property, all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetAreaPropShell_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)


'set new area property
ret = SapModel.PropArea.SetShell_1("A1", 1, True, "4000Psi", 0, 16, 16)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 14.00.

This function supersedes SetShell.

## See Also

GetShell_1

# SetShellDesign

## Syntax

SapObject.SapModel.PropArea.SetShellDesign

## VB6 Procedure

Function SetShellDesign(ByVal Name As String, ByVal MatProp As String, ByVal
SteelLayoutOption As Long, ByVal DesignCoverTopDir1 As Double, ByVal
DesignCoverTopDir2 As Double, ByVal DesignCoverBotDir1 As Double, ByVal
DesignCoverBotDir2 As Double) As Long

## Parameters

Name

The name of an existing shell-type area property.

MatProp

The name of the material property for the area property.

SteelLayoutOption

This is 0, 1 or 2, indicating the rebar layout option.

```
0 = Default
1 = One layer
2 = Two layers
```

DesignCoverTopDir1, DesignCoverTopDir2

The cover to the centroid of the top reinforcing steel running in the local 1 and 2 axes directions of
the area object, respectively. [L]

This item applies only when SteelLayoutOption = 1 or 2.

DesignCoverBotDir1, DesignCoverBotDir2

The cover to the centroid of the bottom reinforcing steel running in the local 1 and 2 axes
directions of the area object, respectively. [L]

This item applies only when SteelLayoutOption = 2.

## Remarks

This function assigns the design parameters for shell-type area properties.

The function returns zero if the parameters are successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub SetAreaPropShellDesign()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewWall(2, 48, 2, 48)

'set new area property
ret = SapModel.PropArea.SetShell("A1", 1, "4000Psi", 0, 16, 16)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)


'set area property design parameters
ret = SapModel.PropArea.SetShellDesign("A1", Name, 2, 2, 3, 2.5, 3.5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetShellDesign

# SetShellLayer_2

## Syntax

SapObject.SapModel.PropArea.SetShellLayer_2

## VB6 Procedure

Function SetShellLayer_2(ByVal Name As String, ByRef NumberLayers As Long, ByRef
LayerName() As String, ByRef Dist() As Double, ByRef Thickness() As Double, ByRef MyType
() As Long, ByRef NumIntegrationPts() As Long, ByRef MatProp() As String, ByRef Matang()
As Double, ByRef MatBehavior() As Long, ByRef S11Type() As Long, ByRef S22Type() As
Long, ByRef S12Type() As Long) As Long

## Parameters

Name

The name of an existing shell-type area property that is specified to be a layered shell property.

NumberLayers

The number of layers in the area property.

LayerName

This is an array that includes the name of each layer.

Dist

This is an array that includes the distance from the area reference surface (area object joint
location plus offsets) to the mid-height of the layer. [L]


Thickness

This is an array that includes the thickness of each layer. [L]

Type

This is an array that includes 1, 2 or 3, indicating the layer type.

```
1 = Shell
```
```
2 = Membrane
```
```
3 = Plate
```
NumIntegrationPts

The number of integration points in the thickness direction for the layer. The locations are
determined by the program using standard Guass-quadrature rules.

MatProp

This is an array that includes the name of the material property for the layer.

MatAng

This is an array that includes the material angle for the layer. [deg]

MatBehavior

This is an array that includes 0 or 1,indicating the material behavior for the layer.

```
0 = Directional
```
```
1 = Coupled
```
S11Type, S22Type, S12Type

These are arrays that include 0, 1 or 2, indicating the material component behavior.

```
0 = Inactive
```
```
1 = Linear
```
```
2 = Nonlinear
```
## Remarks

This function assigns the layer parameters for shell-type area properties.

The function returns zero if the parameters are successfully assigned; otherwise, it returns a
nonzero value.


The function returns an error if the specified area property is not a shell-type property specified to
be a layered shell.

## VBA Example

Sub SetAreaPropShellLayer2()

'dimension variables

Dim SapObject as cOAPI

Dim SapModel As cSapModel

Dim ret As Long

Dim Name As String

Dim MyNumberLayers As Long

Dim MyLayerName() As String

Dim MyDist() As Double

Dim MyThickness() As Double

Dim MyType() As Long

Dim MyNumIntegrationPts() As Long

Dim MyMatProp() As String

Dim MyMatAng() As Double

Dim MyMatBehavior() As Long

Dim MyS11Type() As Long

Dim MyS22Type() As Long

Dim MyS12Type() As Long

'create Sap2000 object

Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application

SapObject.ApplicationStart


'create SapModel object

Set SapModel = SapObject.SapModel

'initialize model

ret = SapModel.InitializeNewModel

'create model from template

ret = SapModel.File.NewWall(2, 48, 2, 48)

'set new area property

ret = SapModel.PropArea.SetShell("A1", 6, "", 0, 0, 0)

'add A615Gr60 rebar material

ret = SapModel.PropMaterial.AddMaterial(Name, eMatType_Rebar, "United States", "ASTM
A706", "Grade 60")

'set area property layer parameters

MyNumberLayers = 5

ReDim MyLayerName(4)

ReDim MyDist(4)

ReDim MyThickness(4)

ReDim MyType(4)

ReDim MyNumIntegrationPts(4)

ReDim MyMatProp(4)

ReDim MyMatAng(4)

ReDim MyMatBehavior(4)

ReDim MyS11Type(4)

ReDim MyS22Type(4)

ReDim MyS12Type(4)


MyLayerName(0) = "Concrete"

MyDist(0) = 0

MyThickness(0) = 16

MyType(0) = 1

MyNumIntegrationPts(0) = 2

MyMatProp(0) = "4000Psi"

MyMatAng(0) = 0

MyMatBehavior(0) = 1

MyS11Type(0) = 1

MyS22Type(0) = 1

MyS12Type(0) = 1

MyLayerName(1) = "Top Bar 1"

MyDist(1) = 6

MyThickness(1) = 0.03

MyType(1) = 1

MyNumIntegrationPts(1) = 1

MyMatProp(1) = Name

MyMatAng(1) = 0

MyMatBehavior(1) = 0

MyS11Type(1) = 1

MyS22Type(1) = 1

MyS12Type(1) = 1

MyLayerName(2) = "Top Bar 2"

MyDist(2) = 6

MyThickness(2) = 0.03


MyType(2) = 1

MyNumIntegrationPts(2) = 1

MyMatProp(2) = Name

MyMatAng(2) = 90

MyMatBehavior(2) = 0

MyS11Type(2) = 1

MyS22Type(2) = 1

MyS12Type(2) = 1

MyLayerName(3) = "Bot Bar 1"

MyDist(3) = -6

MyThickness(3) = 0.03

MyType(3) = 1

MyNumIntegrationPts(3) = 1

MyMatProp(3) = Name

MyMatAng(3) = 0

MyMatBehavior(3) = 0

MyS11Type(3) = 1

MyS22Type(3) = 1

MyS12Type(3) = 1

MyLayerName(4) = "Bot Bar 2"

MyDist(4) = -6

MyThickness(4) = 0.03

MyType(4) = 1

MyNumIntegrationPts(4) = 1

MyMatProp(4) = Name

MyMatAng(4) = 90


MyMatBehavior(4) = 0

MyS11Type(4) = 1

MyS22Type(4) = 1

MyS12Type(4) = 1

ret = SapModel.PropArea.SetShellLayer_2("A1", MyNumberLayers, MyLayerName, MyDist,
MyThickness, MyType, MyNumIntegrationPts, MyMatProp, MyMatAng, MyMatBehavior,
MyS11Type, MyS22Type, MyS12Type)

'close Sap2000

SapObject.ApplicationExit False

Set SapModel = Nothing

Set SapObject = Nothing

End Sub

## Release Notes

Initial release in version 22.1.0

This function supersedes SetShellLayer_1

## See Also

GetShellLayer_2

# ChangeName

## Syntax

SapObject.SapModel.PropCable.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters


Name

The existing name of a defined cable property.

NewName

The new name for the cable property.

## Remarks

This function changes the name of an existing cable property.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeCablePropName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new cable property
ret = SapModel.PropCable.SetProp("C1", Name, 2.25)

'change name of cable property
ret = SapModel.PropCable.ChangeName("C1", "MyCable")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# Count

## Syntax

SapObject.SapModel.PropCable.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns the total number of defined cable properties in the model.

## VBA Example

Sub CountCableProps()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new cable property
ret = SapModel.PropCable.SetProp("C1", Name, 2.25)

'return number of defined cable properties
Count = SapModel.PropCable.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# Delete

## Syntax

SapObject.SapModel.PropCable.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing cable property.

## Remarks

The function deletes a specified cable property.


The function returns zero if the property is successfully deleted; otherwise it returns a nonzero
value. It returns an error if the specified property can not be deleted, for example, if it is assigned
to an existing object.

## VBA Example

Sub DeleteCableProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim i As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new cable properties
ret = SapModel.PropCable.SetProp("C1", Name, 2.25)
ret = SapModel.PropCable.SetProp("C2", Name, 3.25)

'delete cable property
ret = SapModel.PropCable.Delete("C1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

# GetModifiers

## Syntax

SapObject.SapModel.PropCable.GetModifiers

## VB6 Procedure

Function GetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing cable property.

Value

This is an array of three unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Mass modifier
Value(2) = Weight modifier
```
## Remarks

This function retrieves the modifier assignments for a cable property. The default value for all
modifiers is one.

The function returns zero if the modifier assignments are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetCablePropModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new cable property
ret = SapModel.PropCable.SetProp("C1", Name, 2.25)

'assign modifiers
ReDim Value(2)
For i = 0 To 2
Value(i) = 1
Next i
Value(1) = 2
Value(2) = 2
ret = SapModel.PropCable.SetModifiers("C1", Value)

'get modifiers
ReDim Value(2)
ret = SapModel.PropCable.GetModifiers("C1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetModifiers


# GetNameList

## Syntax

SapObject.SapModel.PropCable.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of cable property names retrieved by the program.

MyName

This is a one-dimensional array of cable property names. The MyName array is created as a
dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined cable properties in the model.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetCableNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new cable properties
ret = SapModel.PropCable.SetProp("C1", Name, 2.25)
ret = SapModel.PropCable.SetProp("C2", Name, 3.25)

'get cable property names
ret = SapModel.PropCable.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# GetProp

## Syntax

SapObject.SapModel.PropCable.GetProp

## VB6 Procedure

Function GetProp(ByVal Name As String, ByRef MatProp As String, ByRef Area As Double,
ByRef Color As Long, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing cable property.


MatProp

The name of the material property assigned to the cable property.

Area

The cross-sectional area of the cable. [L^2 ]

Color

The display color assigned to the property.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves cable property definition data.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetCableProperty()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MatProp As String
Dim Area As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new cable property
ret = SapModel.PropCable.SetProp("C1", Name, 2.25)

'get cable property data
ret = SapModel.PropCable.GetProp("C1", MatProp, Area, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetProp

# SetModifiers

## Syntax

SapObject.SapModel.PropCable.SetModifiers

## VB6 Procedure

Function SetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing cable property.

Value

This is an array of 3 unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Mass modifier
```

```
Value(2) = Weight modifier
```
## Remarks

This function assigns property modifiers to a cable property. The default value for all modifiers is
one.

The function returns zero if the modifiers are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignCablePropModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new cable property
ret = SapModel.PropCable.SetProp("C1", Name, 2.25)

'assign modifiers
ReDim Value(2)
For i = 0 To 2
Value(i) = 1
Next i
Value(1) = 2
Value(2) = 2
ret = SapModel.PropCable.SetModifiers("C1", Value)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetModifiers

# SetProp

## Syntax

SapObject.SapModel.PropCable.SetProp

## VB6 Procedure

Function SetProp(ByVal Name As String, ByVal MatProp As String, ByVal Area As Double,
Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID
As String = "") As Long

## Parameters

Name

The name of an existing or new cable property. If this is an existing property, that property is
modified; otherwise, a new property is added.

MatProp

The name of the material property assigned to the cable property.

Area

The cross-sectional area of the cable. [L^2 ]

Color

The display color assigned to the property. If Color is specified as -1, the program will
automatically assign a color.

Notes


The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function defines a cable property.

The function returns zero if the property is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetCableProperty()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new cable property
ret = SapModel.PropCable.SetProp("C1", Name, 2.25)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

GetProp

# ChangeName

## Syntax

SapObject.SapModel.PropFrame.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined frame section property.

NewName

The new name for the frame section property.

## Remarks

This function changes the name of an existing frame section property.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeFramePropName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'change name of frame section property
ret = SapModel.PropFrame.ChangeName("FSEC1", "MySection")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# Count

## Syntax

SapObject.SapModel.PropFrame.Count

## VB6 Procedure

Function Count(Optional ByVal PropType As eFramePropType) As Long

## Parameters

PropType

This optional value is one of the following items in the eFramePropType enumeration.

```
SECTION_I = 1
SECTION_CHANNEL = 2
SECTION_T = 3
SECTION_ANGLE = 4
SECTION_DBLANGLE = 5
SECTION_BOX = 6
```

### SECTION_PIPE = 7

### SECTION_RECTANGULAR = 8

### SECTION_CIRCLE = 9

### SECTION_GENERAL = 10

### SECTION_DBCHANNEL = 11

### SECTION_AUTO = 12

### SECTION_SD = 13

### SECTION_VARIABLE = 14

### SECTION_JOIST = 15

### SECTION_BRIDGE = 16

### SECTION_COLD_C = 17

### SECTION_COLD_2C = 18

### SECTION_COLD_Z = 19

### SECTION_COLD_L = 20

### SECTION_COLD_2L = 21

### SECTION_COLD_HAT = 22

### SECTION_BUILTUP_I_COVERPLATE = 23

### SECTION_PCC_GIRDER_I = 24

### SECTION_PCC_GIRDER_U = 25

### SECTION_BUILTUP_I_HYBRID = 26

### SECTION_BUILTUP_U_HYBRID = 27

If no value is input for PropType, a count is returned for all frame section properties in the model
regardless of type.

## Remarks

This function returns the total number of defined frame section properties in the model. If desired,
counts can be returned for all frame section properties of a specified type in the model.

## VBA Example

Sub CountFrameProps()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'return number of defined materials of all types
Count = SapModel.PropFrame.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Builtup I Hybrid and Builitup U Hybrid added with Version 16.0.0.

## See Also

# Delete

## Syntax

SapObject.SapModel.PropFrame.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing frame section property.

## Remarks

The function deletes a specified frame section property.

The function returns zero if the frame section property is successfully deleted; otherwise it returns
a nonzero value. It returns an error if the specified frame section property can not be deleted; for
example, if it is being used by a frame object.

## VBA Example


Sub DeleteFrameProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'set new frame section property
ret = SapModel.PropFrame.SetGeneral("GEN1", "A992Fy50", 24, 14, 100, 80, 80, 4, 1000,
2400, 140, 200, 150, 220, 3, 5, -1, "API example", "Default")

'get frame object names
ret = SapModel.FrameObj.GetNameList(NumberNames, MyName)

'set frame section property
For i = 1 to NumberNames
ret = SapModel.FrameObj.SetSection(MyName(i - 1), "GEN1")
Next i

'delete frame property
ret = SapModel.PropFrame.Delete("FSEC1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also


# GetAngle_1

## Syntax

SapObject.SapModel.PropFrame.GetAngle-1

## VB6 Procedure

Function GetAngle_1(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef tf As Double, ByRef tw As Double,
ByRef FilletRadius As Double, ByRef Color As Long, ByRef Notes As String, ByRef GUID As
String) As Long

## Parameters

Name

The name of an existing frame section property.

FileName

If the section property was imported from a property file; this is the name of that file. If the section
property was not imported; this item is blank.

MatProp

The name of the material property for the section.

t3

The vertical leg depth. [L]

t2

The horizontal leg width. [L]

tf

The horizontal leg thickness. [L]

tw

The vertical leg thickness. [L]

FilletRadius

The fillet radius. [L]

Color

The display color assigned to the section.


Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for an angle-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim tf As Double
Dim tw As Double

Dim FilletRadius As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetAngle_1("ANGLE1", "A992Fy50", 6, 4, 0.5, 0.5, 0.2)


'get frame section property data
ret = SapModel.PropFrame.GetAngle_1("ANGLE1", FileName, MatProp, t3, t2, tf, tw,
FilletRadius, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the GetAngle.

## See Also

SetAngle_1

# GetAutoSelectAluminum

## Syntax

SapObject.SapModel.PropFrame.GetAutoSelectAluminum

## VB6 Procedure

Function GetAutoSelectAluminum(ByVal Name As String, ByVal NumberItems As Long, ByRef
SectName() As String, ByRef AutoStartSection As String, ByRef Notes As String, ByRef GUID
As String) As Long

## Parameters

Name

The name of an existing auto select section list-type frame section property.

NumberItems

The number of frame section properties included in the auto select list.

SectName

This is an array of the names of the frame section properties included in the auto select list.

AutoStartSection


This is Median or the name of a frame section property in the SectName array. It is the starting
section for the auto select list.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a aluminum auto select lists.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetFramePropAutoSelectAluminum()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MyName() As String
Dim NumberItems As Long
Dim SectName() As String
Dim AutoStartSection As String
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'add aluminum material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_ALUMINUM, , ,
MATERIAL_ALUMINUM_SUBTYPE_6061_T6)

'create new aluminum frame section properties
ret = SapModel.PropFrame.SetISection("AI", Name , 18, 6, 0.5, 0.3, 6, 0.5)
ret = SapModel.PropFrame.SetISection("AI2", Name , 18, 6, 0.6, 0.3, 6, 0.6)
ret = SapModel.PropFrame.SetISection("AI3", Name , 18, 6, 0.7, 0.3, 6, 0.7)


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288, True, "AI", "AI")

'define new auto select list frame section property
ReDim MyName(2)
MyName(0) = "AI"
MyName(1) = "AI2"
MyName(2) = "AI3"
ret = SapModel.PropFrame.SetAutoSelectAluminum("AUTO1", 3, MyName)

'get auto select list data
ret = SapModel.PropFrame.GetAutoSelectAluminum("AUTO1", NumberItems, SectName,
AutoStartSection, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetAutoSelectAluminum

# GetAutoSelectColdFormed

## Syntax

SapObject.SapModel.PropFrame.GetAutoSelectColdFormed

## VB6 Procedure

Function GetAutoSelectColdFormed(ByVal Name As String, ByVal NumberItems As Long,
ByRef SectName() As String, ByRef AutoStartSection As String, ByRef Notes As String, ByRef
GUID As String) As Long

## Parameters

Name

The name of an existing auto select section list-type frame section property.

NumberItems


The number of frame section properties included in the auto select list.

SectName

This is an array of the names of the frame section properties included in the auto select list.

AutoStartSection

This is Median or the name of a frame section property in the SectName array. It is the starting
section for the auto select list.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a cold formed auto select lists.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetFramePropAutoSelectColdFormed()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MyName() As String
Dim NumberItems As Long
Dim SectName() As String
Dim AutoStartSection As String
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'add cold formed material


ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'create new cold formed frame section properties
ret = SapModel.PropFrame.SetISection("CI", Name , 18, 6, 0.5, 0.3, 6, 0.5)
ret = SapModel.PropFrame.SetISection("CI2", Name , 18, 6, 0.6, 0.3, 6, 0.6)
ret = SapModel.PropFrame.SetISection("CI3", Name , 18, 6, 0.7, 0.3, 6, 0.7)

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288, True, "CI", "CI")

'define new auto select list frame section property
ReDim MyName(2)
MyName(0) = "CI"
MyName(1) = "CI2"
MyName(2) = "CI3"
ret = SapModel.PropFrame.SetAutoSelectColdFormed("AUTO1", 3, MyName)

'get auto select list data
ret = SapModel.PropFrame.GetAutoSelectColdFormed("AUTO1", NumberItems, SectName,
AutoStartSection, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetAutoSelectColdFormed

# GetAutoSelectSteel

## Syntax

SapObject.SapModel.PropFrame.GetAutoSelectSteel

## VB6 Procedure

Function GetAutoSelectSteel(ByVal Name As String, ByVal NumberItems As Long, ByRef
SectName() As String, ByRef AutoStartSection As String, ByRef Notes As String, ByRef GUID
As String) As Long


## Parameters

Name

The name of an existing auto select section list–type frame section property.

NumberItems

The number of frame section properties included in the auto select list.

SectName

This is an array of the names of the frame section properties included in the auto select list.

AutoStartSection

This is either Median or the name of a frame section property in the SectName array. It is the
starting section for the auto select list.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a steel auto select lists.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetFramePropAutoSelectSteel()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyName() As String
Dim NumberItems As Long
Dim SectName() As String
Dim AutoStartSection As String
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC1", "A992Fy50", 24, 8, 0.5, 0.3, 8, 0.5)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC2", "A992Fy50", 20, 8, 0.5, 0.3, 8, 0.5)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC3", "A992Fy50", 16, 8, 0.5, 0.3, 8, 0.5)

'set new auto select list frame section property
ReDim MyName(2)
MyName(0) = "ISEC1"
MyName(1) = "ISEC2"
MyName(2) = "ISEC3"
ret = SapModel.PropFrame.SetAutoSelectSteel("AUTO1", 3, MyName, "ISEC2")

'get auto select list data
ret = SapModel.PropFrame.GetAutoSelectSteel("AUTO1", NumberItems, SectName,
AutoStartSection, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetAutoSelectSteel

# GetChannel_2

## Syntax

SapObject.SapModel.PropFrame.GetChannel_2


## VB6 Procedure

Function GetChannel_2(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef tf As Double, ByRef tw As Double,
ByRef FilletRadius As Double, ByRef MirrorAbout2 As Boolean, ByRef Color As Long, ByRef
Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The flange width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

FilletRadius

The fillet radius. [L]

MirrorAbout2 (not applicable)

Indicates whether the section is mirrored about the local 2-axis.

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.


### GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a channel-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropChannel()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim tf As Double
Dim tw As Double

```
Dim FilletRadius As Double
```
```
Dim MirrorAbout2 As Boolean
```
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetChannel_2("CHN1", "A992Fy50", 24, 6, 0.5, 0.3, 0.2, False)

'get frame section property data


ret = SapModel.PropFrame.GetChannel_2("CHN1", FileName, MatProp, t3, t2, tf, tw,
FiletRadius, MirrorAbout2, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the GetChannel

## See Also

SetChannel_2

# GetCircle

## Syntax

SapObject.SapModel.PropFrame.GetCircle

## VB6 Procedure

Function GetCircle(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef Color As Long, ByRef Notes As String, ByRef GUID As
String) As Long

## Parameters

Name

The name of an existing circular frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section diameter. [L]

Color


The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a circular frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropCircle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetCircle("C1", "4000Psi", 20)

'get frame section property data
ret = SapModel.PropFrame.GetCircle("C1", FileName, MatProp, t3, Color, Notes, GUID)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetCircle

SetRebarBeam

SetRebarColumn

GetRebarBeam

GetRebarColumn

# GetColdBox

## Syntax

SapObject.SapModel.PropFrame.GetColdBox

## VB6 Procedure

Function GetColdBox(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef Thickness As Double, ByRef Radius As
Double, ByRef Color As Long, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing cold formed box frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.


t3

The section depth. [L]

t2

The section top flange width. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a cold formed box frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropColdBox()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim Thickness As Double
Dim Radius As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdBox("CB1", Name, 10, 3.2, 0.08, 0.3)

'get frame section property data
ret = SapModel.PropFrame.GetColdBox("CB1", FileName, MatProp, t3, Thickness , Radius,
Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 22.2.0.

## See Also

SetColdBox

# GetColdC

## Syntax

SapObject.SapModel.PropFrame.GetColdC


## VB6 Procedure

Function GetColdC(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef Thickness As Double, ByRef Radius As
Double, ByRef LipDepth As Double, ByRef Color As Long, ByRef Notes As String, ByRef
GUID As String) As Long

## Parameters

Name

The name of an existing cold formed C-type frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

LipDepth

The lip depth, if any. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.


## Remarks

This function retrieves frame section property data for a cold formed C-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropColdC()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim Thickness As Double
Dim Radius As Double
Dim LipDepth As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdC("CC1", Name, 10, 3.2, 0.08, 0.3, 0.6)

'get frame section property data
ret = SapModel.PropFrame.GetColdC("CC1", FileName, MatProp, t3, t2, Thickness , Radius,
LipDepth, Color, Notes, GUID)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetColdC

# GetColdHat

## Syntax

SapObject.SapModel.PropFrame.GetColdHat

## VB6 Procedure

Function GetColdHat(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef Thickness As Double, ByRef Radius As
Double, ByRef LipDepth As Double, ByRef Color As Long, ByRef Notes As String, ByRef
GUID As String) As Long

## Parameters

Name

The name of an existing cold formed hat-type frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]


Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

LipDepth

The lip depth, if any. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a cold formed hat-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropColdHat()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim Thickness As Double
Dim Radius As Double
Dim LipDepth As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdHat("CH1", Name, 10, 3.2, 0.08, 0.3, 0.6)

'get frame section property data
ret = SapModel.PropFrame.GetColdHat("CH1", FileName, MatProp, t3, t2, Thickness ,
Radius, LipDepth, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetColdHat

# GetColdI

## Syntax

SapObject.SapModel.PropFrame.GetColdI

## VB6 Procedure

Function GetColdI(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef t2b As Double, ByRef Thickness As
Double, ByRef Radius As Double, ByRef Color As Long, ByRef Notes As String, ByRef GUID
As String) As Long


## Parameters

Name

The name of an existing cold formed I-shape frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section top flange width. [L]

t2b

The section bottom flange width. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a cold formed I-shape frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.


## VBA Example

Sub GetFramePropColdI()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double

Dim t2b As Double
Dim Thickness As Double
Dim Radius As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdI("CI1", Name, 10, 3.2, 2.5, 0.08, 0.3)

'get frame section property data
ret = SapModel.PropFrame.GetColdI("CI1", FileName, MatProp, t3, t2, t2b, Thickness ,
Radius, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 22.2.0.

## See Also

SetColdI

# GetColdL

## Syntax

SapObject.SapModel.PropFrame.GetColdL

## VB6 Procedure

Function GetColdL(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef Thickness As Double, ByRef Radius As Double, ByRef
LipDepth As Double, ByRef Color As Long, ByRef Notes As String, ByRef GUID As String) As
Long

## Parameters

Name

The name of an existing cold formed Angle frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]


LipDepth

The lip depth, if any. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a cold formed Angle frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropColdL()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim Thickness As Double
Dim Radius As Double
Dim LipDepth As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdL("CL1", Name, 4.0, 0.08, 0.3, 0.6)

'get frame section property data
ret = SapModel.PropFrame.GetColdL("CL1", FileName, MatProp, t3, Thickness , Radius,
LipDepth, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 22.2.0.

## See Also

SetColdL

# GetColdPipe

## Syntax

SapObject.SapModel.PropFrame.GetColdPipe

## VB6 Procedure

Function GetColdPipe(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef Thickness As Double, ByRef Color As Long, ByRef Notes As
String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing cold formed pipe frame section property.


FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

Thickness

The section thickness. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a cold formed pipe frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropColdPipe()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim Thickness As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdPipe("CP1", Name, 8.0, 0.08)

'get frame section property data
ret = SapModel.PropFrame.GetColdPipe("CP1", FileName, MatProp, t3, Thickness, Color,
Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 22.2.0.

## See Also

SetColdPipe

# GetColdT

## Syntax

SapObject.SapModel.PropFrame.GetColdT


## VB6 Procedure

Function GetColdT(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef Thickness As Double, ByRef Radius As
Double, ByRef Color As Long, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing cold formed Tee frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section top flange width. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a cold formed Tee frame section.


The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropColdT()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim Thickness As Double
Dim Radius As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdT("CT1", Name, 10, 3.2, 2.5, 0.08, 0.3)

'get frame section property data
ret = SapModel.PropFrame.GetColdT("CT1", FileName, MatProp, t3, t2, Thickness , Radius,
Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 22.2.0.

## See Also

SetColdT

# GetColdZ

## Syntax

SapObject.SapModel.PropFrame.GetColdZ

## VB6 Procedure

Function GetColdZ(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef Thickness As Double, ByRef Radius As
Double, ByRef LipDepth As Double, ByRef LipAngle As Double, ByRef Color As Long, ByRef
Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing cold formed Z-type frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]

Thickness

The section thickness. [L]


Radius

The corner radius, if any. [L]

LipDepth

The lip depth, if any. [L]

LipAngle

The lip angle measured from horizontal (0 <= LipAngle <= 90). [deg]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a cold formed Z-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropColdZ()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim Thickness As Double
Dim Radius As Double
Dim LipDepth As Double
Dim LipAngle As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdZ("CZ1", Name, 10, 3.2, 0.08, 0.3, 0.6, 60)

'get frame section property data
ret = SapModel.PropFrame.GetColdZ("CZ1", FileName, MatProp, t3, t2, Thickness , Radius,
LipDepth, LipAngle, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetColdZ

# GetCoverPlatedI

## Syntax

SapObject.SapModel.PropFrame.GetCoverPlatedI

## VB6 Procedure

Function GetCoverPlatedI(ByVal Name As String, ByRef SectName As String, ByRef
FyTopFlange As Double, ByRef FyWeb As Double, ByRef FyBotFlange As Double, ByRef tc As
Double, ByRef bc As Double, ByRef MatPropTop As String, ByRef tcb As Double, ByRef bcb


As Double, ByRef MatPropBot As String, ByRef Color As Long, ByRef Notes As String, ByRef
GUID As String) As Long

## Parameters

Name

The name of an existing frame section property.

SectName

The name of an existing I-type frame section property that is used for the I-section portion of the
coverplated I section.

FyTopFlange

The yield strength of the top flange of the I-section. [F/L^2 ]

If this item is 0, the yield strength of the I-section specified by the SectName item is used.

FyWeb

The yield strength of the web of the I-section. [F/L^2 ]

If this item is 0, the yield strength of the I-section specified by the SectName item is used.

FyBotFlange

The yield strength of the bottom flange of the I-section. [F/L^2 ]

If this item is 0, the yield strength of the I-section specified by the SectName item is used.

tc

The thickness of the top cover plate. [L]

If the tc or the bc item is less than or equal to 0, no top cover plate exists.

bc

The width of the top cover plate. [L]

If the tc or the bc item is less than or equal to 0, no top cover plate exists.

MatPropTop

The name of the material property for the top cover plate.

This item applies only if both the tc and the bc items are greater than 0.

tcb

The thickness of the bottom cover plate. [L]

If the tcb or the bcb item is less than or equal to 0, no bottom cover plate exists.


bcb

The width of the bottom cover plate. [L]

If the tcb or the bcb item is less than or equal to 0, no bottom cover plate exists.

MatPropBot

The name of the material property for the bottom cover plate.

This item applies only if both the tcb and the bcb items are greater than 0.

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a tube-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropCoverPlatedI()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim SectName As String
Dim FyTopFlange As Double
Dim FyWeb As Double
Dim FyBotFlange As Double
Dim tc As Double
Dim bc As Double
Dim MatPropTop As String
Dim tcb As Double
Dim bcb As Double
Dim MatPropBot As String
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC", "A992Fy50", 24, 8, 0.5, 0.3, 8, 0.5)

'set new cover plated I-type frame section property
ret = SapModel.PropFrame.SetCoverPlatedI("CPI1", "ISEC", 0, 36, 0, 0.75, 14, "A992Fy50",
0.5, 6, "A992Fy50")

'get frame section property data for cover plated I
ret = SapModel.PropFrame.GetCoverPlatedI("CPI1", SectName, FyTopFlange, FyWeb,
FyBotFlange, tc, bc, MatPropTop, tcb, bcb, MatPropBot, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetCoverPlatedI

# GetDblAngle_2

## Syntax

SapObject.SapModel.PropFrame.GetDblAngle_2

## VB6 Procedure

Function GetDblAngle_2(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef tf As Double, ByRef tw As Double,


ByRef dis As Double, ByRef FilletRadius As Double, ByRef MirrorAbout3 As Boolean, ByRef
Color As Long, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The vertical leg depth. [L]

t2

The total width of the section, that is, the sum of the widths of each horizontal leg plus the back-to
-back distance. [L]

tf

The horizontal leg thickness. [L]

tw

The vertical leg thickness. [L]

dis

The back-to-back distance between the angles. [L]

FilletRadius

The fillet radius. [L]

MirrorAbout3 (not applicable)

Indicates whether the section is mirrored about the local 3-axis.

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.


### GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a double angle-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropDblAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim tf As Double
Dim tw As Double
Dim dis As Double

```
Dim FilletRadius As Double
```
```
Dim MirrorAbout3 As Boolean
```
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetDblAngle_2("DBANG1", "A992Fy50", 6, 9, 0.5, 0.5, 1, 0.2,
False)


'get frame section property data
ret = SapModel.PropFrame.GetDblAngle_2("DBANG1", FileName, MatProp, t3, t2, tf, tw,
dis, FilletRadius, MirrorAbout3, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the GetDblAngle.

## See Also

SetDblAngle_2

# GetDblChannel_1

## Syntax

SapObject.SapModel.PropFrame.GetDblChannel_1

## VB6 Procedure

Function GetDblChannel_1(ByVal Name As String, ByRef FileName As String, ByRef MatProp
As String, ByRef t3 As Double, ByRef t2 As Double, ByRef tf As Double, ByRef tw As Double,
ByRef dis As Double, ByRef FilletRadius As Double, ByRef Color As Long, ByRef Notes As
String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3


The section depth. [L]

t2

The total width of the section, that is, the sum of the widths of each flange plus the back-to-back
distance. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

dis

The back-to-back distance between the channels. [L]

FilletRadius

The fillet radius. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a double channel-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropDblChannel()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim tf As Double


Dim tw As Double
Dim dis As Double

Dim FilletRadius As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetDblChannel_1("DBCHN1", "A992Fy50", 12, 6.5, 0.5, 0.3, 0.5,
0.2)

'get frame section property data
ret = SapModel.PropFrame.GetDblChannel_1("DBCHN1", FileName, MatProp, t3, t2, tf, tw,
dis, FilletRadius, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the GetDblChannel.

## See Also

SetDblChannel_1

# GetGeneral

## Syntax

SapObject.SapModel.PropFrame.GetGeneral


## VB6 Procedure

Function GetGeneral(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef Area As Double, ByRef As2 As Double,
ByRef As3 As Double, ByRef Torsion As Double, ByRef I22 As Double, ByRef I33 As Double,
ByRef S22 As Double, ByRef S33 As Double, ByRef Z22 As Double, ByRef Z33 As Double,
ByRef R22 As Double, ByRef R33 As Double, ByRef Color As Long, ByRef Notes As String,
ByRef GUID As String) As Long

## Parameters

Name

The name of an existing frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]

Area

The cross-sectional area. [L^2 ]

As2

The shear area for forces in the section local 2-axis direction. [L^2 ]

As3

The shear area for forces in the section local 3-axis direction. [L^2 ]

Torsion

The torsional constant. [L^4 ]

I22

The moment of inertia for bending about the local 2 axis. [L^4 ]

I33


The moment of inertia for bending about the local 3 axis. [L^4 ]

S22

The section modulus for bending about the local 2 axis. [L^3 ]

S33

The section modulus for bending about the local 3 axis. [L^3 ]

Z22

The plastic modulus for bending about the local 2 axis. [L^3 ]

Z33

The plastic modulus for bending about the local 3 axis. [L^3 ]

R22

The radius of gyration about the local 2 axis. [L]

R33

The radius of gyration about the local 3 axis. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a general frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropGeneral()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String


Dim t3 As Double
Dim t2 As Double
Dim Area As Double
Dim as2 As Double
Dim as3 As Double
Dim Torsion As Double
Dim I22 As Double
Dim I33 As Double
Dim S22 As Double
Dim S33 As Double
Dim Z22 As Double
Dim Z33 As Double
Dim R22 As Double
Dim R33 As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetGeneral("GEN1", "A992Fy50", 24, 14, 100, 80, 80, 4, 1000,
2400, 140, 200, 150, 220, 3, 5, -1, "API example", "Default")

'get frame section property data
ret = SapModel.PropFrame.GetGeneral("GEN1", FileName, MatProp, t3, t2, Area, As2, As3,
Torsion, I22, I33, S22, S33, Z22, Z33, R22, R33, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

SetGeneral

# GetHybridISection

## Syntax

SapObject.SapModel.PropFrame.GetHybridISection

## VB6 Procedure

Function GetHybridISection(ByVal name As String, ByRef MatPropTopFlange As String, ByRef
MatPropWeb As String, ByRef MatPropBotFlange As String, ByRef t3 As Double, ByRef t2 As
Double, ByRef TF As Double, ByRef TW As Double, ByRef t2b As Double, ByRef tfb As
Double,

ByRef color As Long, ByRef notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing frame section property.

MatPropTopFlange

The name of the material property for the top flange.

MatPropWeb

The name of the material property for the web.

MatPropBotFlange

The name of the material property for the bottom flange.

t3

The height of the section. [L]

t2

The width of the top flange. [L]

TF

The thickness of the top flange. [L]

TW


The thickness of the web. [L]

t2b

The width of the bottom flange. [L]

tfb

The thickness of the bottom flange. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a steel hybrid I frame section.

The function returns zero if the section property data is successfully retrieved, otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropHybridISection()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatPropTopFlange As String
Dim MatPropWeb As String
Dim MatPropBotFlange As String
Dim t3 As Double
Dim t2 As Double
Dim TF As Double
Dim TW As Double
Dim t2b As Double
Dim tfb As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new Hybrid I-type frame section property
ret = SapModel.PropFrame.SetHybridISection("HybridI", "A992Fy50", "A992Fy50",
"A992Fy50", 24, 8, 0.5, 0.3, 8, 0.5)

'get frame section property data for cover plated I
ret = SapModel.PropFrame.GetHybridISection("HybridI", MatPropTopFlange, MatPropWeb,
MatPropBotFlange, t3, t2, TF, TW, t2b, tfb, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.0.0.

## See Also

# GetHybridUSection

## Syntax

SapObject.SapModel.PropFrame.GetHybridUSection

## VB6 Procedure

Function GetHybridUSection(ByVal name As String, ByRef WebMaterial As String, ByRef
TopFlangeMaterial As String, ByRef BotFlangeMaterial As String, ByRef T() As Double, ByRef
color As Long, ByRef notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing frame section property.


WebMaterial

The name of the material property for the webs.

TopFlangeMaterial

The name of the material property for the top flanges.

BotFlangeMaterial

The name of the material property for the bottom flange.

T()

The dimension array of the section:

(0) D1 = Web Depth (vertical, inside to inside of flanges). [L]

(1) B1 = Web Distance at Top (CL to CL). [L]

(2) B2 = Bottom Flange Width. [L]

(3) B3 = Top Flange Width (per each). [L]

(4) B4 = Bottom Flange Lip (Web CL to flange edge, may be zero). [L]

(5) tw = Web Thickness. [L]

(6) tf = Top Flange Thickness. [L]

(7) tfb = Bottom Flange Thickness. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a steel hybrid U frame section.

The function returns zero if the section property data is successfully retrieved, otherwise it returns
a nonzero value.


## VBA Example

Sub GetFramePropHybridUSection()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim WebMaterial As String
Dim TopFlangeMaterial As String
Dim BotFlangeMaterial As String
Dim T() As Double
Dim MyT() As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new Hybrid U-type frame section property
Redim T(7)
T(0) = 48
T(1) = 64
T(2) = 48
T(3) = 15
T(4) = 1.5
T(5) = 1
T(6) = 2
T(7) = 2
ret = SapModel.PropFrame.SetHybridUSection("HybridU", "A992Fy50", "A992Fy50",
"A992Fy50", T())

'get frame section property data for cover plated I
ret = SapModel.PropFrame.GetHybridUSection("HybridI", WebMaterial, TopFlangeMaterial,
BotFlangeMaterial, MyT(), Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.0.0.

## See Also

# GetISection_1

## Syntax

SapObject.SapModel.PropFrame.GetISection_1

## VB6 Procedure

Function GetISection_1(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef tf As Double, ByRef tw As Double,
ByRef t2b As Double, ByRef tfb As Double, ByRef FilletRadius As Double, ByRef Color As
Long, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing I-type frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The top flange width. [L]

tf

The top flange thickness. [L]

tw


The web thickness. [L]

t2b

The bottom flange width. [L]

tfb

The bottom flange thickness. [L]

FilletRadius

The fillet radius. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for an I-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropISection()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim tf As Double
Dim tw As Double
Dim t2b As Double
Dim tfb As Double

```
Dim FilletRadius As Double
```
Dim Color As Long
Dim Notes As String


Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get frame section property data
ret = SapModel.PropFrame.GetISection_1("FSEC1", FileName, MatProp, t3, t2, tf, tw, t2b,
tfb, FilletRadius, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the GetISection.

## See Also

SetISection_1

# GetModifiers

## Syntax

SapObject.SapModel.PropFrame.GetModifiers

## VB6 Procedure

Function GetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name


The name of an existing frame section property.

Value

This is an array of eight unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Shear area in local 2 direction modifier
Value(2) = Shear area in local 3 direction modifier
Value(3) = Torsional constant modifier
Value(4) = Moment of inertia about local 2 axis modifier
Value(5) = Moment of inertia about local 3 axis modifier
Value(6) = Mass modifier
Value(7) = Weight modifier
```
## Remarks

This function retrieves the modifier assignments for a frame section property. The default value
for all modifiers is one.

The function returns zero if the modifier assignments are successfully retrieved; otherwise it
returns a nonzero value.

## VBA Example

Sub GetFramePropModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign modifiers
ReDim Value(7)
For i = 0 To 7
Value(i) = 1


Next i
Value(5) = 100
ret = SapModel.PropFrame.SetModifiers("FSEC1", Value)

'get modifiers
ReDim Value(7)
ret = SapModel.PropFrame.GetModifiers("FSEC1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetModifiers

# GetNameInPropFile

## Syntax

SapObject.SapModel.PropFrame.GetNameInPropFile

## VB6 Procedure

Function GetNameInPropFile(ByVal Name As String, ByRef NameInFile As String, ByRef
FileName As String, ByRef MatProp As String, ByRef PropType As eFramePropType) As Long

## Parameters

Name

The name of an existing frame section property.

NameInFile

The name of the specified frame section property in the frame section property file.

FileName

The name of the frame section property file from which the specified frame section property was
obtained.

MatProp


The name of the material property for the section.

PropType

This is one of the following items in the eFramePropType enumeration.

```
SECTION_I = 1
```
```
SECTION_CHANNEL = 2
```
```
SECTION_T = 3
```
```
SECTION_ANGLE = 4
```
```
SECTION_DBLANGLE = 5
```
```
SECTION_BOX = 6
```
```
SECTION_PIPE = 7
```
```
SECTION_RECTANGULAR = 8
```
```
SECTION_CIRCLE = 9
```
```
SECTION_GENERAL = 10
```
```
SECTION_DBCHANNEL = 11
```
```
SECTION_AUTO = 12
```
```
SECTION_SD = 13
```
```
SECTION_VARIABLE = 14
```
```
SECTION_JOIST = 15
```
```
SECTION_BRIDGE = 16
```
```
SECTION_COLD_C = 17
```
```
SECTION_COLD_2C = 18
```
```
SECTION_COLD_Z = 19
```
```
SECTION_COLD_L = 20
```
```
SECTION_COLD_2L = 21
```
```
SECTION_COLD_HAT = 22
```
```
SECTION_BUILTUP_I_COVERPLATE = 23
```
```
SECTION_PCC_GIRDER_I = 24
```
```
SECTION_PCC_GIRDER_U = 25
```

## Remarks

This function retrieves the names of the section property file from which an imported frame
section originated, and it also retrieves the section name used in the property file.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

If the specified frame section property was not imported, blank strings are returned for
NameInFile and FileName.

## VBA Example

Sub GetFramePropNameInFile()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NameInFile As String
Dim FileName As String
Dim MatProp As String
Dim PropType As eFramePropType

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'import new frame section property
ret = SapModel.PropFrame.ImportProp("MyFrame", "A992Fy50", "Sections8.pro",
"W18X35")

'get frame property name in file
ret = SapModel.PropFrame.GetNameInPropFile("MyFrame", NameInFile, FileName,
MatProp, PropType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.03.

## See Also

# GetNameList

## Syntax

SapObject.SapModel.PropFrame.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String, Optional
ByVal PropType As eFramePropType) As Long

## Parameters

NumberNames

The number of frame section property names retrieved by the program.

MyName

This is a one-dimensional array of frame section property names. The MyName array is created as
a dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

PropType

This optional value is one of the following items in the eFramePropType enumeration.

```
SECTION_I = 1
SECTION_CHANNEL = 2
SECTION_T = 3
SECTION_ANGLE = 4
SECTION_DBLANGLE = 5
SECTION_BOX = 6
SECTION_PIPE = 7
SECTION_RECTANGULAR = 8
SECTION_CIRCLE = 9
SECTION_GENERAL = 10
SECTION_DBCHANNEL = 11
SECTION_AUTO = 12
```

### SECTION_SD = 13

### SECTION_VARIABLE = 14

### SECTION_JOIST = 15

### SECTION_BRIDGE = 16

### SECTION_COLD_C = 17

### SECTION_COLD_2C = 18

### SECTION_COLD_Z = 19

### SECTION_COLD_L = 20

### SECTION_COLD_2L = 21

### SECTION_COLD_HAT = 22

### SECTION_BUILTUP_I_COVERPLATE = 23

### SECTION_PCC_GIRDER_I = 24

### SECTION_PCC_GIRDER_U = 25

### SECTION_BUILTUP_I_HYBRID = 26

### SECTION_BUILTUP_U_HYBRID = 27

If no value is input for PropType, names are returned for all frame section properties in the model
regardless of type.

## Remarks

This function retrieves the names of all defined frame section properties of the specified type.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetFramePropNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get frame section property names


ret = SapModel.PropFrame.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Builtup I Hybrid and Builitup U Hybrid added with Version 15.0.0.

## See Also

# GetNonPrismatic

## Syntax

SapObject.SapModel.PropFrame.GetNonPrismatic

## VB6 Procedure

Function GetNonPrismatic(ByVal Name As String, ByRef NumberItems As Long, ByRef
StartSec() As String, ByRef EndSec() As String, ByRef MyLength() As Double, ByRef MyType()
As Long, ByRef EI33() As Long, ByRef EI22() As Long, ByRef Color As Long, ByRef Notes As
String, ByRef GUID As String) As Long

## Parameters

NumberItems

The number of segments assigned to the nonprismatic section.

StartSec

This is an array of the names of the frame section properties at the start of each segment.

EndSec

This is an array of the names of the frame section properties at the end of each segment.

MyLength

This is an array that includes the length of each segment. The length may be variable or absolute
as indicated by the MyType item. [L] when length is absolute

MyType


This is an array of either 1 or 2, indicating the length type for each segment.

```
1 = Variable (relative length)
2 = Absolute
```
EI33, EI22

This is an array of either 1, 2 or 3, indicating the variation type for EI33 and EI22 in each
segment.

```
1 = Linear
2 = Parabolic
3 = Cubic
```
Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for nonprismatic (variable) sections.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetFramePropNonPrismatic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim StartSec() As String
Dim EndSec() As String
Dim MyLength() As Double
Dim MyType() As Long
Dim EI33() As Long
Dim EI22() As Long
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC1", "A992Fy50", 24, 8, 0.5, 0.3, 8, 0.5)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC2", "A992Fy50", 20, 8, 0.5, 0.3, 8, 0.5)

'set new nonprismatic frame section property
ReDim StartSec(2)
ReDim EndSec(2)
ReDim MyLength(2)
ReDim MyType(2)
ReDim EI33(2)
ReDim EI22(2)
StartSec(0) = "ISEC2"
EndSec(0) = "ISEC1"
MyLength(0) = 60
MyType(0) = 2
EI33(0)= 2
EI22(0)= 1

StartSec(1) = "ISEC1"
EndSec(1) = "ISEC1"
MyLength(1) = 1
MyType(1) = 1
EI33(1)= 2
EI22(1)= 1

StartSec(2) = "ISEC1"
EndSec(2) = "ISEC2"
MyLength(2) = 60
MyType(2) = 2
EI33(2)= 2
EI22(2)= 1

ret = SapModel.PropFrame.SetNonPrismatic("NP1", 3, StartSec, EndSec, MyLength,
MyType, EI33, EI22)

'clear arrays
ReDim StartSec(0)
ReDim EndSec(0)
ReDim MyLength(0)


ReDim MyType(0)
ReDim EI33(0)
ReDim EI22(0)

'get nonprismatic section data
ret = SapModel.PropFrame.GetNonPrismatic("NP1", NumberItems, StartSec, EndSec,
MyLength, MyType, EI33, EI22, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetNonPrismatic

# GetPipe

## Syntax

SapObject.SapModel.PropFrame.GetPipe

## VB6 Procedure

Function GetPipe(ByVal Name As String, ByRef FileName As String, ByRef MatProp As String,
ByRef t3 As Double, ByRef tw As Double, ByRef Color As Long, ByRef Notes As String, ByRef
GUID As String) As Long

## Parameters

Name

The name of an existing frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.


t3

The outside diameter. [L]

tw

The wall thickness. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a pipe-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropPipe()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim tw As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetPipe("PIPE1", "A992Fy50", 8, 0.375)

'get frame section property data
ret = SapModel.PropFrame.GetPipe("PIPE1", FileName, MatProp, t3, tw, Color, Notes,
GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetPipe

# GetPrecastI_1

## Syntax

SapObject.SapModel.PropFrame.GetPrecastI_1

## VB6 Procedure

Function GetPrecastI_1(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef b() As Double, ByRef d() As Double, ByRef t() As Double, ByRef c As Double,
ByRef Color As Long, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing precast concrete I girder frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp


The name of the material property for the section.

b

This is an array, dimensioned to 3, containing the horizontal section dimensions. [L]

```
b(0) = B1 (> 0)
b(1) = B2 (> 0)
b(2) = B3 (>= 0)
b(3) = B4 (>= 0)
```
Section dimensions B1 through B4 are defined on the precast concrete I girder definition form.

d

This is an array, dimensioned to 6, containing the vertical section dimensions. [L]

```
d(0) = D1 (> 0)
d(1) = D2 (> 0)
d(2) = D3 (>= 0)
d(3) = D4 (>= 0)
d(4) = D5 (> 0)
d(5) = D6 (>= 0)
d(6) = D7 (>=0)
```
Section dimensions D1 through D7 are defined on the precast concrete I girder definition form.

t

This is an array, dimensioned to 1, containing the web thickness dimensions. [L]

```
T(0) = T1 (> 0)
```
```
T(1) = T2 (> 0)
```
Section dimensions T1 and T2 are defined on the precast I girder definition form.

c

The bottom flange chamfer dimension, denoted as C1 on the precast concrete I girder definition
form.

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.


## Remarks

This function retrieves frame section property data for a precast concrete I girder frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropPrecastI_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim bb() As Double
Dim dd() As Double

Dim tt() As Double
Dim b() As Double
Dim d() As Double

Dim t() As Double

Dim cc As Double

Dim c As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ReDim bb(3)
ReDim dd(6)


ReDim tt(1)
bb(0) = 12
bb(1) = 16
bb(2) = 0
bb(3) = 0
dd(0) = 28
dd(1) = 4
dd(2) = 3
dd(3) = 0
dd(4) = 5
dd(5) = 5

dd(6) = 0

tt(0) = 6

tt(1) = 6

cc = 0
ret = SapModel.PropFrame.SetPrecastI_1("PC1", "4000Psi", bb, dd, tt, cc)

'get frame section property data
ret = SapModel.PropFrame.GetPrecastI_1("PC1", FileName, MatProp, b, d, t, c, Color, Notes,
GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.

This function supersedes GetPrecast1.

## See Also

SetPrecastI_1

# GetPrecastU

## Syntax

SapObject.SapModel.PropFrame.GetPrecastU

## VB6 Procedure


Function GetPrecastU(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef b() As Double, ByRef d() As Double, ByRef Color As Long, ByRef Notes As
String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing precast concrete U girder frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

b

This is an array, dimensioned to 5, containing the horizontal section dimensions. [L]

```
b(0) = B1 (> 0)
b(1) = B2 (> 0)
b(2) = B3 (> 0)
b(3) = B4 (>= 0)
b(4) = B5 (>= 0)
b(5) = B6 (>= 0)
```
Section dimensions B1 through B6 are defined on the precast concrete U girder definition form.

d

This is an array, dimensioned to 6, containing the vertical section dimensions. [L]

```
d(0) = D1 (> 0)
d(1) = D2 (> 0)
d(2) = D3 (>= 0)
d(3) = D4 (>= 0)
d(4) = D5 (>= 0)
d(5) = D6 (>= 0)
d(6) = D7 (>= 0)
```
Section dimensions D1 through D7 are defined on the precast concrete U girder definition form.

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.


### GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a precast concrete U girder frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropPrecastU()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim bb() As Double
Dim dd() As Double
Dim b() As Double
Dim d() As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set present units to kN-mm
ret = SapModel.SetPresentUnits(kN_mm_C)

'set new frame section property
ReDim bb(5)
ReDim dd(6)
bb(0) = 2350
bb(1) = 1500
bb(2) = 200


bb(3) = 75
bb(4) = 143.8447
bb(5) = 0
dd(0) = 1700
dd(1) = 175
dd(2) = 75
dd(3) = 0
dd(4) = 0
dd(5) = 125
dd(6) = 175
ret = SapModel.PropFrame.SetPrecastU("PC1", "4000Psi", bb, dd)

'get frame section property data
ret = SapModel.PropFrame.GetPrecastU("PC1", FileName, MatProp, b, d, Color, Notes,
GUID)

'set present units to kip-in
ret = SapModel.SetPresentUnits(kip_in_F)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetPrecastU

# GetPropFileNameList

## Syntax

SapObject.SapModel.PropFrame.GetPropFileNameList

## VB6 Procedure

Function GetPropFileNameList(ByVal FileName As String, ByRef NumberNames As Long,
ByRef MyName() As String, ByRef MyPropType() As eFramePropType, Optional ByVal
PropType As eFramePropType) As Long

## Parameters

FileName


The name of the frame section property file from which to get the name list.

In most cases, inputting only the name of the property file (e.g. Sections8.pro) is required, and the
program will be able to find it. In some cases, inputting the full path to the property file may be
necessary.

NumberNames

The number of frame section property names retrieved by the program.

MyName

This is an array the includes the property names obtained from the frame section property file.

MyType

This is an array the includes the property type for each property obtained from the frame section
property file. See the PropType item below for a list of the possible property types.

PropType

This optional value is one of the following items in the eFramePropType enumeration.

```
SECTION_I = 1
SECTION_CHANNEL = 2
SECTION_T = 3
SECTION_ANGLE = 4
SECTION_DBLANGLE = 5
SECTION_BOX = 6
SECTION_PIPE = 7
SECTION_RECTANGULAR = 8
SECTION_CIRCLE = 9
SECTION_GENERAL = 10
SECTION_DBCHANNEL = 11
SECTION_AUTO = 12
SECTION_SD = 13
SECTION_VARIABLE = 14
SECTION_JOIST = 15
SECTION_BRIDGE = 16
SECTION_COLD_C = 17
SECTION_COLD_2C = 18
SECTION_COLD_Z = 19
SECTION_COLD_L = 20
SECTION_COLD_2L = 21
SECTION_COLD_HAT = 22
SECTION_BUILTUP_I_COVERPLATE = 23
SECTION_PCC_GIRDER_I = 24
SECTION_PCC_GIRDER_U = 25
SECTION_BUILTUP_I_HYBRID = 26
SECTION_BUILTUP_U_HYBRID = 27
```
If no value is input for PropType, names are returned for all frame section properties in the
specified file regardless of type.


## Remarks

This function retrieves the names of all defined frame section properties of a specified type in a
specified frame section property file.

The function returns zero if the names are successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example

Sub GetFramePropNamesFromFile()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String
Dim MyType() As eFramePropType

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get frame section property names
ret = SapModel.PropFrame.GetPropFileNameList("Sections8.pro", NumberNames, MyName,
MyType, SECTION_I)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.03.

Builtup I Hybrid and Builitup U Hybrid added with Version 15.0.0.


## See Also

ImportProp

# GetRebarBeam

## Syntax

SapObject.SapModel.PropFrame.GetRebarBeam

## VB6 Procedure

Function GetRebarBeam(ByVal Name As String, ByRef MatPropLong As String, ByRef
MatPropConfine As String, ByRef CoverTop As Double, ByRef CoverBot As Double, ByRef
TopLeftArea As Double, ByRef TopRightArea As Double, ByRef BotLeftArea As Double, ByRef
BotRightArea As Double) As Long

## Parameters

Name

The name of an existing frame section property.

MatPropLong

The name of the rebar material property for the longitudinal rebar.

MatPropConfine

The name of the rebar material property for the confinement rebar.

CoverTop

The distance from the top of the beam to the centroid of the top longitudinal reinforcement. [L]

CoverBot

The distance from the bottom of the beam to the centroid of the bottom longitudinal
reinforcement. [L]

TopLeftArea

The total area of longitudinal reinforcement at the top left end of the beam. [L^2 ]

TopRightArea

The total area of longitudinal reinforcement at the top right end of the beam. [L^2 ]

BotLeftArea

The total area of longitudinal reinforcement at the bottom left end of the beam. [L^2 ]


BotRightArea

The total area of longitudinal reinforcement at the bottom right end of the beam. [L^2 ]

## Remarks

This function retrieves beam rebar data for frame sections.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

This function applies only to the following section types. Calling this function for any other type
of frame section property returns an error.

```
SECTION_T = 3
SECTION_ANGLE = 4
SECTION_RECTANGULAR = 8
SECTION_CIRCLE = 9
```
The material assigned to the specified frame section property must be concrete or this function
returns an error.

## VBA Example

Sub GetBeamRebar()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim RebarName As String
Dim MatPropLong As String
Dim MatPropConfine As String
Dim CoverTop As Double
Dim CoverBot As Double
Dim TopLeftArea As Double
Dim TopRightArea As Double
Dim BotLeftArea As Double
Dim BotRightArea As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'set new frame section property
ret = SapModel.PropFrame.SetRectangle("R1", "4000Psi", 20, 12)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(RebarName, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'set beam rebar data
ret = SapModel.PropFrame.SetRebarBeam("R1", RebarName, RebarName, 3.5, 3, 4.1, 4.2,
4.3, 4.4)

'get beam rebar data
ret = SapModel.PropFrame.GetRebarBeam("R1", MatPropLong, MatPropConfine, CoverTop,
CoverBot, TopLeftArea, TopRightArea, BotLeftArea, BotRightArea)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetRebarBeam

# GetRebarColumn

## Syntax

SapObject.SapModel.PropFrame.GetRebarColumn

## VB6 Procedure

Function GetRebarColumn(ByVal Name As String, ByRef MatPropLong As String, ByRef
MatPropConfine As String, ByRef Pattern As Long, ByRef ConfineType As Long, ByRef Cover
As Double, ByRef NumberCBars As Long, ByRef NumberR3Bars As Long, ByRef
NumberR2Bars As Long, ByRef RebarSize As String, ByRef TieSize As String, ByRef
TieSpacingLongit As Double, ByRef Number2DirTieBars As Long, ByRef Number3DirTieBars
As Long, ByRef ToBeDesigned As Boolean) As Long

## Parameters

Name


The name of an existing frame section property.

MatPropLong

The name of the rebar material property for the longitudinal rebar.

MatPropConfine

The name of the rebar material property for the confinement rebar.

Pattern

This is either 1 or 2, indicating the rebar configuration.

```
1 = Rectangular
2 = Circular
```
For circular frame section properties, this item must be 2; otherwise an error is returned.

ConfineType

This is either 1 or 2, indicating the confinement bar type.

```
1 = Ties
2 = Spiral
```
This item applies only when Pattern = 2. If Pattern = 1, the confinement bar type is assumed to be
ties.

Cover

The clear cover for the confinement steel (ties). In the special case of circular reinforcement in a
rectangular column, this is the minimum clear cover. [L]

NumberCBars

This item applies to a circular rebar configuration, Pattern = 2. It is the total number of
longitudinal reinforcing bars in the column.

NumberR3Bars

This item applies to a rectangular rebar configuration, Pattern = 1. It is the number of longitudinal
bars (including the corner bar) on each face of the column that is parallel to the local 3-axis of the
column.

NumberR2Bars

This item applies to a rectangular rebar configuration, Pattern = 1. It is the number of longitudinal
bars (including the corner bar) on each face of the column that is parallel to the local 2-axis of the
column.

RebarSize

The rebar name for the longitudinal rebar in the column.

TieSize


The rebar name for the confinement rebar in the column.

TieSpacingLongit

The longitudinal spacing of the confinement bars (ties). [L]

Number2DirTieBars

This item applies to a rectangular reinforcing configuration, Pattern = 1. It is the number of
confinement bars (tie legs) extending in the local 2-axis direction of the column.

Number3DirTieBars

This item applies to a rectangular reinforcing configuration, Pattern = 1. It is the number of
confinement bars (tie legs) extending in the local 3-axis direction of the column.

ToBeDesigned

If this item is True, the column longitudinal rebar is to be designed; otherwise it is to be checked.

## Remarks

This function retrieves column rebar data for frame sections.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

This function applies only to the following section types. Calling this function for any other type
of frame section property returns an error.

```
SECTION_RECTANGULAR = 8
SECTION_CIRCLE = 9
```
The material assigned to the specified frame section property must be concrete or else this
function returns an error.

## VBA Example

Sub GetColumnRebar()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim RebarName As String
Dim MatPropLong As String
Dim MatPropConfine As String
Dim Pattern As Long
Dim ConfineType As Long
Dim Cover As Double
Dim NumberCBars As Long
Dim NumberR3Bars As Long
Dim NumberR2Bars As Long
Dim RebarSize As String
Dim TieSize As String


Dim TieSpacingLongit As Double
Dim Number2DirTieBars As Long
Dim Number3DirTieBars As Long
Dim ToBeDesigned As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetRectangle("R1", "4000Psi", 20, 12)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(RebarName, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'set column rebar data
ret = SapModel.PropFrame.SetRebarColumn("R1", RebarName, RebarName, 2, 2, 2, 10, 0, 0,
"#10", "#5", 4, 0, 0, False)

'get column rebar data
ret = SapModel.PropFrame.GetRebarColumn("R1", MatPropLong, MatPropConfine, Pattern,
ConfineType, Cover, NumberCBars, NumberR3Bars, NumberR2Bars, RebarSize, TieSize,
TieSpacingLongit, Number2DirTieBars, Number3DirTieBars, ToBeDesigned)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetRebarColumn


# GetRectangle

## Syntax

SapObject.SapModel.PropFrame.GetRectangle

## VB6 Procedure

Function GetRectangle(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef Color As Long, ByRef Notes As String,
ByRef GUID As String) As Long

## Parameters

Name

The name of an existing rectangular frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a rectangular frame section.


The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropRectangle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetRectangle("R1", "4000Psi", 20, 12)

'get frame section property data
ret = SapModel.PropFrame.GetRectangle("R1", FileName, MatProp, t3, t2, Color, Notes,
GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

SetRectangle

SetRebarBeam

SetRebarColumn

GetRebarBeam

GetRebarColumn

# GetSDSection

## Syntax

SapObject.SapModel.PropFrame.GetSDSection

## VB6 Procedure

Function GetSDSection(ByVal Name As String, ByRef MatProp As String, ByRef NumberItems
As Long, ByRef ShapeName() As String, ByRef MyType() As Long, ByRef DesignType As
Long, ByRef Color As Long, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing section designer property.

MatProp

The name of the base material property for the section.

NumberItems

The number of shapes defined in the section designer section.

ShapeName

This is an array that includes the name of each shape in the section designer section.

MyType

This is an array that includes the type of each shape in the section designer section.

```
1 = I-section
2 = Channel
3 = Tee
4 = Angle
5 = Double Angle
```

```
6 = Box
7 = Pipe
8 = Plate
```
```
101 = Solid Rectangle
102 = Solid Circle
103 = Solid Segment
104 = Solid Sector
```
```
201 = Polygon
```
```
301 = Reinforcing Single
302 = Reinforcing Line
303 = Reinforcing Rectangle
304 = Reinforcing Circle
```
```
401 = Reference Line
402 = Reference Circle
```
```
501 = Caltrans Square
502 = Caltrans Circle
503 = Caltrans Hexagon
504 = Caltrans Octagon
```
DesignType

This is 0, 1, 2 or 3, indicating the design option for the section.

```
0 = No design
1 = Design as general steel section
2 = Design as a concrete column; check the reinforcing
3 = Design as a concrete column; design the reinforcing
```
Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves section property data for a section designer section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.


## VBA Example

Sub GetFramePropSDSection()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim NumberItems As Long
Dim ShapeName() As String
Dim MyType() As Long
Dim DesignType As Long
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add I-section shapes to new property
ret = SapModel.PropFrame.SDShape.SetISection("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1,
18, 6, 1, 0.5, 6, 1)
ret = SapModel.PropFrame.SDShape.SetISection("SD1", "SH2", "A992Fy50", "", -9, -9, 0, -
1, 18, 6, 1, 0.5, 6, 1)
ret = SapModel.PropFrame.SDShape.SetISection("SD1", "SH3", "A992Fy50", "", 9, -9, 0, -1,
18, 6, 1, 0.5, 6, 1)

'get section designer section property data
ret = SapModel.PropFrame.GetSDSection("SD1", MatProp, NumberItems, ShapeName,
MyType, DesignType, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetSDSection

# GetSectProps

## Syntax

SapObject.SapModel.PropFrame.GetSectProps

## VB6 Procedure

Function GetSectProps(ByVal Name As String, ByRef Area As Double, ByRef As2 As Double,
ByRef As3 As Double, ByRef Torsion As Double, ByRef I22 As Double, ByRef I33 As Double,
ByRef S22 As Double, ByRef S33 As Double, ByRef Z22 As Double, ByRef Z33 As Double,
ByRef R22 As Double, ByRef R33 As Double) As Long

## Parameters

Name

The name of an existing frame section property.

Area

The cross-sectional area. [L^2 ]

As2

The shear area for forces in the section local 2-axis direction. [L^2 ]

As3

The shear area for forces in the section local 3-axis direction. [L^2 ]

Torsion

The torsional constant. [L^4 ]

I22

The moment of inertia for bending about the local 2 axis. [L^4 ]


### I33

The moment of inertia for bending about the local 3 axis. [L^4 ]

S22

The section modulus for bending about the local 2 axis. [L^3 ]

S33

The section modulus for bending about the local 3 axis. [L^3 ]

Z22

The plastic modulus for bending about the local 2 axis. [L^3 ]

Z33

The plastic modulus for bending about the local 3 axis. [L^3 ]

R22

The radius of gyration about the local 2 axis. [L]

R33

The radius of gyration about the local 3 axis. [L]

## Remarks

This function retrieves properties for frame section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFramePropProperties()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Area As Double
Dim as2 As Double
Dim as3 As Double
Dim Torsion As Double
Dim I22 As Double
Dim I33 As Double
Dim S22 As Double
Dim S33 As Double
Dim Z22 As Double
Dim Z33 As Double
Dim R22 As Double


Dim R33 As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get frame section properties
ret = SapModel.PropFrame.GetSectProps("FSEC1", Area, As2, As3, Torsion, I22, I33, S22,
S33, Z22, Z33, R22, R33)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# GetTee_1

## Syntax

SapObject.SapModel.PropFrame.GetTee_1

## VB6 Procedure

Function GetTee_1(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef tf As Double, ByRef tw As Double,
ByRef FilletRadius As Double, ByRef MirrorAbout3 As Boolean, ByRef Color As Long, ByRef
Notes As String, ByRef GUID As String) As Long

## Parameters


Name

The name of an existing frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The flange width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

FilletRadius

The fillet radius. [L]

MirrorAbout3 (not applicable)

Indicates whether the section is mirrored about the local 3-axis.

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a tee-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.


## VBA Example

Sub GetFramePropTee()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim tf As Double
Dim tw As Double

```
Dim FilletRadius As Double
```
Dim MirrorAbout3 As Boolean
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetTee_1("TEE1", "A992Fy50", 12, 10, 0.6, 0.3, 0.2, False)

'get frame section property data
ret = SapModel.PropFrame.GetTee_1("TEE1", FileName, MatProp, t3, t2, tf, tw,
FilletRadius, MirrorAbout3, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the GetTee.


## See Also

SetTee_1

SetRebarBeam

GetRebarBeam

# GetTube_1

## Syntax

SapObject.SapModel.PropFrame.GetTube_1

## VB6 Procedure

Function GetTube_1(ByVal Name As String, ByRef FileName As String, ByRef MatProp As
String, ByRef t3 As Double, ByRef t2 As Double, ByRef tf As Double, ByRef tw As Double,
ByRef Radius As Double, ByRef Color As Long, ByRef Notes As String, ByRef GUID As String)
As Long

## Parameters

Name

The name of an existing frame section property.

FileName

If the section property was imported from a property file, this is the name of that file. If the section
property was not imported, this item is blank.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]


Radius

The corner radius, if any. [L]

Color

The display color assigned to the section.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section.

## Remarks

This function retrieves frame section property data for a tube-type frame section.

The function returns zero if the section property data is successfully retrieved; otherwise it returns
a nonzero value.

## VBA Example

Sub GetFramePropTube()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FileName As String
Dim MatProp As String
Dim t3 As Double
Dim t2 As Double
Dim tf As Double
Dim tw As Double

Dim Radius As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetTube_1("TUBE1", "A992Fy50", 8, 6, 0.5, 0.5, 1.0)

'get frame section property data
ret = SapModel.PropFrame.GetTube_1("TUBE1", FileName, MatProp, t3, t2, tf, tw, Radius,
Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 24.2.

This function supersedes GetTube.

## See Also

SetTube_1

# GetTypeOAPI

## Syntax

SapObject.SapModel.PropFrame.GetTypeOAPI

## VB6 Procedure

Function GetTypeOAPI(ByVal Name As String, ByRef PropType As eFramePropType) As Long

## Parameters

Name

The name of an existing frame section property.

PropType

This is one of the following items in the eFramePropType enumeration.

```
I = 1
Channel = 2
```

### T = 3

```
Angle = 4
DblAngle = 5
Box = 6
Pipe = 7
Rectangular = 8
Circle = 9
General = 10
DbChannel = 11
Auto = 12
SD = 13
Variable = 14
Joist = 15
Bridge = 16
Cold_C = 17
Cold_2C = 18
Cold_Z = 19
Cold_L = 20
Cold_2L = 21
Cold_HAT = 22
BuiltupICoverplate = 23
PCCGIRDERI = 24
PCCGIRDERU = 25
```
BuiltupIHybrid = 26

BuiltupUHybrid = 27

PCCGirderSuperT = 41

Cold_Box = 42

Cold_I = 43

Cold_Pipe = 44

Cold_T = 45

Trapezoidal = 46

## Remarks

This function retrieves the property type for the specified frame section property.

The function returns zero if the type is successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetFramePropType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


Dim PropType As eFramePropType

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get frame property type
ret = SapModel.PropFrame.GetTypeOAPI("FSEC1", PropType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed function name to GetTypeOAPI in v17.0.0.

Added New PropType items in 23.1.0

## See Also

# GetTypeRebar

## Syntax

SapObject.SapModel.PropFrame.GetTypeRebar

## VB6 Procedure

Function GetTypeRebar(ByVal Name As String, ByRef MyType As Long) As Long

## Parameters


Name

The name of an existing frame section property.

PropType

This is 0, 1 or 2, indicating the rebar design type.

```
0 = None
1 = Column
2 = Beam
```
## Remarks

This function retrieves the rebar design type for the specified frame section property.

The function returns zero if the type is successfully retrieved; otherwise it returns nonzero.

This function applies only to the following section property types. Calling this function for any
other type of frame section property returns an error.

```
SECTION_T = 3
SECTION_ANGLE = 4
SECTION_RECTANGULAR = 8
SECTION_CIRCLE = 9
```
A nonzero rebar type is returned only if the frame section property has a concrete material.

## VBA Example

Sub GetFramePropRebarType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'set new frame section property
ret = SapModel.PropFrame.SetRectangle("R1", "4000Psi", 20, 12)

'get rebar design type
ret = SapModel.PropFrame.GetTypeRebar("R1", MyType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# ImportProp

## Syntax

SapObject.SapModel.PropFrame.ImportProp

## VB6 Procedure

Function ImportProp(ByVal Name As String, ByVal MatProp As String, ByVal FileName As
String, ByVal PropName As String, Optional ByVal Color As Long = -1, Optional ByVal Notes
As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added. This name does not need to be the same
as the PropName item.

MatProp

The name of the material property for the section.

FileName

The name of the frame section property file from which to get the frame section property specified
by the PropName item.

In most cases you can input just the name of the property file (e.g. Sections8.pro) and the program
will be able to find it. In some cases you may have to input the full path to the property file.


PropName

The name of the frame section property, inside the property file specified by the FileName item,
that is to be imported.

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function imports a frame section property from a property file.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

If the property file is not found, or the specified property name is not found in the property file,
the section is set to be a general section with default properties.

## VBA Example

Sub ImportFrameProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'import new frame section property


ret = SapModel.PropFrame.ImportProp("W18X35", "A992Fy50", "Sections8.pro",
"W18X35")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetPropFileNameList

# SetAngle_1

## Syntax

SapObject.SapModel.PropFrame.SetAngle_1

## VB6 Procedure

Function SetAngle_1(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal tf As Double, ByVal tw As Double, ByVal FilletRadius As Double,
Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID
As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The vertical leg depth. [L]

t2

The horizontal leg width. [L]


tf

The horizontal leg thickness. [L]

tw

The vertical leg thickness. [L]

FilletRadius

The fillet radius. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, then the program assigns a GUID to the section.

## Remarks

This function initializes an angle-type frame section property. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetAngle_1("ANGLE1", "A992Fy50", 6, 4, 0.5, 0.5, 0.2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the SetAngle.

## See Also

GetAngle_1

# SetAutoSelectAluminum

## Syntax

SapObject.SapModel.PropFrame.SetAutoSelectAluminum

## VB6 Procedure

Function SetAutoSelectAluminum(ByVal Name As String, ByVal NumberItems As Long, ByRef
SectName() As String, Optional ByVal AutoStartSection As String = "Median", Optional ByVal
Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

NumberItems

The number of frame section properties included in the auto select list.

SectName

This is an array of the names of the frame section properties included in the auto select list.


Auto select lists and nonprismatic (variable) sections are not allowed in this array.

AutoStartSection

This is Median or the name of a frame section property in the SectName array. It is the starting
section for the auto select list.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function assigns frame section properties to an auto select list. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the auto select list is successfully filled; otherwise it returns a nonzero
value.

## VBA Example

Sub SetFramePropAutoSelectAluminum()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'add aluminum material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_ALUMINUM, , ,
MATERIAL_ALUMINUM_SUBTYPE_6061_T6)

'create new aluminum frame section properties
ret = SapModel.PropFrame.SetISection("AI", Name , 18, 6, 0.5, 0.3, 6, 0.5)


ret = SapModel.PropFrame.SetISection("AI2", Name , 18, 6, 0.6, 0.3, 6, 0.6)
ret = SapModel.PropFrame.SetISection("AI3", Name , 18, 6, 0.7, 0.3, 6, 0.7)

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288, True, "AI", "AI")

'define new auto select list frame section property
ReDim MyName(2)
MyName(0) = "AI"
MyName(1) = "AI2"
MyName(2) = "AI3"
ret = SapModel.PropFrame.SetAutoSelectAluminum("AUTO1", 3, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetAutoSelectAluminum

# SetAutoSelectColdFormed

## Syntax

SapObject.SapModel.PropFrame.SetAutoSelectColdFormed

## VB6 Procedure

Function SetAutoSelectColdFormed(ByVal Name As String, ByVal NumberItems As Long,
ByRef SectName() As String, Optional ByVal AutoStartSection As String = "Median", Optional
ByVal Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

NumberItems


The number of frame section properties included in the auto select list.

SectName

This is an array of the names of the frame section properties included in the auto select list.

Auto select lists and nonprismatic (variable) sections are not allowed in this array.

AutoStartSection

This is Median or the name of a frame section property in the SectName array. It is the starting
section for the auto select list.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function assigns frame section properties to an auto select list. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the auto select list is successfully filled; otherwise it returns a nonzero
value.

## VBA Example

Sub SetFramePropAutoSelectColdFormed()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'add cold formed material


ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'create new cold formed frame section properties
ret = SapModel.PropFrame.SetISection("CI", Name , 18, 6, 0.5, 0.3, 6, 0.5)
ret = SapModel.PropFrame.SetISection("CI2", Name , 18, 6, 0.6, 0.3, 6, 0.6)
ret = SapModel.PropFrame.SetISection("CI3", Name , 18, 6, 0.7, 0.3, 6, 0.7)

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288, True, "CI", "CI")

'define new auto select list frame section property
ReDim MyName(2)
MyName(0) = "CI"
MyName(1) = "CI2"
MyName(2) = "CI3"
ret = SapModel.PropFrame.SetAutoSelectColdFormed("AUTO1", 3, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetAutoSelectColdFormed

# SetAutoSelectSteel

## Syntax

SapObject.SapModel.PropFrame.SetAutoSelectSteel

## VB6 Procedure

Function SetAutoSelectSteel(ByVal Name As String, ByVal NumberItems As Long, ByRef
SectName() As String, Optional ByVal AutoStartSection As String = "Median", Optional ByVal
Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name


The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

NumberItems

The number of frame section properties included in the auto select list.

SectName

This is an array of the names of the frame section properties included in the auto select list.

Auto select lists and nonprismatic (variable) sections are not allowed in this array.

AutoStartSection

This is either Median or the name of a frame section property in the SectName array. It is the
starting section for the auto select list.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function assigns frame section properties to an auto select list. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the auto select list is successfully filled; otherwise it returns a nonzero
value.

## VBA Example

Sub SetFramePropAutoSelectSteel()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC1", "A992Fy50", 24, 8, 0.5, 0.3, 8, 0.5)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC2", "A992Fy50", 20, 8, 0.5, 0.3, 8, 0.5)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC3", "A992Fy50", 16, 8, 0.5, 0.3, 8, 0.5)

'set new auto select list frame section property
ReDim MyName(2)
MyName(0) = "ISEC1"
MyName(1) = "ISEC2"
MyName(2) = "ISEC3"
ret = SapModel.PropFrame.SetAutoSelectSteel("AUTO1", 3, MyName, "ISEC2")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetAutoSelectSteel

# SetChannel_2

## Syntax

SapObject.SapModel.PropFrame.SetChannel_2

## VB6 Procedure

Function SetChannel_2(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal tf As Double, ByVal tw As Double, ByVal FilletRadius As Double,
ByVal MirrorAbout2 As Boolean, Optional ByVal Color As Long = -1, Optional ByVal Notes As
String = "", Optional ByVal GUID As String = "") As Long


## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The flange width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

FilletRadius

The fillet radius. [L]

MirrorAbout2 (not applicable)

Indicates whether the section is mirrored about the local 2-axis.

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a channel-type frame section property. If this function is called for an
existing frame section property, all items for the section are reset to their default value.


The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropChannel()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetChannel_2("CHN1", "A992Fy50", 24, 6, 0.5, 0.3, 0.2, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the SetChannel

## See Also

GetChannel_2

# SetCircle

## Syntax

SapObject.SapModel.PropFrame.SetCircle


## VB6 Procedure

Function SetCircle(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID
As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section diameter. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a solid circular frame section property. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropCircle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object


Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetCircle("C1", "4000Psi", 20)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetCircle

SetRebarBeam

SetRebarColumn

GetRebarBeam

GetRebarColumn

# SetColdBox

## Syntax

SapObject.SapModel.PropFrame.SetColdBox

## VB6 Procedure

Function SetColdBox(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal Thickness As Double, ByVal Radius As Double, Optional ByVal


Color As Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID As String = "")
As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section top flange width. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a cold formed box frame section property. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.


## VBA Example

Sub SetFramePropColdBox()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdBox("CB1", Name, 10, 3.2, 0.08, 0.3)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 22.2.0.

## See Also

GetColdBox

# SetColdC


## Syntax

SapObject.SapModel.PropFrame.SetColdC

## VB6 Procedure

Function SetColdC(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal Thickness As Double, ByVal Radius As Double, ByVal LipDepth As
Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional
ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

LipDepth

The lip depth, if any. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID


The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a cold formed C-type frame section property. If this function is called for
an existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropColdC()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdC("CC1", Name, 10, 3.2, 0.08, 0.3, 0.6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

GetColdC

# SetColdHat

## Syntax

SapObject.SapModel.PropFrame.SetColdHat

## VB6 Procedure

Function SetColdHat(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal Thickness As Double, ByVal Radius As Double, ByVal LipDepth As
Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional
ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

LipDepth

The lip depth, if any. [L]

Color


The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, then the program assigns a GUID to the section.

## Remarks

This function initializes a cold formed hat-type frame section property. If this function is called
for an existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropColdHat()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdHat("CH1", Name, 10, 3.2, 0.08, 0.3, 0.6)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetColdHat

# SetColdI

## Syntax

SapObject.SapModel.PropFrame.SetColdI

## VB6 Procedure

Function SetColdI(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal t2b As Double, ByVal Thickness As Double, ByVal Radius As
Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional
ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section top flange width. [L]

t2b

The section bottom flange width. [L]


Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a cold formed I-shape frame section property. If this function is called for
an existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropColdI()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdI("CI1", Name, 10, 3.2, 0.08, 0.3, 0.6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 22.2.0.

## See Also

GetColdI

# SetColdL

## Syntax

SapObject.SapModel.PropFrame.SetColdL

## VB6 Procedure

Function SetColdL(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal Thickness As Double, ByVal Radius As Double, ByVal LipDepth As Double, Optional
ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID As
String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3


The section depth. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

LipDepth

The lip depth, if any. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a cold formed Angle frame section property. If this function is called for
an existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropColdL()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdL("CL1", Name, 4.0, 0.08, 0.3, 0.6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 22.2.0.

## See Also

GetColdL

# SetColdPipe

## Syntax

SapObject.SapModel.PropFrame.SetColdPipe

## VB6 Procedure

Function SetColdPipe(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal Thickness As Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As
String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.


MatProp

The name of the material property for the section.

t3

The section depth. [L]

Thickness

The section thickness. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a cold formed pipe frame section property. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropColdPipe()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdPipe("CP1", Name, 8.0, 0.08)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 22.2.0.

## See Also

GetColdPipe

# SetColdT

## Syntax

SapObject.SapModel.PropFrame.SetColdT

## VB6 Procedure

Function SetColdT(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal Thickness As Double, ByVal Radius As Double, Optional ByVal
Color As Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID As String = "")
As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.


MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section top flange width. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a cold formed Tee frame section property. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropColdT()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdT("CT1", Name, 10, 3.2, 0.08, 0.3, 0.6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 22.2.0.

## See Also

GetColdT

# SetColdZ

## Syntax

SapObject.SapModel.PropFrame.SetColdZ

## VB6 Procedure

Function SetColdZ(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal Thickness As Double, ByVal Radius As Double, ByVal LipDepth As
Double, ByVal LipAngle As Double, Optional ByVal Color As Long = -1, Optional ByVal Notes
As String = "", Optional ByVal GUID As String = "") As Long


## Parameters

Name

The name of an existing or new frame section property. If this is an existing property then that
property is modified, otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]

Thickness

The section thickness. [L]

Radius

The corner radius, if any. [L]

LipDepth

The lip depth, if any. [L]

LipAngle

The lip angle measured from horizontal (0 <= LipAngle <= 90). [deg]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a cold formed Z-type frame section property. If this function is called for
an existing frame section property, all items for the section are reset to their default value.


The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropColdZ()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add cold formed material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_COLDFORMED, , , ,
MATERIAL_COLDFORMED_SUBTYPE_ASTM_A653SQGr50)

'set new frame section property
ret = SapModel.PropFrame.SetColdZ("CZ1", Name, 10, 3.2, 0.08, 0.3, 0.6, 60)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetColdZ


# SetCoverPlatedI

## Syntax

SapObject.SapModel.PropFrame.SetCoverPlatedI

## VB6 Procedure

Function SetCoverPlatedI(ByVal Name As String, ByVal SectName As String, ByVal
FyTopFlange As Double, ByVal FyWeb As Double, ByVal FyBotFlange As Double, ByVal tc As
Double, ByVal bc As Double, ByVal MatPropTop As String, ByVal tcb As Double, ByVal bcb
As Double, ByVal MatPropBot As String, Optional ByVal Color As Long = -1, Optional ByVal
Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

SectName

The name of an existing I-type frame section property that is used for the I-section portion of the
coverplated I section.

FyTopFlange

The yield strength of the top flange of the I-section. [F/L^2 ]

If this item is 0, the yield strength of the I-section specified by the SectName item is used.

FyWeb

The yield strength of the web of the I-section. [F/L^2 ]

If this item is 0, the yield strength of the I-section specified by the SectName item is used.

FyBotFlange

The yield strength of the bottom flange of the I-section. [F/L^2 ]

If this item is 0, the yield strength of the I-section specified by the SectName item is used.

tc

The thickness of the top cover plate. [L]

If the tc or the bc item is less than or equal to 0, no top cover plate exists.

bc


The width of the top cover plate. [L]

If the tc or the bc item is less than or equal to 0, no top cover plate exists.

MatPropTop

The name of the material property for the top cover plate.

This item applies only if both the tc and the bc items are greater than 0.

tcb

The thickness of the bottom cover plate. [L]

If the tcb or the bcb item is less than or equal to 0, no bottom cover plate exists.

bcb

The width of the bottom cover plate. [L]

If the tcb or the bcb item is less than or equal to 0, no bottom cover plate exists.

MatPropBot

The name of the material property for the bottom cover plate.

This item applies only if both the tcb and the bcb items are greater than 0.

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a cover plated I-type frame section property. If this function is called for
an existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropCoverPlatedI()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC", "A992Fy50", 24, 8, 0.5, 0.3, 8, 0.5)

'set new cover plated I-type frame section property
ret = SapModel.PropFrame.SetCoverPlatedI("CPI1", "ISEC", 0, 36, 0, 0.75, 14, "A992Fy50",
0.5, 6, "A992Fy50")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetCoverPlatedI

# SetDblAngle_2

## Syntax

SapObject.SapModel.PropFrame.SetDblAngle_2

## VB6 Procedure


Function SetDblAngle_2(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal tf As Double, ByVal tw As Double, ByVal dis As Double, ByVal
FilletRadius As Double, ByVal MirrorAbout3 As Boolean, Optional ByVal Color As Long = -1,
Optional ByVal Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The vertical leg depth. [L]

t2

The total width of the section, that is, the sum of the widths of each horizontal leg plus the back-to
-back distance. [L]

tf

The horizontal leg thickness. [L]

tw

The vertical leg thickness. [L]

dis

The back-to-back distance between the angles. [L]

FilletRadius

The fillet radius. [L]

MirrorAbout3 (not applicable)

Indicates whether the section is mirrored about the local 3-axis.

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID


The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a double angle-type frame section property. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropDblAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetDblAngle_2("DBANG1", "A992Fy50", 6, 9, 0.5, 0.5, 1, 0.2,
False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the GetDblAngle.

## See Also


GetDblAngle_2

# SetDblChannel_1

## Syntax

SapObject.SapModel.PropFrame.SetDblChannel_1

## VB6 Procedure

Function SetDblChannel_1(ByVal Name As String, ByVal MatProp As String, ByVal t3 As
Double, ByVal t2 As Double, ByVal tf As Double, ByVal tw As Double, ByVal dis As Double,
ByVal FilletRadius As Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As
String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The total width of the section, that is, the sum of the widths of each flange plus the back-to-back
distance. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

dis

The back-to-back distance between the channels. [L]

FilletRadius

The fillet radius. [L]

Color


The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a double channel-type frame section property. If this function is called for
an existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropDblChannel()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetDblChannel_1("DBCHN1", "A992Fy50", 12, 6.5, 0.5, 0.3, 0.5,
0.2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 25.0.0. This function replaces the SetDblAngle.

## See Also

GetDblChannel_1

# SetGeneral

## Syntax

SapObject.SapModel.PropFrame.SetGeneral

## VB6 Procedure

Function SetGeneral(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal Area As Double, ByVal As2 As Double, ByVal As3 As Double,
ByVal Torsion As Double, ByVal I22 As Double, ByVal I33 As Double, ByVal S22 As Double,
ByVal S33 As Double, ByVal Z22 As Double, ByVal Z33 As Double, ByVal R22 As Double,
ByVal R33 As Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As String =
"", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]

Area

The cross-sectional area. [L^2 ]

As2

The shear area for forces in the section local 2-axis direction. [L^2 ]


As3

The shear area for forces in the section local 3-axis direction. [L^2 ]

Torsion

The torsional constant. [L^4 ]

I22

The moment of inertia for bending about the local 2 axis. [L^4 ]

I33

The moment of inertia for bending about the local 3 axis. [L^4 ]

S22

The section modulus for bending about the local 2 axis. [L^3 ]

S33

The section modulus for bending about the local 3 axis. [L^3 ]

Z22

The plastic modulus for bending about the local 2 axis. [L^3 ]

Z33

The plastic modulus for bending about the local 3 axis. [L^3 ]

R22

The radius of gyration about the local 2 axis. [L]

R33

The radius of gyration about the local 3 axis. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.


## Remarks

This function initializes a general frame section property. If this function is called for an existing
frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropGeneral()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetGeneral("GEN1", "A992Fy50", 24, 14, 100, 80, 80, 4, 1000,
2400, 140, 200, 150, 220, 3, 5, -1, "API example", "Default")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetGeneral


# SetHybridISection

## Syntax

SapObject.SapModel.PropFrame.SetHybridISection

## VB6 Procedure

Function SetHybridISection(ByVal Name As String, ByRef MatPropTopFlange As String, ByRef
MatPropWeb As String, ByRef MatPropBotFlange As String, ByRef t3 As Double, ByRef t2 As
Double, ByRef TF As Double, ByRef TW As Double, ByRef t2b As Double, ByRef tfb As
Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional
ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property then that
property is modified, otherwise, a new property is added.

MatPropTopFlange

The name of the material property for the top flange.

MatPropWeb

The name of the material property for the web.

MatPropBotFlange

The name of the material property for the bottom flange.

t3

The height of the section. [L]

t2

The width of the top flange. [L]

TF

The thickness of the top flange. [L]

TW

The thickness of the web. [L]

t2b

The width of the bottom flange. [L]


tfb

The thickness of the bottom flange. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, then the program assigns a GUID to the section.

## Remarks

This function initializes a steel hybrid I frame section property. If this function is called for an
existing frame section property then all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized, otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropHybridISection()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new Hybrid I-type frame section property
ret = SapModel.PropFrame.SetHybridISection("HybridI", "A992Fy50", "A992Fy50",
"A992Fy50", 24, 8, 0.5, 0.3, 8, 0.5)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.0.0.

## See Also

# SetHybridUSection

## Syntax

SapObject.SapModel.PropFrame.SetHybridUSection

## VB6 Procedure

Function SetHybridUSection(ByVal Name As String, ByRef WebMaterial As String, ByRef
TopFlangeMaterial As String, ByRef BotFlangeMaterial As String, ByRef T() As Double,
Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID
As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property then that
property is modified, otherwise, a new property is added.

MatPropTopFlange

The name of the material property for the top flange.

MatPropWeb

The name of the material property for the web.

MatPropBotFlange

The name of the material property for the bottom flange.

T()

The dimension array of the section:


(0) D1 = Web Depth (vertical, inside to inside of flanges). [L]

(1) B1 = Web Distance at Top (CL to CL). [L]

(2) B2 = Bottom Flange Width. [L]

(3) B3 = Top Flange Width (per each). [L]

(4) B4 = Bottom Flange Lip (Web CL to flange edge, may be zero). [L]

(5) tw = Web Thickness. [L]

(6) tf = Top Flange Thickness. [L]

(7) tfb = Bottom Flange Thickness. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, then the program assigns a GUID to the section.

## Remarks

This function initializes a steel hybrid U frame section property. If this function is called for an
existing frame section property then all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized, otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropHybridUSection()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim T() As Double
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new Hybrid U-type frame section property
Redim T(7)
T(0) = 48
T(1) = 64
T(2) = 48
T(3) = 15
T(4) = 1.5
T(5) = 1
T(6) = 2
T(7) = 2
ret = SapModel.PropFrame.SetHybridUSection("HybridU", "A992Fy50", "A992Fy50",
"A992Fy50", T())

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.0.0.

## See Also

# SetISection_1

## Syntax

SapObject.SapModel.PropFrame.SetISection_1

## VB6 Procedure

Function SetISection_1(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal tf As Double, ByVal tw As Double, ByVal t2b As Double, ByVal tfb
As Double, ByVal FilletRadius As Double, Optional ByVal Color As Long = -1, Optional ByVal
Notes As String = "", Optional ByVal GUID As String = "") As Long


## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The top flange width. [L]

tf

The top flange thickness. [L]

tw

The web thickness. [L]

t2b

The bottom flange width. [L]

tfb

The bottom flange thickness. [L]

FilletRadius

The fillet radius. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.


## Remarks

This function initializes an I-type frame section property. If this function is called for an existing
frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropISection()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetISection_1("ISEC1", "A992Fy50", 24, 10, 0.5, 0.3, 14, 0.6,
0.2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the SetISection.

## See Also

GetISection_1


# SetModifiers

## Syntax

SapObject.SapModel.PropFrame.SetModifiers

## VB6 Procedure

Function SetModifiers(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing frame section property.

Value

This is an array of eight unitless modifiers.

```
Value(0) = Cross sectional area modifier
Value(1) = Shear area in local 2 direction modifier
Value(2) = Shear area in local 3 direction modifier
Value(3) = Torsional constant modifier
Value(4) = Moment of inertia about local 2 axis modifier
Value(5) = Moment of inertia about local 3 axis modifier
Value(6) = Mass modifier
Value(7) = Weight modifier
```
## Remarks

This function assigns property modifiers to a frame section property. The default value for all
modifiers is one.

The function returns zero if the modifiers are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub AssignFramePropModifiers()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'assign modifiers
ReDim Value(7)
For i = 0 To 7
Value(i) = 1
Next i
Value(5) = 100
ret = SapModel.PropFrame.SetModifiers("FSEC1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetModifiers

# SetNonPrismatic

## Syntax

SapObject.SapModel.PropFrame.SetNonPrismatic

## VB6 Procedure

Function SetNonPrismatic(ByVal Name As String, ByVal NumberItems As Long, ByRef StartSec
() As String, ByRef EndSec() As String, ByRef MyLength() As Double, ByRef MyType() As
Long, ByRef EI33() As Long, ByRef EI22() As Long, Optional ByVal Color As Long = -1,
Optional ByVal Notes As String = "", Optional ByVal GUID As String = "") As Long


## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

NumberItems

The number of segments assigned to the nonprismatic section.

StartSec

This is an array of the names of the frame section properties at the start of each segment.

Auto select lists and nonprismatic sections are not allowed in this array.

EndSec

This is an array of the names of the frame section properties at the end of each segment.

Auto select lists and nonprismatic sections are not allowed in this array.

MyLength

This is an array that includes the length of each segment. The length may be variable or absolute
as indicated by the MyType item. [L] when length is absolute

MyType

This is an array of either 1 or 2, indicating the length type for each segment.

```
1 = Variable (relative length)
2 = Absolute
```
EI33, EI22

This is an array of 1, 2 or 3, indicating the variation type for EI33 and EI22 in each segment.

```
1 = Linear
2 = Parabolic
3 = Cubic
```
Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID


The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function assigns data to a nonprismatic frame section property.

The function returns zero if the data is successfully filled; otherwise it returns a nonzero value.

## VBA Example

Sub SetFramePropNonprismatic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim StartSec() As String
Dim EndSec() As String
Dim MyLength() As Double
Dim MyType() As Long
Dim EI33() As Long
Dim EI22() As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC1", "A992Fy50", 24, 8, 0.5, 0.3, 8, 0.5)

'set new I-type frame section property
ret = SapModel.PropFrame.SetISection("ISEC2", "A992Fy50", 20, 8, 0.5, 0.3, 8, 0.5)

'set new nonprismatic frame section property
ReDim StartSec(2)
ReDim EndSec(2)
ReDim MyLength(2)
ReDim MyType(2)
ReDim EI33(2)
ReDim EI22(2)


StartSec(0) = "ISEC2"
EndSec(0) = "ISEC1"
MyLength(0) = 60
MyType(0) = 2
EI33(0)= 2
EI22(0)= 1

StartSec(1) = "ISEC1"
EndSec(1) = "ISEC1"
MyLength(1) = 1
MyType(1) = 1
EI33(1)= 2
EI22(1)= 1

StartSec(2) = "ISEC1"
EndSec(2) = "ISEC2"
MyLength(2) = 60
MyType(2) = 2
EI33(2)= 2
EI22(2)= 1

ret = SapModel.PropFrame.SetNonPrismatic("NP1", 3, StartSec, EndSec, MyLength,
MyType, EI33, EI22)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetNonPrismatic

# SetPipe

## Syntax

SapObject.SapModel.PropFrame.SetPipe

## VB6 Procedure

Function SetPipe(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double, ByVal
tw As Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "",
Optional ByVal GUID As String = "") As Long


## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The outside diameter. [L]

tw

The wall thickness. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a pipe-type frame section property. If this function is called for an existing
frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropPipe()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetPipe("PIPE1", "A992Fy50", 8, 0.375)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetPipe

# SetPrecastI_1

## Syntax

SapObject.SapModel.PropFrame.SetPrecastI_1

## VB6 Procedure

Function SetPrecastI_1(ByVal Name As String, ByVal MatProp As String, ByRef b() As Double,
ByRef d() As Double, ByRef t() As Double, ByRef c As Double,Optional ByVal Color As Long =
-1, Optional ByVal Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp


The name of the material property for the section.

b

This is an array, dimensioned to 3, containing the horizontal section dimensions. [L]

```
b(0) = B1 (> 0)
b(1) = B2 (> 0)
b(2) = B3 (>= 0)
b(3) = B4 (>= 0)
```
Section dimensions B1 through B4 are defined on the precast concrete I girder definition form.

d

This is an array, dimensioned to 6, containing the vertical section dimensions. [L]

```
d(0) = D1 (> 0)
d(1) = D2 (> 0)
d(2) = D3 (>= 0)
d(3) = D4 (>= 0)
d(4) = D5 (> 0)
d(5) = D6 (>= 0)
d(6) = D7 (>=0)
```
Section dimensions D1 through D7 are defined on the precast concrete I girder definition form.

t

This is an array, dimensioned to 1, containing the web thickness dimensions. [L]

```
T(0) = T1 (> 0)
```
```
T(1) = T2 (> 0)
```
Section dimensions T1 and T2 are defined on the precast I girder definition form.

c

The bottom flange chamfer dimension, denoted as C1 on the precast concrete I girder definition
form.

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.


## Remarks

This function initializes a precast concrete I girder frame section property. If this function is called
for an existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropPrecastI_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim bb() As Double
Dim dd() As Double

Dim tt() As Double

Dim cc As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ReDim bb(3)
ReDim dd(6)

ReDim tt(1)
bb(0) = 12
bb(1) = 16
bb(2) = 0
bb(3) = 0
dd(0) = 28
dd(1) = 4
dd(2) = 3
dd(3) = 0
dd(4) = 5
dd(5) = 5


dd(6) = 0

tt(0) = 6

tt(1) = 6

cc = 0
ret = SapModel.PropFrame.SetPrecastI_1("PC1", "4000Psi", bb, dd, tt, cc)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.

The function supersedes by SetPrecastI.

## See Also

GetPrecastI_1

# SetPrecastU

## Syntax

SapObject.SapModel.PropFrame.SetPrecastU

## VB6 Procedure

Function SetPrecastU(ByVal Name As String, ByVal MatProp As String, ByRef b() As Double,
ByRef d() As Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "",
Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

b


This is an array, dimensioned to 5, containing the horizontal section dimensions. [L]

```
b(0) = B1 (> 0)
b(1) = B2 (> 0)
b(2) = B3 (> 0)
b(3) = B4 (>= 0)
b(4) = B5 (>= 0)
b(5) = B6 (>= 0)
```
Section dimensions B1 through B6 are defined on the precast concrete U girder definition form.

d

This is an array, dimensioned to 6, containing the vertical section dimensions. [L]

```
d(0) = D1 (> 0)
d(1) = D2 (> 0)
d(2) = D3 (>= 0)
d(3) = D4 (>= 0)
d(4) = D5 (>= 0)
d(5) = D6 (>= 0)
d(6) = D7 (>= 0)
```
Section dimensions D1 through D7 are defined on the precast concrete U girder definition form.

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a precast concrete U girder frame section property. If this function is
called for an existing frame section property, all items for the section are reset to their default
value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropPrecastU()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim bb() As Double
Dim dd() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set present units to kN-mm
ret = SapModel.SetPresentUnits(kN_mm_C)

'set new frame section property
ReDim bb(5)
ReDim dd(6)
bb(0) = 2350
bb(1) = 1500
bb(2) = 200
bb(3) = 75
bb(4) = 143.8447
bb(5) = 0
dd(0) = 1700
dd(1) = 175
dd(2) = 75
dd(3) = 0
dd(4) = 0
dd(5) = 125
dd(6) = 175
ret = SapModel.PropFrame.SetPrecastU("PC1", "4000Psi", bb, dd)

'set present units to kip-in
ret = SapModel.SetPresentUnits(kip_in_F)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.02.

## See Also

GetPrecastU

# SetRebarBeam

## Syntax

SapObject.SapModel.PropFrame.SetRebarBeam

## VB6 Procedure

Function SetRebarBeam(ByVal Name As String, ByVal MatPropLong As String, ByVal
MatPropConfine As String, ByVal CoverTop As Double, ByVal CoverBot As Double, ByVal
TopLeftArea As Double, ByVal TopRightArea As Double, ByVal BotLeftArea As Double, ByVal
BotRightArea As Double) As Long

## Parameters

Name

The name of an existing frame section property.

MatPropLong

The name of the rebar material property for the longitudinal rebar.

MatPropConfine

The name of the rebar material property for the confinement rebar.

CoverTop

The distance from the top of the beam to the centroid of the top longitudinal reinforcement. [L]

CoverBot

The distance from the bottom of the beam to the centroid of the bottom longitudinal
reinforcement. [L]

TopLeftArea

The total area of longitudinal reinforcement at the top left end of the beam. [L^2 ]

TopRightArea

The total area of longitudinal reinforcement at the top right end of the beam. [L^2 ]

BotLeftArea


The total area of longitudinal reinforcement at the bottom left end of the beam. [L^2 ]

BotRightArea

The total area of longitudinal reinforcement at the bottom right end of the beam. [L^2 ]

## Remarks

This function assigns beam rebar data to frame sections.

The function returns zero if the rebar data is successfully assigned; otherwise it returns a nonzero
value.

This function applies only to the following section types. Calling this function for any other type
of frame section property returns an error.

```
SECTION_T = 3
SECTION_ANGLE = 4
SECTION_RECTANGULAR = 8
SECTION_CIRCLE = 9
```
The material assigned to the specified frame section property must be concrete or this function
returns an error.

## VBA Example

Sub AssignBeamRebar()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim RebarName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetRectangle("R1", "4000Psi", 20, 12)

'add ASTM A706 rebar material


ret = SapModel.PropMaterial.AddQuick(RebarName, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'set beam rebar data
ret = SapModel.PropFrame.SetRebarBeam("R1", RebarName, RebarName, 3.5, 3, 4.1, 4.2,
4.3, 4.4)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetRebarBeam

# SetRebarColumn

## Syntax

SapObject.SapModel.PropFrame.SetRebarColumn

## VB6 Procedure

Function SetRebarColumn(ByVal Name As String, ByVal MatPropLong As String, ByVal
MatPropConfine As String, ByVal Pattern As Long, ByVal ConfineType As Long, ByVal Cover
As Double, ByVal NumberCBars As Long, ByVal NumberR3Bars As Long, ByVal
NumberR2Bars As Long, ByVal RebarSize As String, ByVal TieSize As String, ByVal
TieSpacingLongit As Double, ByVal Number2DirTieBars As Long, ByVal Number3DirTieBars
As Long, ByVal ToBeDesigned As Boolean) As Long

## Parameters

Name

The name of an existing frame section property.

MatPropLong

The name of the rebar material property for the longitudinal rebar.

MatPropConfine

The name of the rebar material property for the confinement rebar.


Pattern

This is either 1 or 2, indicating the rebar configuration.

```
1 = Rectangular
2 = Circular
```
For circular frame section properties this item must be 2; otherwise an error is returned.

ConfineType

This is either 1 or 2, indicating the confinement bar type.

```
1 = Ties
2 = Spiral
```
This item applies only when Pattern = 2. If Pattern = 1, the confinement bar type is assumed to be
ties.

Cover

The clear cover for the confinement steel (ties). In the special case of circular reinforcement in a
rectangular column, this is the minimum clear cover. [L]

NumberCBars

This item applies to a circular rebar configuration, Pattern = 2. It is the total number of
longitudinal reinforcing bars in the column.

NumberR3Bars

This item applies to a rectangular rebar configuration, Pattern = 1. It is the number of longitudinal
bars (including the corner bar) on each face of the column that is parallel to the local 3-axis of the
column.

NumberR2Bars

This item applies to a rectangular rebar configuration, Pattern = 1. It is the number of longitudinal
bars (including the corner bar) on each face of the column that is parallel to the local 2-axis of the
column.

RebarSize

The rebar name for the longitudinal rebar in the column.

TieSize

The rebar name for the confinement rebar in the column.

TieSpacingLongit

The longitudinal spacing of the confinement bars (ties). [L]

Number2DirTieBars


This item applies to a rectangular reinforcing configuration, Pattern = 1. It is the number of
confinement bars (tie legs) running in the local 2-axis direction of the column.

Number3DirTieBars

This item applies to a rectangular reinforcing configuration, Pattern = 1. It is the number of
confinement bars (tie legs) running in the local 3-axis direction of the column.

ToBeDesigned

If this item is True, the column longitudinal rebar is to be designed; otherwise it is to be checked.

## Remarks

This function assigns column rebar data to frame sections.

The function returns zero if the rebar data is successfully assigned; otherwise it returns a nonzero
value.

This function applies only to the following section types. Calling this function for any other type
of frame section property returns an error.

```
SECTION_RECTANGULAR = 8
SECTION_CIRCLE = 9
```
The material assigned to the specified frame section property must be concrete or else this
function returns an error.

## VBA Example

Sub AssignColumnRebar()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim RebarName As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'set new frame section property
ret = SapModel.PropFrame.SetRectangle("R1", "4000Psi", 30, 30)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(RebarName, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'set column rebar data
ret = SapModel.PropFrame.SetRebarColumn("R1", RebarName, RebarName, 2, 2, 2, 10, 0, 0,
"#10", "#5", 4, 0, 0, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetRebarColumn

# SetRectangle

## Syntax

SapObject.SapModel.PropFrame.SetRectangle

## VB6 Procedure

Function SetRectangle(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "",
Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3


The section depth. [L]

t2

The section width. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a solid rectangular frame section property. If this function is called for an
existing frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropRectangle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetRectangle("R1", "4000Psi", 20, 12)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetRectangle

SetRebarBeam

SetRebarColumn

GetRebarBeam

GetRebarColumn

# SetSDSection

## Syntax

SapObject.SapModel.PropFrame.SetSDSection

## VB6 Procedure

Function SetSDSection(ByVal Name As String, ByVal MatProp As String, Optional ByVal
DesignType As Long = 0, Optional ByVal Color As Long = -1, Optional ByVal Notes As String =
"", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the base material property for the section.

DesignType

This is 0, 1, 2 or 3, indicating the design option for the section.


```
0 = No design
1 = Design as general steel section
2 = Design as a concrete column; check the reinforcing
3 = Design as a concrete column; design the reinforcing
```
When DesignType = 1 is assigned, the material property specified by the MatProp item must be a
steel material; otherwise the program sets DesignType = 0.

Similarly, when DesignType = 2 or DesignType = 3 is assigned, the material property specified by
the MatProp item must be a concrete material; otherwise the program sets DesignType = 0.

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a section designer property.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropSDSection()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetSDSection

# SetTee_1

## Syntax

SapObject.SapModel.PropFrame.SetTee_1

## VB6 Procedure

Function SetTee_1(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal tf As Double, ByVal tw As Double, ByVal FilletRadius As Double,
ByVal MirrorAbout3 As Boolean, Optional ByVal Color As Long = -1, Optional ByVal Notes As
String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2


The flange width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

FilletRadius

The fillet radius. [L]

MirrorAbout3 (not applicable)

Indicates whether the section is mirrored about the local 3-axis.

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a tee-type frame section property. If this function is called for an existing
frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropTee()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetTee_1("TEE1", "A992Fy50", 12, 10, 0.6, 0.3, 0.2, False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 25.0.0. This function replaces the SetTee.

## See Also

GetTee_1

SetRebarBeam

GetRebarBeam

# SetTube_1

## Syntax

SapObject.SapModel.PropFrame.SetTube_1

## VB6 Procedure

Function SetTube_1(ByVal Name As String, ByVal MatProp As String, ByVal t3 As Double,
ByVal t2 As Double, ByVal tf As Double, ByVal tw As Double, ByVal Radius As Double,
Optional ByVal Color As Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID
As String = "") As Long

## Parameters

Name


The name of an existing or new frame section property. If this is an existing property, that
property is modified; otherwise, a new property is added.

MatProp

The name of the material property for the section.

t3

The section depth. [L]

t2

The section width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

Radius

The corner radius, may be zero. [L]

Color

The display color assigned to the section. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the section.

GUID

The GUID (global unique identifier), if any, assigned to the section. If this item is input as
Default, the program assigns a GUID to the section.

## Remarks

This function initializes a tube-type frame section property. If this function is called for an existing
frame section property, all items for the section are reset to their default value.

The function returns zero if the section property is successfully initialized; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFramePropTube()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new frame section property
ret = SapModel.PropFrame.SetTube_1("TUBE1", "A992Fy50", 8, 6, 0.5, 0.5, 0.75)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 24.2.

This function supersedes SetTube.

## See Also

GetTube_1

# Delete

## Syntax

SapObject.SapModel.PropFrame.SDShape.Delete

## VB6 Procedure

Function Delete(ByVal Name As String, ByRef ShapeName As String, Optional ByVal All As
Boolean = False) As Long


## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing shape in a section designer property. If the All item is True, this item may
be specified as a blank string.

All

If this item is True, all shapes in the section designer property specified by the Name item are
deleted.

## Remarks

This function deletes shapes from a section designer property.

The function returns zero if the shape is successfully deleted; otherwise it returns a nonzero value.

## VBA Example

Sub DeleteFrameSDPropShape()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add I-section shapes to new property
ret = SapModel.PropFrame.SDShape.SetISection("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1,
18, 6, 1, 0.5, 6, 1)
ret = SapModel.PropFrame.SDShape.SetISection("SD1", "SH2", "A992Fy50", "", -9, -9, 0, -


### 1, 18, 6, 1, 0.5, 6, 1)

ret = SapModel.PropFrame.SDShape.SetISection("SD1", "SH3", "A992Fy50", "", 9, -9, 0, -1,
18, 6, 1, 0.5, 6, 1)

'delete shape from section designer property
ret = SapModel.PropFrame.SDShape.Delete("SD1", "SH1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

Modified optional argument All to be ByVal in version 12.0.1.

## See Also

# GetAngle

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetAngle

## VB6 Procedure

Function GetAngle(ByVal Name As String, ByVal ShapeName As String, ByRef MatProp As
String, ByRef PropName As String, ByRef Color As Long, ByRef XCenter As Double, ByRef
YCenter As Double, ByRef h As Double, ByRef bf As Double, ByRef tf As Double, ByRef tw As
Double, ByRef Rotation As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing Angle shape in the specified frame section property.

MatProp

The name of the material property for the shape.

PropName


This is a blank string or the name of a defined Angle property that has been imported from a
section property file. If it is the name of a defined Angle property, the section dimensions are
taken from that property.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

h

The section depth. [L]

bf

The flange width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

## Remarks

This function retrieves property data for an Angle shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim PropName As String
Dim Color As Long
Dim XCenter As Double


Dim YCenter As Double
Dim h As Double
Dim bf As Double
Dim tf As Double
Dim tw As Double
Dim Rotation As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Angle shape to new property
ret = SapModel.PropFrame.SDShape.SetAngle("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1,
18, 6, 1, 0.5)

'get Angle shape property data
ret = SapModel.PropFrame.SDShape.GetAngle("SD1", "SH1", MatProp, PropName, Color,
Xcenter, Ycenter, h, bf, tf, tw, Rotation)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetAngle


# GetChannel

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetChannel

## VB6 Procedure

Function GetChannel(ByVal Name As String, ByVal ShapeName As String, ByRef MatProp As
String, ByRef PropName As String, ByRef Color As Long, ByRef XCenter As Double, ByRef
YCenter As Double, ByRef h As Double, ByRef bf As Double, ByRef tf As Double, ByRef tw As
Double, ByRef Rotation As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing Channel shape in the specified frame section property.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined Channel property that has been imported from a
section property file. If it is the name of a defined Channel property, the section dimensions are
taken from that property.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

h

The section depth. [L]

bf

The flange width. [L]


tf

The flange thickness. [L]

tw

The web thickness. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

## Remarks

This function retrieves property data for a Channel shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropChannel()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim PropName As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim h As Double
Dim bf As Double
Dim tf As Double
Dim tw As Double
Dim Rotation As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Channel shape to new property
ret = SapModel.PropFrame.SDShape.SetChannel("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1,
18, 6, 1, 0.5)

'get Channel shape property data
ret = SapModel.PropFrame.SDShape.GetChannel("SD1", "SH1", MatProp, PropName, Color,
Xcenter, Ycenter, h, bf, tf, tw, Rotation)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetChannel

# GetDblAngle

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetDblAngle

## VB6 Procedure

Function GetDblAngle(ByVal Name As String, ByVal ShapeName As String, ByRef MatProp As
String, ByRef PropName As String, ByRef Color As Long, ByRef XCenter As Double, ByRef
YCenter As Double, ByRef h As Double, ByRef w As Double, ByRef tf As Double, ByRef tw As
Double, ByRef dis As Double, ByRef Rotation As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing Double Angle shape in the specified frame section property.

MatProp


The name of the material property for the shape.

PropName

This is a blank string or the name of a defined Double Angle property that has been imported from
a section property file. If it is the name of a defined Double Angle property, then the section
dimensions are taken from that property.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

h

The section depth. [L]

w

The flange width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

dis

Separation between the two flanges that are parallel. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

## Remarks

This function retrieves property data for a Double Angle shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example


Sub GetFrameSDPropDblAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim PropName As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim h As Double
Dim w As Double
Dim tf As Double
Dim tw As Double
Dim dis As Double
Dim Rotation As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Double Angle shape to new property
ret = SapModel.PropFrame.SDShape.SetDblAngle("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -
1, 18, 6, 1, 0.5, 2)

'get Double Angle shape property data
ret = SapModel.PropFrame.SDShape.GetDblAngle("SD1", "SH1", MatProp, PropName,
Color, Xcenter, Ycenter, h, w, tf, tw, dis, Rotation)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.


## See Also

SetDblAngle

# GetISection

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetISection

## VB6 Procedure

Function GetISection(ByVal Name As String, ByVal ShapeName As String, ByRef MatProp As
String, ByRef PropName As String, ByRef Color As Long, ByRef XCenter As Double, ByRef
YCenter As Double, ByRef h As Double, ByRef bf As Double, ByRef tf As Double, ByRef tw As
Double, ByRef bfb As Double, ByRef tfb As Double, ByRef Rotation As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing I-section shape in the specified frame section property.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined I-section property that has been imported from a
section property file. If it is the name of a defined I-section property, the section dimensions are
taken from that property.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

h


The section depth. [L]

bf

The top flange width. [L]

tf

The top flange thickness. [L]

tw

The web thickness. [L]

bfb

The bottom flange width. [L]

tfb

The bottom flange thickness. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

## Remarks

This function retrieves property data for an I-section shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropISection()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim PropName As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim h As Double
Dim bf As Double
Dim tf As Double
Dim tw As Double
Dim bfb As Double
Dim tfb As Double
Dim Rotation As Double


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add I-section shape to new property
ret = SapModel.PropFrame.SDShape.SetISection("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1,
18, 6, 1, 0.5, 6, 1)

'get I-section shape property data
ret = SapModel.PropFrame.SDShape.GetISection("SD1", "SH1", MatProp, PropName, Color,
Xcenter, Ycenter, h, bf, tf, tw, bfb, tfb, Rotation)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetISection

# GetPipe

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetPipe

## VB6 Procedure


Function GetPipe(ByVal Name As String, ByVal ShapeName As String, ByRef MatProp As
String, ByRef PropName As String, ByRef Color As Long, ByRef XCenter As Double, ByRef
YCenter As Double, ByRef diameter As Double, ByRef thickness As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing Pipe shape in the specified frame section property.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined Pipe property that has been imported from a section
property file. If it is the name of a defined Pipe property, the section dimensions are taken from
that property.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

diameter

The outer diameter of the Pipe. [L]

thickness

The wall thickness of the Pipe. [L]

## Remarks

This function retrieves property data for a Pipe shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example


Sub GetFrameSDPropPipe()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim PropName As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim diameter As Double
Dim thickness As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Pipe shape to new property
ret = SapModel.PropFrame.SDShape.SetPipe("SD1", "SH1", "A992Fy50", "", 0, -9, -1, 12, 1)

'get Pipe shape property data
ret = SapModel.PropFrame.SDShape.GetPipe("SD1", "SH1", MatProp, PropName, Color,
Xcenter, Ycenter, diameter, thickness)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetPipe


# GetPlate

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetPlate

## VB6 Procedure

Function GetPlate(ByVal Name As String, ByVal ShapeName As String, ByRef MatProp As
String, ByRef Color As Long, ByRef XCenter As Double, ByRef YCenter As Double, ByRef
thickness As Double, ByRef w As Double, ByRef Rotation As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing Plate shape in the specified frame section property.

MatProp

The name of the material property for the shape.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

thickness

The thickness of the plate. [L]

w

The width of the Plate. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]


## Remarks

This function retrieves property data for an Plate shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropPlate()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim thickness As Double
Dim w As Double
Dim Rotation As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Plate shape to new property
ret = SapModel.PropFrame.SDShape.SetPlate("SD1", "SH1", "A992Fy50", 0, -9, 0, -1, 2, 6)

'get Plate shape property data
ret = SapModel.PropFrame.SDShape.GetPlate("SD1", "SH1", MatProp, Color, Xcenter,
Ycenter, thickness, w, Rotation)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

## See Also

SetPlate

# GetPolygon

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetPolygon

## VB6 Procedure

Function GetPolygon(ByVal Name As String, ByVal ShapeName As String, ByRef MatProp As
String, ByRef SSOverwrite As String, ByRef NumberPoints As Long, ByRef X() As Double,
ByRef Y() As Double, ByRef Radius() As Double, ByRef Color As Long, ByRef Reinf As
Boolean, ByRef MatRebar As String) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing polygon shape in the specified frame section property.

MatProp

The name of the material property for the shape.

SSOverwrite

This is a blank string, Default, or the name of a defined stress-strain curve.

If this item is a blank string or Default, the shape stress-strain curve is based on the assigned
material property.

NumberPoints

The number of point coordinates used to define the polygon.

X

This is an array that contains the X-coordinates of the polygon points. [L]


### Y

This is an array that contains the Y-coordinates of the polygon points. [L]

Radius

This is an array that contains the radius to be applied at each of the polygon points. [L]

Color

The fill color assigned to the shape.

Reinf

This item is True when there is edge and corner reinforcing steel associated with the shape. The
MatProp item must refer to a concrete material for this item to be True.

MatRebar

The material property for the edge and corner reinforcing steel associated with the shape. This
item applies only when the MatProp item is a concrete material and the Reinf item is True.

## Remarks

This function retrieves property data for a polygon shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropPolygon()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MatProp As String
Dim SSOverwrite As String

Dim NumberPoints As Long

Dim NumberPointsGet As Long
Dim X() As Double
Dim Y() As Double
Dim Radius() As Double
Dim XGet() As Double
Dim YGet() As Double
Dim RadiusGet() As Double
Dim Color As Long
Dim Reinf As Boolean
Dim MatRebar As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, eMatType.eMatType_Rebar, , , , ,
eMatTypeRebar.eMatTypeRebar_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add polygon shape to new property
NumberPoints = 5
ReDim X(4)
ReDim Y(4)
ReDim Radius(4)
X(0) = -26
Y(0) = -26
Radius(0) = 0

X(1) = -20
Y(1) = -20
Radius(1) = 5
X(2) = -25
Y(2) = 15
Radius(2) = 0
X(3) = 20
Y(3) = 12
Radius(3) = 3
X(4) = 25
Y(4) = -15
Radius(4) = 0
ret = SapModel.PropFrame.SDShape.SetPolygon("SD1", "SH1", "4000Psi", "Default",
NumberPoints, X, Y, Radius, -1, True, Name)

'get polygon shape property data
ret = SapModel.PropFrame.SDShape.GetPolygon("SD1", "SH1", MatProp, SSOverwrite,
NumberPointsGet, XGet, YGet, RadiusGet, Color, Reinf, MatRebar)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.1.0.

## See Also

SetPolygon

# GetRefCircle

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetRefCircle

## VB6 Procedure

Function GetRefCircle(ByVal Name As String, ByVal ShapeName As String, ByRef XCenter As
Double, ByRef YCenter As Double, ByRef Diameter As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Diameter

The diameter of the circular shape. [L]


## Remarks

This function retrieves property data for a reference circle shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropRefCircle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim XCenter As Double
Dim YCenter As Double
Dim Diameter As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'add reference circle shape to new property
ret = SapModel.PropFrame.SDShape.SetRefCircle("SD1", "SH1", 5, 5, 120)

'get reference circle shape property data
ret = SapModel.PropFrame.SDShape.GetRefCircle("SD1", "SH1", XCenter, YCenter,
Diameter)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

## See Also

SetRefCircle

# GetRefLine

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetRefLine

## VB6 Procedure

Function GetRefLine(ByVal Name As String, ByVal ShapeName As String, ByRef X1 As
Double, ByRef Y1 As Double, ByRef X2 As Double, ByRef Y2 As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of a reference line shape in the section designer section.

X1

The section designer X coordinate of the first drawn end point of the line pattern reinforcing. [L]

Y1

The section designer Y coordinate of the first drawn end point of the line pattern reinforcing. [L]

X2

The section designer X coordinate of the second drawn end point of the line pattern reinforcing.
[L]

Y2

The section designer Y coordinate of the second drawn end point of the line pattern reinforcing.
[L]

## Remarks


This function retrieves property data for a reference line shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropRefLine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatRebar As String
Dim X1 As Double
Dim Y1 As Double
Dim X2 As Double
Dim Y2 As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000psi")

'add Line Pattern Reinforcing shape to new property
ret = SapModel.PropFrame.SDShape.SetRefLine("SD1", "SH1", 5, 5, 2, 2)

'get Reference Line shape property data
ret = SapModel.PropFrame.SDShape.GetRefLine("SD1", "SH1", X1, Y1, X2, Y2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.


## See Also

SetRefLine

# GetReinfCircle

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetReinfCircle

## VB6 Procedure

Function GetReinfCircle(ByVal Name As String, ByVal ShapeName As String, ByRef XCenter
As Double, ByRef YCenter As Double, ByRef Diameter As Double, ByRef Numberbars As Long,
ByRef Rotation As Double, ByRef RebarSize As String, ByRef MatRebar As String) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of a circular reinforcing shape in the section designer section.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Diameter

The diameter of the circular shape. [L]

NumberBars

The number of equally spaced bars for the circular reinforcing.

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Barsize

It is the size of the reinforcing bar.

MatRebar


The material property for the reinforcing steel.

## Remarks

This function retrieves property data for a circular reinforcing shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropReinfCircle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatRebar As String
Dim XCenter As Double
Dim YCenter As Double
Dim Diameter As Double
Dim Numberbars As Long
Dim Rotation As Double
Dim RebarSize As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'add circular reinforcing shape to new property
ret = SapModel.PropFrame.SDShape.SetReinfCircle("SD1", "SH1", 0, 0, 12, 4, 45, "#9",
Name)


'get circular reinforcing shape property data
ret = SapModel.PropFrame.SDShape.GetReinfCircle("SD1", "SH1", Xcenter, Ycenter,
Diameter, Numberbars, Rotation, RebarSize, MatRebar)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetReinfCircle

# GetReinfCorner

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetReinfCorner

## VB6 Procedure

Function GetReinfCorner(ByVal Name As String, ByVal ShapeName As String, ByRef
NumberItems As Long, ByRef PointNum() As Long, ByRef RebarSize() As String) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing solid rectangle shape in the specified frame section property.

NumberItems

The number of edges in the shape.

PointNum

This is an array that includes the corner point number in the shape.

RebarSize


This is an array that includes None or the name of a defined rebar, indicating the rebar assignment
to the considered corner point.

## Remarks

This function retrieves corner point reinforcing data for solid rectangle, circle and polygon shapes
in a section designer property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropReinfCorner()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberItems As Long
Dim PointNum() As Long
Dim RebarSize() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add solid rectangle shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidRect("SD1", "SH1", "4000Psi", "Default", 0, 0,
24, 16, 0, -1, True, Name)

'specify corner reinforcing
ret = SapModel.PropFrame.SDShape.SetReinfCorner("SD1", "SH1", 1, "#9", True)


ret = SapModel.PropFrame.SDShape.SetReinfCorner("SD1", "SH1", 1, "#8")

'get corner point reinforcing
ret = SapModel.PropFrame.SDShape.GetReinfCorner("SD1", "SH1", NumberItems,
PointNum, RebarSize)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetReinfCorner

SetReinfEdge

GetReinfEdge

# GetReinfEdge

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetReinfEdge

## VB6 Procedure

Function GetReinfEdge(ByVal Name As String, ByVal ShapeName As String, ByRef
NumberItems As Long, ByRef EdgeNum() As Long, ByRef RebarSize() As String, ByRef
Spacing() As Double, ByRef Cover() As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing solid rectangle shape in the specified frame section property.

NumberItems

The number of edges in the shape.


EdgeNum

This is an array that includes the edge number in the shape.

RebarSize

This is an array that includes None or the name of a defined rebar, indicating the rebar assignment
to the considered edge.

Spacing

This is an array that includes the rebar maximum center-to-center along the considered edge. [L]

Cover

This is an array that includes the rebar clear cover along the considered edge. [L]

## Remarks

This function retrieves edge reinforcing data for solid rectangle, circle, polygon, and rectangular
reinforcing shapes in a section designer property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropReinfEdge()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberItems As Long
Dim EdgeNum() As Long
Dim RebarSize() As String
Dim Spacing() As Double
Dim Cover() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add solid rectangle shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidRect("SD1", "SH1", "4000Psi", "Default", 0, 0,
24, 16, 0, -1, True, Name)

'specify edge reinforcing
ret = SapModel.PropFrame.SDShape.SetReinfEdge("SD1", "SH1", 1, "#7", 8, 1.75, True)
ret = SapModel.PropFrame.SDShape.SetReinfEdge("SD1", "SH1", 1, "#4", 4, 1.5)

'get edge reinforcing
ret = SapModel.PropFrame.SDShape.GetReinfEdge("SD1", "SH1", NumberItems, EdgeNum,
RebarSize, Spacing, Cover)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetReinfEdge

SetReinfCorner

GetReinfCorner

# GetReinfLine

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetReinfLine

## VB6 Procedure


Function GetReinfLine(ByVal Name As String, ByVal ShapeName As String, ByRef X1 As
Double, ByRef Y1 As Double, ByRef X2 As Double, ByRef Y2 As Double, ByRef Spacing As
Double, ByRef RebarSize As String, ByRef EndBars As Boolean, ByRef MatRebar As String) As
Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of a line reinforcing shape in the section designer section.

X1

The section designer X coordinate of the first drawn end point of the line reinforcing. [L]

Y1

The section designer Y coordinate of the first drawn end point of the line reinforcing. [L]

X2

The section designer X coordinate of the second drawn end point of the line reinforcing. [L]

Y2

The section designer Y coordinate of the second drawn end point of the line reinforcing. [L]

Spacing

The center-to-center spacing of the bars in the line pattern shape. [L]

Bar Size

The size of the reinforcing bars used in the line reinforcing shape.

EndBars

This item is True when there are bars at the end points of the line reinforcing.

MatRebar

The material property for the reinforcing steel.

## Remarks

This function retrieves property data for a line reinforcing shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetFrameSDPropReinfLine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatRebar As String
Dim X1 As Double
Dim Y1 As Double
Dim X2 As Double
Dim Y2 As Double
Dim Spacing As Double
Dim RebarSize As String
Dim EndBars As Boolean
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000psi")

'add line reinforcing shape to new property
ret = SapModel.PropFrame.SDShape.SetReinfLine("SD1", "SH1", 0, 0, 5, 2, 12, "#9", True,
Name)

'get line reinforcing shape property data
ret = SapModel.PropFrame.SDShape.GetReinfLine("SD1", "SH1", X1, Y1, X2, Y2, Spacing,
RebarSize, EndBars, MatRebar)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

## See Also

SetReinfLine

# GetReinfRectangular

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetReinfRectangular

## VB6 Procedure

Function GetReinfRectangular(ByVal Name As String, ByVal ShapeName As String, ByRef
XCenter As Double, ByRef YCenter As Double, ByRef h As Double, ByRef w As Double, ByRef
Rotation As Double, ByRef MatRebar As String) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of a rectangular reinforcing shape in the section designer section.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

h

The section depth. [L]

w

The top flange width. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]


MatRebar

The material property for the reinforcing steel.

## Remarks

This function retrieves property data for a rectangular reinforcing shape in a section designer
section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropReinfRectangular()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatRebar As String
Dim XCenter As Double
Dim YCenter As Double
Dim h As Double
Dim w As Double
Dim Rotation As Double
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000psi")

'add rectangular reinforcing shape to new property
ret = SapModel.PropFrame.SDShape.SetReinfRectangular("SD1", "SH1", 0, 0, 12, 12, 45,
Name)


'get rectangular reinforcing shape property data
ret = SapModel.PropFrame.SDShape.GetReinfRectangular("SD1", "SH1", Xcenter, Ycenter,
h, w, Rotation, MatRebar)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetReinfRectangular

# GetReinfSingle

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetReinfSingle

## VB6 Procedure

Function GetReinfSingle(ByVal Name As String, ByVal ShapeName As String, ByRef XCenter
As Double, ByRef YCenter As Double, ByRef RebarSize As String, ByRef MatRebar As String)
As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of a single bar reinforcing shape in the section designer section.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]


Barsize

The size of the reinforcing bar.

MatRebar

The material property for the reinforcing steel.

## Remarks

This function retrieves property data for a single bar reinforcing shape in a section designer
section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropReinfSingle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatRebar As String
Dim XCenter As Double
Dim YCenter As Double
Dim RebarSize As String
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000psi")

'add single bar reinforcing shape to new property


ret = SapModel.PropFrame.SDShape.SetReinfSingle("SD1", "SH1", 5, 5, "#9", Name)

'get single bar reinforcing shape property data
ret = SapModel.PropFrame.SDShape.GetReinfSingle("SD1", "SH1", XCenter, YCenter,
RebarSize, MatRebar)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetReinfSingle

# GetSolidCircle

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetSolidCircle

## VB6 Procedure

Function GetSolidCircle(ByVal Name As String, ByValShapeName As String, ByRefMatProp As
String, ByRefSSOverwrite As String, ByRef Color As Long, ByRefXCenter As Double,
ByRefYCenter As Double, Optional ByRefDiameter As Double, ByRefReinfAs Boolean,
ByRefNumberBarsAs Long = 8, ByRef Rotation As Double, ByRef Cover As Double,
ByRefRebarSize As String, ByRefMatRebar As String) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing solid circle shape in the specified frame section property.

MatProp

The name of the material property for the shape.

SSOverwrite


This is a blank string, Default, or the name of a defined stress-strain curve.

If this item is a blank string or Default, the shape stress-strain curve is based on the assigned
material property.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Diameter

The diameter of the circle.[L]

Reinf

This item is True when there is edge and corner reinforcing steel associated with the shape. The
MatProp item must refer to a concrete material for this item to be True.

# Bars

This item is visible only if the Reinforcing item is set to True. It is the number of equally spaced
bars for the circular reinforcing.

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Barcover

This item is visible only if the Reinforcing item is set to True. It is the clear cover for the specified
rebar.

Bar Size

This item is visible only if the Reinforcing item is set to True. It is the size of the reinforcing bar.

MatRebar

The material property for the edge and corner reinforcing steel associated with the shape. This
item applies only when the MatProp item is a concrete material and the Reinf item is True.

## Remarks

This function retrieves property data for a solid circle shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.


## VBA Example

Sub GetFrameSDPropSolidCircle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MatProp As String
Dim SSOverwrite As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim Diameter As Long
Dim Reinf As Boolean
Dim NumberBars As Long
Dim Rotation As Double
Dim Cover As Double
Dim RebarSize As String
Dim MatRebar As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'createSapModelobject
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'addASTMA706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'add solid circle shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidCircle("SD1", "SH1", "4000psi", "Default", 0,
0, 12, -1, True, 16, 0, 16, "#4", Name)

'get solid circle shape property data
ret = SapModel.PropFrame.SDShape.GetSolidCircle("SD1", "SH1", MatProp, SSOverwrite,
Color, XCenter, YCenter, Diameter, Reinf, NumberBars, Rotation, Cover, RebarSize, MatRebar)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetSolidCircle

# GetSolidRect

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetSolidRect

## VB6 Procedure

Function GetSolidRect(ByVal Name As String, ByVal ShapeName As String, ByRef MatProp As
String, ByRef SSOverwrite As String, ByRef Color As Long, ByRef XCenter As Double, ByRef
YCenter As Double, ByRef h As Double, ByRef w As Double, ByRef Rotation As Double, ByRef
Reinf As Boolean, ByRef MatRebar As String) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing solid rectangle shape in the specified frame section property.

MatProp

The name of the material property for the shape.

SSOverwrite

This is a blank string, Default, or the name of a defined stress-strain curve.

If this item is a blank string or Default, the shape stress-strain curve is based on the assigned
material property.

Color


The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

h

The section depth. [L]

w

The section width. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Reinf

This item is True when there is edge and corner reinforcing steel associated with the shape. The
MatProp item must refer to a concrete material for this item to be True.

MatRebar

The material property for the edge and corner reinforcing steel associated with the shape. This
item applies only when the MatProp item is a concrete material and the Reinf item is True.

## Remarks

This function retrieves property data for a solid rectangular shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropSolidRect()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MatProp As String
Dim SSOverwrite As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim h As Double


Dim w As Double
Dim Rotation As Double
Dim Reinf As Boolean
Dim MatRebar As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add solid rectangle shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidRect("SD1", "SH1", "4000Psi", "Default", 0, 0,
24, 16, 0, -1, True, Name)

'get solid rectangle shape property data
ret = SapModel.PropFrame.SDShape.GetSolidRect("SD1", "SH1", MatProp, SSOverwrite,
Color, Xcenter, Ycenter, h, w, Rotation, Reinf, MatRebar)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetSolidRect


# GetSolidSector

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetSolidSector

## VB6 Procedure

Function GetSolidSector(ByVal Name As String, ByValShapeName As String, ByRefMatProp As
String, ByRef Color As Long, ByRefXCenter As Double, ByRefYCenter As Double, ByRef
Angle As Double, ByRefRotation As Double, ByRef Radius As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing solid sector shape in the specified frame section property.

MatProp

The name of the material property for the shape.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Angle

The angle between the two radii that define the circular sector. [deg]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Radius

The radius of the circle defining the Sector. [L]


## Remarks

This function retrieves property data for a solid sector shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropSolidSector()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MatProp As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim Angle As Double
Dim Rotation As Double
Dim Radius As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'createSapModelobject
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'addASTMA706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'add solid sector shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidSector("SD1", "SH1", "4000Psi", 0, 0, 95, 0,
10, -1)

'get solid sector shape property data
ret = SapModel.PropFrame.SDShape.GetSolidSector("SD1", "SH1", MatProp, Color,
Xcenter, Ycenter, Angle, Rotation, Radius)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetSolidSector

# GetSolidSegment

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetSolidSegment

## VB6 Procedure

Function GetSolidSegment(ByVal Name As String, ByValShapeName As String, ByRefMatProp
As String, ByRef Color As Long, ByRefXCenter As Double, ByRefYCenter As Double, ByRef
Angle As Double, ByRefRotation As Double, ByRef Radius As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing solid segment shape in the specified frame section property.

MatProp

The name of the material property for the shape.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]


YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Angle

The angle between lines drawn from the center of the circle to the end points of the chord tat
defines the segment. [deg]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Radius

The radius of the circle defining the segment.

## Remarks

This function retrieves property data for a solid segment shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropSolidSegment()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MatProp As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim Angle As Double
Dim Rotation As Double
Dim Radius As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'createSapModelobject
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'add solid segment shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidSegment("SD1", "SH1", "4000Psi", 0, 0, 95, 0,
10, -1)

'get solid segment shape property data
ret = SapModel.PropFrame.SDShape.GetSolidSegment("SD1", "SH1", MatProp, Color,
Xcenter, Ycenter, Angle, Rotation, Radius)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetSolidSegment

# GetTee

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetTee

## VB6 Procedure

Function GetTee(ByVal Name As String, ByVal ShapeName As String, ByRef MatProp As
String, ByRef PropName As String, ByRef Color As Long, ByRef XCenter As Double, ByRef
YCenter As Double, ByRef h As Double, ByRef bf As Double, ByRef tf As Double, ByRef tw As
Double, ByRef Rotation As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName


The name of an existing Tee shape in the specified frame section property.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined Tee property that has been imported from a section
property file. If it is the name of a defined Tee property, the section dimensions are taken from
that property.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

h

The section depth. [L]

bf

The section width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

## Remarks

This function retrieves property data for a Tee shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example


Sub GetFrameSDPropTee()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim PropName As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim h As Double
Dim bf As Double
Dim tf As Double
Dim tw As Double
Dim Rotation As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Tee shape to new property
ret = SapModel.PropFrame.SDShape.SetTee("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1, 18,
6, 1, 0.5)

'get Tee shape property data
ret = SapModel.PropFrame.SDShape.GetTee("SD1", "SH1", MatProp, PropName, Color,
Xcenter, Ycenter, h, bf, tf, tw, Rotation)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.


## See Also

SetTee

# GetTube

## Syntax

SapObject.SapModel.PropFrame.SDShape.GetTube

## VB6 Procedure

Function GetTube(ByVal Name As String, ByVal ShapeName As String, ByRef MatProp As
String, ByRef PropName As String, ByRef Color As Long, ByRef XCenter As Double, ByRef
YCenter As Double, ByRef h As Double, ByRef w As Double, ByRef tf As Double, ByRef tw As
Double, ByRef Rotation As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing Tube shape in the specified frame section property.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined Tube property that has been imported from a
section property file. If it is the name of a defined Tube property, the section dimensions are taken
from that property.

Color

The fill color assigned to the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

h


The section height. [L]

w

The section width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

## Remarks

This function retrieves property data for a Tube shape in a section designer section.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetFrameSDPropTube()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim PropName As String
Dim Color As Long
Dim XCenter As Double
Dim YCenter As Double
Dim h As Double
Dim w As Double
Dim tf As Double
Dim tw As Double
Dim Rotation As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Tube shape to new property
ret = SapModel.PropFrame.SDShape.SetTube("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1,
18, 6, 1, 0.5)

'get Tube shape property data
ret = SapModel.PropFrame.SDShape.GetTube("SD1", "SH1", MatProp, PropName, Color,
Xcenter, Ycenter, h, w, tf, tw, Rotation)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

SetTube

# SetAngle

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetAngle

## VB6 Procedure

Function SetAngle(ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As
String, ByVal PropName As String, ByVal XCenter As Double, ByVal YCenter As Double,
ByVal Rotation As Double, Optional ByVal Color As Long = -1, Optional ByVal h As Double =
24, Optional ByVal bf As Double = 24, Optional ByVal tf As Double = 2.4, Optional ByVal tw
As Double = 2.4) As Long

## Parameters

Name


The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined Angle property that has been imported from a
section property file.

If this item is a blank string, the section dimensions are taken from the values input in this
function.

If this item is the name of a defined Angle property that has been imported from a section property
file, the section dimensions are taken from the specified Angle property.

If this item is not blank, and the specified property name is not an Angle that was imported from a
section property file, an error is returned.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

h

The section depth. [L]

bf

The flange width. [L]

tf

The flange thickness. [L]


tw

The web thickness. [L]

## Remarks

This function adds a new Angle shape or modifies an existing shape to be an Angle shape in a
section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Angle shape to new property
ret = SapModel.PropFrame.SDShape.SetAngle("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1,
18, 6, 1, 0.5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.


## See Also

GetAngle

# SetChannel

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetChannel

## VB6 Procedure

Function SetChannel (ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As
String, ByVal PropName As String, ByVal XCenter As Double, ByVal YCenter As Double,
ByVal Rotation As Double, Optional ByVal Color As Long = -1, Optional ByVal h As Double =
24, Optional ByVal bf As Double = 24, Optional ByVal tf As Double = 2.4, Optional ByVal tw
As Double = 2.4) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined Channel property that has been imported from a
section property file.

If this item is a blank string, the section dimensions are taken from the values input in this
function.

If this item is the name of a defined Channel property that has been imported from a section
property file, the section dimensions are taken from the specified Channel property.

If this item is not blank, and the specified property name is not an Channel that was imported from
a section property file, an error is returned.


XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

h

The section depth. [L]

bf

The flange width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

## Remarks

This function adds a new Channel shape or modifies an existing shape to be a Channel shape in a
section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropChannel()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Channel shape to new property
ret = SapModel.PropFrame.SDShape.SetChannel("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1,
18, 6, 1, 0.5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetChannel

# SetDblAngle

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetDblAngle

## VB6 Procedure

Function SetDblAngle(ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As
String, ByVal PropName As String, ByVal XCenter As Double, ByVal YCenter As Double,
ByVal Rotation As Double, Optional ByVal Color As Long = -1, Optional ByVal h As Double =
24, Optional ByVal w As Double = 24, Optional ByVal tf As Double = 2.4, Optional ByVal tw As
Double = 2.4, Optional ByVal dis As Double = 1.2) As Long

## Parameters


Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined DblAngle property that has been imported from a
section property file.

If this item is a blank string, the section dimensions are taken from the values input in this
function.

If this item is the name of a defined DblAngle property that has been imported from a section
property file, the section dimensions are taken from the specified DblAngle property.

If this item is not blank and the specified property name is not an DblAngle that was imported
from a section property file, an error is returned.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

h

The section depth. [L]

w

The flange width. [L]

tf


The flange thickness. [L]

tw

The web thickness. [L]

dis

Separation between the two flanges that are parallel. [L]

## Remarks

This function adds a new Double Angle shape or modifies an existing shape to be an Double
Angle shape in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropDblAngle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Double Angle shape to new property
ret = SapModel.PropFrame.SDShape.SetDblAngle("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -
1, 18, 6, 1, 0.5, 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetDblAngle

# SetISection

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetISection

## VB6 Procedure

Function SetISection(ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As
String, ByVal PropName As String, ByVal XCenter As Double, ByVal YCenter As Double,
ByVal Rotation As Double, Optional ByVal Color As Long = -1, Optional ByVal h As Double =
24, Optional ByVal bf As Double = 24, Optional ByVal tf As Double = 2.4, Optional ByVal tw
As Double = 2.4, Optional ByVal bfb As Double = 24, Optional ByVal tfb As Double = 2.4) As
Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined I-section property that has been imported from a
section property file.


If this item is a blank string, the section dimensions are taken from the values input in this
function.

If this item is the name of a defined I-section property that has been imported from a section
property file, the section dimensions are taken from the specified I-section property.

If this item is not blank, and the specified property name is not an I-section that was imported
from a section property file, an error is returned.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

h

The section depth. [L]

bf

The top flange width. [L]

tf

The top flange thickness. [L]

tw

The web thickness. [L]

bfb

The bottom flange width. [L]

tfb

The bottom flange thickness. [L]

## Remarks

This function adds a new I-section shape or modifies an existing shape to be an I-section shape in
a section designer property.


The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropISection()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add I-section shape to new property
ret = SapModel.PropFrame.SDShape.SetISection("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1,
18, 6, 1, 0.5, 6, 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetISection

# SetPipe


## Syntax

SapObject.SapModel.PropFrame.SDShape.SetPipe

## VB6 Procedure

Function SetPipe(ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As
String, ByVal PropName As String, ByVal XCenter As Double, ByVal YCenter As Double,
Optional ByVal Color As Long = -1, Optional ByVal diameter As Double = 24, Optional ByVal
thickness As Double = 2.4) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined Pipe property that has been imported from a section
property file.

If this item is a blank string, the section dimensions are taken from the values input in this
function.

If this item is the name of a defined Pipe property that has been imported from a section property
file, the section dimensions are taken from the specified Pipe property.

If this item is not blank and the specified property name is not a Pipe that was imported from a
section property file, an error is returned.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Color


The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

diameter

The outer diameter of the Pipe. [L]

thickness

The wall thickness of the Pipe. [L]

## Remarks

This function adds a new Pipe shape or modifies an existing shape to be a Pipe shape in a section
designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropPipe()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Pipe shape to new property
ret = SapModel.PropFrame.SDShape.SetPipe("SD1", "SH1", "A992Fy50", "", 0, -9, -1, 12, 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetPipe

# SetPlate

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetPlate

## VB6 Procedure

Function SetPlate(ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As
String, ByVal XCenter As Double, ByVal YCenter As Double, ByVal Rotation As Double,
Optional ByVal Color As Long = -1, Optional ByVal thickness As Double = 2.4, Optional ByVal
w As Double = 24) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,n
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]


Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

thickness

The thickness of the plate. [L]

w

The width of the Plate. [L]

## Remarks

This function adds a new Plate shape or modifies an existing shape to be a Plate shape in a section
designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropPlate()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Plate shape to new property


ret = SapModel.PropFrame.SDShape.SetPlate("SD1", "SH1", "A992Fy50", 0, -9, 0, -1, 2, 6)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetPlate

# SetPolygon

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetPolygon

## VB6 Procedure

Function SetPolygon(ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As
String, ByVal SSOverwrite As String, ByVal NumberPoints As Long, ByRef X() As Double,
ByRef Y() As Double, ByRef Radius() As Double, Optional ByVal Color As Long = -1, Optional
ByVal Reinf As Boolean = False, Optional ByVal MatRebar As String = "") As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

SSOverwrite


This is a blank string, Default, or the name of a defined stress-strain curve.

If this item is a blank string or Default, the shape stress-strain curve is based on the assigned
material property.

NumberPoints

The number of point coordinates used to define the polygon.

X

This is an array that contains the X-coordinates of the polygon points. [L]

Y

This is an array that contains the Y-coordinates of the polygon points. [L]

Radius

This is an array that contains the radius to be applied at each of the polygon points. [L]

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

Reinf

This item is True when there is edge and corner reinforcing steel associated with the shape.

If the MatProp item is not a concrete material, this item is always assumed to be False.

MatRebar

The material property for the edge and corner reinforcing steel associated with the shape. This
item applies only when the MatProp item is a concrete material and the Reinf item is True.

## Remarks

This function adds a new polygon shape or modifies an existing shape to be a polygon shape in a
section designer property.

The polygon points must be defined in order around the polygon, otherwise the shape will be
created incorrectly or the creation of the shape will fail.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero val.

## VBA Example

Sub SetFrameSDPropPolygon()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim Name As String

Dim NumberPoints As Long

Dim X() As Double

Dim Y() As Double

Dim Radius() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, eMatType.eMatType_Rebar, , , , ,
eMatTypeRebar.eMatTypeRebar_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add polygon shape to new property
NumberPoints = 5
ReDim X(4)
ReDim Y(4)
ReDim Radius(4)
X(0) = -26
Y(0) = -26
Radius(0) = 0

X(1) = -20
Y(1) = -20
Radius(1) = 5
X(2) = -25
Y(2) = 15
Radius(2) = 0
X(3) = 20
Y(3) = 12
Radius(3) = 3
X(4) = 25
Y(4) = -15


Radius(4) = 0
ret = SapModel.PropFrame.SDShape.SetPolygon("SD1", "SH1", "4000Psi", "Default",
NumberPoints, X, Y, Radius, -1, True, Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 19.1.0.

## See Also

GetPolygon

# SetRefCircle

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetRefCircle

## VB6 Procedure

Function SetRefCircle(ByVal Name As String, ByRef ShapeName As String, ByVal XCenter As
Double, ByVal YCenter As Double, ByVal Diameter As Double)As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter


The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Diameter

The diameter of the circular shape. [L]

## Remarks

This function adds a new reference circle shape or modifies an existing shape to be a reference
circle shape in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropRefCircle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'add reference circle shape to new property
ret = SapModel.PropFrame.SDShape.SetRefCircle("SD1", "SH1", 0, 0, 12)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

## See Also

GetRefCircle

# SetRefLine

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetRefLine

## VB6 Procedure

Function SetRefLine(ByVal Name As String, ByRef ShapeName As String, ByVal X1 As
Double, ByVal Y1 As Double, ByVal X2 As Double, ByVal Y2 As Double) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

X1

The section designer X coordinate of the first drawn end point of the line pattern reinforcing. [L]

Y1

The section designer Y coordinate of the first drawn end point of the line pattern reinforcing. [L]

X2

The section designer X coordinate of the second drawn end point of the line pattern reinforcing.
[L]

Y2

The section designer Y coordinate of the second drawn end point of the line pattern reinforcing.
[L]


## Remarks

This function adds a new reference line shape or modifies an existing shape to be a reference line
shape in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropRefLine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000psi")

'add Line Pattern Reinforcing shape to new property
ret = SapModel.PropFrame.SDShape.SetRefLine("SD1", "SH1", 5, 5, 2, 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also


GetRefLine

# SetReinfCircle

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetReinfCircle

## VB6 Procedure

Function SetReinfCircle(ByVal Name As String, ByRef ShapeName As String, ByVal XCenter
As Double, ByVal YCenter As Double, ByVal Diameter As Double, ByVal Numberbars As Long,
ByVal Rotation As Double, ByVal RebarSize As Double, Optional ByVal MatRebar As String =
"") As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Diameter

The diameter of the circular shape. [L]

NumberBars

The number of equally spaced bars for the circular reinforcing.

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Barsize

It is the size of the reinforcing bar.


MatRebar

The material property for the reinforcing steel.

## Remarks

This function adds a new circular reinforcing shape or modifies an existing shape to be an circular
reinforcing shape in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropReinfCircle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'add circular reinforcing shape to new property
ret = SapModel.PropFrame.SDShape.SetReinfCircle("SD1", "SH1", 0, 0, 12, 4, 45, "#9",
Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

## See Also

GetReinfCircle

# SetReinfCorner

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetReinfCorner

## VB6 Procedure

Function SetReinfCorner(ByVal Name As String, ByRef ShapeName As String, ByVal PointNum
As Long, ByVal RebarSize As String, Optional ByVal All As Boolean = False) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing solid rectangle, circle or polygon shape in the specified section.

PointNum

An corner point number in the shape. This item is ignored if the All item is True.

RebarSize

This is None or the name of a defined rebar, indicating the rebar assignment to the specified
corner.

All

If this item is True, the specified rebar data applies to all corners in the shape.

## Remarks

This function specifies corner reinforcing in solid rectangle, circle and polygon shapes in a section
designer property.

The function returns zero if the reinforcing is successfully specified; otherwise it returns a nonzero
value.


## VBA Example

Sub SetFrameSDPropReinfCorner()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add solid rectangle shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidRect("SD1", "SH1", "4000Psi", "Default", 0, 0,
24, 16, 0, -1, True, Name)

'specify corner reinforcing
ret = SapModel.PropFrame.SDShape.SetReinfCorner("SD1", "SH1", 1, "#9", True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetReinfCorner


SetReinfEdge

GetReinfEdge

# SetReinfEdge

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetReinfEdge

## VB6 Procedure

Function SetReinfEdge(ByVal Name As String, ByRef ShapeName As String, ByVal EdgeNum
As Long, ByVal RebarSize As String, ByVal Spacing As Double, ByVal Cover As Double,
Optional ByVal All As Boolean = False) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing solid rectangle, circle or polygon shape in the specified section.

EdgeNum

An edge number in the shape. This item is ignored if the All item is True.

RebarSize

This is None or the name of a defined rebar, indicating the rebar assignment to the specified edge.

Spacing

This is the rebar maximum center-to-center along the specified edge. [L]

Cover

This is the rebar clear cover along the specified edge. [L]

All

If this item is True, the specified rebar data applies to all edges in the shape.

## Remarks

This function specifies edge reinforcing in solid rectangle, circle, polygon and rectangular
reinforcing shapes in a section designer property.


The function returns zero if the reinforcing is successfully specified; otherwise it returns a nonzero
value.

## VBA Example

Sub SetFrameSDPropReinfEdge()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add solid rectangle shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidRect("SD1", "SH1", "4000Psi", "Default", 0, 0,
24, 16, 0, -1, True, Name)

'specify edge reinforcing
ret = SapModel.PropFrame.SDShape.SetReinfEdge("SD1", "SH1", 1, "#7", 8, 1.75, True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.


## See Also

GetReinfEdge

SetReinfCorner

GetReinfCorner

# SetReinfLine

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetReinfLine

## VB6 Procedure

Function SetReinfLine(ByVal Name As String, ByRef ShapeName As String, ByVal X1 As
Double, ByVal Y1 As Double, ByVal X2 As Double, ByVal Y2 As Double, Optional ByVal
Spacing As Double = 6, Optional ByVal RebarSize As String = "", Optional ByVal EndBars As
Boolean = False, ByVal MatRebar As String) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

X1

The section designer X coordinate of the first drawn end point of the line reinforcing. [L]

Y1

The section designer Y coordinate of the first drawn end point of the line reinforcing. [L]

X2

The section designer X coordinate of the second drawn end point of the line reinforcing. [L]

Y2

The section designer Y coordinate of the second drawn end point of the line reinforcing. [L]


Spacing

The center-to-center spacing of the bars in the line pattern shape. [L]

Bar Size

The size of the reinforcing bars used in the line reinforcing shape.

EndBars

This item is True when there are bars at the end points of the line reinforcing.

MatRebar

The material property for the reinforcing steel.

## Remarks

This function adds a new line reinforcing shape or modifies an existing shape to be a line
reinforcing shape in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropReinfLine()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)


'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000psi")

'add Line Pattern Reinforcing shape to new property
ret = SapModel.PropFrame.SDShape.SetReinfLine("SD1", "SH1", 0, 0, 5, 2, 12, "#9", True,
Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetReinfLine

# SetReinfRectangular

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetReinfRectangular

## VB6 Procedure

Function SetReinfRectangular(ByVal Name As String, ByRef ShapeName As String, ByVal
XCenter As Double, ByVal YCenter As Double, ByVal h As Double, ByVal Rotation As Double,
ByVal w As Double, Optional ByVal MatRebar As String = "") As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

XCenter


The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

h

The section depth. [L]

w

The top flange width. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

MatRebar

The material property for the reinforcing steel.

## Remarks

This function adds a new rectangular reinforcing shape or modifies an existing shape to be a
rectangular reinforcing shape in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropReinfRectangular()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000psi")

'add rectangular reinforcing shape to new property
ret = SapModel.PropFrame.SDShape.SetReinfRectangular("SD1", "SH1", 0, 0, 12, 12, 45,
Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

Moved Rotation to after the width, w, in version 25.0.0

## See Also

GetReinfRectangular

# SetReinfSingle

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetReinfSingle

## VB6 Procedure

Function SetReinfSingle(ByVal Name As String, ByRef ShapeName As String, ByVal XCenter
As Double, ByVal YCenter As Double, Optional ByVal RebarSize As String = "", Optional
ByRef MatRebar As String = "") As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName


The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Barsize

It is the size of the reinforcing bar.

MatRebar

The material property for the reinforcing steel.

## Remarks

This function adds a new single bar reinforcing shape or modifies an existing shape to be a single
bar reinforcing shape in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropReinfSingle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000psi")

'add single bar reinforcing shape to new property
ret = SapModel.PropFrame.SDShape.SetReinfSingle("SD1", "SH1", 5, 5, "#9", Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetReinfSingle

# SetSolidCircle

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetSolidCircle

## VB6 Procedure

Function SetSolidCircle(ByVal Name As String, ByRefShapeNameAs String, ByValMatProp As
String, ByValSSOverwrite As String, ByValXCenter As Double, ByValYCenter As Double,
Optional ByVal diameter As Double = 24, Optional ByVal color As Long = -1, Optional
ByValReinf As Boolean = False, Optional ByValNumberBars As Long = 8, Option ByVal
Rotation As Double = 22.5, Optional ByVal Cover As Double = 2, Optional ByValRebarSize As
String = "", Optional ByValMatRebar As String = "") As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName


The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

SSOverwrite

This is a blank string, Default, or the name of a defined stress-strain curve.

If this item is a blank string or Default, the shape stress-strain curve is based on the assigned
material property.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Diameter

The diameter of the circle.[L]

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

Reinf

This item is True when there is edge and corner reinforcing steel associated with the shape.

If the MatProp item is not a concrete material, this item is always assumed to be False.

# Bars

This item is visible only if the Reinforcing item is set to True. It is the number of equally spaced
bars for the circular reinforcing.

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Bar Cover

This item is visible only if the Reinforcing item is set to True. It is the clear cover for the
specified rebar. [L]

Barsize


This item is visible only if the Reinforcing item is set to True. It is the size of the reinforcing bar.

MatRebar

The material property for the edge and corner reinforcing steel associated with the shape. This
item applies only when the MatProp item is a concrete material and the Reinf item is True.

## Remarks

This function adds a new solid circle shape or modifies an existing shape to be a solid circle shape
in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropSolidCircle()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'createSapModelobject
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'addASTMA706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'add solid circle shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidCircle("SD1", "SH1", "4000psi", "Default", 0,
0, 12, -1, True, 16, 0, 16, "#4", Name)

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetSolidCircle

# SetSolidRect

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetSolidRect

## VB6 Procedure

Function SetSolidRect(ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As
String, ByVal SSOverwrite As String, ByVal XCenter As Double, ByVal YCenter As Double,
ByVal h As Double, ByVal w As Double, ByVal Rotation As Double, Optional ByVal color As
Long = -1, Optional ByVal Reinf As Boolean = False, Optional ByVal MatRebar As String = "")
As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

SSOverwrite

This is a blank string, Default, or the name of a defined stress-strain curve.


If this item is a blank string or Default, the shape stress-strain curve is based on the assigned
material property.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

h

The section depth. [L]

w

The section width. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

Reinf

This item is True when there is edge and corner reinforcing steel associated with the shape.

If the MatProp item is not a concrete material, this item is always assumed to be False.

MatRebar

The material property for the edge and corner reinforcing steel associated with the shape. This
item applies only when the MatProp item is a concrete material and the Reinf item is True.

## Remarks

This function adds a new solid rectangle shape or modifies an existing shape to be an solid
rectangle shape in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.


## VBA Example

Sub SetFrameSDPropSolidRect()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add solid rectangle shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidRect("SD1", "SH1", "4000Psi", "Default", 0, 0,
24, 16, 0, -1, True, Name)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetSolidRect


# SetSolidSector

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetSolidSector

## VB6 Procedure

Function SetSolidSector(ByVal Name As String, ByRefShapeName As String, ByValMatProp As
String, ByValXCenter As Double, ByValYCenter As Double, ByVal Angle As Double, ByVal
Rotation As Double, ByValRadius As Double, Optional ByVal Color As Long = -1) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Angle

The angle between the two radii that define the circular sector. [deg]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Radius

The radius of the circle defining the Sector. [L]

Color


The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

## Remarks

This function adds a new solid sector shape or modifies an existing shape to be a solid sector
shape in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropSolidSector()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'createSapModelobject
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'addASTMA706 rebar material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , ,
MATERIAL_REBAR_SUBTYPE_ASTM_A706)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'add solid sector shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidSector("SD1", "SH1", "4000Psi", 0, 0, 95, 0,
10, -1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

## See Also

GetSolidSector

# SetSolidSegment

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetSolidSegment

## VB6 Procedure

Function SetSolidSegment(ByVal Name As String, ByRefShapeName As String, ByValMatProp
As String, ByValXCenter As Double, ByValYCenter As Double, ByVal Angle As Double, ByVal
Rotation As Double, ByValRadius as Double, Optional ByVal Color As Long = -1) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Angle

The angle between lines drawn from the center of the circle to the end points of the chord tat
defines the segment. [deg]


Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Radius

The radius of the circle defining the segment.

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

## Remarks

This function adds a new solid segment shape or modifies an existing shape to be a solid segment
shape in a section designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropSolidSegment()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'createSapModelobject
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "4000Psi")

'add solid segment shape to new property
ret = SapModel.PropFrame.SDShape.SetSolidSegment("SD1", "SH1", "4000Psi", 0, 0, 95, 0,
10, -1)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetSolidSegment

# SetTee

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetTee

## VB6 Procedure

Function SetTee(ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As
String, ByVal PropName As String, ByVal XCenter As Double, ByVal YCenter As Double,
ByVal Rotation As Double, Optional ByVal Color As Long = -1, Optional ByVal h As Double =
24, Optional ByVal bf As Double = 24, Optional ByVal tf As Double = 2.4, Optional ByVal tw
As Double = 2.4) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

PropName


This is a blank string or the name of a defined Tee property that has been imported from a section
property file.

If this item is a blank string, the section dimensions are taken from the values input in this
function.

If this item is the name of a defined Tee property that has been imported from a section property
file, the section dimensions are taken from the specified Tee property.

If this item is not blank, and the specified property name is not a Tee that was imported from a
section property file, an error is returned.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Color

The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

h

The section depth. [L]

bf

The section width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

## Remarks

This function adds a new Tee shape or modifies an existing shape to be a Tee shape in a section
designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.


## VBA Example

Sub SetFrameSDPropTee()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")

'add Tee shape to new property
ret = SapModel.PropFrame.SDShape.SetTee("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1, 18,
6, 1, 0.5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetTee

# SetTube

## Syntax

SapObject.SapModel.PropFrame.SDShape.SetTube


## VB6 Procedure

Function SetTube(ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As
String, ByVal PropName As String, ByVal XCenter As Double, ByVal YCenter As Double,
ByVal Rotation As Double, Optional ByVal Color As Long = -1, Optional ByVal h As Double =
24, Optional ByVal w As Double = 24, Optional ByVal tf As Double = 2.4, Optional ByVal tw As
Double = 2.4) As Long

## Parameters

Name

The name of an existing frame section property that is a section designer section.

ShapeName

The name of an existing or new shape in a section designer property. If this is an existing shape,
that shape is modified; otherwise, a new shape is added.

This item may be input as a blank string, in which case the program will assign a shape name to
the shape and return that name in the ShapeName variable.

MatProp

The name of the material property for the shape.

PropName

This is a blank string or the name of a defined Tube property that has been imported from a
section property file.

If this item is a blank string, the section dimensions are taken from the values input in this
function.

If this item is the name of a defined Tube property that has been imported from a section property
file, the section dimensions are taken from the specified Tube property.

If this item is not blank and the specified property name is not an Tube that was imported from a
section property file, an error is returned.

XCenter

The X-coordinate of the center of the shape in the section designer coordinate system. [L]

YCenter

The Y-coordinate of the center of the shape in the section designer coordinate system. [L]

Rotation

The counter clockwise rotation of the shape from its default orientation. [deg]

Color


The fill color assigned to the shape. If Color is specified as -1, the program will automatically
assign the default fill color.

h

The section height. [L]

w

The section width. [L]

tf

The flange thickness. [L]

tw

The web thickness. [L]

## Remarks

This function adds a new Tube shape or modifies an existing shape to be a Tube shape in a section
designer property.

The function returns zero if the shape is successfully added or modified; otherwise it returns a
nonzero value.

## VBA Example

Sub SetFrameSDPropTube()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add new section designer frame section property
ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")


'add Tube shape to new property
ret = SapModel.PropFrame.SDShape.SetTube("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1,
18, 6, 1, 0.5)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

## See Also

GetTube

# AddMaterial

## Syntax

SapObject.SapModel.PropMaterial.AddMaterial

## VB6 Procedure

Function AddMaterial(ByRef Name As String, ByVal MatType As eMatType, ByVal Region As
String, ByVal Standard As String, ByVal Grade As String, Optional ByVal UserName As String =
"") As Long

## Parameters

Name

This item is returned by the program. It is the name that the program ultimately assigns for the
material property. If no UserName is specified, the program assigns a default name to the material
property. If a UserName is specified and that name is not used for another material property, the
UserName is assigned to the material property.

MatType

This is one of the following items in the eMatType enumeration.

```
eMatType_Steel = 1
eMatType_Concrete = 2
eMatType_NoDesign = 3
eMatType_Aluminum = 4
eMatType_ColdFormed = 5
eMatType_Rebar = 6
```

```
eMatType_Tendon = 7
```
Region

The region name of the material property that is user-predefined in the file
"CSiMaterialLibrary*.xml" located in subfolder "Property Libraries" under the CSiBridge
installation.

Standard

The Standard name of the material property with the specified MatType within the specified
region.

Grade

The Grade name of the material property with the specified MatType within the specified region
and Standard.

UserName

This is an optional user specified name for the material property. If a UserName is specified and
that name is already used for another material property, the program ignores the UserName.

## Remarks

This function adds a new material property to the model based on the Code-specified and other pre
-defined material properties defined in the installed file "CSiMaterialLibrary*.xml" located in
subfolder "Property Libraries" under the CSiBridge installation folder.

The function returns zero if the material property is successfully added, otherwise it returns a
nonzero value.

## VBA Example

Sub AddMaterial()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add ASTM A706 rebar material property in United states Region
ret = SapModel.PropMaterial.AddMaterial(Name, eMatType_Rebar, "United States", "ASTM
A706", "Grade 60")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Updated the documentation of the eMatType enumeration in v22.1.0

Initial release in version 15.2.0.

The function supersedes AddQuick as of version 15.2.0.

# ChangeName

## Syntax

SapObject.SapModel.PropMaterial.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined material property.

NewName

The new name for the material property.

## Remarks

This function changes the name of an existing material property.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.


## VBA Example

Sub ChangeMaterialName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'change name of material property
ret = SapModel.PropMaterial.ChangeName("4000Psi", "MatConc")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# Count

## Syntax

SapObject.SapModel.PropMaterial.Count

## VB6 Procedure

Function Count(Optional ByVal MatType As eMatType) As Long


## Parameters

MatType

This optional value is one of the following items in the eMatType enumeration.

```
eMatType_Steel = 1
eMatType_Concrete = 2
eMatType_NoDesign = 3
eMatType_Aluminum = 4
eMatType_ColdFormed = 5
eMatType_Rebar = 6
eMatType_Tendon = 7
```
If no value is input for MatType, a count is returned for all material properties in the model
regardless of type.

## Remarks

This function returns the total number of defined material properties in the model. If desired,
counts can be returned for all material properties of a specified type in the model.

## VBA Example

Sub CountMaterials()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'return number of defined materials of all types
Count = SapModel.PropMaterial.Count

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Updated the documentation of the eMatType enumeration in v22.1.0

Initial release in version 11.02.

## See Also

# Delete

## Syntax

SapObject.SapModel.PropMaterial.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing material property.

## Remarks

The function deletes a specified material property.

The function returns zero if the material property is successfully deleted; otherwise it returns a
nonzero value. It returns an error if the specified material property can not be deleted, for example,
if it is being used in a section property.

## VBA Example

Sub DeleteMaterial()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'delete material
ret = SapModel.PropMaterial.Delete("4000Psi")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# GetCoupledModelType

## Syntax

SapObject.SapModel.PropMaterial.GetCoupledModelType

## VB6 Procedure

Function GetCoupledModelType(ByVal Name As String, ByRef MatCoupledType As
eMatCoupledType, Optional ByVal Temp As Double = 0.0) As Long

## Parameters

Name

The name of an existing material property.

MatCoupledType

This is one of the following items in the eMatCoupledType enumeration.


```
None = 1
VonMisesPlasticity = 2
ModifiedDarwinPecknoldConcrete = 3
```
Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the nonlinear coupled modeling type for a specified material

The function returns zero if the assignment data is successfully obtained; otherwise it returns a
nonzero value.

## VBA Example

Sub GetMatCoupledTypeData()

'dimension variables

Dim SapObject as cOAPI

Dim SapModel As cSapModel

Dim ret As Long

Dim MatCoupledType As eMatCoupledType

'create Sap2000 object

Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application

SapObject.ApplicationStart

'create SapModel object

Set SapModel = SapObject.SapModel


'initialize model

ret = SapModel.InitializeNewModel

'create model from template

ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property

ret = SapModel.PropMaterial.SetMaterial("Steel", eMatType.eMatType_Steel, -1, "API
example test", "Default")

'get coupled material type data

ret = SapModel.PropMaterial.GetCoupledModelType("Steel", MatCoupledType)

'close Sap2000

SapObject.ApplicationExit False

Set SapModel = Nothing

Set SapObject = Nothing

End Sub

## Release Notes

Initial release in version 22.1.0

## See Also

SetCoupledModelType

# GetDamping

## Syntax

SapObject.SapModel.PropMaterial.GetDamping


## VB6 Procedure

Function GetDamping(ByVal Name As String, ByRef ModalRatio As Double, ByRef
ViscousMassCoeff As Double, ByRef ViscousStiffCoeff As Double, ByRef HystereticMassCoeff
As Double, ByRef HystereticStiffCoeff As Double, Optional ByVal Temp As Double = 0) As
Long

## Parameters

Name

The name of an existing material property.

ModalRatio

The modal damping ratio.

ViscousMassCoeff

The mass coefficient for viscous proportional damping.

ViscousStiffCoeff

The stiffness coefficient for viscous proportional damping.

HystereticMassCoeff

The mass coefficient for hysteretic proportional damping.

HystereticStiffCoeff

The stiffness coefficient for hysteretic proportional damping.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been previously defined for the material.

## Remarks

This function retrieves the additional material damping data for the material.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetMatPropDamping()
'dimension variables
Dim SapObject as cOAPI


Dim SapModel As cSapModel
Dim ret As Long
Dim ModalRatio As Double
Dim ViscousMassCoeff As Double
Dim ViscousStiffCoeff As Double
Dim HystereticMassCoeff As Double
Dim HystereticStiffCoeff As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Conc", MATERIAL_CONCRETE)

'assign material damping data
ret = SapModel.PropMaterial.SetDamping("Conc", 0.04, 0, 0, 0, 0)

'get material damping data
ret = SapModel.PropMaterial.GetDamping("Conc", ModalRatio, ViscousMassCoeff,
ViscousStiffCoeff, HystereticMassCoeff, HystereticStiffCoeff)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.03.

## See Also

SetDamping


# GetMaterial

## Syntax

SapObject.SapModel.PropMaterial.GetMaterial

## VB6 Procedure

Function GetMaterial(ByVal Name As String, ByRef MatType As eMatType, ByRef Color As
Long, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing material property.

MatType

This is one of the following items in the eMatType enumeration.

```
eMatType_Steel = 1
eMatType_Concrete = 2
eMatType_NoDesign = 3
eMatType_Aluminum = 4
eMatType_ColdFormed = 5
eMatType_Rebar = 6
eMatType_Tendon = 7
```
Color

The display color assigned to the material.

Notes

The notes, if any, assigned to the material.

GUID

The GUID (global unique identifier), if any, assigned to the material.

## Remarks

This function retrieves some basic material property data.

The function returns zero if the material is successfully retrieved; otherwise it returns a nonzero
value.

## VBA Example


Sub GetBasicMatPropData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatType As eMatType
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", eMatType_Steel, -1, "API example test",
"Default")

'get basic material property data
ret = SapModel.PropMaterial.GetMaterial("Steel", MatType, Color, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Updated the documentation of the eMatType enumeration in v22.1.0

Initial release in version 11.02.

## See Also

SetMaterial

# GetMPAnisotropic


## Syntax

SapObject.SapModel.PropMaterial.GetMPAnisotropic

## VB6 Procedure

Function GetMPAnisotropic(ByVal Name As String, ByRef e As Double, ByRef u As Double,
ByRef a As Double, ByRef g As Double, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing material property.

e

This is an array that includes the modulus of elasticity.

```
e(0) = E1 [F/L^2 ]
e(1) = E2 [F/L^2 ]
e(2) = E3 [F/L^2 ]
```
u

This is an array that includes poisson’s ratio.

```
u(0) = U12
u(1) = U13
u(2) = U23
u(3) = U14
u(4) = U24
u(5) = U34
u(6) = U15
u(7) = U25
u(8) = U35
u(9) = U45
u(10) = U16
u(11) = U26
u(12) = U36
u(13) = U46
u(14) = U56
```
a

This is an array that includes the thermal coefficient.

```
a(0) = A1 [1/T]
a(1) = A2 [1/T]
a(2) = A3 [1/T]
a(3) = A12 [1/T]
a(4) = A13 [1/T]
```

```
a(5) = A23 [1/T]
```
g

This is an array that includes the shear modulus.

```
g(0) = G12 [F/L^2 ]
g(1) = G13 [F/L^2 ]
g(2) = G23 [F/L^2 ]
```
Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been previously defined for the material.

## Remarks

This function retrieves the mechanical properties for a material with an anisotropic directional
symmetry type.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the symmetry type of the specified material is not anisotropic.

## VBA Example

Sub GetMatPropAnisotropic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyE() As Double
Dim MyU() As Double
Dim MyA() As Double
Dim MyG() As Double
Dim e() As Double
Dim u() As Double
Dim a() As Double
Dim g() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign anisotropic mechanical properties
ReDim MyE(2)
ReDim MyU(14)
ReDim MyA(6)
ReDim MyG(2)
MyE(0)=30000
MyE(1)=10000
MyE(2)=2000
MyU(0)=0.2
MyU(1)=0.05
MyU(2)=0.1
MyU(3)=0
MyU(4)=0
MyU(5)=0
MyU(6)=0
MyU(7)=0
MyU(8)=0.01
MyU(9)=0
MyU(10)=0
MyU(11)=0
MyU(12)=0
MyU(13)=0
MyU(14)=0
MyA(0)=6.5E-6
MyA(1)=6.5E-6
MyA(2)=6.5E-6
MyA(3)=6.5E-6
MyA(4)=6.5E-6
MyA(5)=6.5E-6
MyG(0)=1500
MyG(1)=2500
MyG(2)=8700
ret = SapModel.PropMaterial.SetMPAnisotropic("Steel", MyE, MyU, MyA, MyG)

'get anisotropic mechanical properties
ret = SapModel.PropMaterial.GetMPAnisotropic("Steel", e, u, a, g)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

SetMPAnisotropic

# GetMPIsotropic

## Syntax

SapObject.SapModel.PropMaterial.GetMPIsotropic

## VB6 Procedure

Function GetMPIsotropic(ByVal Name As String, ByRef e As Double, ByRef u As Double,
ByRef a As Double, ByRef g As Double, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing material property.

e

The modulus of elasticity. [F/L^2 ]

u

Poisson’s ratio.

a

The thermal coefficient. [1/T]

g

The shear modulus. For isotropic materials this value is program calculated from the modulus of
elasticity and poisson’s ratio. [F/L^2 ]

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.


## Remarks

This function retrieves the mechanical properties for a material with an isotropic directional
symmetry type.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the symmetry type of the specified material is not isotropic.

## VBA Example

Sub GetMatPropIsotropic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim e As Double
Dim u As Double
Dim a As Double
Dim g As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign isotropic mechanical properties
ret = SapModel.PropMaterial.SetMPIsotropic("Steel", 29500, 0.25, 6E-06)

'get isotropic mechanical properties
ret = SapModel.PropMaterial.GetMPIsotropic("Steel", e, u, a, g)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

SetMPIsotropic

# GetMPOrthotropic

## Syntax

SapObject.SapModel.PropMaterial.GetMPOrthotropic

## VB6 Procedure

Function GetMPOrthotropic(ByVal Name As String, ByRef e As Double, ByRef u As Double,
ByRef a As Double, ByRef g As Double, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing material property.

e

This is an array that includes the modulus of elasticity.

```
e(0) = E1 [F/L^2 ]
e(1) = E2 [F/L^2 ]
e(2) = E3 [F/L^2 ]
```
u

This is an array that includes poisson’s ratio.

```
u(0) = U12
u(1) = U13
u(2) = U23
```
a

This is an array that includes the thermal coefficient.

```
a(0) = A1 [1/T]
a(1) = A2 [1/T]
a(2) = A3 [1/T]
```

g

This is an array that includes the shear modulus.

```
g(0) = G12 [F/L^2 ]
g(1) = G13 [F/L^2 ]
g(2) = G23 [F/L^2 ]
```
Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the mechanical properties for a material with an orthotropic directional
symmetry type.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the symmetry type of the specified material is not orthotropic.

## VBA Example

Sub GetMatPropOrthotropic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyE() As Double
Dim MyU() As Double
Dim MyA() As Double
Dim MyG() As Double
Dim e() As Double
Dim u() As Double
Dim a() As Double
Dim g() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign orthotropic mechanical properties
ReDim MyE(2)
ReDim MyU(2)
ReDim MyA(2)
ReDim MyG(2)
MyE(0)=30000
MyE(1)=10000
MyE(2)=2000
MyU(0)=0.2
MyU(1)=0.05
MyU(2)=0.1
MyA(0)=6.5E-6
MyA(1)=6.5E-6
MyA(2)=6.5E-6
MyG(0)=1500
MyG(1)=2500
MyG(2)=8700
ret = SapModel.PropMaterial.SetMPOrthotropic("Steel", MyE, MyU, MyA, MyG)

'get orthotropic mechanical properties
ret = SapModel.PropMaterial.GetMPOrthotropic("Steel", e, u, a, g)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetMPOrthotropic

# GetMPUniaxial

## Syntax

SapObject.SapModel.PropMaterial.GetMPUniaxial


## VB6 Procedure

Function GetMPUniaxial(ByVal Name As String, ByRef e As Double, ByRef a As Double,
Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing material property.

e

The modulus of elasticity. [F/L^2 ]

a

The thermal coefficient. [1/T]

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been previously defined for the material.

## Remarks

This function retrieves the mechanical properties for a material with a uniaxial directional
symmetry type.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the symmetry type of the specified material is not uniaxial.

## VBA Example

Sub GetMatPropUniaxial()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim e As Double
Dim a As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Rebar", MATERIAL_REBAR)

'assign uniaxial mechanical properties
ret = SapModel.PropMaterial.SetMPUniaxial("Rebar", 28500, 6E-06)

'get uniaxial mechanical properties
ret = SapModel.PropMaterial.GetMPUniaxial("Rebar", e, a)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetMPUniaxial

# GetNameList

## Syntax

SapObject.SapModel.PropMaterial.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String, Optional
ByVal MatType As eMatType) As Long

## Parameters

NumberNames

The number of material property names retrieved by the program.


MyName

This is a one-dimensional array of material property names. The MyName array is created as a
dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

MatType

This optional value is one of the following items in the eMatType enumeration.

```
eMatType_Steel = 1
eMatType_Concrete = 2
eMatType_NoDesign = 3
eMatType_Aluminum = 4
eMatType_ColdFormed = 5
eMatType_Rebar = 6
eMatType_Tendon = 7
```
If no value is input for MatType, names are returned for all material properties in the model
regardless of type.

## Remarks

This function retrieves the names of all defined material properties of the specified type.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetMaterialNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get material property names
ret = SapModel.PropMaterial.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Updated the documentation of the eMatType enumeration in v22.1.0

Initial release in version 11.02.

## See Also

# GetOAluminum

## Syntax

SapObject.SapModel.PropMaterial.GetOAluminum

## VB6 Procedure

Function GetOAluminum(ByVal Name As String, ByVal MyType As Long, ByRef Alloy As
String, ByRef Fcy As Double, ByRef Fty As Double, ByRef Ftu As Double, ByRef Fsu As
Double, ByRef SSHysType As Long, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing aluminum material property.

MyType

This is 1, 2 or 3, indicating the type of aluminum.

```
1 = Wrought
2 = Cast-Mold
3 = Cast-Sand
```
Alloy


The Alloy designation for the aluminum, for example, 2014-T6 for wrought or 356.0-T7 for cast
(mold or sand) aluminum.

Fcy

The compressive yield strength of aluminum. [F/L^2 ]

Fty

The tensile yield strength of aluminum. [F/L^2 ]

Ftu

The tensile ultimate strength of aluminum. [F/L^2 ]

Fsu

The shear ultimate strength of aluminum. [F/L^2 ]

SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the other material property data for aluminum materials.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not aluminum.

## VBA Example

Sub GetMatPropAluminumData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyType As Long
Dim Alloy As String
Dim Fcy As Double
Dim Fty As Double


Dim Ftu As Double
Dim Fsu As Double
Dim SSHysType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Aluminum", MATERIAL_ALUMINUM)

'assign other properties
ret = SapModel.PropMaterial.SetOAluminum("Aluminum", 1, "2014-T6", 34, 34, 37, 23, 2)

'get other properties
ret = SapModel.PropMaterial.GetOAluminum("Aluminum", MyType, Alloy, Fcy, Fty, Ftu,
Fsu, SSHysType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetOAluminum

# GetOColdFormed

## Syntax

SapObject.SapModel.PropMaterial.GetOColdFormed


## VB6 Procedure

Function GetOColdFormed(ByVal Name As String, ByRef Fy As Double, ByRef Fu As Double,
ByRef SSHysType As Long, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing cold formed material property.

Fy

The minimum yield stress. [F/L^2 ]

Fu

The minimum tensile stress. [F/L^2 ]

SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the other material property data for cold formed materials.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not cold formed.

## VBA Example

Sub GetMatPropColdFormedData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Fy As Double
Dim Fu As Double
Dim SSHysType As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("ColdFormed", MATERIAL_COLDFORMED)

'assign other properties
ret = SapModel.PropMaterial.SetOColdFormed("ColdFormed", 52, 67, 1)

'get other properties
ret = SapModel.PropMaterial.GetOColdFormed("ColdFormed", Fy, Fu, SSHysType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetOColdFormed

# GetOConcrete_1

## Syntax

SapObject.SapModel.PropMaterial.GetOConcrete_1

## VB6 Procedure

Function GetOConcrete_1(ByVal Name As String, ByRef fc As Double, ByRef IsLightweight As
Boolean, ByRef fcsfactor As Double, ByRef SSType As Long, ByRef SSHysType As Long,


ByRef StrainAtfc As Double, ByRef StrainUltimate As Double, ByRef FinalSlope As Double,
ByRef FrictionAngle As Double, ByRef DilatationalAngle As Double, Optional ByVal Temp As
Double = 0) As Long

## Parameters

Name

The name of an existing concrete material property.

fc

The concrete compressive strength. [F/L^2 ]

IsLightweight

If this item is True, the concrete is assumed to be lightweight concrete.

fcsfactor

The shear strength reduction factor for lightweight concrete.

SSType

This is 0, 1 or 2, indicating the stress-strain curve type.

```
0 = User defined
1 = Parametric - Simple
2 = Parametric - Mander
```
SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
StrainAtfc

This item applies only to parametric stress-strain curves. It is the strain at the unconfined
compressive strength.

StrainUltimate

This item applies only to parametric stress-strain curves. It is the ultimate unconfined strain
capacity.

FinalSlope

This item applies only to parametric stress-strain curves. It is a multiplier on the material modulus
of elasticity, E. This value multiplied times E gives the final slope on the compression side of the
curve.

FrictionAngle


The Drucker-Prager friction angle, 0 <= FrictionAngle < 90. [deg]

DilatationalAngle

The Drucker-Prager dilatational angle, 0 <= DilatationalAngle < 90. [deg]

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the other material property data for concrete materials.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not concrete.

## VBA Example

Sub GetMatPropConcreteData_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim fc As Double
Dim IsLightweight As Boolean
Dim fcsfactor As Double
Dim SSType As Long
Dim SSHysType As Long
Dim StrainAtfc As Double
Dim StrainUltimate As Double
Dim FinalSlope As Double
Dim FrictionAngle As Double
Dim DilatationalAngle As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Concrete", MATERIAL_CONCRETE)

'assign other properties
ret = SapModel.PropMaterial.SetOConcrete_1("Concrete", 5, False, 0, 1, 2, 0.0022, 0.0052, -
0.1)

'get other properties
ret = SapModel.PropMaterial.GetOConcrete_1("Concrete", fc, IsLightweight, fcsfactor,
SSType, SSHysType, StrainAtfc, StrainUltimate, FinalSlope, FrictionAngle, DilatationalAngle)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

This function supersedes GetOConcrete.

## See Also

SetOConcrete_1

# GetONoDesign

## Syntax

SapObject.SapModel.PropMaterial.GetONoDesign

## VB6 Procedure

Function GetONoDesign(ByVal Name As String, ByRef FrictionAngle As Double, ByRef
DilatationalAngle As Double, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing concrete material property.

FrictionAngle

The Drucker-Prager friction angle, 0 <= FrictionAngle < 90. [deg]


DilatationalAngle

The Drucker-Prager dilatational angle, 0 <= DilatationalAngle < 90. [deg]

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the other material property data for no design type materials.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not concrete.

## VBA Example

Sub GetMatPropNoDesignData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim FrictionAngle As Double
Dim DilatationalAngle As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("NoDesign", MATERIAL_NODESIGN)

'assign other properties
ret = SapModel.PropMaterial.SetONoDesign("NoDesign", 10, 15)

'get other properties
ret = SapModel.PropMaterial.GetONoDesign("NoDesign", FrictionAngle, DilatationalAngle)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetONoDesign

# GetORebar_1

## Syntax

SapObject.SapModel.PropMaterial.GetORebar_1

## VB6 Procedure

Function GetORebar_1(ByVal Name As String, ByRef Fy As Double, ByRef Fu As Double,
ByRef eFy As Double, ByRef eFu As Double, ByRef SSType As Long, ByRef SSHysType As
Long, ByRef StrainAtHardening As Double, ByRef StrainUltimate As Double, ByRef FinalSlope
As Double, ByRef UseCaltransSSDefaults As Boolean, Optional ByVal Temp As Double = 0) As
Long

## Parameters

Name

The name of an existing rebar material property.

Fy

The minimum yield stress. [F/L^2 ]

Fu

The minimum tensile stress. [F/L^2 ]

eFy

The expected yield stress. [F/L^2 ]

eFu


The expected tensile stress. [F/L^2 ]

SSType

This is 0, 1 or 2, indicating the stress-strain curve type.

```
0 = User defined
1 = Parametric - Simple
2 = Parametric - Park
```
SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
StrainAtHardening

This item applies only when parametric stress-strain curves are used and when
UseCaltransSSDefaults is False. It is the strain at the onset of strain hardening.

StrainUltimate

This item applies only when parametric stress-strain curves are used and when
UseCaltransSSDefaults is False. It is the ultimate strain capacity. This item must be larger than the
StrainAtHardening item.

FinalSlope

This item applies only to parametric stress-strain curves. It is a multiplier on the material modulus
of elasticity, E. This value multiplied times E gives the final slope of the curve.

UseCaltransSSDefaults

If this item is True, the program uses Caltrans default controlling strain values, which are bar size
dependent.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the other material property data for rebar materials.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not rebar.


## VBA Example

Sub GetMatPropRebarData_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Fy As Double
Dim Fu As Double
Dim eFy As Double
Dim eFu As Double
Dim SSType As Long
Dim SSHysType As Long
Dim StrainAtHardening As Double
Dim StrainUltimate As Double
Dim FinalSlope As Double
Dim UseCaltransSSDefaults As Boolean

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Rebar", MATERIAL_REBAR)

'assign other properties
ret = SapModel.PropMaterial.SetORebar_1("Rebar", 62, 93, 70, 102, 2, 2, 0.02, 0.1, -0.1,
False)

'get other properties
ret = SapModel.PropMaterial.GetORebar_1("Rebar", Fy, Fu, eFy, eFu, SSType, SSHysType,
StrainAtHardening, StrainUltimate, FinalSlope, UseCaltransSSDefaults)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 12.00.

This function supersedes GetORebar.

## See Also

SetORebar_1

# GetOSteel_1

## Syntax

SapObject.SapModel.PropMaterial.GetOSteel_1

## VB6 Procedure

Function GetOSteel_1(ByVal Name As String, ByRef Fy As Double, ByRef Fu As Double,
ByRef eFy As Double, ByRef eFu As Double, ByRef SSType As Long, ByRef SSHysType As
Long, ByRef StrainAtHardening As Double, ByRef StrainAtMaxStress As Double, ByRef
StrainAtRupture As Double, ByRef FinalSlope As Double, Optional ByVal Temp As Double = 0)
As Long

## Parameters

Name

The name of an existing steel material property.

Fy

The minimum yield stress. [F/L^2 ]

Fu

The minimum tensile stress. [F/L^2 ]

eFy

The expected yield stress. [F/L^2 ]

eFu

The expected tensile stress. [F/L^2 ]

SSType

This is 0 or 1. indicating the stress-strain curve type.


```
0 = User defined
1 = Parametric - Simple
```
SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
StrainAtHardening

This item applies only to parametric stress-strain curves. It is the strain at the onset of strain
hardening.

StrainAtMaxStress

This item applies only to parametric stress-strain curves. It is the strain at maximum stress.

StrainAtRupture

This item applies only to parametric stress-strain curves. It is the strain at rupture.

FinalSlope

This item applies only to parametric stress-strain curves. It is a multiplier on the material modulus
of elasticity, E. This value multiplied times E gives the final slope of the curve.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the other material property data for steel materials.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not steel.

## VBA Example

Sub GetMatPropSteelData_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Fy As Double
Dim Fu As Double


Dim eFy As Double
Dim eFu As Double
Dim SSType As Long
Dim SSHysType As Long
Dim StrainAtHardening As Double
Dim StrainAtMaxStress As Double
Dim StrainAtRupture As Double
Dim FinalSlope As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign other properties
ret = SapModel.PropMaterial.SetOSteel_1("Steel", 55, 68, 60, 70, 1, 2, 0.02, 0.1, 0.2, -0.1)

'get other properties
ret = SapModel.PropMaterial.GetOSteel_1("Steel", Fy, Fu, eFy, eFu, SSType, SSHysType,
StrainAtHardening, StrainAtMaxStress, StrainAtRupture, FinalSlope)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

This function supersedes GetOSteel.

## See Also

SetOSteel_1


# GetOTendon_1

## Syntax

SapObject.SapModel.PropMaterial.GetOTendon_1

## VB6 Procedure

Function GetOTendon_1(ByVal Name As String, ByRef Fy As Double, ByRef Fu As Double,
ByRef SSType As Long, ByRef SSHysType As Long, ByRef FinalSlope As Double, Optional
ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing tendon material property.

Fy

The minimum yield stress. [F/L^2 ]

Fu

The minimum tensile stress. [F/L^2 ]

SSType

This is 0, 1 or 2, indicating the stress-strain curve type.

```
0 = User defined
1 = Parametric – 250 ksi strand
2 = Parametric – 270 ksi strand
```
SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
FinalSlope

This item applies only to parametric stress-strain curves. It is a multiplier on the material modulus
of elasticity, E. This value multiplied times E gives the final slope of the curve.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.


This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the other material property data for tendon materials.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not tendon.

## VBA Example

Sub GetMatPropTendonData_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Fy As Double
Dim Fu As Double
Dim SSType As Long
Dim SSHysType As Long
Dim FinalSlope As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Tendon", MATERIAL_TENDON)

'assign other properties
ret = SapModel.PropMaterial.SetOTendon_1("Tendon", 230, 255, 1, 1, -0.1)

'get other properties
ret = SapModel.PropMaterial.GetOTendon_1("Tendon", Fy, Fu, SSType, SSHysType,
FinalSlope)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

This function supersedes GetOTendon.

## See Also

SetOTendon_1

# GetSSCurve

## Syntax

SapObject.SapModel.PropMaterial.GetSSCurve

## VB6 Procedure

Function GetMPIsotropic(ByVal Name As String, ByRef NumberPoints As Long, ByRef PointID
() As Long, ByRef Strain() As Double, ByRef Stress() As Double, Optional ByVal SectName As
String = "", Optional ByVal RebarArea As Double = 0, Optional ByVal Temp As Double = 0) As
Long

## Parameters

Name

The name of an existing material property.

NumberPoints

The number of points in the stress-strain curve.

PointID

This is one of the following integers which sets the point ID. The point ID controls the color that
will be displayed for hinges in a deformed shape plot.

```
-5 = -E
-4 = -D
-3 = -C
-2 = -B
0 = None
1 = A
2 = B
3 = C
```

### 4 = D

### 5 = E

Strain

This is an array that includes the strain at each point on the stress strain curve.

Stress

This is an array that includes the stress at each point on the stress strain curve. [F/L^2 ]

SectName

This item applies only if the specified material is concrete with a Mander concrete type.

This is the frame section property for which the Mander stress-strain curve is retrieved.

The section must be round or rectangular.

RebarArea

This item applies only if the specified material is rebar, which does not have a user-defined stress-
strain curve and is specified to use Caltrans default controlling strain values, which are bar size
dependent.

This is the area of the rebar for which the stress-strain curve is retrieved.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the material stress-strain curve.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

```
Sub GetMatPropSSCurve()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberPoints As Long
Dim PointID() As Long
Dim Strain() As Double
Dim Stress() As Double
```

```
'create Sap2000 object
Set SapObject = CreateObject
("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
SapObject.ApplicationStart
```
```
'create SapModel object
Set SapModel = SapObject.SapModel
```
```
'initialize model
ret = SapModel.InitializeNewModel
```
```
'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
```
'get stress strain curve
ret = SapModel.PropMaterial.GetSSCurve("A992Fy50",
NumberPoints, PointID, Strain, Stress)
```
```
'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub
```
## Release Notes

Initial release in version 11.02.

## See Also

SetSSCurve

# GetTemp

## Syntax

SapObject.SapModel.PropMaterial.GetTemp

## VB6 Procedure

Function GetTemp(ByVal Name As String, ByRef NumberItems as long, ByRef Temp() As
Double) As Long

## Parameters


Name

The name of a material property.

NumberItems

The number of different temperatures at which properties are specified for the material.

Temp

This is an array that includes the different temperatures at which properties are specified for the
material.

## Remarks

This function retrieves the temperatures at which properties are specified for a material.

The function returns zero if the temperatures are successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetMatPropTemps()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberItems As Long
Dim MyTemp() As Double
Dim Temp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'specify temps at which properties will be provided
ReDim MyTemp(2)
MyTemp(0) = 0


MyTemp(1) = 50
MyTemp(2) = 100
ret = SapModel.PropMaterial.SetTemp("Steel", 3, MyTemp)

'get temps at which properties are provided
ret = SapModel.PropMaterial.GetTemp("Steel", NumberItems, Temp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetTemp

# GetTypeOAPI

## Syntax

SapObject.SapModel.PropMaterial.GetTypeOAPI

## VB6 Procedure

Function GetTypeOAPI(ByVal Name As String, ByRef MatType As eMatType, ByRef SymType
As Long) As Long

## Parameters

Name

The name of an existing material property.

MatType

This is one of the following items in the eMatType enumeration.

```
eMatType_Steel = 1
eMatType_Concrete = 2
eMatType_NoDesign = 3
eMatType_Aluminum = 4
eMatType_ColdFormed = 5
eMatType_Rebar = 6
eMatType_Tendon = 7
```

SymType

This is 0, 1, 2 or 3, indicating the material directional symmetry type.

```
0 = Isotropic
1 = Orthotropic
2 = Anisotropic
3 = Uniaxial
```
## Remarks

This function retrieves the material type for the specified material.

The function returns zero if the type is successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetMaterialType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatType As eMatType
Dim SymType As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'get material type
ret = SapModel.PropMaterial.GetTypeOAPI("4000Psi", MatType, SymType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Updated the documentation of the eMatType enumeration in v22.1.0

Initial release in version 11.02.

Changed function name to GetTypeOAPI in v17.0.0.

## See Also

# GetVonMisesPlasticityParameters

## Syntax

SapObject.SapModel.PropMaterial.GetVonMisesPlasticityParameters

## VB6 Procedure

Function GetVonMisesPlasticityParameters(ByVal Name As String, ByRef UseIsoLinHardening
As Boolean, ByRef IsoLinHardeningModulus As Double, ByRef UseIsoNLHardening As
Boolean, ByRef IsoNLUltimateStressRatio As Double, ByRef IsoNLHardeningRate As Double,
ByRef UseKinLinHardening As Boolean, ByRef KinLinHardeningModulus As Double, ByRef
YieldStress As Double, Optional ByVal Temp As Double = 0.0) As Long

## Parameters

Name

The name of an existing material property.

UseIsoLinHardening

If this item is True, the linear isotropic hardening is enabled.

IsoLinHardeningModulus

The linear isotropic hardening modulus, used if UseIsoLinHardening = True.

UseIsoNLHardening

If this item is True, the nonlinear isotropic saturation hardening is enabled.

IsoNLUltimateStressRatio

The ultimate stress as a ratio of the yield stress, used if UseIsoNLHardening = True.

IsoNLHardeningRate

The hardening rate parameter, used if UseIsoNLHardening = True.


UseKinLinHardening

If this item is True, the linear kinematic hardening is enabled.

KinLinHardeningModulus

The linear kinematic hardening modulus, used if UseKinLinHardening = True.

YieldStress

The yield stress.

This item applies only if the specified material has a material type of eMatType.NoDesign.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function gets the Von Mises Plasticity coupled modeling parameters for a specified material

The function returns zero if the assignment data is successfully obtained; otherwise it returns a
nonzero value.

## VBA Example

Sub GetMatCoupledTypeData()

'dimension variables

Dim SapObject as cOAPI

Dim SapModel As cSapModel

Dim UseIsoLinHardening As Boolean

Dim IsoLinHardeningModulus As Double

Dim UseIsoNLHardening As Boolean

Dim IsoNLUltimateStressRatio As Double

Dim IsoNLHardeningRate As Double

Dim UseKinLinHardening As Boolean

Dim KinLinHardeningModulus As Double

Dim YieldStress As Double


Dim ret As Long

'create Sap2000 object

Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application

SapObject.ApplicationStart

'create SapModel object

Set SapModel = SapObject.SapModel

'initialize model

ret = SapModel.InitializeNewModel

'create model from template

ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property

ret = SapModel.PropMaterial.SetMaterial("Steel", eMatType.eMatType_Steel, -1, "API
example test", "Default")

'set coupled material type data

ret = SapModel.PropMaterial.SetCoupledModelType("Steel",
eMatCoupledType.eMatCoupledType_VonMisesPlasticity)

'get Von Mises Plasticity data

ret = SapModel.PropMaterial.GetVonMisesPlasticityParameters ("Steel",
UseIsoLinHardening, IsoLinHardeningModulus, UseIsoNLHardening, IsoNLUltimateStressRatio,
IsoNLHardeningRate, UseKinLinHardening, KinLinHardeningModulus, YieldStress)


'close Sap2000

SapObject.ApplicationExit False

Set SapModel = Nothing

Set SapObject = Nothing

End Sub

## Release Notes

Initial release in version 22.1.0

## See Also

GetCoupledModelType

SetCoupledModelType

SetVonMisesPlasticityParameters

# GetWeightAndMass

## Syntax

SapObject.SapModel.PropMaterial.GetWeightAndMass

## VB6 Procedure

Function GetWeightAndMass(ByVal Name As String, ByRef w As Double, ByRef m As Double,
Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing material property.

w

The weight per unit volume for the material. [F/L^3 ]

m

The mass per unit volume for the material. [M/L^3 ]

Temp


This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function retrieves the weight per unit volume and mass per unit volume of the material.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetMatPropWeightAndMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim w As Double
Dim m As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign material property weight per unit volume
ret = SapModel.PropMaterial.SetWeightAndMass("Steel", 1, 0.00029)

'get material weight and mass per unit volume
ret = SapModel.PropMaterial.GetWeightAndMass("Steel", w, m)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

SetWeightAndMass

# SetCoupledModelType

## Syntax

SapObject.SapModel.PropMaterial.SetCoupledModelType

## VB6 Procedure

Function SetCoupledModelType(ByVal Name As String, ByVal MatCoupledType As
eMatCoupledType, Optional ByVal Temp As Double = 0.0) As Long

## Parameters

Name

The name of an existing material property.

MatCoupledType

This is one of the following items in the eMatCoupledType enumeration.

```
None = 1
VonMisesPlasticity = 2
ModifiedDarwinPecknoldConcrete = 3
```
Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function sets the nonlinear coupled modeling type for a specified material

The function returns zero if the assignment data is successfully assigned; otherwise it returns a
nonzero value.


## VBA Example

Sub SetMatCoupledTypeData()

'dimension variables

Dim SapObject as cOAPI

Dim SapModel As cSapModel

Dim ret As Long

'create Sap2000 object

Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application

SapObject.ApplicationStart

'create SapModel object

Set SapModel = SapObject.SapModel

'initialize model

ret = SapModel.InitializeNewModel

'create model from template

ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property

ret = SapModel.PropMaterial.SetMaterial("Steel", eMatType.eMatType_Steel, -1, "API
example test", "Default")

'set coupled material type data

ret = SapModel.PropMaterial.SetCoupledModelType("Steel",
eMatCoupledType.eMatCoupledType_VonMisesPlasticity)


'close Sap2000

SapObject.ApplicationExit False

Set SapModel = Nothing

Set SapObject = Nothing

End Sub

## Release Notes

Initial release in version 22.1.0

## See Also

GetCoupledModelType

# SetDamping

## Syntax

SapObject.SapModel.PropMaterial.SetDamping

## VB6 Procedure

Function SetDamping(ByVal Name As String, ByVal ModalRatio As Double, ByVal
ViscousMassCoeff As Double, ByVal ViscousStiffCoeff As Double, ByVal HystereticMassCoeff
As Double, ByVal HystereticStiffCoeff As Double, Optional ByVal Temp As Double = 0) As
Long

## Parameters

Name

The name of an existing material property.

ModalRatio

The modal damping ratio.

ViscousMassCoeff

The mass coefficient for viscous proportional damping.

ViscousStiffCoeff

The stiffness coefficient for viscous proportional damping.


HystereticMassCoeff

The mass coefficient for hysteretic proportional damping.

HystereticStiffCoeff

The stiffness coefficient for hysteretic proportional damping.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
previously defined for the material.

## Remarks

This function sets the additional material damping data for the material.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropDamping()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Conc", MATERIAL_CONCRETE)

'assign material damping data
ret = SapModel.PropMaterial.SetDamping("Conc", 0.04, 0, 0, 0, 0)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.03.

## See Also

GetDamping

# SetMaterial

## Syntax

SapObject.SapModel.PropMaterial.SetMaterial

## VB6 Procedure

Function SetMaterial(ByVal Name As String, ByVal MatType As eMatType, Optional ByVal
Color As Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID As String = "")
As Long

## Parameters

Name

The name of an existing or new material property. If this is an existing property, that property is
modified; otherwise, a new property is added.

MatType

This is one of the following items in the eMatType enumeration.

```
eMatType_Steel = 1
eMatType_Concrete = 2
eMatType_NoDesign = 3
eMatType_Aluminum = 4
eMatType_ColdFormed = 5
eMatType_Rebar = 6
eMatType_Tendon = 7
```
Color

The display color assigned to the material. If Color is specified as -1, the program will
automatically assign a color.


Notes

The notes, if any, assigned to the material.

GUID

The GUID (global unique identifier), if any, assigned to the material. If this item is input as
Default, the program assigns a GUID to the material.

## Remarks

This function initializes a material property. If this function is called for an existing material
property, all items for the material are reset to their default value.

The function returns zero if the material is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub InitializeMatProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", eMatType_Steel)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Updated the documentation of the eMatType enumeration in v22.1.0

Initial release in version 11.02.

## See Also

GetMaterial

# SetMPAnisotropic

## Syntax

SapObject.SapModel.PropMaterial.SetMPAnisotropic

## VB6 Procedure

Function SetMPAnisotropic(ByVal Name As String, ByRef e() As Double, ByRef u() As Double,
ByRef a() As Double, ByRef g() As Double, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing material property.

e

This is an array that includes the modulus of elasticity.

```
e(0) = E1 [F/L^2 ]
e(1) = E2 [F/L^2 ]
e(2) = E3 [F/L^2 ]
```
u

This is an array that includes poisson’s ratio.

```
u(0) = U12
u(1) = U13
u(2) = U23
u(3) = U14
u(4) = U24
u(5) = U34
u(6) = U15
u(7) = U25
u(8) = U35
u(9) = U45
u(10) = U16
u(11) = U26
u(12) = U36
```

```
u(13) = U46
u(14) = U56
```
a

```
This is an array that includes the thermal coefficient.
```
```
a(0) = A1 [1/T]
a(1) = A2 [1/T]
a(2) = A3 [1/T]
a(3) = A12 [1/T]
a(4) = A13 [1/T]
a(5) = A23 [1/T]
```
g

This is an array that includes the shear modulus.

```
g(0) = G12 [F/L^2 ]
g(1) = G13 [F/L^2 ]
g(2) = G23 [F/L^2 ]
```
Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the material directional symmetry type to anisotropic, and assigns the
anisotropic mechanical properties.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropAnisotropic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyE() As Double
Dim MyU() As Double
Dim MyA() As Double
Dim MyG() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application


SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign anisotropic mechanical properties
ReDim MyE(2)
ReDim MyU(14)
ReDim MyA(6)
ReDim MyG(2)
MyE(0)=30000
MyE(1)=10000
MyE(2)=2000
MyU(0)=0.2
MyU(1)=0.05
MyU(2)=0.1
MyU(3)=0
MyU(4)=0
MyU(5)=0
MyU(6)=0
MyU(7)=0
MyU(8)=0.01
MyU(9)=0
MyU(10)=0
MyU(11)=0
MyU(12)=0
MyU(13)=0
MyU(14)=0
MyA(0)=6.5E-6
MyA(1)=6.5E-6
MyA(2)=6.5E-6
MyA(3)=6.5E-6
MyA(4)=6.5E-6
MyA(5)=6.5E-6
MyG(0)=1500
MyG(1)=2500
MyG(2)=8700
ret = SapModel.PropMaterial.SetMPAnisotropic("Steel", MyE, MyU, MyA, MyG)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

GetMPAnisotropic

# SetMPIsotropic

## Syntax

SapObject.SapModel.PropMaterial.SetMPIsotropic

## VB6 Procedure

Function SetMPIsotropic(ByVal Name As String, ByVal e As Double, ByVal u As Double,
ByVal a As Double, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing material property.

e

The modulus of elasticity. [F/L^2 ]

u

Poisson’s ratio.

a

The thermal coefficient. [1/T]

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the material directional symmetry type to isotropic, and assigns the isotropic
mechanical properties.


The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropIsotropic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign isotropic mechanical properties
ret = SapModel.PropMaterial.SetMPIsotropic("Steel", 29500, 0.25, 6E-06)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetMPIsotropic

# SetMPOrthotropic

## Syntax


SapObject.SapModel.PropMaterial.SetMPOrthotropic

## VB6 Procedure

Function SetMPOrthotropic(ByVal Name As String, ByRef e() As Double, ByRef u() As Double,
ByRef a() As Double, ByRef g() As Double, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing material property.

e

This is an array that includes the modulus of elasticity.

```
e(0) = E1 [F/L^2 ]
e(1) = E2 [F/L^2 ]
e(2) = E3 [F/L^2 ]
```
u

This is an array that includes poisson’s ratio.

```
u(0) = U12
u(1) = U13
u(2) = U23
```
a

```
This is an array that includes the thermal coefficient.
```
```
a(0) = A1 [1/T]
a(1) = A2 [1/T]
a(2) = A3 [1/T]
```
g

This is an array that includes the shear modulus.

```
g(0) = G12 [F/L^2 ]
g(1) = G13 [F/L^2 ]
g(2) = G23 [F/L^2 ]
```
Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.


## Remarks

This function sets the material directional symmetry type to orthotropic, and assigns the
orthotropic mechanical properties.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropOrthotropic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyE() As Double
Dim MyU() As Double
Dim MyA() As Double
Dim MyG() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign orthotropic mechanical properties
ReDim MyE(2)
ReDim MyU(2)
ReDim MyA(2)
ReDim MyG(2)
MyE(0)=30000
MyE(1)=10000
MyE(2)=2000
MyU(0)=0.2
MyU(1)=0.05
MyU(2)=0.1
MyA(0)=6.5E-6
MyA(1)=6.5E-6
MyA(2)=6.5E-6
MyG(0)=1500


MyG(1)=2500
MyG(2)=8700
ret = SapModel.PropMaterial.SetMPOrthotropic("Steel", MyE, MyU, MyA, MyG)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetMPOrthotropic

# SetMPUniaxial

## Syntax

SapObject.SapModel.PropMaterial.SetMPUniaxial

## VB6 Procedure

Function SetMPUniaxial(ByVal Name As String, ByVal e As Double, ByVal a As Double,
Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing material property.

e

The modulus of elasticity. [F/L^2 ]

a

The thermal coefficient. [1/T]

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.


This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the material directional symmetry type to uniaxial, and assigns the uniaxial
mechanical properties.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropUniaxial()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Rebar", MATERIAL_REBAR)

'assign uniaxial mechanical properties
ret = SapModel.PropMaterial.SetMPUniaxial("Rebar", 28500, 6E-06)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

GetMPUniaxial

# SetOAluminum

## Syntax

SapObject.SapModel.PropMaterial.SetOAluminum

## VB6 Procedure

Function SetOAluminum(ByVal Name As String, ByVal MyType As Long, ByVal Alloy As
String, ByVal Fcy As Double, ByVal Fty As Double, ByVal Ftu As Double, ByVal Fsu As
Double, ByVal SSHysType As Long, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing aluminum material property.

MyType

This is 1, 2 or 3, indicating the type of aluminum.

```
1 = Wrought
2 = Cast-Mold
3 = Cast-Sand
```
Alloy

The Alloy designation for the aluminum, for example, 2014-T6 for wrought or 356.0-T7 for cast
(mold or sand) aluminum.

Fcy

The compressive yield strength of aluminum. [F/L^2 ]

Fty

The tensile yield strength of aluminum. [F/L^2 ]

Ftu

The tensile ultimate strength of aluminum. [F/L^2 ]

Fsu

The shear ultimate strength of aluminum. [F/L^2 ]


SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the other material property data for aluminum materials.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropAluminumData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Aluminum", MATERIAL_ALUMINUM)

'assign other properties
ret = SapModel.PropMaterial.SetOAluminum("Aluminum", 1, "2014-T6", 34, 34, 37, 23, 2)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetOAluminum

# SetOColdFormed

## Syntax

SapObject.SapModel.PropMaterial.SetOColdFormed

## VB6 Procedure

Function SetOColdFormed(ByVal Name As String, ByVal Fy As Double, ByVal Fu As Double,
ByVal SSHysType As Long, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing cold formed material property.

Fy

The minimum yield stress. [F/L^2 ]

Fu

The minimum tensile stress. [F/L^2 ]

SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
Temp


This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the other material property data for cold formed materials.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropColdFormedData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("ColdFormed", MATERIAL_COLDFORMED)

'assign other properties
ret = SapModel.PropMaterial.SetOColdFormed("ColdFormed", 52, 67, 1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

GetOColdFormed

# SetOConcrete_1

## Syntax

SapObject.SapModel.PropMaterial.SetOConcrete_1

## VB6 Procedure

Function SetOConcrete_1(ByVal Name As String, ByVal fc As Double, ByVal IsLightweight As
Boolean, ByVal fcsfactor As Double, ByVal sstype As Long, ByVal SSHysType As Long, ByVal
StrainAtfc As Double, ByVal StrainUltimate As Double, ByVal FinalSlope As Double, Optional
ByVal FrictionAngle As Double = 0, Optional ByVal DilatationalAngle As Double = 0, Optional
ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing concrete material property.

fc

The concrete compressive strength. [F/L^2 ]

IsLightweight

If this item is True, the concrete is assumed to be lightweight concrete.

fcsfactor

The shear strength reduction factor for lightweight concrete.

SSType

This is 0, 1 or 2, indicating the stress-strain curve type.

```
0 = User defined
1 = Parametric - Simple
2 = Parametric - Mander
```
SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```

StrainAtfc

This item applies only to parametric stress-strain curves. It is the strain at the unconfined
compressive strength.

StrainUltimate

This item applies only to parametric stress-strain curves. It is the ultimate unconfined strain
capacity. This item must be larger than the StrainAtfc item.

FinalSlope

This item applies only to parametric stress-strain curves. It is a multiplier on the material modulus
of elasticity, E. This value multiplied times E gives the final slope on the compression side of the
curve.

FrictionAngle

The Drucker-Prager friction angle, 0 <= FrictionAngle < 90. [deg]

DilatationalAngle

The Drucker-Prager dilatational angle, 0 <= DilatationalAngle < 90. [deg]

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the other material property data for concrete materials.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropConcreteData_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Concrete", MATERIAL_CONCRETE)

'assign other properties
ret = SapModel.PropMaterial.SetOConcrete_1("Concrete", 5, False, 0, 1, 2, 0.0022, 0.0052, -
0.1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

This function supersedes SetOConcrete.

## See Also

GetOConcrete_1

# SetONoDesign

## Syntax

SapObject.SapModel.PropMaterial.SetONoDesign

## VB6 Procedure

Function SetONoDesign(ByVal Name As String, Optional ByVal FrictionAngle As Double = 0,
Optional ByVal DilatationalAngle As Double = 0, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing concrete material property.


FrictionAngle

The Drucker-Prager friction angle, 0 <= FrictionAngle < 90. [deg]

DilatationalAngle

The Drucker-Prager dilatational angle, 0 <= DilatationalAngle < 90. [deg]

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the other material property data for no design type materials.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropNoDesignData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("NoDesign", MATERIAL_NODESIGN)

'assign other properties
ret = SapModel.PropMaterial.SetONoDesign("NoDesign", 10, 15)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetONoDesign

# SetORebar_1

## Syntax

SapObject.SapModel.PropMaterial.SetORebar_1

## VB6 Procedure

Function SetORebar_1(ByVal Name As String, ByVal Fy As Double, ByVal Fu As Double,
ByVal eFy As Double, ByVal eFu As Double, ByVal SSType As Long, ByVal SSHysType As
Long, ByVal StrainAtHardening As Double, ByVal StrainUltimate As Double, ByVal FinalSlope
As Double, ByVal UseCaltransSSDefaults As Boolean, Optional ByVal Temp As Double = 0) As
Long

## Parameters

Name

The name of an existing rebar material property.

Fy

The minimum yield stress. [F/L^2 ]

Fu

The minimum tensile stress. [F/L^2 ]

eFy

The expected yield stress. [F/L^2 ]

eFu

The expected tensile stress. [F/L^2 ]


SSType

This is 0, 1 or 2, indicating the stress-strain curve type.

```
0 = User defined
1 = Parametric - Simple
2 = Parametric - Park
```
SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
StrainAtHardening

This item applies only when parametric stress-strain curves are used and when
UseCaltransSSDefaults is False. It is the strain at the onset of strain hardening.

StrainUltimate

This item applies only when parametric stress-strain curves are used and when
UseCaltransSSDefaults is False. It is the ultimate strain capacity. This item must be larger than the
StrainAtHardening item.

FinalSlope

This item applies only to parametric stress-strain curves. It is a multiplier on the material modulus
of elasticity, E. This value multiplied times E gives the final slope of the curve.

UseCaltransSSDefaults

If this item is True, the program uses Caltrans default controlling strain values, which are bar size
dependent.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the other material property data for rebar materials.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example


Sub AssignMatPropRebarData_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Rebar", MATERIAL_REBAR)

'assign other properties
ret = SapModel.PropMaterial.SetORebar_1("Rebar", 62, 93, 70, 102, 2, 2, 0.02, 0.1, -0.1,
False)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

This function supersedes SetORebar.

## See Also

GetORebar_1

# SetOSteel_1

## Syntax

SapObject.SapModel.PropMaterial.SetOSteel_1


## VB6 Procedure

Function SetOSteel_1(ByVal Name As String, ByVal Fy As Double, ByVal Fu As Double, ByVal
eFy As Double, ByVal eFu As Double, ByVal SSType As Long, ByVal SSHysType As Long,
ByVal StrainAtHardening As Double, ByVal StrainAtMaxStress As Double, ByVal
StrainAtRupture As Double, ByVal FinalSlope As Double, Optional ByVal Temp As Double = 0)
As Long

## Parameters

Name

The name of an existing steel material property.

Fy

The minimum yield stress. [F/L^2 ]

Fu

The minimum tensile stress. [F/L^2 ]

eFy

The expected yield stress. [F/L^2 ]

eFu

The expected tensile stress. [F/L^2 ]

SSType

This is 0 or 1, indicating the stress-strain curve type.

```
0 = User defined
1 = Parametric - Simple
```
SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
StrainAtHardening

This item applies only to parametric stress-strain curves. It is the strain at the onset of strain
hardening.

StrainAtMaxStress

This item applies only to parametric stress-strain curves. It is the strain at maximum stress. This
item must be larger than the StrainAtHardening item.


StrainAtRupture

This item applies only to parametric stress-strain curves. It is the strain at rupture. This item must
be larger than the StrainAtMaxStress item.

FinalSlope

This item applies only to parametric stress-strain curves. It is a multiplier on the material modulus
of elasticity, E. This value multiplied times E gives the final slope of the curve.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the other material property data for steel materials.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropSteelData_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign other properties
ret = SapModel.PropMaterial.SetOSteel_1("Steel", 55, 68, 60, 70, 1, 2, 0.02, 0.1, 0.2, -0.1)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

This function supersedes SetOSteel.

## See Also

GetOSteel_1

# SetSSCurve

## Syntax

SapObject.SapModel.PropMaterial.SetSSCurve

## VB6 Procedure

Function SetSSCurve(ByVal Name As String, ByVal NumberPoints As Long, ByRef PointID()
As Long, ByRef Strain() As Double, ByRef Stress() As Double, Optional ByVal Temp As Double
= 0) As Long

## Parameters

Name

The name of an existing material property.

NumberPoints

The number of points in the stress-strain curve. This item must be at least 3.

PointID

This is one of the following integers which sets the point ID. The point ID controls the color that
will be displayed for hinges in a deformed shape plot.

```
-5 = -E
-4 = -D
-3 = -C
-2 = -B
0 = None
```

### 1 = A

### 2 = B

### 3 = C

### 4 = D

### 5 = E

The point IDs must be input in numerically increasing order, except that 0 (None) values are
allowed anywhere. No duplicate values are allowed excepth for 0 (None).

Strain

This is an array that includes the strain at each point on the stress strain curve. The strains must
increase monotonically.

Stress

This is an array that includes the stress at each point on the stress strain curve. [F/L^2 ]

Points that have a negative strain must have a zero or negative stress. Similarly, points that have a
positive strain must have a zero or positive stress.

There must be one point defined that has zero strain and zero stress.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the material stress-strain curve for materials that are specified to have user-
defined stress-strain curves.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropUserSS()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim PointID() As Long
Dim Strain() As Double
Dim Stress() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign other properties
ret = SapModel.PropMaterial.SetOSteel("Steel", 55, 68, 60, 70, 0, 1, 0, 0, 0)

'assign user SS curve
ReDim PointID(4)
ReDim Strain(4)
ReDim Stress(4)
Strain(0) = -0.003: Stress(0) = -50: PointID(0) = -3
Strain(1) = -0.001: Stress(1) = -25: PointID(1) = 0
Strain(2) = 0: Stress(2) = -0: PointID(2) = 1
Strain(3) = 0.003: Stress(3) = 40: PointID(3) = 0
Strain(4) = 0.008: Stress(4) = 80: PointID(4) = 5
ret = SapModel.PropMaterial.SetSSCurve("Steel", 5, PointID, Strain, Stress)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetSSCurve

# SetOTendon_1

## Syntax

SapObject.SapModel.PropMaterial.SetOTendon_1


## VB6 Procedure

Function SetOTendon_1(ByVal Name As String, ByVal Fy As Double, ByVal Fu As Double,
ByVal SSType As Long, ByVal SSHysType As Long, ByVal FinalSlope As Double, Optional
ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing tendon material property.

Fy

The minimum yield stress. [F/L^2 ]

Fu

The minimum tensile stress. [F/L^2 ]

SSType

This is 0, 1 or 2, indicating the stress-strain curve type.

```
0 = User defined
1 = Parametric – 250 ksi strand
2 = Parametric – 270 ksi strand
```
SSHysType

This is 0, 1 or 2, indicating the stress-strain hysteresis type.

```
0 = Elastic
1 = Kinematic
2 = Takeda
```
FinalSlope

This item applies only to parametric stress-strain curves. It is a multiplier on the material modulus
of elasticity, E. This value multiplied times E gives the final slope of the curve.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
defined previously for the material.

## Remarks

This function sets the other material property data for tendon materials.


The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropTendonData_1()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Tendon", MATERIAL_TENDON)

'assign other properties
ret = SapModel.PropMaterial.SetOTendon_1("Tendon", 230, 255, 1, 1, -0.1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 12.00.

This function supersedes SetOTendon.

## See Also

GetOTendon_1

# SetTemp


## Syntax

SapObject.SapModel.PropMaterial.SetTemp

## VB6 Procedure

Function SetTemp(ByVal Name As String, ByVal NumberItems as long, ByRef Temp() As
Double) As Long

## Parameters

Name

The name of an existing material property.

NumberItems

The number of different temperatures at which properties are specified for the material.

Temp

This is an array that includes the different temperatures at which properties are specified for the
material.

## Remarks

This function assigns the temperatures at which properties are specified for a material. This data is
required only for materials whose properties are temperature dependent.

The function returns zero if the temperatures are successfully set; otherwise it returns a nonzero
value.

## VBA Example

Sub SetMatPropTemps()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyTemp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'specify temps at which properties will be provided
ReDim MyTemp(2)
MyTemp(0) = 0
MyTemp(1) = 50
MyTemp(2) = 100
ret = SapModel.PropMaterial.SetTemp("Steel", 3, MyTemp)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetTemp

# SetVonMisesPlasticityParameters

## Syntax

SapObject.SapModel.PropMaterial.SetVonMisesPlasticityParameters

## VB6 Procedure

Function SetVonMisesPlasticityParameters(ByVal Name As String, ByVal UseIsoLinHardening
As Boolean, ByVal IsoLinHardeningModulus As Double, ByVal UseIsoNLHardening As
Boolean, ByVal IsoNLUltimateStressRatio As Double, ByVal IsoNLHardeningRate As Double,
ByVal UseKinLinHardening As Boolean, ByVal KinLinHardeningModulus As Double, Optional
ByVal YieldStress As Double = 0.0, Optional ByVal Temp As Double = 0.0) As Long

## Parameters

Name


The name of an existing material property.

UseIsoLinHardening

If this item is True, the linear isotropic hardening is enabled.

IsoLinHardeningModulus

The linear isotropic hardening modulus, used if UseIsoLinHardening = True.

UseIsoNLHardening

If this item is True, the nonlinear isotropic saturation hardening is enabled.

IsoNLUltimateStressRatio

The ultimate stress as a ratio of the yield stress, used if UseIsoNLHardening = True.

IsoNLHardeningRate

The hardening rate parameter, used if UseIsoNLHardening = True.

UseKinLinHardening

If this item is True, the linear kinematic hardening is enabled.

KinLinHardeningModulus

The linear kinematic hardening modulus, used if UseKinLinHardening = True.

YieldStress

The yield stress.

This item applies only if the specified material has a material type of eMatType.NoDesign.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been defined previously for the material.

## Remarks

This function sets the Von Mises Plasticity coupled modeling parameters for a specified material

The function returns zero if the assignment data is successfully assigned; otherwise it returns a
nonzero value.

## VBA Example

Sub SetMatCoupledTypeData()


'dimension variables

Dim SapObject as cOAPI

Dim SapModel As cSapModel

Dim ret As Long

'create Sap2000 object

Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application

SapObject.ApplicationStart

'create SapModel object

Set SapModel = SapObject.SapModel

'initialize model

ret = SapModel.InitializeNewModel

'create model from template

ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property

ret = SapModel.PropMaterial.SetMaterial("Steel", eMatType.eMatType_Steel, -1, "API
example test", "Default")

'set coupled material type data

ret = SapModel.PropMaterial.SetCoupledModelType("Steel",
eMatCoupledType.eMatCoupledType_VonMisesPlasticity)

'set Von Mises Plasticity data


ret = SapModel.PropMaterial.SetVonMisesPlasticityParameters ("Steel", True, 1000.0, True,
1.2, 50, True, 1000.0)

'close Sap2000

SapObject.ApplicationExit False

Set SapModel = Nothing

Set SapObject = Nothing

End Sub

## Release Notes

Initial release in version 22.1.0

## See Also

GetCoupledModelType

SetCoupledModelType

GetVonMisesPlasticityParameters

# SetWeightAndMass

## Syntax

SapObject.SapModel.PropMaterial.SetWeightAndMass

## VB6 Procedure

Function SetWeightAndMass(ByVal Name As String, ByVal MyOption As Long, ByVal Value
As Double, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing material property.

MyOption

This is either 1 or 2, indicating what is specified by the Value item.

```
1 = Weight per unit volume is specified
2 = Mass per unit volume is specified
```

If the weight is specified, the corresponding mass is program calculated based on the specified
weight. Similarly, if the mass is specified, the corresponding weight is program calculated based
on the specified mass.

Value

This is either the weight per unit volume or the mass per unit volume, depending on the value of
the MyOption item. [F/L^3 ] for MyOption = 1 (weight), and [M/L^3 ] for MyOption = 2 (mass)

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data applies. The temperature must have been
define previously for the material.

## Remarks

This function assigns weight per unit volume or mass per unit volume to a material property.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropWeight()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Steel", MATERIAL_STEEL)

'assign material property weight per unit volume
ret = SapModel.PropMaterial.SetWeightAndMass("Steel", 1, 0.00029)


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetWeightAndMass

# GetConcreteCEBFIP90

## Syntax

SapObject.SapModel.PropMaterial.GetConcreteCEBFIP90

## VB6 Procedure

Function GetConcreteCEBFIP90(ByVal Name As String, ByRef ConsiderConcreteAge As
Boolean, ByRef ConsiderConcreteCreep As Boolean, ByRef ConsiderConcreteShrinkage As
Boolean, ByRef CEBFIPsCoefficient As Double, ByRef RelativeHumidity As Double, ByRef
NotionalSize As Double, ByRef ShrinkageCoefficient As Double, ByRef ShrinkageStartAge As
Double, ByRef UseSeries As Long, ByRef NumberSeriesTerms As Long, Optional ByVal Temp
As Double = 0) As Long

## Parameters

Name

The name of an existing concrete material property.

ConsiderConcreteAge

If this item is True, time dependence is considered for concrete compressive strength and stiffness
(modulus of elasticity).

ConsiderConcreteCreep

If this item is True, time dependence is considered for concrete creep.

ConsiderConcreteShrinkage

If this item is True, time dependence is considered for concrete shrinkage.

CEBFIPsCoefficient


This is the cement type coefficient. This item applies only when ConsiderConcreteAge = True.

RelativeHumidity

This is relative humidity. This item applies only when ConsiderConcreteCreep = True or
ConsiderConcreteShrinkage = True.

NotionalSize

This is notional size of the member. This item applies only when ConsiderConcreteCreep = True
or ConsiderConcreteShrinkage = True.

As defined in Equation 2.1-69 of CEB_FIP Model Code 1990 the notional size is equal to two
times the cross-sectional area of the member divided by the perimeter of the member in contact
with the atmosphere.

ShrinkageCoefficient

This is the shrinkage coefficient as defined in Equation 2.1-76 of CEB_FIP Model Code 1990.
This item applies only when ConsiderConcreteShrinkage = True.

ShrinkageStartAge

This is the shrinkage start age in days as used in Section 2.1.6.4.4 of CEB_FIP Model Code 1990.
This item applies only when ConsiderConcreteShrinkage = True.

UseSeries

This is either 0 or 1, indicating the creep integration type.

```
0 = Full integration
1 = Dirichlet series
```
This item applies only when ConsiderConcreteCreep = True.

NumberSeriesTerms

This is the number of series terms used when integrating based on a Dirichlet series. This item
applies only when ConsiderConcreteCreep = True and UseSeries = 1.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been previously defined for the material.

## Remarks

This function retrieves the time dependent CEB FIP-90 material property data for concrete
materials.


The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not concrete.

## VBA Example

Sub GetMatPropConcreteTimeDepCEBFIP90()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ConsiderConcreteAge As Boolean
Dim ConsiderConcreteCreep As Boolean
Dim ConsiderConcreteShrinkage As Boolean
Dim CEBFIPsCoefficient As Double
Dim RelativeHumidity As Double
Dim NotionalSize As Double
Dim ShrinkageCoefficient As Double
Dim ShrinkageStartAge As Double
Dim UseSeries As Long
Dim NumberSeriesTerms As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Concrete", MATERIAL_CONCRETE)

'assign CEB FIP-90 time dependent data
ret = SapModel.PropMaterial.TimeDep.SetConcreteCEBFIP90("Concrete", True, True, True,
0.2, 40, 4, 4.9, 2, 1, 12)

'get CEB FIP-90 time dependent data
ret = SapModel.PropMaterial.TimeDep.GetConcreteCEBFIP90("Concrete",
ConsiderConcreteAge, ConsiderConcreteCreep, ConsiderConcreteShrinkage,
CEBFIPsCoefficient, RelativeHumidity, NotionalSize, ShrinkageCoefficient, ShrinkageStartAge,
UseSeries, NumberSeriesTerms)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetConcreteCEBFIP90

# GetTendonScaleFactors

## Syntax

SapObject.SapModel.PropMaterial.TimeDep.GetTendonScaleFactors

## VB6 Procedure

Function GetTendonScaleFactors(ByVal Name As String, ByRef ScaleFactorRelaxation As
Double, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing tendon material property.

ScaleFactorRelaxation

This value multiplies the relaxation coefficient, and hence the relaxation strain, computed for the
material during a time-dependent analysis. It has no effect for load cases that do not consider time-
dependent effects, or for materials that do not consider relaxation effects. The default value is
unity, and the specified value must be positive.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been previously defined for the material.

## Remarks

This function retrieves the scale factors for the time-dependent material property data for tendon
materials.


The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not tendon.

## VBA Example

Sub GetMatPropTendonTimeDepScaleFactors()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim ScaleFactorRelaxation As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Tendon", eMatType,Tendon)

'assign CEB FIP-90 time dependent data
ret = SapModel.PropMaterial.TimeDep.SetTendonCEBFIP90("Tendon", True, 2, 1, 12)

'assign time dependent scale factors
ret = SapModel.PropMaterial.TimeDep.SetTendonScaleFactors("Tendon", 1.15)

'get time dependent scale factors
ret = SapModel.PropMaterial.TimeDep.GetTendonScaleFactors("Tendon",
ScaleFactorRelaxation)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 17.2.0.

## See Also

SetTendonScaleFactors

# GetTendonCEBFIP90

## Syntax

SapObject.SapModel.PropMaterial.GetTendonCEBFIP90

## VB6 Procedure

Function GetTendonCEBFIP90(ByVal Name As String, ByRef ConsiderSteelRelaxation As
Boolean, ByRef CEBFIPClass As Long, ByRef UseSeries As Long, ByRef NumberSeriesTerms
As Long, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing tendon material property.

ConsiderSteelRelaxation

If this item is True, time dependence is considered for tendon steel relaxation.

CEBFIPClass

This is either 1 or 2, indicating the CEB FIP-90 class. This item applies only when
ConsiderSteelRelaxation = True.

UseSeries

This is either 0 or 1, indicating the steel relaxation integration type.

```
0 = Full integration
1 = Dirichlet series
```
This item applies only when ConsiderSteelRelaxation = True.

NumberSeriesTerms

This is the number of series terms used when integrating based on a Dirichlet series. This item
applies only when ConsiderSteelRelaxation = True and UseSeries = 1.

Temp


This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been previously defined for the material.

## Remarks

This function retrieves the time dependent CEB FIP-90 material property data for tendon
materials.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not tendon.

## VBA Example

Sub GetMatPropTendonTimeDepCEBFIP90()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim ConsiderSteelRelaxation As Boolean
Dim CEBFIPClass As Long
Dim UseSeries As Long
Dim NumberSeriesTerms As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Tendon", MATERIAL_TENDON)

'assign CEB FIP-90 time dependent data
ret = SapModel.PropMaterial.TimeDep.SetTendonCEBFIP90("Tendon", True, 2, 1, 12)

'get CEB FIP-90 time dependent data
ret = SapModel.PropMaterial.TimeDep.GetTendonCEBFIP90("Tendon",
ConsiderSteelRelaxation, CEBFIPClass, UseSeries, NumberSeriesTerms)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetTendonCEBFIP90

# GetConcreteScaleFactors

## Syntax

SapObject.SapModel.PropMaterial.TimeDep.GetConcreteScaleFactors

## VB6 Procedure

Function GetConcreteScaleFactors(ByVal Name As String, ByVal ScaleFactorAge As Double,
ByVal ScaleFactorCreep As Double, ByVal ScaleFactorShrinkage As Double, Optional ByVal
Temp As Double = 0) As Long

## Parameters

Name

The name of an existing concrete material property.

ScaleFactorAge

This value multiplies the stiffness (modulus of elasticity) computed with age for the material
during a time-dependent analysis. It has no effect for load cases that do not consider time-
dependent effects, or for materials that do not consider time-dependent age effects. The default
value is unity, and the specified value must be positive.

ScaleFactorCreep

This value multiplies the creep coefficient, and hence the creep strain, computed for the material
during a time-dependent analysis. It has no effect for load cases that do not consider time-
dependent effects, or for materials that do not consider creep effects. The default value is unity,
and the specified value must be positive.

ScaleFactorShrinkage

This value multiplies the shrinkage strain computed for the material during a time-dependent
analysis. It has no effect for load cases that do not consider time-dependent effects, or for


materials that do not consider shrinkage effects. The default value is unity, and the specified value
must be positive.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been previously defined for the material.

## Remarks

This function retrieves the scale factors for the time-dependent material property data for concrete
materials.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.
The function returns an error if the specified material is not concrete.

## VBA Example

Sub GetMatPropConcreteTimeDepScaleFactors()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

Dim ScaleFactorAge As Double
Dim ScaleFactorCreep As Double
Dim ScaleFactorShrinkage As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Concrete", eMatType,Concrete)

'assign CEB FIP-90 time dependent data
ret = SapModel.PropMaterial.TimeDep.SetConcreteCEBFIP90("Concrete", True, True, True,
0.2, 40, 4, 4.9, 2, 1, 12)


'assign time dependent scale factors
ret = SapModel.PropMaterial.TimeDep.SetConcreteScaleFactors("Concrete", 1.0, 1.2, 1.1)

'get time dependent scale factors
ret = SapModel.PropMaterial.TimeDep.GetConcreteScaleFactors("Concrete",
ScaleFactorAge, ScaleFactorCreep, ScaleFactorShrinkage)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.

## See Also

SetConcreteCEBFIP90

# SetConcreteCEBFIP90

## Syntax

SapObject.SapModel.PropMaterial.TimeDep.SetConcreteCEBFIP90

## VB6 Procedure

Function SetConcreteCEBFIP90(ByVal Name As String, ByVal ConsiderConcreteAge As
Boolean, ByVal ConsiderConcreteCreep As Boolean, ByVal ConsiderConcreteShrinkage As
Boolean, ByVal CEBFIPsCoefficient As Double, ByVal RelativeHumidity As Double, ByVal
NotionalSize As Double, ByVal ShrinkageCoefficient As Double, ByVal ShrinkageStartAge As
Double, ByVal UseSeries As Long, ByVal NumberSeriesTerms As Long, Optional ByVal Temp
As Double = 0) As Long

## Parameters

Name

The name of an existing concrete material property.

ConsiderConcreteAge

If this item is True, time dependence is considered for concrete compressive strength and stiffness
(modulus of elasticity).


ConsiderConcreteCreep

If this item is True, time dependence is considered for concrete creep.

ConsiderConcreteShrinkage

If this item is True, time dependence is considered for concrete shrinkage.

CEBFIPsCoefficient

This is the cement type coefficient. This item applies only when ConsiderConcreteAge = True.

RelativeHumidity

This is relative humidity. This item applies only when ConsiderConcreteCreep = True or
ConsiderConcreteShrinkage = True.

NotionalSize

This is notional size of the member. This item applies only when ConsiderConcreteCreep = True
or ConsiderConcreteShrinkage = True.

As defined in Equation 2.1-69 of CEB_FIP Model Code 1990 the notional size is equal to two
times the cross-sectional area of the member divided by the perimeter of the member in contact
with the atmosphere.

ShrinkageCoefficient

This is the shrinkage coefficient as defined in Equation 2.1-76 of CEB_FIP Model Code 1990.
This item applies only when ConsiderConcreteShrinkage = True.

ShrinkageStartAge

This is the shrinkage start age in days as used in Section 2.1.6.4.4 of CEB_FIP Model Code 1990.
This item applies only when ConsiderConcreteShrinkage = True.

UseSeries

This is either 0 or 1, indicating the creep integration type.

```
0 = Full integration
1 = Dirichlet series
```
This item applies only when ConsiderConcreteCreep = True.

NumberSeriesTerms

This is the number of series terms used when integrating based on a Dirichlet series. This item
applies only when ConsiderConcreteCreep = True and UseSeries = 1.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.


This item is the temperature at which the specified data applies. The temperature must have been
previously defined for the material.

## Remarks

This function sets the time dependent CEB FIP-90 material property data for concrete materials.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropConcreteTimeDepCEBFIP90()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Concrete", MATERIAL_CONCRETE)

'assign CEB FIP-90 time dependent data
ret = SapModel.PropMaterial.TimeDep.SetConcreteCEBFIP90("Concrete", True, True, True,
0.2, 40, 4, 4.9, 2, 1, 12)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

GetConcreteCEBFIP90

# SetConcreteScaleFactors

## Syntax

SapObject.SapModel.PropMaterial.TimeDep.SetConcreteScaleFactors

## VB6 Procedure

Function SetConcreteScaleFactors(ByVal Name As String, ByVal ScaleFactorAge As Double,
ByVal ScaleFactorCreep As Double, ByVal ScaleFactorShrinkage As Double, Optional ByVal
Temp As Double = 0) As Long

## Parameters

Name

The name of an existing concrete material property.

ScaleFactorAge

This value multiplies the stiffness (modulus of elasticity) computed with age for the material
during a time-dependent analysis. It has no effect for load cases that do not consider time-
dependent effects, or for materials that do not consider time-dependent age effects. The default
value is unity, and the specified value must be positive.

ScaleFactorCreep

This value multiplies the creep coefficient, and hence the creep strain, computed for the material
during a time-dependent analysis. It has no effect for load cases that do not consider time-
dependent effects, or for materials that do not consider creep effects. The default value is unity,
and the specified value must be positive.

ScaleFactorShrinkage

This value multiplies the shrinkage strain computed for the material during a time-dependent
analysis. It has no effect for load cases that do not consider time-dependent effects, or for
materials that do not consider shrinkage effects. The default value is unity, and the specified value
must be positive.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been previously defined for the material.


## Remarks

This function sets scale factors for the time-dependent material property data for concrete
materials. If this function is not called, default values of unity are assumed for all scale factors.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropConcreteTimeDepScaleFactors()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Concrete", eMatType,Concrete)

'assign CEB FIP-90 time dependent data
ret = SapModel.PropMaterial.TimeDep.SetConcreteCEBFIP90("Concrete", True, True, True,
0.2, 40, 4, 4.9, 2, 1, 12)

'assign time dependent scale factors
ret = SapModel.PropMaterial.TimeDep.SetConcreteScaleFactors("Concrete", 1.0, 1.2, 1.1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.


## See Also

GetConcreteScaleFactors

# SetTendonCEBFIP90

## Syntax

SapObject.SapModel.PropMaterial.TimeDep.SetTendonCEBFIP90

## VB6 Procedure

Function SetTendonCEBFIP90(ByVal Name As String, ByVal ConsiderSteelRelaxation As
Boolean, ByVal CEBFIPClass As Long, ByVal UseSeries As Long, ByVal NumberSeriesTerms
As Long, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing tendon material property.

ConsiderSteelRelaxation

If this item is True, time dependence is considered for tendon steel relaxation.

CEBFIPClass

This is either 1 or 2, indicating the CEB FIP-90 class. This item applies only when
ConsiderSteelRelaxation = True.

UseSeries

This is either 0 or 1, indicating the steel relaxation integration type.

```
0 = Full integration
1 = Dirichlet series
```
This item applies only when ConsiderSteelRelaxation = True.

NumberSeriesTerms

This is the number of series terms used when integrating based on a Dirichlet series. This item
applies only when ConsiderSteelRelaxation = True and UseSeries = 1.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.


This item is the temperature at which the specified data applies. The temperature must have been
previously defined for the material.

## Remarks

This function sets the time dependent CEB FIP-90 material property data for tendon materials.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropTendonTimeDepCEBFIP90()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Tendon", MATERIAL_TENDON)

'assign CEB FIP-90 time dependent data
ret = SapModel.PropMaterial.TimeDep.SetTendonCEBFIP90("Tendon", True, 2, 1, 12)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also


GetTendonCEBFIP90

# SetTendonScaleFactors

## Syntax

SapObject.SapModel.PropMaterial.TimeDep.SetTendonScaleFactors

## VB6 Procedure

Function SetTendonScaleFactors(ByVal Name As String, ByRef ScaleFactorRelaxtion As
Double, Optional ByVal Temp As Double = 0) As Long

## Parameters

Name

The name of an existing tendon material property.

ScaleFactorRelaxation

This value multiplies the relaxation coefficient, and hence the relaxation strain, computed for the
material during a time-dependent analysis. It has no effect for load cases that do not consider time-
dependent effects, or for materials that do not consider relaxation effects. The default value is
unity, and the specified value must be positive.

Temp

This item applies only if the specified material has properties that are temperature dependent. That
is, it applies only if properties are specified for the material at more than one temperature.

This item is the temperature at which the specified data is to be retrieved. The temperature must
have been previously defined for the material.

## Remarks

This function sets scale factors for the time-dependent material property data for tendon materials.
If this function is not called, default values of unity are assumed for all scale factors.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub AssignMatPropTendonTimeDepCEBIFP90
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'initialize new material property
ret = SapModel.PropMaterial.SetMaterial("Tendon", eMatType,Tendon)

'assign CEB FIP-90 time dependent data
ret = SapModel.PropMaterial.TimeDep.SetTendonCEBFIP90("Tendon", True, 2, 1, 12)

'assign time dependent scale factors
ret = SapModel.PropMaterial.TimeDep.SetTendonScaleFactors("Tendon", 1.15)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 17.2.0.

## See Also

GetTendonScaleFactors

# ChangeName

## Syntax

SapObject.SapModel.PropLink.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long


## Parameters

Name

The existing name of a defined link property.

NewName

The new name for the link property.

## Remarks

This function changes the name of an existing link property.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeLinkPropName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12


ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)

'change name of link property
ret = SapModel.PropLink.ChangeName("L1", "MyLink")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# Count

## Syntax

SapObject.SapModel.PropLink.Count

## VB6 Procedure

Function Count(Optional ByVal PropType As eLinkPropType) As Long

## Parameters

PropType

This optional value is one of the following items in the eLinkPropType enumeration.

```
NLPROP_LINEAR = 1
NLPROP_DAMPER = 2
NLPROP_GAP = 3
NLPROP_HOOK = 4
NLPROP_PLASTIC_WEN = 5
NLPROP_ISOLATOR1 = 6 (Rubber isolator)
NLPROP_ISOLATOR2 = 7 (Friction isolator)
NLPROP_MULTILINEAR_ELASTIC = 8
NLPROP_MULTILINEAR_PLASTIC = 9
NLPROP_ISOLATOR3 = 10 (T/C Friction isolator)
```
If no value is input for PropType, a count is returned for all link properties in the model regardless
of type.


## Remarks

This function returns the total number of defined link properties in the model. If desired, counts
can be returned for all link properties of a specified type in the model.

## VBA Example

Sub CountLinkProps()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add link property
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)

'return number of defined links of all types
Count = SapModel.PropLink.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

# Delete

## Syntax

SapObject.SapModel.PropLink.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing link property.

## Remarks

The function deletes a specified link property.

The function returns zero if the link property is successfully deleted; otherwise it returns a nonzero
value. It returns an error if the specified link property can not be deleted, for example, if it is being
used by an existing link object.

## VBA Example

Sub DeleteLinkProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim i As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)

'add link properties
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)
ret = SapModel.PropLink.SetLinear("L2", DOF, Fixed, Ke, Ce, 0, 0)

'delete link property
ret = SapModel.PropLink.Delete("L1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# GetDamper

## Syntax

SapObject.SapModel.PropLink.GetDamper

## VB6 Procedure

Function GetDamper(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As
Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef


k() As Double, ByRef c() As Double, ByRef cexp() As Double, ByRef dj2 As Double, ByRef dj3
As Double, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing exponential damper-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke


This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

c

This is an array of nonlinear damping coefficient terms for the link property. The nonlinear
damping coefficient applies for nonlinear analyses.

```
c(0) = U1 [F/(L^cexp)]
c(1) = U2 [F/(L^cexp)]
c(2) = U3 [F/(L^cexp)]
c(3) = R1 [FL]
c(4) = R2 [FL]
c(5) = R3 [FL]
```

The term c(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

cexp

This is an array of the nonlinear damping exponent terms. The nonlinear damping exponent
applies for nonlinear analyses. It is applied to the velocity across the damper in the equation of
motion.

```
cexp(0) = U1
cexp(1) = U2
cexp(2) = U3
cexp(3) = R1
cexp(4) = R2
cexp(5) = R3
```
The term cexp(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for an exponential damper-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropDamper()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean


Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MyC() As Double
Dim MyCexp() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Nonlinear() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim k() As Double
Dim c() As Double
Dim cexp() As Double
Dim dj2 As Double
Dim dj3 As Double
Dim Notes As String
Dim GUID As String

```
'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
SapObject.ApplicationStart
```
```
'create SapModel object
Set SapModel = SapObject.SapModel
```
```
'initialize model
ret = SapModel.InitializeNewModel
```
```
'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
```
'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MyC(5)
ReDim MyCexp(5)
```
```
MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01
```
```
MyDOF(1) = True
MyNonLinear(1) = True
```

```
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MyC(1)=0.08
MyCexp(1) = 1.2
```
```
MyDOF(2) = True
MyFixed(2) = True
```
```
ret = SapModel.PropLink.SetDamper("D1", MyDOF, MyFixed,
MyNonLinear, MyKe, MyCe, MyK, MyC, MyCexp, 1, 0)
```
```
'get link property data
```
```
ret = SapModel.PropLink.GetDamper ("D1", DOF, Fixed, NonLinear, Ke, Ce, k, c,
cexp, dj2, dj3, Notes, GUID)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 11.02.

Clarification that damper type is exponential added in version 16.0.2.

## See Also

SetDamper

# GetDamperBilinear

## Syntax

SapObject.SapModel.PropLink.GetDamperBilinear

## VB6 Procedure


Function GetDamperBilinear (ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed()
As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double,
ByRef k() As Double, ByRef c() As Double, ByRef cy() As Double, ByRef ForceLimit() As
Double, ByVal dj2 As Double, ByVal dj3 As Double, Optional ByVal Notes As String = "",
Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing bilinear damper-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained.)

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.


```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) only applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

c

This is an array of nonlinear initial damping coefficient terms for the link property. The nonlinear
initial damping coefficient applies for nonlinear analyses.

```
c(0) = U1 [F/L]
c(1) = U2 [F/L]
c(2) = U3 [F/L]
c(3) = R1 [FL]
c(4) = R2 [FL]
c(5) = R3 [FL]
```
The term c(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

cy

This is an array of nonlinear yielded damping coefficient terms for the link property. The
nonlinear yielded damping coefficient applies for nonlinear analyses.

```
cy(0) = U1 [F/L]
cy(1) = U2 [F/L]
cy(2) = U3 [F/L]
```

```
cy(3) = R1 [FL]
cy(4) = R2 [FL]
cy(5) = R3 [FL]
```
The term cy(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

ForceLimit

This is an array of nonlinear linear force limit terms for the link property. The linear force limit
applies for nonlinear analyses.

```
ForceLimit(0) = U1 [F]
ForceLimit(1) = U2 [F]
ForceLimit(2) = U3 [F]
ForceLimit(3) = R1 [FL]
ForceLimit(4) = R2 [FL]
ForceLimit(5) = R3 [FL]
```
The term ForceLimit(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function retrieves link property data for a bilinear damper-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropDamperBilinear ()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```

```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim MyDOF() As Boolean
```
```
Dim MyFixed() As Boolean
```
```
Dim MyNonLinear() As Boolean
```
```
Dim MyKe() As Double
```
```
Dim MyCe() As Double
```
```
Dim MyK() As Double
```
```
Dim MyC() As Double
```
```
Dim MyCy() As Double
```
```
Dim MyForceLimit() As Double
```
```
Dim DOF() As Boolean
```
```
Dim Fixed() As Boolean
```
```
Dim NonLinear() As Boolean
```
```
Dim Ke() As Double
```
```
Dim Ce() As Double
```
```
Dim K() As Double
```
```
Dim C() As Double
```
```
Dim Cy() As Double
```
```
Dim ForceLimit() As Double
```
```
Dim dj2 As Double
```
```
Dim dj3 As Double
```
```
Dim Notes As String
```
```
Dim GUID As String
```
'create Sap2000 object

```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```

'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
'add link property

```
ReDim MyDOF(5)
```
```
ReDim MyFixed(5)
```
```
ReDim MyNonLinear(5)
```
```
ReDim MyKe(5)
```
```
ReDim MyCe(5)
```
```
ReDim MyK(5)
```
```
ReDim MyC(5)
```
```
ReDim MyCy(5)
```
```
ReDim MyForceLimit(5)
```
```
MyDOF(0) = True
```
```
MyKe(0) = 12
```
```
MyCe(0) = 0.01
```
```
MyDOF(1) = True
```

```
MyNonLinear(1) = True
```
```
MyKe(1) = 12
```
```
MyCe(1) = 0.01
```
```
MyK(1) = 20
```
```
MyC(1)=0.08
```
```
MyCy(1) = 0.008
```
```
MyForceLimit(1) = 50
```
```
MyDOF(2) = True
```
```
MyFixed(2) = True
```
```
ret = SapModel.PropLink.SetDamperBilinear("D1", MyDOF, MyFixed,
MyNonLinear, MyKe, MyCe, MyK, MyC, MyCy, MyForceLimit, 1, 0)
```
```
'get link property data
```
```
ret = SapModel.PropLink.GetDamperBilinear ("D1", DOF, Fixed, NonLinear, Ke,
Ce, k, c, cy, ForceLimit, dj2, dj3, Notes, GUID)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.0.2.

## See Also

SetDamperBilinear


# GetDamperFrictionSpring

## Syntax

SapObject.SapModel.PropLink.GetDamperFrictionSpring

## VB6 Procedure

Function GetDamperFrictionSpring(ByVal Name As String, ByRef DOF() As Boolean, ByRef
Fixed() As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As
Double, ByRef k() As Double, ByRef k1() As Double, ByRef k2() As Double, ByRef u0() As
Double, ByRef us() As Double, ByRef dir() As Long, ByRef dj2 As Double, ByRef dj3 As
Double, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing friction spring damper-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained.)

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
```

```
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial (nonslipping) stiffness terms for the link property. The initial stiffness
applies for nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) only applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

k1

This is an array of slipping stiffness when loading terms for the link property. The slipping
stiffness when loading applies for nonlinear analyses.

```
k1(0) = U1 [F/L]
k1(1) = U2 [F/L]
k1(2) = U3 [F/L]
k1(3) = R1 [FL]
k1(4) = R2 [FL]
k1(5) = R3 [FL]
```

The term k1(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

k2

This is an array of slipping stiffness when unloading terms for the link property. The slipping
stiffness when unloading applies for nonlinear analyses.

```
k2(0) = U1 [F/L]
k2(1) = U2 [F/L]
k2(2) = U3 [F/L]
k2(3) = R1 [FL]
k2(4) = R2 [FL]
k2(5) = R3 [FL]
```
The term k2(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

u0

This is an array of precompression displacement terms for the link property. The nonlinear
precompression displacement applies for nonlinear analyses.

```
u0(0) = U1 [L]
u0(1) = U2 [L]
u0(2) = U3 [L]
u0(3) = R1
u0(4) = R2
u0(5) = R3
```
The term u0(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

us

This is an array of stop displacement terms for the link property. The nonlinear stop displacement
applies for nonlinear analyses.

```
us(0) = U1 [L]
us(1) = U2 [L]
us(2) = U3 [L]
us(3) = R1
us(4) = R2
us(5) = R3
```
The term us(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.


### GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function retrieves link property data for a friction spring damper-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropDamperFrictionSpring()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim MyDOF() As Boolean
```
```
Dim MyFixed() As Boolean
```
```
Dim MyNonLinear() As Boolean
```
```
Dim MyKe() As Double
```
```
Dim MyCe() As Double
```
```
Dim MyK() As Double
```
```
Dim MyK1() As Double
```
```
Dim MyK2() As Double
```
```
Dim MyU0() As Double
```
```
Dim MyUs() As Double
```
```
Dim MyDir() As Long
```
```
Dim DOF() As Boolean
```
```
Dim Fixed() As Boolean
```
```
Dim NonLinear() As Boolean
```
```
Dim Ke() As Double
```

```
Dim Ce() As Double
```
```
Dim K() As Double
```
```
Dim K1() As Double
```
```
Dim K2() As Double
```
```
Dim U0() As Double
```
```
Dim Us() As Double
```
```
Dim Dir() As Long
```
```
Dim dj2 As Double
```
```
Dim dj3 As Double
```
```
Dim Notes As String
```
```
Dim GUID As String
```
'create Sap2000 object

```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
'add link property


ReDim MyDOF(5)

ReDim MyFixed(5)

ReDim MyNonLinear(5)

ReDim MyKe(5)

ReDim MyCe(5)

ReDim MyK(5)

ReDim MyK1(5)

ReDim MyK2(5)

ReDim MyU0(5)

ReDim MyUs(5)

ReDim MyDir(5)

MyDOF(0) = True

MyKe(0) = 12

MyCe(0) = 0.01

MyDOF(1) = True

MyNonLinear(1) = True

MyKe(1) = 12

MyCe(1) = 0.01

MyK(1) = 20

MyK1(1)=2

MyK2(1) = 1

MyU0(1) = -.2

MyUs(1) = 1

MyDir(1) = 2

MyDOF(2) = True


```
MyFixed(2) = True
```
```
ret = SapModel.PropLink.SetDamperFrictionSpring("D1", MyDOF, MyFixed,
MyNonLinear, MyKe, MyCe, MyK, MyK1, MyK2, MyU0, MyUs, MyDir, 1, 0)
```
```
'get link property data
```
```
ret = SapModel.PropLink.GetDamperFrictionSpring ("D1", DOF, Fixed,
NonLinear, Ke, Ce, k, K1, K2, U0, Us, Dir, dj2, dj3, Notes, GUID)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.0.2.

## See Also

SetDamperFrictionSpring

# GetDamperLinearExponential

## Syntax

SapObject.SapModel.PropLink.GetDamperLinearExponential

## VB6 Procedure

Function GetDamperLinearExponential(ByVal Name As String, ByRef DOF() As Boolean,
ByRef Fixed() As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce()
As Double, ByRef k() As Double, ByRef c() As Double, ByRef cexp() As Double, ByRef
ForceLimit() As Double, ByRef dj2 As Double, ByRef dj3 As Double, ByRef Notes As String,
ByRef GUID As String) As Long

## Parameters


Name

The name of an existing linear exponential damper-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained.)

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```

The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) only applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

c

This is an array of nonlinear damping coefficient terms for the link property. The nonlinear
damping coefficient applies for nonlinear analyses.

```
c(0) = U1 [F/(L^cexp)]
c(1) = U2 [F/(L^cexp)]
c(2) = U3 [F/(L^cexp)]
c(3) = R1 [FL]
c(4) = R2 [FL]
c(5) = R3 [FL]
```
The term c(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

cexp

This is an array of the nonlinear damping exponent terms. The nonlinear damping exponent
applies for nonlinear analyses. It is applied to the velocity across the damper in the equation of
motion.

```
cexp(0) = U1
cexp(1) = U2
cexp(2) = U3
cexp(3) = R1
cexp(4) = R2
```

```
cexp(5) = R3
```
The term cexp(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

ForceLimit

This is an array of nonlinear linear force limit terms for the link property. The linear force limit
applies for nonlinear analyses.

```
ForceLimit(0) = U1 [F]
ForceLimit(1) = U2 [F]
ForceLimit(2) = U3 [F]
ForceLimit(3) = R1 [FL]
ForceLimit(4) = R2 [FL]
ForceLimit(5) = R3 [FL]
```
The term ForceLimit(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function retrieves link property data for a linear exponential damper-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropDamperLinearExponential()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```

```
Dim ret As Long
```
```
Dim MyDOF() As Boolean
```
```
Dim MyFixed() As Boolean
```
```
Dim MyNonLinear() As Boolean
```
```
Dim MyKe() As Double
```
```
Dim MyCe() As Double
```
```
Dim MyK() As Double
```
```
Dim MyC() As Double
```
```
Dim MyCexp() As Double
```
```
Dim MyForceLimit() As Double
```
```
Dim DOF() As Boolean
```
```
Dim Fixed() As Boolean
```
```
Dim NonLinear() As Boolean
```
```
Dim Ke() As Double
```
```
Dim Ce() As Double
```
```
Dim K() As Double
```
```
Dim C() As Double
```
```
Dim Cexp() As Double
```
```
Dim ForceLimit() As Double
```
```
Dim dj2 As Double
```
```
Dim dj3 As Double
```
```
Dim Notes As String
```
```
Dim GUID As String
```
'create Sap2000 object

```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
'start Sap2000 application


```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
'add link property

```
ReDim MyDOF(5)
```
```
ReDim MyFixed(5)
```
```
ReDim MyNonLinear(5)
```
```
ReDim MyKe(5)
```
```
ReDim MyCe(5)
```
```
ReDim MyK(5)
```
```
ReDim MyC(5)
```
```
ReDim MyCexp(5)
```
```
ReDim MyForceLimit(5)
```
```
MyDOF(0) = True
```
```
MyKe(0) = 12
```
```
MyCe(0) = 0.01
```
```
MyDOF(1) = True
```
```
MyNonLinear(1) = True
```

```
MyKe(1) = 12
```
```
MyCe(1) = 0.01
```
```
MyK(1) = 20
```
```
MyC(1)=0.08
```
```
MyCexp(1) = 1.2
```
```
MyForceLimit(1) = 50
```
```
MyDOF(2) = True
```
```
MyFixed(2) = True
```
```
ret = SapModel.PropLink.SetDamperLinearExponential("D1", MyDOF, MyFixed,
MyNonLinear, MyKe, MyCe, MyK, MyC, MyCexp, MyForceLimit, 1, 0)
```
```
'get link property data
```
```
ret = SapModel.PropLink.GetDamperLinearExponential ("D1", DOF, Fixed,
NonLinear, Ke, Ce, k, c, cexp, ForceLimit, dj2, dj3, Notes, GUID)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.0.2.

## See Also

SetDamperLinearExponential

# GetFrictionIsolator


## Syntax

SapObject.SapModel.PropLink.GetFrictionIsolator

## VB6 Procedure

Function GetFrictionIsolator(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed()
As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double,
ByRef k() As Double, ByRef Slow() As Double, ByRef Fast() As Double, ByRef Rate() As
Double, ByRef Radius() As Double, ByRef Damping As Double, ByRef dj2 As Double, ByRef
dj3 As Double, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing friction isolator-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
```

```
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1, Not Used
NonLinear(4) = R2, Not Used
NonLinear(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U1, U2 and U3. For those degrees of
freedom, the term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1, Not Used
k(4) = R2, Not Used
k(5) = R3, Not Used
```

Note that this item is applicable only for degrees of freedom U1, U2 and U3. For those degrees of
freedom, the term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Slow

This is an array of the friction coefficient at zero velocity terms for the link property. This
coefficient applies for nonlinear analyses.

```
Slow(0) = U1, Not Used
Slow(1) = U2
Slow(2) = U3
Slow(3) = R1, Not Used
Slow(4) = R2, Not Used
Slow(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Slow(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Fast

This is an array of the friction coefficient at fast velocity terms for the link property. This
coefficient applies for nonlinear analyses.

```
Fast(0) = U1, Not Used
Fast(1) = U2
Fast(2) = U3
Fast(3) = R1, Not Used
Fast(4) = R2, Not Used
Fast(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Fast(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Rate

This is an array of the inverse of the characteristic sliding velocity terms for the link property. This
item applies for nonlinear analyses.

```
Rate(0) = U1, Not Used
Rate(1) = U2 [s/L]
Rate(2) = U3 [s/L]
Rate(3) = R1, Not Used
Rate(4) = R2, Not Used
Rate(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Rate(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.


Radius

This is an array of the radius of the sliding contact surface terms for the link property. Inputting 0
means there is an infinite radius, that is, the slider is flat. This item applies for nonlinear analyses.

```
Radius(0) = U1, Not Used
Radius(1) = U2 [L]
Radius(2) = U3 [L]
Radius(3) = R1, Not Used
Radius(4) = R2, Not Used
Radius(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Radius(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear
(n) = True.

Damping

This is the nonlinear damping coefficient used for the axial translational degree of freedom, U1.
This item applies for nonlinear analyses. [F/L]

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for a friction isolator-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropFrictionIsolator()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MySlow() As Double
Dim MyFast() As Double
Dim MyRate() As Double
Dim MyRadius() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Nonlinear() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim k() As Double
Dim Slow() As Double
Dim Fast() As Double
Dim Rate() As Double
Dim Radius() As Double
Dim Damping As Double
Dim dj2 As Double
Dim dj3 As Double
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MySlow(5)
ReDim MyFast(5)
ReDim MyRate(5)
ReDim MyRadius(5)


MyDOF(0) = True
MyNonLinear(0) = True
MyKe(0) = 12
MyCe(0) = 0.01
MyK(0) = 1000

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MySlow(1)= 0.6
MyFast(1)= 0.5
MyRate(1)= 10
MyRadius(1)= 80

MyDOF(2) = True
MyNonLinear(2) = True
MyKe(2) = 14
MyCe(2) = 0.008
MyK(2) = 22
MySlow(2)= 0.66
MyFast(2)= 0.55
MyRate(2)= 12
MyRadius(2)= 75

MyDOF(3) = True
MyKe(3) = 15
MyCe(3) = 0

MyDOF(4) = True
MyFixed(4) = True

ret = SapModel.PropLink.SetFrictionIsolator("FI1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, MyK, MySlow, MyFast, MyRate, MyRadius, 0.1, 2, 3)

'get link property data
ret = SapModel.PropLink.GetFrictionIsolator("FI1", DOF, Fixed, NonLinear, Ke, Ce, k,
Slow, Fast, Rate, Radius, Damping, dj2, dj3, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

SetFrictionIsolator

# GetGap

## Syntax

SapObject.SapModel.PropLink.GetGap

## VB6 Procedure

Function GetGap(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As Boolean,
ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef k() As
Double, ByRef dis() As Double, ByRef dj2 As Double, ByRef dj3 As Double, ByRef Notes As
String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing gap-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.


NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
```

```
k(5) = R3 [FL]
```
The term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dis

This is an array of initial gap opening terms for the link property. The initial gap opening applies
for nonlinear analyses.

```
dis(0) = U1 [L]
dis(1) = U2 [L]
dis(2) = U3 [L]
dis(3) = R1 [rad]
dis(4) = R2 [rad]
dis(5) = R3 [rad]
```
The term dis(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for a gap-type link property.

The function returns zero if the property data is retrieved successfully; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropGap()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean


Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MyDis() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Nonlinear() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim k() As Double
Dim dis() As Double
Dim dj2 As Double
Dim dj3 As Double
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MyDis(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MyDis(1)=1.2


MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetGap("G1", MyDOF, MyFixed, MyNonLinear, MyKe, MyCe,
MyK, MyDis, 2, 0)

'get link property data
ret = SapModel.PropLink.GetGap("G1", DOF, Fixed, NonLinear, Ke, Ce, k, dis, dj2, dj3,
Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetGap

# GetHook

## Syntax

SapObject.SapModel.PropLink.GetHook

## VB6 Procedure

Function GetHook(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As
Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef
k() As Double, ByRef dis() As Double, ByRef dj2 As Double, ByRef dj3 As Double, ByRef Notes
As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing hook-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
```

### DOF(1) = U2

### DOF(2) = U3

### DOF(3) = R1

### DOF(4) = R2

### DOF(5) = R3

Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.


```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dis

This is an array of initial hook opening terms for the link property. The initial hook opening
applies for nonlinear analyses.

```
c(0) = U1 [L]
c(1) = U2 [L]
c(2) = U3 [L]
c(3) = R1 [rad]
c(4) = R2 [rad]
c(5) = R3 [rad]
```
The term dis(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID


The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for a hook-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropHook()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MyDis() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Nonlinear() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim k() As Double
Dim dis() As Double
Dim dj2 As Double
Dim dj3 As Double
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property


ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MyDis(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MyDis(1)=1.2

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetHook("H1", MyDOF, MyFixed, MyNonLinear, MyKe, MyCe,
MyK, MyDis, 2, 0)

'get link property data
ret = SapModel.PropLink.GetHook("H1", DOF, Fixed, NonLinear, Ke, Ce, k, dis, dj2, dj3,
Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetHook

# GetLinear

## Syntax

SapObject.SapModel.PropLink.GetLinear


## VB6 Procedure

Function GetLinear(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As
Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef dj2 As Double, ByRef dj3 As
Double, ByRef KeCoupled As Boolean, ByRef CeCoupled As Boolean, ByRef Notes As String,
ByRef GUID As String) As Long

## Parameters

Name

The name of an existing linear-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity if DOF(0) = True
Fixed(1) = U2 fixity if DOF(1) = True
Fixed(2) = U3 fixity if DOF(2) = True
Fixed(3) = R1 fixity if DOF(3) = True
Fixed(4) = R2 fixity if DOF(4) = True
Fixed(5) = R3 fixity if DOF(5) = True
```
Ke

This is an array of stiffness terms for the link property. There are 6 terms in the array if the
stiffness is uncoupled and 21 if it is coupled. The KeCoupled item indicates if the stiffness is
coupled.

If the stiffness is uncoupled:

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```

If the stiffness is coupled:

```
Ke(0) = U1U1 [F/L]
Ke(1) = U1U2 [F/L]
Ke(2) = U2U2 [F/L]
Ke(3) = U1U3 [F/L]
Ke(4) = U2U3 [F/L]
Ke(5) = U3U3 [F/L]
Ke(6) = U1R1 [F]
Ke(7) = U2R1 [F]
Ke(8) = U3R1 [F]
Ke(9) = R1R1 [FL]
Ke(10) = U1R2 [F]
Ke(11) = U2R2 [F]
Ke(12) = U3R2 [F]
Ke(13) = R1R2 [FL]
Ke(14) = R2R2 [FL]
Ke(15) = U1R3 [F]
Ke(16) = U2R3 [F]
Ke(17) = U3R3 [F]
Ke(18) = R1R3 [FL]
Ke(19) = R2R3 [FL]
Ke(20) = R3R3 [FL]
```
Ce

This is an array of damping terms for the link property. There are 6 terms in the array if the
damping is uncoupled and 21 if it is coupled. The CeCoupled item indicates if the damping is
coupled.

If the damping is uncoupled:

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
If the damping is coupled:

```
Ce(0) = U1U1 [F/L]
Ce(1) = U1U2 [F/L]
Ce(2) = U2U2 [F/L]
Ce(3) = U1U3 [F/L]
Ce(4) = U2U3 [F/L]
Ce(5) = U3U3 [F/L]
Ce(6) = U1R1 [F]
Ce(7) = U2R1 [F]
Ce(8) = U3R1 [F]
Ce(9) = R1R1 [FL]
Ce(10) = U1R2 [F]
Ce(11) = U2R2 [F]
```

```
Ce(12) = U3R2 [F]
Ce(13) = R1R2 [FL]
Ce(14) = R2R2 [FL]
Ce(15) = U1R3 [F]
Ce(16) = U2R3 [F]
Ce(17) = U3R3 [F]
Ce(18) = R1R3 [FL]
Ce(19) = R2R3 [FL]
Ce(20) = R3R3 [FL]
```
dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

KeCoupled

This item is True if the link stiffness, Ke, is coupled. There are 21 terms in the Ke array if Ke is
coupled; otherwise there are 6 terms.

CeCoupled

This item is True if the link damping, Ce, is coupled. There are 21 terms in the Ce array if Ce is
coupled; otherwise there are 6 terms.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for a linear-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropLinear()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean


Dim MyFixed() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim dj2 As Double
Dim dj3 As Double
Dim KeCoupled As Boolean
Dim CeCoupled As Boolean
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyKe(5)
ReDim MyCe(5)
MyDOF(0) = True
MyKe(0) = 12
ret = SapModel.PropLink.SetLinear("L1", MyDOF, MyFixed, MyKe, MyCe, 0, 0)

'get link property data
ret = SapModel.PropLink.GetLinear("L1", DOF, Fixed, Ke, Ce, dj2, dj3, KeCoupled,
CeCoupled, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

SetLinear

# GetMultiLinearElastic

## Syntax

SapObject.SapModel.PropLink.GetMultiLinearElastic

## VB6 Procedure

Function GetMultiLinearElastic(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed
() As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double,
ByRef dj2 As Double, ByRef dj3 As Double, ByRef Notes As String, ByRef GUID As String) As
Long

## Parameters

Name

The name of an existing multilinear elastic-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.


NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies pnly when DOF(n) = True and Fixed(n) = False.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]


Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for a multilinear elastic-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropMultiLinearElastic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Nonlinear() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim dj2 As Double
Dim dj3 As Double
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetMultiLinearElastic("MLE1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, 2, 0)

'get link property data
ret = SapModel.PropLink.GetMultiLinearElastic("MLE1", DOF, Fixed, NonLinear, Ke,
Ce, dj2, dj3, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetMultiLinearElastic

GetMultiLinearPoints

SetMultiLinearPoints

# GetMultiLinearPlastic

## Syntax

SapObject.SapModel.PropLink.GetMultiLinearPlastic


## VB6 Procedure

Function GetMultiLinearPlastic(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed
() As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double,
ByRef dj2 As Double, ByRef dj3 As Double, ByRef Notes As String, ByRef GUID As String) As
Long

## Parameters

Name

The name of an existing multilinear plastic-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```

The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for a multilinear plastic-type link property.


The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropMultiLinearPlastic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Nonlinear() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim dj2 As Double
Dim dj3 As Double
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True


MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetMultiLinearPlastic("MLP1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, 2, 0)

'get link property data
ret = SapModel.PropLink.GetMultiLinearPlastic("MLP1", DOF, Fixed, NonLinear, Ke, Ce,
dj2, dj3, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetMultiLinearPlastic

GetMultiLinearPoints

SetMultiLinearPoints

# GetMultiLinearPoints

## Syntax

SapObject.SapModel.PropLink.GetMultiLinearPoints

## VB6 Procedure

Function GetMultiLinearPoints(ByVal Name As String, ByVal DOF As Long, ByRef
NumberPoints As Long, ByRef F() As Double, ByRef D() As Double, ByRef MyType As Long,
ByRef a1 As Double, ByRef a2 As Double, ByRef b1 As Double, ByRef b2 As Double, ByRef
eta As Double) As Long

## Parameters

Name


The name of an existing multilinear elastic or multilinear plastic link property.

DOF

This is 1, 2, 3, 4, 5 or 6, indicating the degree of freedom to which the multilinear points apply.

```
1 = U1
2 = U2
3 = U3
4 = R1
5 = R2
6 = R3
```
NumberPoints

The number of foce-defomation points for the specified degree of freedom.

F

This is an array, dimensioned to NumberPoints - 1, that includes the force at each point. When
DOF is U1, U2 or U3, this is a force. When DOF is R1, R2 or R3, this is a moment. [F] if DOF <=
3, and [FL} if DOF > 3

D

This is an array, dimensioned to NumberPoints - 1, that includes the displacement at each point.
When DOF is U1, U2 or U3, this is a translation. When DOF is R1, R2 or R3, this is a rotation.
[L] if DOF <= 3, and [rad] if DOF > 3

MyType

This item applies only to multilinear plastic link properties. It is 1, 2 or 3, indicating the hysteresis
type.

```
1 = Kinematic
2 = Takeda
3 = Pivot
```
a1

This item only applies to multilinear plastic link properties that have a pivot hysteresis type
(MyType = 3). It is the Alpha1 hysteresis parameter.

a2

This item applies only to multilinear plastic link properties that have a pivot hysteresis type
(MyType = 3). It is the Alpha2 hysteresis parameter.

b1

This item applies only to multilinear plastic link properties that have a pivot hysteresis type
(MyType = 3). It is the Beta1 hysteresis parameter.

b2


This item applies only to multilinear plastic link properties that have a pivot hysteresis type
(MyType = 3). It is the Beta2 hysteresis parameter.

eta

This item applies only to multilinear plastic link properties that have a pivot hysteresis type
(MyType = 3). It is the Eta hysteresis parameter.

## Remarks

This function retrieves the force-deformation data for a specified degree of freedom in multilinear
elastic and multilinear plastic link properties.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

To successfully retrieve this data from the indicated link property, the following conditions must
be met:

1. The link property must be multilinear elastic or multilinear plastic.
2. The specified DOF must be active.
3. The specified DOF must not be fixed.
4. The specified DOF must be nonlinear.

## VBA Example

Sub GetLinkPropMultiLinearPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyF() As Double
Dim MyD() As Double
Dim NumberPoints As Long
Dim F() As Double
Dim D() As Double
Dim MyType As Long
Dim a1 As Double
Dim a2 As Double
Dim b1 As Double
Dim b2 As Double
Dim eta As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart


'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetMultiLinearPlastic("MLP1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, 2, 0)

'set multilinear force-defomation data
ReDim MyF(4)
ReDim MyD(4)

MyF(0) = -12
MyF(1) = -10
MyF(2) = 0
MyF(3) = 8
MyF(4) = 9

MyD(0) = -8
MyD(1) = -0.6
MyD(2) = 0
MyD(3) = 0.2
MyD(4) = 6

ret = SapModel.PropLink.SetMultiLinearPoints("MLP1", 2, 5, MyF, MyD, 3, 9, 12, 0.75, 0.8,
.1)

'get multilinear force-defomation data
ret = SapModel.PropLink.GetMultiLinearPoints("MLP1", 2, NumberPoints, F, D, MyType,


a1, a2, b1, b2, eta)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetMultiLinearPoints

SetMultiLinearElastic

GetMultiLinearElastic

SetMultiLinearPlastic

GetMultiLinearPlastic

# GetNameList

## Syntax

SapObject.SapModel.PropLink.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String, Optional
ByVal PropType As eLinkPropType) As Long

## Parameters

NumberNames

The number of link property names retrieved by the program.

MyName

This is a one-dimensional array of link property names. The MyName array is created as a
dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```

The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

PropType

This optional value is one of the following items in the eLinkPropType enumeration.

```
NLPROP_LINEAR = 1
NLPROP_DAMPER = 2
NLPROP_GAP = 3
NLPROP_HOOK = 4
NLPROP_PLASTIC_WEN = 5
NLPROP_ISOLATOR1 = 6 (Rubber isolator)
NLPROP_ISOLATOR2 = 7 (Friction isolator)
NLPROP_MULTILINEAR_ELASTIC = 8
NLPROP_MULTILINEAR_PLASTIC = 9
NLPROP_ISOLATOR3 = 10 (T/C Friction isolator)
```
If no value is input for PropType, names are returned for all link properties in the model regardless
of type.

## Remarks

This function retrieves the names of all defined link properties of the specified type.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetLinkPropNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link properties
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)
ret = SapModel.PropLink.SetLinear("L2", DOF, Fixed, Ke, Ce, 0, 0)

'get link property names
ret = SapModel.PropLink.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# GetPDelta

## Syntax

SapObject.SapModel.PropLink.GetPDelta

## VB6 Procedure

Function GetPDelta(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing link property.

Value

This is an array of P-delta parameters.


```
Value(0) = M2 P-delta to I-end of link as moment, M2I
Value(1) = M2 P-delta to J-end of link as moment, M2J
Value(2) = M3 P-delta to I-end of link as moment, M3I
Value(3) = M3 P-delta to J-end of link as moment, M3J
```
## Remarks

This function retrieves P-delta parameters for a link property.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetLinkPropPDelta()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim MyValue() As Double
Dim Value() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)

'set link property P-delta parameters
ReDim MyValue(3)


MyValue(0) = 0.6
MyValue(1) = 0.4
MyValue(2) = 0.3
MyValue(3) = 0.2
ret = SapModel.PropLink.SetPDelta("L1", MyValue)

'get link property P-delta parameters
ret = SapModel.PropLink.GetPDelta("L1", Value)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetPDelta

# GetPlasticWen

## Syntax

SapObject.SapModel.PropLink.GetPlasticWen

## VB6 Procedure

Function GetPlasticWen(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As
Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef
k() As Double, ByRef Yield() As Double, ByRef Ratio() As Double, ByRef exp() As Double,
ByRef dj2 As Double, ByRef dj3 As Double, ByRef Notes As String, ByRef GUID As String) As
Long

## Parameters

Name

The name of an existing plastic Wen-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
```

### DOF(1) = U2

### DOF(2) = U3

### DOF(3) = R1

### DOF(4) = R2

### DOF(5) = R3

Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.


```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

Yield

This is an array of yield force terms for the link property. The yield force applies for nonlinear
analyses.

```
Yield(0) = U1 [F]
Yield(1) = U2 [F]
Yield(2) = U3 [F]
Yield(3) = R1 [FL]
Yield(4) = R2 [FL]
Yield(5) = R3 [FL]
```
The term Yield(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

Ratio

This is an array of post-yield stiffness ratio terms for the link property. The post-yield stiffness
ratio applies for nonlinear analyses. It is the post-yield stiffness divided by the initial stiffness.

```
Ratio(0) = U1
Ratio(1) = U2
Ratio(2) = U3
Ratio(3) = R1
Ratio(4) = R2
Ratio(5) = R3
```
The term Ratio(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.


exp

This is an array of yield exponent terms for the link property. The yield exponent applies for
nonlinear analyses. The yielding exponent that controls the sharpness of the transition from the
initial stiffness to the yielded stiffness.

```
exp(0) = U1
exp(1) = U2
exp(2) = U3
exp(3) = R1
exp(4) = R2
exp(5) = R3
```
The term exp(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for a plastic Wen-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropPlasticWen()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double


Dim MyK() As Double
Dim MyYield() As Double
Dim MyRatio() As Double
Dim MyExp() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Nonlinear() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim k() As Double
Dim Yield() As Double
Dim Ratio() As Double
Dim exp() As Double
Dim dj2 As Double
Dim dj3 As Double
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MyYield(5)
ReDim MyRatio(5)
ReDim MyExp(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20


MyYield(1)= 50
MyRatio(1)= 0.1
MyExp(1)= 3

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetPlasticWen("PW1", MyDOF, MyFixed, MyNonLinear, MyKe,
MyCe, MyK, MyYield, MyRatio, MyExp, 2, 0)

'get link property data
ret = SapModel.PropLink.GetPlasticWen("PW1", DOF, Fixed, NonLinear, Ke, Ce, k, Yield,
Ratio, exp, dj2, dj3, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetPlasticWen

# GetRubberIsolator

## Syntax

SapObject.SapModel.PropLink.GetRubberIsolator

## VB6 Procedure

Function GetRubberIsolator(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As
Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef
k() As Double, ByRef Yield() As Double, ByRef Ratio() As Double, ByRef dj2 As Double,
ByRef dj3 As Double, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing rubber isolator-type link property.

DOF


This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1, Not Used
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1, Not Used
NonLinear(4) = R2, Not Used
NonLinear(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```

The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1, Not Used
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1, Not Used
k(4) = R2, Not Used
k(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Yield

This is an array of yield force terms for the link property. The yield force applies for nonlinear
analyses.

```
Yield(0) = U1, Not Used
Yield(1) = U2 [F]
Yield(2) = U3 [F]
Yield(3) = R1, Not Used
Yield(4) = R2, Not Used
Yield(5) = R3, Not Used
```
The term Yield(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

Ratio

This is an array of post-yield stiffness ratio terms for the link property. The post-yield stiffness
ratio applies for nonlinear analyses. It is the post-yield stiffness divided by the initial stiffness.

```
Ratio(0) = U1, Not Used
```

```
Ratio(1) = U2
Ratio(2) = U3
Ratio(3) = R1, Not Used
Ratio(4) = R2, Not Used
Ratio(5) = R3, Not Used
```
The term Ratio(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies pnly when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for a rubber isolator-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropRubberIsolator()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MyYield() As Double
Dim MyRatio() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Nonlinear() As Boolean
Dim Ke() As Double


Dim Ce() As Double
Dim k() As Double
Dim Yield() As Double
Dim Ratio() As Double
Dim dj2 As Double
Dim dj3 As Double
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MyYield(5)
ReDim MyRatio(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MyYield(1)= 50
MyRatio(1)= 0.1

MyDOF(2) = True
MyNonLinear(2) = True
MyKe(2) = 15
MyCe(2) = 0.008
MyK(2) = 22
MyYield(2)= 60
MyRatio(2)= 0.15


MyDOF(3) = True
MyFixed(3) = True

ret = SapModel.PropLink.SetRubberIsolator("RI1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, MyK, MyYield, MyRatio, 2, 3)

'get link property data
ret = SapModel.PropLink.GetRubberIsolator("RI1", DOF, Fixed, NonLinear, Ke, Ce, k,
Yield, Ratio, dj2, dj3, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetRubberIsolator

# GetSpringData

## Syntax

SapObject.SapModel.PropLink.GetSpringData

## VB6 Procedure

Function GetSpringData(ByVal Name As String, ByRef DefinedForThisLength As Double,
ByRef DefinedForThisArea As Double) As Long

## Parameters

Name

The name of an existing link property.

DefinedForThisLength

The link property is defined for this length in a line (frame) spring. [L]

DefinedForThisArea

The link property is defined for this area in an area spring. [L^2 ]


## Remarks

This function retrieves length and area values for a link property that are used if the link property
is specified in line and area spring assignments.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetLinkPropSpringData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim DefinedForThisLength As Double
Dim DefinedForThisArea As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)

'set link property spring data
ret = SapModel.PropLink.SetSpringData("L1", 12, 2)

'get link property spring data
ret = SapModel.PropLink.GetSpringData("L1", DefinedForThisLength, DefinedForThisArea)

'close Sap2000


SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetSpringData

# GetTCFrictionIsolator

## Syntax

SapObject.SapModel.PropLink.GetTCFrictionIsolator

## VB6 Procedure

Function GetTCFrictionIsolator(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed
() As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double,
ByRef k() As Double, ByRef Slow() As Double, ByRef Fast() As Double, ByRef Rate() As
Double, ByRef Radius() As Double, ByRef SlowT() As Double, ByRef FastT() As Double, ByRef
RateT() As Double, ByRef kt As Double, ByRef dis As Double, ByRef dist As Double, ByRef
Damping As Double, ByRef dj2 As Double, ByRef dj3 As Double, ByRef Notes As String, ByRef
GUID As String) As Long

## Parameters

Name

The name of an existing T/C friction isolator-type link property.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed


This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies pnly when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1, Not Used
NonLinear(4) = R2, Not Used
NonLinear(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U1, U2 and U3. For those degrees of
freedom, the term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
```

```
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1, Not Used
k(4) = R2, Not Used
k(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U1, U2 and U3. For those degrees of
freedom, the term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Slow

This is an array of the friction coefficient at zero velocity terms when U1 is in compression for the
link property. This coefficient applies for nonlinear analyses.

```
Slow(0) = U1, Not Used
Slow(1) = U2
Slow(2) = U3
Slow(3) = R1, Not Used
Slow(4) = R2, Not Used
Slow(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Slow(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Fast

This is an array of the friction coefficient at fast velocity terms when U1 is in compression for the
link property. This coefficient applies for nonlinear analyses.

```
Fast(0) = U1, Not Used
Fast(1) = U2
Fast(2) = U3
Fast(3) = R1, Not Used
Fast(4) = R2, Not Used
Fast(5) = R3, Not Used
```

Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Fast(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Rate

This is an array of the inverse of the characteristic sliding velocity terms when U1 is in
compression for the link property. This item applies for nonlinear analyses.

```
Rate(0) = U1, Not Used
Rate(1) = U2 [s/L]
Rate(2) = U3 [s/L]
Rate(3) = R1, Not Used
Rate(4) = R2, Not Used
Rate(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Rate(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Radius

This is an array of the radius of the sliding contact surface terms for the link property. Inputting 0
means there is an infinite radius, that is, the slider is flat. This item applies for nonlinear analyses.

```
Radius(0) = U1, Not Used
Radius(1) = U2 [L]
Radius(2) = U3 [L]
Radius(3) = R1, Not Used
Radius(4) = R2, Not Used
Radius(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Radius(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear
(n) = True.

SlowT

This is an array of the friction coefficient at zero velocity terms when U1 is in tension for the link
property. This coefficient applies for nonlinear analyses.

```
SlowT(0) = U1, Not Used
SlowT(1) = U2
SlowT(2) = U3
SlowT(3) = R1, Not Used
SlowT(4) = R2, Not Used
SlowT(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term SlowT(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear
(n) = True.


FastT

This is an array of the friction coefficient at fast velocity terms when U1 is in tension for the link
property. This coefficient applies for nonlinear analyses.

```
FastT(0) = U1, Not Used
FastT(1) = U2
FastT(2) = U3
FastT(3) = R1, Not Used
FastT(4) = R2, Not Used
FastT(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term FastT(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

RateT

This is an array of the inverse of the characteristic sliding velocity terms when U1 is in tension for
the link property. This item applies for nonlinear analyses.

```
RateT(0) = U1, Not Used
RateT(1) = U2 [s/L]
RateT(2) = U3 [s/L]
RateT(3) = R1, Not Used
RateT(4) = R2, Not Used
RateT(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term RateT(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

kt

The axial translational tension stiffness for the U1 degree of freedom. This item applies for
nonlinear analyses. [F/L]

dis

The U1 degree of freedom gap opening for compression. This item applies for nonlinear analyses.
[L]

dist

The U1 degree of freedom gap opening for tension. This item applies for nonlinear analyses. [L]

Damping

The nonlinear damping coefficient used for the axial translational degree of freedom, U1. This
item applies for nonlinear analyses. [F/L]

dj2


The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for a T/C friction isolator-type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropTCFrictionIsolator()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MySlow() As Double
Dim MyFast() As Double
Dim MyRate() As Double
Dim MyRadius() As Double
Dim MySlowT() As Double
Dim MyFastT() As Double
Dim MyRateT() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Nonlinear() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim k() As Double
Dim Slow() As Double
Dim Fast() As Double
Dim Rate() As Double


Dim Radius() As Double
Dim SlowT() As Double
Dim FastT() As Double
Dim RateT() As Double
Dim kt As Double
Dim dis As Double
Dim dist As Double
Dim Damping As Double
Dim dj2 As Double
Dim dj3 As Double
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MySlow(5)
ReDim MyFast(5)
ReDim MyRate(5)
ReDim MyRadius(5)
ReDim MySlowT(5)
ReDim MyFastT(5)
ReDim MyRateT(5)

MyDOF(0) = True
MyNonLinear(0) = True
MyKe(0) = 12
MyCe(0) = 0.01
MyK(0) = 1000

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01


MyK(1) = 20
MySlow(1)= 0.6
MyFast(1)= 0.5
MyRate(1)= 10
MyRadius(1)= 80
MySlowT(1)= 0.61
MyFastT(1)= 0.51
MyRateT(1)= 10.1

MyDOF(2) = True
MyNonLinear(2) = True
MyKe(2) = 14
MyCe(2) = 0.008
MyK(2) = 22
MySlow(2)= 0.66
MyFast(2)= 0.55
MyRate(2)= 12
MyRadius(2)= 75
MySlowT(2)= 0.67
MyFastT(2)= 0.56
MyRateT(2)= 12.1

MyDOF(3) = True
MyKe(3) = 15
MyCe(3) = 0

MyDOF(4) = True
MyFixed(4) = True

ret = SapModel.PropLink.SetTCFrictionIsolator("TCFI1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, MyK, MySlow, MyFast, MyRate, MyRadius, MySlowT, MyFastT, MyRateT, 18,
2, 3, 0.1, 2, 3)

'get link property data
ret = SapModel.PropLink.GetTCFrictionIsolator("TCFI1", DOF, Fixed, NonLinear, Ke, Ce,
k, Slow, Fast, Rate, Radius, SlowT, FastT, RateT, kt, dis, dist, Damping, dj2, dj3, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetTCFrictionIsolator


# GetTriplePendulumIsolator

## Syntax

SapObject.SapModel.PropLink.GetTriplePendulumIsolator

## VB6 Procedure

Function GetTriplePendulumIsolator(ByVal Name As String, ByRef dof() As Boolean, ByRef
Fixed() As Boolean, ByRef Nonlinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As
Double, ByRef K1 As Double, ByRef Damping As Double, ByRef K() As Double, ByRef Slow()
As Double, ByRef Fast() As Double, ByRef Rate() As Double, ByRef Radius() As Double, ByRef
StopDist() As Double, ByRef HeightOut As Double, ByRef HeightIn As Double, ByRef dj2 As
Double, ByRef dj3 As Double, ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing Triple Pendulum Isolator type link property.

DOF

This is a Boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a Boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) only applies when DOF(n) = True.

NonLinear


This is a Boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1, Not Used
NonLinear(4) = R2, Not Used
NonLinear(5) = R3, Not Used
```
Note that this item is applicable for degrees of freedom U1, U2 and U3 only. For those degrees of
freedom, the term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses, and also for nonlinear analysis for those DOF for which NonLinear(n) = False.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

K1

This is the axial compression stiffness for the U1 degree of freedom. This item applies for
nonlinear analyses. [F/L]

Damping

This is the nonlinear damping coefficient for the axial degree of freedom, U1, when it is in
compression. This item applies for nonlinear analyses. [F/L]

K


This is an array, dimensioned to 3, of initial nonlinear stiffness (before sliding) for each sliding
surface.

```
K(0) = for the outer top sliding surface [F/L]
K(1) = for the outer bottom sliding surface [F/L]
K(2) = for the inner top sliding surface [F/L]
K(3) = for the inner bottom sliding surface [F/L]
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Slow

This is an array, dimensioned to 3, of the friction coefficient at zero velocity for each sliding
surface when U1 is in compression.

```
Slow(0) = for the outer top sliding surface
Slow(1) = for the outer bottom sliding surface
Slow(2) = for the inner top sliding surface
Slow(3) = for the inner bottom sliding surface
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term Slow(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Fast

This is an array, dimensioned to 3, of the friction coefficient at fast velocity for each sliding
surface when U1 is in compression.

```
Fast(0) = for the outer top sliding surface
Fast(1) = for the outer bottom sliding surface
Fast(2) = for the inner top sliding surface
Fast(3) = for the inner bottom sliding surface
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term Fast(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Rate

This is an array, dimensioned to 3, of the inverse of the characteristic sliding velocity for the Slow
and Fast friction coefficients for each sliding surface. This item applies for nonlinear analyses.

```
Rate(0) = for the outer top sliding surface [s/L]
Rate(1) = for the outer bottom sliding surface [s/L]
Rate(2) = for the inner top sliding surface [s/L]
Rate(3) = for the inner bottom sliding surface [s/L]
```

Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term Rate(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Radius

This is an array, dimensioned to 3, of the radius for each sliding surface. Inputting 0 means there
is an infinite radius, that is, the slider is flat. This item applies for nonlinear analyses.

```
Radius(0) = for the outer top sliding surface [L]
Radius(1) = for the outer bottom sliding surface [L]
Radius(2) = for the inner top sliding surface [L]
Radius(3) = for the inner bottom sliding surface [L]
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term Radius(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear
(n) = True.

StopDist

This is an array, dimensioned to 3, of the amount of displacement allowed before hitting a stiff
limit for each sliding surface. Inputting 0 means there is no stop. This item applies for nonlinear
analyses.

```
StopDist(0) = for the outer top sliding surface [L]
StopDist(1) = for the outer bottom sliding surface [L]
StopDist(2) = for the inner top sliding surface [L]
StopDist(3) = for the inner bottom sliding surface [L]
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term StopDist(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear
(n) = True.

HeightOut

This is the height (distance) between the outer sliding surfaces at zero displacement. [L]

Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

HeightIn

This is the height (distance) between the inner sliding surfaces. [L]

Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring, that is, the center of the isolator.
This item applies only when DOF(2) = True. [L]

dj3


The distance from the J-End of the link to the U3 shear spring, that is, the center of the isolator.
This item applies only when DOF(3) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves link property data for a Triple Pendulum Isolator type link property.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetLinkPropTriplePendulumIsolator()
'dimension variables
Dim SapObject As Sap2000.SapObject
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MySlow() As Double
Dim MyFast() As Double
Dim MyRate() As Double
Dim MyRadius() As Double
Dim MyStopDist() As Double
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Nonlinear() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim K() As Double
Dim Slow() As Double
Dim Fast() As Double
Dim Rate() As Double
Dim Radius() As Double
Dim StopDist() As Double
Dim K1 As Double
Dim Damping As Double
Dim Hout As Double
Dim Hin As Double
Dim dj2 As Double


Dim dj3 As Double
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = New SAP2000.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(3)
ReDim MySlow(3)
ReDim MyFast(3)
ReDim MyRate(3)
ReDim MyRadius(3)
ReDim MyStopDist(3)

MyDOF(0) = True
MyNonLinear(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01

MyDOF(2) = True
MyNonLinear(2) = True
MyKe(2) = 14
MyCe(2) = 0.008

MyK(0) = 20
MySlow(0)= 0.6
MyFast(0)= 0.5
MyRate(0)= 10
MyRadius(0)= 80
MyStopDist(0)= 8


MyK(1) = 22
MySlow(1)= 0.66
MyFast(1)= 0.55
MyRate(1)= 12
MyRadius(1)= 75
MyStopDist(1)= 8

MyK(2) = 20
MySlow(2)= 0.6
MyFast(2)= 0.5
MyRate(2)= 10
MyRadius(2)= 80
MyStopDist(2)= 8

MyK(3) = 20
MySlow(3)= 0.6
MyFast(3)= 0.5
MyRate(3)= 10
MyRadius(3)= 80
MyStopDist(3)= 8

MyDOF(3) = True
MyKe(3) = 15
MyCe(3) = 0

MyDOF(4) = True
MyFixed(4) = True

ret = SapModel.PropLink.SetTriplePendulumIsolator("TPI1", MyDOF, MyFixed,
MyNonLinear, MyKe, MyCe, 1000, 0.1, MyK, MySlow, MyFast, MyRate, MyRadius,
MyStopDist, 6, 3, 3, 3)

'get link property data
ret = SapModel.PropLink.GetTriplePendulumIsolator("TPI1", DOF, Fixed, NonLinear, Ke,
Ce, K1, Damping, K, Slow, Fast, Rate, Radius, StopDist, Hout, Hin, dj2, dj3, Notes, GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.00.

## See Also

SetTriplePendulumIsolator


# GetTypeOAPI

## Syntax

SapObject.SapModel.PropLink.GetTypeOAPI

## VB6 Procedure

Function GetTypeOAPI(ByVal Name As String, ByRef PropType As eLinkPropType) As Long

## Parameters

Name

The name of an existing link property.

PropType

This is one of the following items in the eLinkPropType enumeration.

```
NLPROP_LINEAR = 1
NLPROP_DAMPER = 2
NLPROP_GAP = 3
NLPROP_HOOK = 4
NLPROP_PLASTIC_WEN = 5
NLPROP_ISOLATOR1 = 6 (Rubber isolator)
NLPROP_ISOLATOR2 = 7 (Friction isolator)
NLPROP_MULTILINEAR_ELASTIC = 8
NLPROP_MULTILINEAR_PLASTIC = 9
NLPROP_ISOLATOR3 = 10 (T/C Friction isolator)
```
## Remarks

This function retrieves the property type for the specified link property.

The function returns zero if the type is successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetLinkPropType()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim PropType As eLinkPropType


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)

'get link property type
ret = SapModel.PropLink.GetTypeOAPI("L1", PropType)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Changed function name to GetTypeOAPI in v17.0.0.

## See Also

# GetWeightAndMass

## Syntax

SapObject.SapModel.PropLink.GetWeightAndMass


## VB6 Procedure

Function GetWeightAndMass(ByVal Name As String, ByRef w As Double, ByRef m As Double,
ByRef R1 As Double, ByRef R2 As Double, ByRef R3 As Double) As Long

## Parameters

Name

The name of an existing link property.

w

The weight of the link. [F]

m

The translational mass of the link. [M]

R1

The rotational inertia of the link about its local 1 axis. [ML^2 ]

R2

The rotational inertia of the link about its local 2 axis. [ML^2 ]

R3

The rotational inertia of the link about its local 3 axis. [ML^2 ]

## Remarks

This function retrieves weight and mass data for a link property.

The function returns zero if the data is successfully retrieved; otherwise it returns a nonzero value.

## VBA Example

Sub GetLinkPropWeightAndMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim w As Double
Dim m As Double
Dim R1 As Double


Dim R2 As Double
Dim R3 As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)

'set link property weight and mass
ret = SapModel.PropLink.SetWeightAndMass("L1", 10, 0.26, 0.0012, 0.0014, 0.0016)

'get link property weight and mass
ret = SapModel.PropLink.GetWeightAndMass("L1", w, m, R1, R2, R3)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetWeightAndMass


# SetDamper

## Syntax

SapObject.SapModel.PropLink.SetDamper

## VB6 Procedure

Function SetDamper(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As
Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef
k() As Double, ByRef c() As Double, ByRef cexp() As Double, ByVal dj2 As Double, ByVal dj3
As Double, Optional ByVal Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.


```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) only applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.


c

This is an array of nonlinear damping coefficient terms for the link property. The nonlinear
damping coefficient applies for nonlinear analyses.

```
c(0) = U1 [F/(L^cexp)]
c(1) = U2 [F/(L^cexp)]
c(2) = U3 [F/(L^cexp)]
c(3) = R1 [FL]
c(4) = R2 [FL]
c(5) = R3 [FL]
```
The term c(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

cexp

This is an array of the nonlinear damping exponent terms. The nonlinear damping exponent
applies for nonlinear analyses. It is applied to the velocity across the damper in the equation of
motion.

```
cexp(0) = U1
cexp(1) = U2
cexp(2) = U3
cexp(3) = R1
cexp(4) = R2
cexp(5) = R3
```
The term cexp(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes an exponential damper-type link property. If this function is called for an
existing link property, all items for the property are reset to their default values.


The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropDamper()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MyC() As Double
Dim MyCexp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MyC(5)
ReDim MyCexp(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01


MyK(1) = 20
MyC(1)=0.08
MyCexp(1) = 1.2

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetDamper("D1", MyDOF, MyFixed, MyNonLinear, MyKe,
MyCe, MyK, MyC, MyCexp, 1, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

Clarification that damper type is exponential added in version 16.0.2.

## See Also

GetDamper

# SetDamperBilinear

## Syntax

SapObject.SapModel.PropLink.SetDamperBilinear

## VB6 Procedure

Function SetDamperBilinear (ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed()
As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double,
ByRef k() As Double, ByRef c() As Double, ByRef cy() As Double, ByRef ForceLimit() As
Double, ByVal dj2 As Double, ByVal dj3 As Double, Optional ByVal Notes As String = "",
Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF


This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained.)

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
```

```
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) only applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

c

This is an array of nonlinear initial damping coefficient terms for the link property. The nonlinear
initial damping coefficient applies for nonlinear analyses.

```
c(0) = U1 [F/L]
c(1) = U2 [F/L]
c(2) = U3 [F/L]
c(3) = R1 [FL]
c(4) = R2 [FL]
c(5) = R3 [FL]
```
The term c(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

cy

This is an array of nonlinear yielded damping coefficient terms for the link property. The
nonlinear yielded damping coefficient applies for nonlinear analyses.

```
cy(0) = U1 [F/L]
cy(1) = U2 [F/L]
cy(2) = U3 [F/L]
cy(3) = R1 [FL]
cy(4) = R2 [FL]
cy(5) = R3 [FL]
```
The term cy(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

ForceLimit

This is an array of nonlinear linear force limit terms for the link property. The linear force limit
applies for nonlinear analyses.

```
ForceLimit(0) = U1 [F]
ForceLimit(1) = U2 [F]
ForceLimit(2) = U3 [F]
ForceLimit(3) = R1 [FL]
ForceLimit(4) = R2 [FL]
```

```
ForceLimit(5) = R3 [FL]
```
The term ForceLimit(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes a bilinear damper-type link property. If this function is called for an
existing link property, all items for the property are reset to their default values.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropDamperBilinear ()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim MyDOF() As Boolean
```
```
Dim MyFixed() As Boolean
```
```
Dim MyNonLinear() As Boolean
```
```
Dim MyKe() As Double
```
```
Dim MyCe() As Double
```

```
Dim MyK() As Double
```
```
Dim MyC() As Double
```
```
Dim MyCy() As Double
```
```
Dim MyForceLimit() As Double
```
'create Sap2000 object

```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
'add link property

```
ReDim MyDOF(5)
```
```
ReDim MyFixed(5)
```
```
ReDim MyNonLinear(5)
```
```
ReDim MyKe(5)
```
```
ReDim MyCe(5)
```
```
ReDim MyK(5)
```
```
ReDim MyC(5)
```

```
ReDim MyCy(5)
```
```
ReDim MyForceLimit(5)
```
```
MyDOF(0) = True
```
```
MyKe(0) = 12
```
```
MyCe(0) = 0.01
```
```
MyDOF(1) = True
```
```
MyNonLinear(1) = True
```
```
MyKe(1) = 12
```
```
MyCe(1) = 0.01
```
```
MyK(1) = 20
```
```
MyC(1)=0.08
```
```
MyCy(1) = 0.008
```
```
MyForceLimit(1) = 50
```
```
MyDOF(2) = True
```
```
MyFixed(2) = True
```
```
ret = SapModel.PropLink.SetDamperBilinear("D1", MyDOF, MyFixed,
MyNonLinear, MyKe, MyCe, MyK, MyC, MyCy, MyForceLimit, 1, 0)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub

## Release Notes


Initial release in version 16.0.2.

## See Also

GetDamperBilinear

# SetDamperFrictionSpring

## Syntax

SapObject.SapModel.PropLink.SetDamperFrictionSpring

## VB6 Procedure

Function SetDamperFrictionSpring(ByVal Name As String, ByRef DOF() As Boolean, ByRef
Fixed() As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As
Double, ByRef k() As Double, ByRef k1() As Double, ByRef k2() As Double, ByRef u0() As
Double, ByRef us() As Double, ByRef dir() As Long, ByVal dj2 As Double, ByVal dj3 As
Double, Optional ByVal Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained.)

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.


NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial (nonslipping) stiffness terms for the link property. The initial stiffness
applies for nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) only applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

k1


This is an array of slipping stiffness when loading terms for the link property. The slipping
stiffness when loading applies for nonlinear analyses.

```
k1(0) = U1 [F/L]
k1(1) = U2 [F/L]
k1(2) = U3 [F/L]
k1(3) = R1 [FL]
k1(4) = R2 [FL]
k1(5) = R3 [FL]
```
The term k1(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

k2

This is an array of slipping stiffness when unloading terms for the link property. The slipping
stiffness when unloading applies for nonlinear analyses.

```
k2(0) = U1 [F/L]
k2(1) = U2 [F/L]
k2(2) = U3 [F/L]
k2(3) = R1 [FL]
k2(4) = R2 [FL]
k2(5) = R3 [FL]
```
The term k2(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

u0

This is an array of precompression displacement terms for the link property. The nonlinear
precompression displacement applies for nonlinear analyses.

```
u0(0) = U1 [L]
u0(1) = U2 [L]
u0(2) = U3 [L]
u0(3) = R1
u0(4) = R2
u0(5) = R3
```
The term u0(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

us

This is an array of stop displacement terms for the link property. The nonlinear stop displacement
applies for nonlinear analyses.

```
us(0) = U1 [L]
us(1) = U2 [L]
us(2) = U3 [L]
us(3) = R1
us(4) = R2
us(5) = R3
```
The term us(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]


dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes a friction spring damper-type link property. If this function is called for an
existing link property, all items for the property are reset to their default values.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropDamperFrictionSpring()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim MyDOF() As Boolean
```
```
Dim MyFixed() As Boolean
```
```
Dim MyNonLinear() As Boolean
```
```
Dim MyKe() As Double
```
```
Dim MyCe() As Double
```
```
Dim MyK() As Double
```
```
Dim MyK1() As Double
```
```
Dim MyK2() As Double
```
```
Dim MyU0() As Double
```
```
Dim MyUs() As Double
```

```
Dim MyDir() As Long
```
'create Sap2000 object

```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
'add link property

```
ReDim MyDOF(5)
```
```
ReDim MyFixed(5)
```
```
ReDim MyNonLinear(5)
```
```
ReDim MyKe(5)
```
```
ReDim MyCe(5)
```
```
ReDim MyK(5)
```
```
ReDim MyK1(5)
```
```
ReDim MyK2(5)
```
```
ReDim MyU0(5)
```
```
ReDim MyUs(5)
```

```
ReDim MyDir(5)
```
```
MyDOF(0) = True
```
```
MyKe(0) = 12
```
```
MyCe(0) = 0.01
```
```
MyDOF(1) = True
```
```
MyNonLinear(1) = True
```
```
MyKe(1) = 12
```
```
MyCe(1) = 0.01
```
```
MyK(1) = 20
```
```
MyK1(1)=2
```
```
MyK2(1) = 1
```
```
MyU0(1) = -.2
```
```
MyUs(1) = 1
```
```
MyDir(1) = 2
```
```
MyDOF(2) = True
```
```
MyFixed(2) = True
```
```
ret = SapModel.PropLink.SetDamperFrictionSpring("D1", MyDOF, MyFixed,
MyNonLinear, MyKe, MyCe, MyK, MyK1, MyK2, MyU0, MyUs, MyDir, 1, 0)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub


## Release Notes

Initial release in version 16.0.2.

## See Also

GetDamperFrictionSpring

# SetDamperLinearExponential

## Syntax

SapObject.SapModel.PropLink.SetDamperLinearExponential

## VB6 Procedure

Function SetDamperLinearExponential(ByVal Name As String, ByRef DOF() As Boolean, ByRef
Fixed() As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As
Double, ByRef k() As Double, ByRef c() As Double, ByRef cexp() As Double, ByRef ForceLimit
() As Double, ByVal dj2 As Double, ByVal dj3 As Double, Optional ByVal Notes As String = "",
Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained.)

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
```

```
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
```

```
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) only applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

c

This is an array of nonlinear damping coefficient terms for the link property. The nonlinear
damping coefficient applies for nonlinear analyses.

```
c(0) = U1 [F/(L^cexp)]
c(1) = U2 [F/(L^cexp)]
c(2) = U3 [F/(L^cexp)]
c(3) = R1 [FL]
c(4) = R2 [FL]
c(5) = R3 [FL]
```
The term c(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

cexp

This is an array of the nonlinear damping exponent terms. The nonlinear damping exponent
applies for nonlinear analyses. It is applied to the velocity across the damper in the equation of
motion.

```
cexp(0) = U1
cexp(1) = U2
cexp(2) = U3
cexp(3) = R1
cexp(4) = R2
cexp(5) = R3
```
The term cexp(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

ForceLimit

This is an array of nonlinear linear force limit terms for the link property. The linear force limit
applies for nonlinear analyses.

```
ForceLimit(0) = U1 [F]
ForceLimit(1) = U2 [F]
ForceLimit(2) = U3 [F]
ForceLimit(3) = R1 [FL]
ForceLimit(4) = R2 [FL]
ForceLimit(5) = R3 [FL]
```
The term ForceLimit(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]


dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes a linear exponential damper-type link property. If this function is called
for an existing link property, all items for the property are reset to their default values.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropDamperLinearExponential()

```
'dimension variables
```
```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim MyDOF() As Boolean
```
```
Dim MyFixed() As Boolean
```
```
Dim MyNonLinear() As Boolean
```
```
Dim MyKe() As Double
```
```
Dim MyCe() As Double
```
```
Dim MyK() As Double
```
```
Dim MyC() As Double
```
```
Dim MyCexp() As Double
```
```
Dim MyForceLimit() As Double
```

'create Sap2000 object

```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
'add link property

```
ReDim MyDOF(5)
```
```
ReDim MyFixed(5)
```
```
ReDim MyNonLinear(5)
```
```
ReDim MyKe(5)
```
```
ReDim MyCe(5)
```
```
ReDim MyK(5)
```
```
ReDim MyC(5)
```
```
ReDim MyCexp(5)
```
```
ReDim MyForceLimit(5)
```
```
MyDOF(0) = True
```
```
MyKe(0) = 12
```

```
MyCe(0) = 0.01
```
```
MyDOF(1) = True
```
```
MyNonLinear(1) = True
```
```
MyKe(1) = 12
```
```
MyCe(1) = 0.01
```
```
MyK(1) = 20
```
```
MyC(1)=0.08
```
```
MyCexp(1) = 1.2
```
```
MyForceLimit(1) = 50
```
```
MyDOF(2) = True
```
```
MyFixed(2) = True
```
```
ret = SapModel.PropLink.SetDamperLinearExponential("D1", MyDOF, MyFixed,
MyNonLinear, MyKe, MyCe, MyK, MyC, MyCexp, MyForceLimit, 1, 0)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
End Sub

## Release Notes

Initial release in version 16.0.2.

## See Also

GetDamperLinearExponential

# SetFrictionIsolator


## Syntax

SapObject.SapModel.PropLink.SetFrictionIsolator

## VB6 Procedure

Function SetFrictionIsolator(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed()
As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double,
ByRef k() As Double, ByRef Slow() As Double, ByRef Fast() As Double, ByRef Rate() As
Double, ByRef Radius() As Double, ByVal Damping As Double, ByVal dj2 As Double, ByVal
dj3 As Double, Optional ByVal Notes As String = "", Optional ByVal GUID As String = "") As
Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.


```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1, Not Used
NonLinear(4) = R2, Not Used
NonLinear(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U1, U2 and U3. For those degrees of
freedom, the term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1, Not Used
k(4) = R2, Not Used
k(5) = R3, Not Used
```

Note that this item is applicable only for degrees of freedom U1, U2 and U3. For those degrees of
freedom, the term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Slow

This is an array of the friction coefficient at zero velocity terms for the link property. This
coefficient applies for nonlinear analyses.

```
Slow(0) = U1, Not Used
Slow(1) = U2
Slow(2) = U3
Slow(3) = R1, Not Used
Slow(4) = R2, Not Used
Slow(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Slow(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Fast

This is an array of the friction coefficient at fast velocity terms for the link property. This
coefficient applies for nonlinear analyses.

```
Fast(0) = U1, Not Used
Fast(1) = U2
Fast(2) = U3
Fast(3) = R1, Not Used
Fast(4) = R2, Not Used
Fast(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Fast(n) applies pnly when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Rate

This is an array of the inverse of the characteristic sliding velocity terms for the link property. This
item applies for nonlinear analyses.

```
Rate(0) = U1, Not Used
Rate(1) = U2 [s/L]
Rate(2) = U3 [s/L]
Rate(3) = R1, Not Used
Rate(4) = R2, Not Used
Rate(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Rate(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.


Radius

This is an array of the radius of the sliding contact surface terms for the link property. Inputting 0
means there is an infinite radius, that is, the slider is flat. This item applies for nonlinear analyses.

```
Radius(0) = U1, Not Used
Radius(1) = U2 [L]
Radius(2) = U3 [L]
Radius(3) = R1, Not Used
Radius(4) = R2, Not Used
Radius(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Radius(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear
(n) = True.

Damping

This is the nonlinear damping coefficient used for the axial translational degree of freedom, U1.
This item applies for nonlinear analyses. [F/L]

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes a friction isolator-type link property. If this function is called for an
existing link property, all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropFrictionIsolator()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MySlow() As Double
Dim MyFast() As Double
Dim MyRate() As Double
Dim MyRadius() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MySlow(5)
ReDim MyFast(5)
ReDim MyRate(5)
ReDim MyRadius(5)

MyDOF(0) = True
MyNonLinear(0) = True
MyKe(0) = 12
MyCe(0) = 0.01
MyK(0) = 1000

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MySlow(1)= 0.6


MyFast(1)= 0.5
MyRate(1)= 10
MyRadius(1)= 80

MyDOF(2) = True
MyNonLinear(2) = True
MyKe(2) = 14
MyCe(2) = 0.008
MyK(2) = 22
MySlow(2)= 0.66
MyFast(2)= 0.55
MyRate(2)= 12
MyRadius(2)= 75

MyDOF(3) = True
MyKe(3) = 15
MyCe(3) = 0

MyDOF(4) = True
MyFixed(4) = True

ret = SapModel.PropLink.SetFrictionIsolator("FI1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, MyK, MySlow, MyFast, MyRate, MyRadius, 0.1, 2, 3)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetFrictionIsolator

# SetGap

## Syntax

SapObject.SapModel.PropLink.SetGap

## VB6 Procedure

Function SetGap(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As Boolean,
ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef k() As


Double, ByRef dis() As Double, ByVal dj2 As Double, ByVal dj3 As Double, Optional ByVal
Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property then that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke


This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dis

This is an array of initial gap opening terms for the link property. The initial gap opening applies
for nonlinear analyses.

```
dis(0) = U1 [L]
dis(1) = U2 [L]
dis(2) = U3 [L]
dis(3) = R1 [rad]
dis(4) = R2 [rad]
dis(5) = R3 [rad]
```

The term dis(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes a gap-type link property. If this function is called for an existing link
property, all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropGap()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MyDis() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MyDis(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MyDis(1)=1.2

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetGap("G1", MyDOF, MyFixed, MyNonLinear, MyKe, MyCe,
MyK, MyDis, 2, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetGap

# SetHook


## Syntax

SapObject.SapModel.PropLink.SetHook

## VB6 Procedure

Function SetHook(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As Boolean,
ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef k() As
Double, ByRef dis() As Double, ByVal dj2 As Double, ByVal dj3 As Double, Optional ByVal
Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property then that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
```

```
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dis


This is an array of initial hook opening terms for the link property. The initial hook opening
applies for nonlinear analyses.

```
c(0) = U1 [L]
c(1) = U2 [L]
c(2) = U3 [L]
c(3) = R1 [rad]
c(4) = R2 [rad]
c(5) = R3 [rad]
```
The term dis(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes a hook-type link property. If this function is called for an existing link
property, all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropHook()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double


Dim MyDis() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MyDis(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MyDis(1)=1.2

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetHook("H1", MyDOF, MyFixed, MyNonLinear, MyKe, MyCe,
MyK, MyDis, 2, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

GetHook

# SetLinear

## Syntax

SapObject.SapModel.PropLink.SetLinear

## VB6 Procedure

Function SetLinear(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As
Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByVal dj2 As Double, ByVal dj3 As
Double, Optional ByVal KeCoupled As Boolean = False, Optional ByVal CeCoupled As Boolean
= False, Optional ByVal Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity if DOF(0) = True
Fixed(1) = U2 fixity if DOF(1) = True
Fixed(2) = U3 fixity if DOF(2) = True
Fixed(3) = R1 fixity if DOF(3) = True
Fixed(4) = R2 fixity if DOF(4) = True
Fixed(5) = R3 fixity if DOF(5) = True
```
Ke


This is an array of stiffness terms for the link property. There are 6 terms in the array if the
stiffness is uncoupled and 21 if it is coupled. The KeCoupled item indicates if the stiffness is
coupled.

If the stiffness is uncoupled:

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
If the stiffness is coupled:

```
Ke(0) = U1U1 [F/L]
Ke(1) = U1U2 [F/L]
Ke(2) = U2U2 [F/L]
Ke(3) = U1U3 [F/L]
Ke(4) = U2U3 [F/L]
Ke(5) = U3U3 [F/L]
Ke(6) = U1R1 [F]
Ke(7) = U2R1 [F]
Ke(8) = U3R1 [F]
Ke(9) = R1R1 [FL]
Ke(10) = U1R2 [F]
Ke(11) = U2R2 [F]
Ke(12) = U3R2 [F]
Ke(13) = R1R2 [FL]
Ke(14) = R2R2 [FL]
Ke(15) = U1R3 [F]
Ke(16) = U2R3 [F]
Ke(17) = U3R3 [F]
Ke(18) = R1R3 [FL]
Ke(19) = R2R3 [FL]
Ke(20) = R3R3 [FL]
```
Ce

This is an array of damping terms for the link property. There are 6 terms in the array if the
damping is uncoupled and 21 if it is coupled. The CeCoupled item indicates if the damping is
coupled.

If the damping is uncoupled:

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```

If the damping is coupled:

```
Ce(0) = U1U1 [F/L]
Ce(1) = U1U2 [F/L]
Ce(2) = U2U2 [F/L]
Ce(3) = U1U3 [F/L]
Ce(4) = U2U3 [F/L]
Ce(5) = U3U3 [F/L]
Ce(6) = U1R1 [F]
Ce(7) = U2R1 [F]
Ce(8) = U3R1 [F]
Ce(9) = R1R1 [FL]
Ce(10) = U1R2 [F]
Ce(11) = U2R2 [F]
Ce(12) = U3R2 [F]
Ce(13) = R1R2 [FL]
Ce(14) = R2R2 [FL]
Ce(15) = U1R3 [F]
Ce(16) = U2R3 [F]
Ce(17) = U3R3 [F]
Ce(18) = R1R3 [FL]
Ce(19) = R2R3 [FL]
Ce(20) = R3R3 [FL]
```
dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

KeCoupled

This item is True if the link stiffness, Ke, is coupled. There are 21 terms in the Ke array if Ke is
coupled; otherwise there are 6 terms.

CeCoupled

This item is True if the link damping, Ce, is coupled. There are 21 terms in the Ce array if Ce is
coupled; otherwise there are 6 terms.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.


## Remarks

This function initializes a linear-type link property. If this function is called for an existing link
property, all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropLinear()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub


## Release Notes

Initial release in version 11.02.

## See Also

GetLinear

# SetMultiLinearElastic

## Syntax

SapObject.SapModel.PropLink.SetMultiLinearElastic

## VB6 Procedure

Function SetMultiLinearElastic(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed()
As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double,
ByVal dj2 As Double, ByVal dj3 As Double, Optional ByVal Notes As String = "", Optional
ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property then. that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
```

```
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]


dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes a multilinear elastic-type link property. If this function is called for an
existing link property, all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropMultiLinearElastic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)


ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetMultiLinearElastic("MLE1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, 2, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetMultiLinearElastic

GetMultiLinearPoints

SetMultiLinearPoints

# SetMultiLinearPlastic

## Syntax

SapObject.SapModel.PropLink.SetMultiLinearPlastic

## VB6 Procedure

Function SetMultiLinearPlastic(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed()
As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double,


ByVal dj2 As Double, ByVal dj3 As Double, Optional ByVal Notes As String = "", Optional
ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke


This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes a multilinear plastic-type link property. If this function is called for an
existing link property, all items for the property are reset to their default values.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.


## VBA Example

Sub SetLinkPropMultiLinearPlastic()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetMultiLinearPlastic("MLP1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, 2, 0)

'close Sap2000
SapObject.ApplicationExit False


Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetMultiLinearPlastic

GetMultiLinearPoints

SetMultiLinearPoints

# SetMultiLinearPoints

## Syntax

SapObject.SapModel.PropLink.SetMultiLinearPoints

## VB6 Procedure

Function SetMultiLinearPoints(ByVal Name As String, ByVal DOF As Long, ByVal
NumberPoints As Long, ByRef F() As Double, ByRef D() As Double, Optional ByVal MyType
As Long = 1, Optional ByVal a1 As Double = 0, Optional ByVal a2 As Double = 0, Optional
ByVal b1 As Double = 0, Optional ByVal b2 As Double = 0, Optional ByVal eta As Double = 0)
As Long

## Parameters

Name

The name of an existing multilinear elastic or multilinear plastic link property.

DOF

This is 1, 2, 3, 4, 5 or 6, indicating the degree of freedom to which the multilinear points apply.

```
1 = U1
2 = U2
3 = U3
4 = R1
5 = R2
6 = R3
```
NumberPoints


The number of foce-defomation points for the specified degree of freedom.

F

This is an array, dimensioned to NumberPoints - 1, that includes the force at each point. When
DOF is U1, U2 or U3, this is a force. When DOF is R1, R2 or R3. this is a moment. [F] if DOF <=
3, and [FL} if DOF > 3

D

This is an array, dimensioned to NumberPoints - 1, that includes the displacement at each point.
When DOF is U1, U2 or U3, this is a translation. When DOF is R1, R2 or R3, this is a rotation.
[L] if DOF <= 3, and [rad] if DOF > 3

MyType

This item applies only to multilinear plastic link properties. It is 1, 2 or 3, indicating the hysteresis
type.

```
1 = Kinematic
2 = Takeda
3 = Pivot
```
a1

This item applies only to multilinear plastic link properties that have a pivot hysteresis type
(MyType = 3). It is the Alpha1 hysteresis parameter.

a2

This item applies only to multilinear plastic link properties that have a pivot hysteresis type
(MyType = 3). It is the Alpha2 hysteresis parameter.

b1

This item applies only to multilinear plastic link properties that have a pivot hysteresis type
(MyType = 3). It is the Beta1 hysteresis parameter.

b2

This item applies only to multilinear plastic link properties that have a pivot hysteresis type
(MyType = 3). It is the Beta2 hysteresis parameter.

eta

This item applies only to multilinear plastic link properties that have a pivot hysteresis type
(MyType = 3). It is the Eta hysteresis parameter.

## Remarks

This function sets the force-deformation data for a specified degree of freedom in multilinear
elastic and multilinear plastic link properties.

The function returns zero if the data is successfully assigned; otherwise it returns a nonzero value.


To successfully apply this data to the indicated link property, the following conditions must be
met:

1. The link property must be multilinear elastic or multilinear plastic.
2. The specified DOF must be active.
3. The specified DOF must not be fixed.
4. The specified DOF must be nonlinear.

## VBA Example

Sub SetLinkPropMultiLinearPoints()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyF() As Double
Dim MyD() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12


MyCe(1) = 0.01

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetMultiLinearPlastic("MLP1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, 2, 0)

'set multilinear force-defomation data
ReDim MyF(4)
ReDim MyD(4)

MyF(0) = -12
MyF(1) = -10
MyF(2) = 0
MyF(3) = 8
MyF(4) = 9

MyD(0) = -8
MyD(1) = -0.6
MyD(2) = 0
MyD(3) = 0.2
MyD(4) = 6

ret = SapModel.PropLink.SetMultiLinearPoints("MLP1", 2, 5, MyF, MyD, 3, 9, 12, 0.75, 0.8,
.1)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetMultiLinearPoints

SetMultiLinearElastic

GetMultiLinearElastic

SetMultiLinearPlastic

GetMultiLinearPlastic

# SetPDelta


## Syntax

SapObject.SapModel.PropLink.SetPDelta

## VB6 Procedure

Function SetPDelta(ByVal Name As String, ByRef Value() As Double) As Long

## Parameters

Name

The name of an existing link property.

Value

This is an array of P-delta parameters.

```
Value(0) = M2 P-delta to I-end of link as moment, M2I
Value(1) = M2 P-delta to J-end of link as moment, M2J
Value(2) = M3 P-delta to I-end of link as moment, M3I
Value(3) = M3 P-delta to J-end of link as moment, M3J
```
## Remarks

This function assigns P-delta parameters to a link property.

The function returns zero if the values are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropPDelta()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double
Dim MyValue() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object


Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)

'set link property P-delta parameters
ReDim MyValue(3)
MyValue(0) = 0.6
MyValue(1) = 0.4
MyValue(2) = 0.3
MyValue(3) = 0.2
ret = SapModel.PropLink.SetPDelta("L1", MyValue)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetPDelta

# SetPlasticWen

## Syntax

SapObject.SapModel.PropLink.SetPlasticWen

## VB6 Procedure

Function SetPlasticWen(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As
Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef


k() As Double, ByRef Yield() As Double, ByRef Ratio() As Double, ByRef exp() As Double,
ByVal dj2 As Double, ByVal dj3 As Double, Optional ByVal Notes As String = "", Optional
ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1 has nonlinear properties
NonLinear(4) = R2 has nonlinear properties
NonLinear(5) = R3 has nonlinear properties
```
The term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke


This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1 [FL]
k(4) = R2 [FL]
k(5) = R3 [FL]
```
The term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

Yield

This is an array of yield force terms for the link property. The yield force applies for nonlinear
analyses.

```
Yield(0) = U1 [F]
Yield(1) = U2 [F]
Yield(2) = U3 [F]
Yield(3) = R1 [FL]
Yield(4) = R2 [FL]
Yield(5) = R3 [FL]
```

The term Yield(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

Ratio

This is an array of post-yield stiffness ratio terms for the link property. The post-yield stiffness
ratio applies for nonlinear analyses. It is the post-yield stiffness divided by the initial stiffness.

```
Ratio(0) = U1
Ratio(1) = U2
Ratio(2) = U3
Ratio(3) = R1
Ratio(4) = R2
Ratio(5) = R3
```
The term Ratio(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

exp

This is an array of yield exponent terms for the link property. The yield exponent applies for
nonlinear analyses. The yielding exponent that controls the sharpness of the transition from the
initial stiffness to the yielded stiffness.

```
exp(0) = U1
exp(1) = U2
exp(2) = U3
exp(3) = R1
exp(4) = R2
exp(5) = R3
```
The term exp(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.


## Remarks

This function initializes a plastic Wen-type link property. If this function is called for an existing
link property, all items for the property are reset to their default values.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropPlasticWen()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MyYield() As Double
Dim MyRatio() As Double
Dim MyExp() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MyYield(5)
ReDim MyRatio(5)
ReDim MyExp(5)

MyDOF(0) = True


MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MyYield(1)= 50
MyRatio(1)= 0.1
MyExp(1)= 3

MyDOF(2) = True
MyFixed(2) = True

ret = SapModel.PropLink.SetPlasticWen("PW1", MyDOF, MyFixed, MyNonLinear, MyKe,
MyCe, MyK, MyYield, MyRatio, MyExp, 2, 0)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetPlasticWen

# SetRubberIsolator

## Syntax

SapObject.SapModel.PropLink.SetRubberIsolator

## VB6 Procedure

Function SetRubberIsolator(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed() As
Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double, ByRef
k() As Double, ByRef Yield() As Double, ByRef Ratio() As Double, ByVal dj2 As Double,
ByVal dj3 As Double, Optional ByVal Notes As String = "", Optional ByVal GUID As String =
"") As Long

## Parameters


Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1, Not Used
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1, Not Used
NonLinear(4) = R2, Not Used
NonLinear(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
```

```
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.

```
k(0) = U1, Not Used
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1, Not Used
k(4) = R2, Not Used
k(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Yield

This is an array of yield force terms for the link property. The yield force applies for nonlinear
analyses.

```
Yield(0) = U1, Not Used
Yield(1) = U2 [F]
Yield(2) = U3 [F]
Yield(3) = R1, Not Used
Yield(4) = R2, Not Used
Yield(5) = R3, Not Used
```
The term Yield(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.


Ratio

This is an array of post-yield stiffness ratio terms for the link property. The post-yield stiffness
ratio applies for nonlinear analyses. It is the post-yield stiffness divided by the initial stiffness.

```
Ratio(0) = U1, Not Used
Ratio(1) = U2
Ratio(2) = U3
Ratio(3) = R1, Not Used
Ratio(4) = R2, Not Used
Ratio(5) = R3, Not Used
```
The term Ratio(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes a rubber isolator-type link property. If this function is called for an
existing link property, all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropRubberIsolator()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double


Dim MyCe() As Double
Dim MyK() As Double
Dim MyYield() As Double
Dim MyRatio() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MyYield(5)
ReDim MyRatio(5)
ReDim MyExp(5)

MyDOF(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MyYield(1)= 50
MyRatio(1)= 0.1

MyDOF(2) = True
MyNonLinear(2) = True
MyKe(2) = 15
MyCe(2) = 0.008
MyK(2) = 22
MyYield(2)= 60
MyRatio(2)= 0.15

MyDOF(3) = True
MyFixed(3) = True


ret = SapModel.PropLink.SetRubberIsolator("RI1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, MyK, MyYield, MyRatio, 2, 3)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetRubberIsolator

# SetSpringData

## Syntax

SapObject.SapModel.PropLink.SetSpringData

## VB6 Procedure

Function SetSpringData(ByVal Name As String, ByVal DefinedForThisLength As Double, ByVal
DefinedForThisArea As Double) As Long

## Parameters

Name

The name of an existing link property.

DefinedForThisLength

The link property is defined for this length in a line (frame) spring. [L]

DefinedForThisArea

The link property is defined for this area in an area spring. [L^2 ]

## Remarks

This function assigns length and area values to a link property that are used if the link property is
specified in line and area spring assignments.


The function returns zero if the values are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropSpringData()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)

'set link property spring data
ret = SapModel.PropLink.SetSpringData("L1", 12, 2)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

GetSpringData

# SetTCFrictionIsolator

## Syntax

SapObject.SapModel.PropLink.SetTCFrictionIsolator

## VB6 Procedure

Function SetTCFrictionIsolator(ByVal Name As String, ByRef DOF() As Boolean, ByRef Fixed()
As Boolean, ByRef NonLinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As Double,
ByRef k() As Double, ByRef Slow() As Double, ByRef Fast() As Double, ByRef Rate() As
Double, ByRef Radius() As Double, ByRef SlowT() As Double, ByRef FastT() As Double, ByRef
RateT() As Double, ByVal kt As Double, ByVal dis As Double, ByVal dist As Double, ByVal
Damping As Double, ByVal dj2 As Double, ByVal dj3 As Double, Optional ByVal Notes As
String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF

This is a boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
DOF(5) = R3
```
Fixed

This is a boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```

The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1, Not Used
NonLinear(4) = R2, Not Used
NonLinear(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U1, U2 and U3. For those degrees of
freedom, the term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

k

This is an array of initial stiffness terms for the link property. The initial stiffness applies for
nonlinear analyses.


```
k(0) = U1 [F/L]
k(1) = U2 [F/L]
k(2) = U3 [F/L]
k(3) = R1, Not Used
k(4) = R2, Not Used
k(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U1, U2 and U3. For those degrees of
freedom, the term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Slow

This is an array of the friction coefficient at zero velocity terms when U1 is in compression for the
link property. This coefficient applies for nonlinear analyses.

```
Slow(0) = U1, Not Used
Slow(1) = U2
Slow(2) = U3
Slow(3) = R1, Not Used
Slow(4) = R2, Not Used
Slow(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Slow(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Fast

This is an array of the friction coefficient at fast velocity terms when U1 is in compression for the
link property. This coefficient applies for nonlinear analyses.

```
Fast(0) = U1, Not Used
Fast(1) = U2
Fast(2) = U3
Fast(3) = R1, Not Used
Fast(4) = R2, Not Used
Fast(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Fast(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Rate

This is an array of the inverse of the characteristic sliding velocity terms when U1 is in
compression for the link property. This item applies for nonlinear analyses.

```
Rate(0) = U1, Not Used
Rate(1) = U2 [s/L]
Rate(2) = U3 [s/L]
```

```
Rate(3) = R1, Not Used
Rate(4) = R2, Not Used
Rate(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Rate(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Radius

This is an array of the radius of the sliding contact surface terms for the link property. Inputting 0
means there is an infinite radius, that is, the slider is flat. This item applies for nonlinear analyses.

```
Radius(0) = U1, Not Used
Radius(1) = U2 [L]
Radius(2) = U3 [L]
Radius(3) = R1, Not Used
Radius(4) = R2, Not Used
Radius(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term Radius(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear
(n) = True.

SlowT

This is an array of the friction coefficient at zero velocity terms when U1 is in tension for the link
property. This coefficient applies for nonlinear analyses.

```
SlowT(0) = U1, Not Used
SlowT(1) = U2
SlowT(2) = U3
SlowT(3) = R1, Not Used
SlowT(4) = R2, Not Used
SlowT(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term SlowT(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear
(n) = True.

FastT

This is an array of the friction coefficient at fast velocity terms when U1 is in tension for the link
property. This coefficient applies for nonlinear analyses.

```
FastT(0) = U1, Not Used
FastT(1) = U2
FastT(2) = U3
FastT(3) = R1, Not Used
FastT(4) = R2, Not Used
FastT(5) = R3, Not Used
```

Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term FastT(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

RateT

This is an array of the inverse of the characteristic sliding velocity terms when U1 is in tension for
the link property. This item applies for nonlinear analyses.

```
RateT(0) = U1, Not Used
RateT(1) = U2 [s/L]
RateT(2) = U3 [s/L]
RateT(3) = R1, Not Used
RateT(4) = R2, Not Used
RateT(5) = R3, Not Used
```
Note that this item is applicable only for degrees of freedom U2 and U3. For those degrees of
freedom, the term RateT(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

kt

The axial translational tension stiffness for the U1 degree of freedom. This item applies for
nonlinear analyses. [F/L]

dis

The U1 degree of freedom gap opening for compression. This item applies for nonlinear analyses.
[L]

dist

The U1 degree of freedom gap opening for tension. This item applies for nonlinear analyses. [L]

Damping

The nonlinear damping coefficient used for the axial translational degree of freedom, U1. This
item applies for nonlinear analyses. [F/L]

dj2

The distance from the J-End of the link to the U2 shear spring. This item applies only when DOF
(1) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring. This item applies only when DOF
(2) = True. [L]

Notes

The notes, if any, assigned to the property.


### GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function initializes a T/C friction isolator-type link property. If this function is called for an
existing link property, all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropTCFrictionIsolator()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double
Dim MyK() As Double
Dim MySlow() As Double
Dim MyFast() As Double
Dim MyRate() As Double
Dim MyRadius() As Double
Dim MySlowT() As Double
Dim MyFastT() As Double
Dim MyRateT() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)


ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(5)
ReDim MySlow(5)
ReDim MyFast(5)
ReDim MyRate(5)
ReDim MyRadius(5)
ReDim MySlowT(5)
ReDim MyFastT(5)
ReDim MyRateT(5)

MyDOF(0) = True
MyNonLinear(0) = True
MyKe(0) = 12
MyCe(0) = 0.01
MyK(0) = 1000

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01
MyK(1) = 20
MySlow(1)= 0.6
MyFast(1)= 0.5
MyRate(1)= 10
MyRadius(1)= 80
MySlowT(1)= 0.61
MyFastT(1)= 0.51
MyRateT(1)= 10.1

MyDOF(2) = True
MyNonLinear(2) = True
MyKe(2) = 14
MyCe(2) = 0.008
MyK(2) = 22
MySlow(2)= 0.66
MyFast(2)= 0.55
MyRate(2)= 12
MyRadius(2)= 75
MySlowT(2)= 0.67
MyFastT(2)= 0.56
MyRateT(2)= 12.1

MyDOF(3) = True
MyKe(3) = 15
MyCe(3) = 0

MyDOF(4) = True
MyFixed(4) = True

ret = SapModel.PropLink.SetTCFrictionIsolator("TCFI1", MyDOF, MyFixed, MyNonLinear,
MyKe, MyCe, MyK, MySlow, MyFast, MyRate, MyRadius, MySlowT, MyFastT, MyRateT, 18,


### 2, 3, 0.1, 2, 3)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetTCFrictionIsolator

# SSetTriplePendulumIsolator

## Syntax

SapObject.SapModel.PropLink.SetTriplePendulumIsolator

## VB6 Procedure

Function SetTriplePendulumIsolator(ByVal Name As String, ByRef dof() As Boolean, ByRef
Fixed() As Boolean, ByRef Nonlinear() As Boolean, ByRef Ke() As Double, ByRef Ce() As
Double, ByVal K1 As Double, ByVal Damping As Double, ByRef K() As Double, ByRef Slow()
As Double, ByRef Fast() As Double, ByRef Rate() As Double, ByRef Radius() As Double, ByRef
StopDist() As Double, ByVal HeightOut As Double, ByVal HeightIn As Double, ByVal dj2 As
Double, ByVal dj3 As Double, Optional ByVal Notes As String = "", Optional ByVal GUID As
String = "") As Long

## Parameters

Name

The name of an existing or new link property. If this is an existing property, that property is
modified; otherwise, a new property is added.

DOF

This is a Boolean array, dimensioned to 5, indicating if properties exist for a specified degree of
freedom.

```
DOF(0) = U1
DOF(1) = U2
DOF(2) = U3
DOF(3) = R1
DOF(4) = R2
```

### DOF(5) = R3

Fixed

This is a Boolean array, dimensioned to 5, indicating if the specified degree of freedom is fixed
(restrained).

```
Fixed(0) = U1 fixity
Fixed(1) = U2 fixity
Fixed(2) = U3 fixity
Fixed(3) = R1 fixity
Fixed(4) = R2 fixity
Fixed(5) = R3 fixity
```
The term Fixed(n) applies only when DOF(n) = True.

NonLinear

This is a Boolean array, dimensioned to 5, indicating if nonlinear properties exist for a specified
degree of freedom.

```
NonLinear(0) = U1 has nonlinear properties
NonLinear(1) = U2 has nonlinear properties
NonLinear(2) = U3 has nonlinear properties
NonLinear(3) = R1, Not Used
NonLinear(4) = R2, Not Used
NonLinear(5) = R3, Not Used
```
Note that this item is applicable for degrees of freedom U1, U2 and U3 only. For those degrees of
freedom, the term NonLinear(n) applies only when DOF(n) = True and Fixed(n) = False.

Ke

This is an array of effective stiffness terms for the link property. The effective stiffness applies for
linear analyses, and also for nonlinear analysis for those DOF for which NonLinear(n) = False.

```
Ke(0) = U1 [F/L]
Ke(1) = U2 [F/L]
Ke(2) = U3 [F/L]
Ke(3) = R1 [FL]
Ke(4) = R2 [FL]
Ke(5) = R3 [FL]
```
The term Ke(n) applies only when DOF(n) = True and Fixed(n) = False.

Ce

This is an array of effective damping terms for the link property. The effective damping applies
for linear analyses.

```
Ce(0) = U1 [F/L]
```

```
Ce(1) = U2 [F/L]
Ce(2) = U3 [F/L]
Ce(3) = R1 [FL]
Ce(4) = R2 [FL]
Ce(5) = R3 [FL]
```
The term Ce(n) applies only when DOF(n) = True and Fixed(n) = False.

K1

This is the axial compression stiffness for the U1 degree of freedom. This item applies for
nonlinear analyses. [F/L]

Damping

This is the nonlinear damping coefficient for the axial degree of freedom, U1, when it is in
compression. This item applies for nonlinear analyses. [F/L]

K

This is an array, dimensioned to 3, of initial nonlinear stiffness (before sliding) for each sliding
surface.

```
K(0) = for the outer top sliding surface [F/L]
K(1) = for the outer bottom sliding surface [F/L]
K(2) = for the inner top sliding surface [F/L]
K(3) = for the inner bottom sliding surface [F/L]
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term k(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Slow

This is an array, dimensioned to 3, of the friction coefficient at zero velocity for each sliding
surface when U1 is in compression.

```
Slow(0) = for the outer top sliding surface
Slow(1) = for the outer bottom sliding surface
Slow(2) = for the inner top sliding surface
Slow(3) = for the inner bottom sliding surface
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term Slow(n) only applies when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Fast

This is an array, dimensioned to 3, of the friction coefficient at fast velocity for each sliding
surface when U1 is in compression.

```
Fast(0) = for the outer top sliding surface
```

```
Fast(1) = for the outer bottom sliding surface
Fast(2) = for the inner top sliding surface
Fast(3) = for the inner bottom sliding surface
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term Fast(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) =
True.

Rate

This is an array, dimensioned to 3, of the inverse of the characteristic sliding velocity for the Slow
and Fast friction coefficients for each sliding surface. This item applies for nonlinear analyses.

```
Rate(0) = for the outer top sliding surface [s/L]
Rate(1) = for the outer bottom sliding surface [s/L]
Rate(2) = for the inner top sliding surface [s/L]
Rate(3) = for the inner bottom sliding surface [s/L]
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term Rate(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n)
= True.

Radius

This is an array, dimensioned to 3, of the radius for each sliding surface. Inputting 0 means there
is an infinite radius, that is, the slider is flat. This item applies for nonlinear analyses.

```
Radius(0) = for the outer top sliding surface [L]
Radius(1) = for the outer bottom sliding surface [L]
Radius(2) = for the inner top sliding surface [L]
Radius(3) = for the inner bottom sliding surface [L]
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term Radius(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear
(n) = True.

StopDist

This is an array, dimensioned to 3, of the amount of displacement allowed before hitting a stiff
limit for each sliding surface. Inputting 0 means there is no stop. This item applies for nonlinear
analyses.

```
StopDist(0) = for the outer top sliding surface [L]
StopDist(1) = for the outer bottom sliding surface [L]
StopDist(2) = for the inner top sliding surface [L]
StopDist(3) = for the inner bottom sliding surface [L]
```
Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term StopDist(n) applies only when DOF(n) = True, Fixed(n) = False and NonLinear
(n) = True.


HeightOut

This is the height (distance) between the outer sliding surfaces at zero displacement. [L]

Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

HeightIn

This is the height (distance) between the inner sliding surfaces. [L]

Note that this item is applicable for degrees of freedom U2 and U3 only. For those degrees of
freedom, the term applies only when DOF(n) = True, Fixed(n) = False and NonLinear(n) = True.

dj2

The distance from the J-End of the link to the U2 shear spring, that is, the center of the isolator.
This item applies only when DOF(2) = True. [L]

dj3

The distance from the J-End of the link to the U3 shear spring, that is, the center of the isolator.
This item applies only when DOF(3) = True. [L]

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, then the program assigns a GUID to the property.

## Remarks

This function initializes a Triple Pendulum Isolator type link property. If this function is called for
an existing link property, then all items for the property are reset to their default value.

The function returns zero if the property is successfully initialized, otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropTriplePendulumIsolator()
'dimension variables
Dim SapObject As Sap2000.SapObject
Dim SapModel As cSapModel
Dim ret As Long
Dim MyDOF() As Boolean
Dim MyFixed() As Boolean
Dim MyNonLinear() As Boolean
Dim MyKe() As Double
Dim MyCe() As Double


Dim MyK() As Double
Dim MySlow() As Double
Dim MyFast() As Double
Dim MyRate() As Double
Dim MyRadius() As Double
Dim MyStopDist () As Double

'create Sap2000 object
Set SapObject = New SAP2000.SapObject

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim MyDOF(5)
ReDim MyFixed(5)
ReDim MyNonLinear(5)
ReDim MyKe(5)
ReDim MyCe(5)
ReDim MyK(3)
ReDim MySlow(3)
ReDim MyFast(3)
ReDim MyRate(3)
ReDim MyRadius(3)
ReDim MyStopDist(3)

MyDOF(0) = True
MyNonLinear(0) = True
MyKe(0) = 12
MyCe(0) = 0.01

MyDOF(1) = True
MyNonLinear(1) = True
MyKe(1) = 12
MyCe(1) = 0.01

MyDOF(2) = True
MyNonLinear(2) = True
MyKe(2) = 1
MyCe(2) = 0.008

MyK(0) = 20
MySlow(0)= 0.6
MyFast(0)= 0.5


MyRate(0)= 10
MyRadius(0)= 80
MyStopDist(0)= 8

MyK(1) = 22
MySlow(1)= 0.66
MyFast(1)= 0.55
MyRate(1)= 12
MyRadius(1)= 75
MyStopDist(1)= 8

MyK(2) = 20
MySlow(2)= 0.6
MyFast(2)= 0.5
MyRate(2)= 10
MyRadius(2)= 80
MyStopDist(2)= 8

MyK(3) = 20
MySlow(3)= 0.6
MyFast(3)= 0.5
MyRate(3)= 10
MyRadius(3)= 80
MyStopDist(3)= 8

MyDOF(3) = True
MyKe(3) = 15
MyCe(3) = 0

MyDOF(4) = True
MyFixed(4) = True

ret = SapModel.PropLink.SetTriplePendulumIsolator("TPI1", MyDOF, MyFixed,
MyNonLinear, MyKe, MyCe, 1000, 0.1, MyK, MySlow, MyFast, MyRate, MyRadius,
MyStopDist, 6, 3, 3, 3)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 16.00.

## See Also

GetTriplePendulumIsolator


# SetWeightAndMass

## Syntax

SapObject.SapModel.PropLink.SetWeightAndMass

## VB6 Procedure

Function SetWeightAndMass(ByVal Name As String, ByVal w As Double, ByVal m As Double,
ByVal R1 As Double, ByVal R2 As Double, ByVal R3 As Double) As Long

## Parameters

Name

The name of an existing link property.

w

The weight of the link. [F]

m

The translational mass of the link. [M]

R1

The rotational inertia of the link about its local 1 axis. [ML^2 ]

R2

The rotational inertia of the link about its local 2 axis. [ML^2 ]

R3

The rotational inertia of the link about its local 3 axis. [ML^2 ]

## Remarks

This function assigns weight and mass values to a link property.

The function returns zero if the values are successfully assigned; otherwise it returns a nonzero
value.

## VBA Example

Sub SetLinkPropWeightAndMass()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel


Dim ret As Long
Dim DOF() As Boolean
Dim Fixed() As Boolean
Dim Ke() As Double
Dim Ce() As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add link property
ReDim DOF(5)
ReDim Fixed(5)
ReDim Ke(5)
ReDim Ce(5)
DOF(0) = True
Ke(0) = 12
ret = SapModel.PropLink.SetLinear("L1", DOF, Fixed, Ke, Ce, 0, 0)

'set link property weight and mass
ret = SapModel.PropLink.SetWeightAndMass("L1", 10, 0.26, 0.0012, 0.0014, 0.0016)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetWeightAndMass


# ChangeName

## Syntax

SapObject.SapModel.PropRebar.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined rebar property.

**NewName**

The new name for the rebar property.

## Remarks

This function changes the name of an existing rebar property.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeRebarPropName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)


'set new rebar property
ret = SapModel.PropRebar.SetProp("R1", 1, 1.128)

'change name of rebar property
ret = SapModel.PropRebar.ChangeName("R1", "MyRebar")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.2.0.

## See Also

# Count

## Syntax

SapObject.SapModel.PropRebar.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns the total number of defined rebar properties in the model.

## VBA Example

Sub CountRebarProps()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new rebar property
ret = SapModel.PropRebar.SetProp("R1", 1, 1.128)

'return number of defined rebar properties
Count = SapModel.PropRebar.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.2.0.

## See Also

# Delete

## Syntax

SapObject.SapModel.PropRebar.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters


**Name**

The name of an existing rebar property.

## Remarks

The function deletes a specified rebar property.

The function returns zero if the property is successfully deleted; otherwise it returns a nonzero
value. It returns an error if the specified property can not be deleted, for example, if it is assigned
to an existing object.

## VBA Example

Sub DeleteRebarProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new rebar properties
ret = SapModel.PropRebar.SetProp("R1", 1, 1.128)
ret = SapModel.PropRebar.SetProp("R2", 1, 1.128)

'delete rebar property
ret = SapModel.PropRebar.Delete("R1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.2.0.


## See Also

# GetNameList

## Syntax

SapObject.SapModel.PropRebar.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

**NumberNames**

The number of rebar property names retrieved by the program.

**MyName**

This is a one-dimensional array of rebar property names. The MyName array is created as a
dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined rebar properties in the model.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetRebarNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")


'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new rebar properties
ret = SapModel.PropRebar.SetProp("R1", 1, 1.27)
ret = SapModel.PropRebar.SetProp("R2", 1, 1.27)

'get rebar property names
ret = SapModel.PropRebar.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.2.0.

## See Also

# GetProp

## Syntax

SapObject.SapModel.PropRebar.GetProp

## VB6 Procedure

Function GetProp(ByVal Name As String, ByRef Area As Double, ByRef Diameter As Double)
As Long

## Parameters

Name


The name of an existing rebar property.

**Area**

The cross-sectional area of the rebar. [L^2 ]

**Diameter**

The diameter of the rebar. [L]

## Remarks

This function retrieves rebar property definition data.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetRebarProperty()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Area As Double
Dim Diameter As Double

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new rebar property
ret = SapModel.PropRebar.SetProp("R1", 1, 1.128)

'get rebar property data
ret = SapModel.PropRebar.GetProp("R1", Area, Diameter)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing


Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.2.0.

## See Also

SetProp

# SetProp

## Syntax

SapObject.SapModel.PropRebar.SetProp

## VB6 Procedure

Function SetProp(ByVal Name As String, ByVal Area As Double, ByVal Diameter As Double)
As Long

## Parameters

**Name**

The name of an existing or new rebar property. If this is an existing property, that property is
modified; otherwise, a new property is added.

**Area**

The cross-sectional area of the rebar. [L^2 ]

**Diameter**

The diameter of the rebar. [L]

## Remarks

This function defines a rebar property.

The function returns zero if the property is successfully defined; otherwise it returns a nonzero
value.

## VBA Example


Sub SetRebarProperty()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'set new rebar property
ret = SapModel.PropRebar.SetProp("R1", 1, 1.128)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in v21.2.0.

## See Also

GetProp

# ChangeName

## Syntax

SapObject.SapModel.PropSolid.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long


## Parameters

Name

The existing name of a defined solid property.

NewName

The new name for the solid property.

## Remarks

This function changes the name of an existing solid property.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.

## VBA Example

Sub ChangeSolidPropName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(20, 50, 20)

'change name of solid property
ret = SapModel.PropSolid.ChangeName("SOLID1", "MySolid")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes


Initial release in version 11.02.

## See Also

# Count

## Syntax

SapObject.SapModel.PropSolid.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns the total number of defined solid properties in the model.

## VBA Example

Sub CountSolidProps()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(20, 50, 20)

'return number of defined solid properties
Count = SapModel.PropSolid.Count


'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# Delete

## Syntax

SapObject.SapModel.PropSolid.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing solid property.

## Remarks

The function deletes a specified solid property.

The function returns zero if the property is successfully deleted; otherwise it returns a nonzero
value. It returns an error if the specified property can not be deleted, for example, if it is assigned
to an existing object.

## VBA Example

Sub DeleteSolidProp()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim i As Long
Dim NumberNames As Long
Dim MyName() As String


'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(20, 50, 20)

'set new solid property
ret = SapModel.PropSolid.SetProp("S1", "4000Psi", 0, 10, 20, True)

'get solid object names
ret = SapModel.SolidObj.GetNameList(NumberNames, MyName)

'set solid property
For i = 1 to NumberNames
ret = SapModel.SolidObj.SetProperty(MyName(i - 1), "S1")
Next i

'delete solid property
ret = SapModel.PropSolid.Delete("SOLID1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# GetNameList

## Syntax

SapObject.SapModel.PropSolid.GetNameList


## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of solid property names retrieved by the program.

MyName

This is a one-dimensional array of solid property names. The MyName array is created as a
dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined solid properties in the model.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetSolidNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.NewSolidBlock(20, 50, 20)


'get solid property names
ret = SapModel.PropSolid.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# GetProp

## Syntax

SapObject.SapModel.PropSolid.GetProp

## VB6 Procedure

Function GetProp(ByVal Name As String, ByRef MatProp As String, ByRef a As Double, ByRef
B As Double, ByRef c As Double, ByRef Incompatible As Boolean, ByRef Color As Long,
ByRef Notes As String, ByRef GUID As String) As Long

## Parameters

Name

The name of an existing solid property.

MatProp

The name of the material property assigned to the solid property.

a

The material angle A. [deg]

b

The material angle B. [deg]

c

The material angle C. [deg]


Incompatible

If this item is True, incompatible bending modes are included in the stiffness formulation. In
general, incompatible modes significantly improve the bending behavior of the object.

Color

The display color assigned to the property.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves solid property definition data.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetSolidProperty()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim MatProp As String
Dim a As Double
Dim b As Double
Dim c As Double
Dim Incompatible As Boolean
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.NewSolidBlock(20, 50, 20)

'get solid property data
ret = SapModel.PropSolid.GetProp("SOLID1", MatProp, a, b, c, Incompatible, Color, Notes,
GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetProp

# SetProp

## Syntax

SapObject.SapModel.PropSolid.SetProp

## VB6 Procedure

Function SetProp(ByVal Name As String, ByVal MatProp As String, ByVal a As Double, ByVal
B As Double, ByVal c As Double, ByVal Incompatible As Boolean, Optional ByVal Color As
Long = -1, Optional ByVal Notes As String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new solid property. If this is an existing property, that property is
modified; otherwise, a new property is added.

MatProp

The name of the material property assigned to the solid property.

a

The material angle A. [deg]

b


The material angle B. [deg]

c

The material angle C. [deg]

Incompatible

If this item is True, incompatible bending modes are included in the stiffness formulation. In
general, incompatible modes significantly improve the bending behavior of the object.

Color

The display color assigned to the property. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function defines a solid property.

The function returns zero if the property is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetSolidProperty()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template


ret = SapModel.File.NewSolidBlock(20, 50, 20)

'set new solid property
ret = SapModel.PropSolid.SetProp("S1", "4000Psi", 0, 10, 20, True)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetProp

# ChangeName

## Syntax

SapObject.SapModel.PropTendon.ChangeName

## VB6 Procedure

Function ChangeName(ByVal Name As String, ByVal NewName As String) As Long

## Parameters

Name

The existing name of a defined tendon property.

NewName

The new name for the tendon property.

## Remarks

This function changes the name of an existing tendon property.

The function returns zero if the new name is successfully applied; otherwise it returns a nonzero
value.


## VBA Example

Sub ChangeTendonPropName()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new tendon property
ret = SapModel.PropTendon.SetProp("T1", Name, 1, 2.25)

'change name of tendon property
ret = SapModel.PropTendon.ChangeName("T1", "MyTendon")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.


## See Also

# Count

## Syntax

SapObject.SapModel.PropTendon.Count

## VB6 Procedure

Function Count() As Long

## Parameters

None

## Remarks

This function returns the total number of defined tendon properties in the model.

## VBA Example

Sub CountTendonProps()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim Count As Long

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)


'set new tendon property
ret = SapModel.PropTendon.SetProp("T1", Name, 1, 2.25)

'return number of defined tendon properties
Count = SapModel.PropTendon.Count

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# Delete

## Syntax

SapObject.SapModel.PropTendon.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of an existing tendon property.

## Remarks

The function deletes a specified tendon property.

The function returns zero if the property is successfully deleted; otherwise it returns a nonzero
value. It returns an error if the specified property can not be deleted, for example, if it is assigned
to an existing object.

## VBA Example

Sub DeleteTendonProp()
'dimension variables


Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim i As Long
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new tendon properties
ret = SapModel.PropTendon.SetProp("T1", Name, 1, 2.25)
ret = SapModel.PropTendon.SetProp("T2", Name, 1, 3.25)

'delete tendon property
ret = SapModel.PropTendon.Delete("T1")

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# GetNameList

## Syntax


SapObject.SapModel.PropTendon.GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of tendon property names retrieved by the program.

MyName

This is a one-dimensional array of tendon property names. The MyName array is created as a
dynamic, zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames - 1) inside the SAP2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined tendon properties in the model.

The function returns zero if the names are successfully retrieved; otherwise it returns nonzero.

## VBA Example

Sub GetTendonNames()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim NumberNames As Long
Dim MyName() As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model
ret = SapModel.InitializeNewModel


'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new tendon properties
ret = SapModel.PropTendon.SetProp("T1", Name, 1, 2.25)
ret = SapModel.PropTendon.SetProp("T2", Name, 1, 3.25)

'get tendon property names
ret = SapModel.PropTendon.GetNameList(NumberNames, MyName)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

# GetProp

## Syntax

SapObject.SapModel.PropTendon.GetProp

## VB6 Procedure

Function GetProp(ByVal Name As String, ByRef MatProp As String, ByRef ModelingOption As
Long, ByRef Area As Double, ByRef Color As Long, ByRef Notes As String, ByRef GUID As
String) As Long

## Parameters

Name

The name of an existing tendon property.

MatProp

The name of the material property assigned to the tendon property.

ModelingOption


This is either 1 or 2, indicating the tendon modeling option.

```
1 = Model tendon as loads
2 = Model tendon as elements
```
Area

The cross-sectional area of the tendon. [L^2 ]

Color

The display color assigned to the property.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property.

## Remarks

This function retrieves tendon property definition data.

The function returns zero if the property data is successfully retrieved; otherwise it returns a
nonzero value.

## VBA Example

Sub GetTendonProperty()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String
Dim MatProp As String
Dim ModelingOption As Long
Dim Area As Double
Dim Color As Long
Dim Notes As String
Dim GUID As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel

'initialize model


ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new tendon property
ret = SapModel.PropTendon.SetProp("T1", Name, 1, 2.25)

'get tendon property data
ret = SapModel.PropTendon.GetProp("T1", MatProp, ModelingOption, Area, Color, Notes,
GUID)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

SetProp

# SetProp

## Syntax

SapObject.SapModel.PropTendon.SetProp

## VB6 Procedure

Function SetProp(ByVal Name As String, ByVal MatProp As String, ByVal ModelingOption As
Long, ByVal Area As Double, Optional ByVal Color As Long = -1, Optional ByVal Notes As
String = "", Optional ByVal GUID As String = "") As Long

## Parameters

Name

The name of an existing or new tendon property. If this is an existing property, that property is
modified; otherwise, a new property is added.


MatProp

The name of the material property assigned to the tendon property.

ModelingOption

This is either 1 or 2, indicating the tendon modeling option.

```
1 = Model tendon as loads
2 = Model tendon as elements
```
Area

The cross-sectional area of the tendon. [L^2 ]

Color

The display color assigned to the property. If Color is specified as -1, the program will
automatically assign a color.

Notes

The notes, if any, assigned to the property.

GUID

The GUID (global unique identifier), if any, assigned to the property. If this item is input as
Default, the program assigns a GUID to the property.

## Remarks

This function defines a tendon property.

The function returns zero if the property is successfully defined; otherwise it returns a nonzero
value.

## VBA Example

Sub SetTendonProperty()
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim Name As String

'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")

'start Sap2000 application
SapObject.ApplicationStart

'create SapModel object
Set SapModel = SapObject.SapModel


'initialize model
ret = SapModel.InitializeNewModel

'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)

'add tendon material
ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_TENDON, , , , , ,
MATERIAL_TENDON_SUBTYPE_ASTM_A416Gr270)

'set new tendon property
ret = SapModel.PropTendon.SetProp("T1", Name, 1, 2.25)

'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
End Sub

## Release Notes

Initial release in version 11.02.

## See Also

GetProp

# AddQuad

## Syntax

SapObject.SapModel.SectCut.AddQuad

## VB6 Procedure

Function AddQuad(ByVal Name As String, ByRef X() As Double, ByRef Y() As Double, ByRef
Z() As Double) As Long

## Parameters

Name

The name of an existing section cut.

GroupName


### X

This is an array of four X coordinates, one for each of the four points defining the quadrilateral.

Y

This is an array of four Y coordinates, one for each of the four points defining the quadrilateral.

Z

This is an array of four Z coordinates, one for each of the four points defining the quadrilateral.

## Remarks

This function adds a new quadrilateral to a section cut defined by quadrilaterals.

The function returns zero if the quadrilateral is successfully, otherwise it returns a nonzero value.

## VBA Example

```
Sub AddSectionCutQuad()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim X(3) As Double
```
```
Dim Y(3) As Double
```
```
Dim Z(3) As Double
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```

'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
'define new group

```
ret = SapModel.GroupDef.SetGroup("Group1")
```
'add objects to group

```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("2", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("3", "Group1")
```
'define section cut

```
X(0) = -300
```
```
X(1) = -270
```
```
X(2) = -270
```
```
X(3) = -300
```
```
Y(0) = 10
```
```
Y(1) = 10
```
```
Y(2) = -10
```
```
Y(3) = -10
```
```
Z(0) = 10
```
```
Z(1) = 10
```
```
Z(2) = 10
```
```
Z(3) = 10
```
```
ret = SapModel.SectCut.SetByQuad("SCut1", "Group1", 1,
X, Y, Z)
```

```
'add a second quadrilateral
```
```
X(0) = 270
```
```
X(1) = 300
```
```
X(2) = 300
```
```
X(3) = 270
```
```
Y(0) = 10
```
```
Y(1) = 10
```
```
Y(2) = -10
```
```
Y(3) = -10
```
```
Z(0) = 10
```
```
Z(1) = 10
```
```
Z(2) = 10
```
```
Z(3) = 10
```
```
ret = SapModel.SectCut.AddQuad("SCut1", X, Y, Z)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

SetByQuad


# DeleteCut

## Syntax

SapObject.SapModel.SectCut.Delete

## VB6 Procedure

Function Delete(ByVal Name As String) As Long

## Parameters

Name

The name of the section cut to be deleted.

## Remarks

This function deletes an existing section cut.

The function returns zero if the section cut is successfully deleted, otherwise it returns a nonzero
value.

## VBA Example

```
Sub DeleteSectionCut()
```
```
'dimension variables
Dim SapObject as cOAPI
Dim SapModel As cSapModel
Dim ret As Long
Dim X(3) As Double
Dim Y(3) As Double
Dim Z(3) As Double
```
```
'create Sap2000 object
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
SapObject.ApplicationStart
```
```
'create SapModel object
Set SapModel = SapObject.SapModel
```
```
'initialize model
ret = SapModel.InitializeNewModel
```

```
'create model from template
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```
```
'define new group
ret = SapModel.GroupDef.SetGroup("Group1")
```
```
'add objects to group
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
ret = SapModel.FrameObj.SetGroupAssign("2", "Group1")
ret = SapModel.FrameObj.SetGroupAssign("3", "Group1")
```
```
'define section cut
X(0) = -300
X(1) = -270
X(2) = -270
X(3) = -300
Y(0) = 10
Y(1) = 10
Y(2) = -10
Y(3) = -10
Z(0) = 10
Z(1) = 10
Z(2) = 10
Z(3) = 10
ret = SapModel.SectCut.SetByQuad("SCut1", "Group1", 1, X, Y, Z)
```
```
'delete section cut
ret = SapModel.SectCut.Delete("SCut1")
```
```
'close Sap2000
SapObject.ApplicationExit False
Set SapModel = Nothing
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 23.4.0.

## See Also

SetByQuad

# GetCutInfo

## Syntax

SapObject.SapModel.SectCut.GetCutInfo


## VB6 Procedure

Function GetCutInfo(ByVal Name As String, ByRef GroupName As String, ByRef MyType As
Long , ByRef Num As Long) As Long

## Parameters

Name

The name of an existing section cut.

GroupName

The name of the group associated with the section cut.

MyType

This is either 1, 2, 3 or 4 indicating the result type of the section cut.

```
1 = Analysis
2 = Design Wall
3 = Design Spandrel
4 = Design Slab
```
Num

The number of quadrilateral cutting planes defined for the section cut. If this number is zero then
the section cut is defined by the associated group.

## Remarks

This function gets basic information about an existing section cut.

The function returns zero if the section cut information is successfully obtained, otherwise it
returns a nonzero value.

## VBA Example

Sub GetSectionCutInfo()

```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```

```
Dim GroupName As String
```
```
Dim MyType As Long
```
```
Dim Num As Long
```
'create Sap2000 object

```
Set SapObject = New Sap2000v16.SapObject
```
'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
'define new group

```
ret = SapModel.GroupDef.SetGroup("Group1")
```
'add objects to group

```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
'define section cut

```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1", 1)
```

```
'get basic section cut information
```
```
ret = SapModel.SectCut.GetCutInfo ("SCut1", GroupName,
MyType, Num)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

# GetLocalAxisAdvancedAnalysis

## Syntax

SapObject.SapModel.SectCut.GetLocalAxesAdvancedAnalysis

## VB6 Procedure

Function GetLocalAxesAdvancedAnalysis(ByVal Name As String, ByRef Active As Boolean,
ByRef AxVectOpt As Long, ByRef AxCSys As String, ByRef axdir() As Long, ByRef AxPt() As
String, ByRef AxVect() As Double, ByRef Plane2 As Long, ByRef PlVectOpt As Long, ByRef
PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double)
As Long

## Parameters

Name

The name of an existing section cut.

Active


This is True if advanced local axes exist.

AxVectOpt, PlVectOpt

This is 1, 2 or 3, indicating the axis/plane reference vector option. This item applies only when the
Active item is True.

```
1 = Coordinate direction
2 = Two joints
3 = User vector
```
AxCSys, PlCSys

The coordinate system used to define the axis/plane reference vector coordinate directions and the
axis/plane user vector. This item applies when the Active item is True and the
AxVectOpt/PlVectOpt item is 1 or 3.

AxDir, PlDir

This is an array dimensioned to 1 (2 integers), indicating the axis/plane reference vector primary
and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center
in the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1. Possible coordinate
direction values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
AxPt, PlPt

This is an array dimensioned to 1 (2 strings), indicating the labels of two joints that define the
axis/plane reference vector. Either of these joints may be specified as None to indicate the center
of the specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt
item is 2.

AxVect, PlVect

This is an array dimensioned to 2 (3 doubles) that defines the axis/plane reference vector. This
item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 3.

Plane2


This is 12, 13, 21, 23, 31 or 32, indicating that the local plane determined by the plane reference
vector is the 1-2, 1-3, 2-1, 2-3, 3-1, 0r 3-2 plane. This item applies only when the Active item is
True.

## Remarks

This function gets the advanced local axes data for an existing section cut whose result type is
Analysis.

The function returns zero if the data is successfully retrieved, otherwise it returns a nonzero value.

## VBA Example

```
Sub GetSectionCutLocalAxesAdvancedAnalysis()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim Active As Boolean
```
```
Dim AxVectOpt As Long
```
```
Dim AxCSys As String
```
```
Dim MyAxDir() As Long
```
```
Dim MyAxPt() As String
```
```
Dim MyAxVect() As Double
```
```
Dim Plane2 As Long
```
```
Dim PlVectOpt As Long
```
```
Dim PlCSys As String
```
```
Dim MyPlDir() As Long
```
```
Dim MyPlPt() As String
```
```
Dim MyPlVect() As Double
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```

'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
'define new group

```
ret = SapModel.GroupDef.SetGroup("Group1")
```
'add objects to group

```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
'define section cut

```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
1)
```
'set section cut advanced local axes data

```
Redim MyAxDir(1)
```
```
Redim MyAxPt(1)
```
```
Redim MyAxVect(2)
```
```
Redim MyPlDir(1)
```
```
Redim MyPlPt(1)
```

```
Redim MyPlVect(2)
```
```
MyAxVect(0)=0.707
```
```
MyAxVect(1)=0.707
```
```
MyAxVect(2)=0
```
```
MyPlDir(0) = 2
```
```
MyPlDir(1) = 3
```
```
ret = SapModel.SectCut.SetLocalAxesAdvancedAnalysis
("SCut1", True, 3, "Global", MyAxDir, MyAxPt,
MyAxVect, 12, 1, "Global", MyPlDir, MyPlPt, MyPlVect)
```
```
'get section cut advanced local axes data
```
```
ret = SapModel.SectCut.GetLocalAxesAdvancedAnalysis
("SCut1", Active, AxVectOpt, AxCSys, MyAxDir, MyAxPt,
MyAxVect, Plane2, PlVectOpt, PlCSys, MyPlDir, MyPlPt,
MyPlVect)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

GetLocalAxesAnalysis


# GetLocalAxesAnalysys

## Syntax

SapObject.SapModel.SectCut.GetLocalAxesAnalysis

## VB6 Procedure

Function GetLocalAxesAnalysis(ByVal Name As String, ByRef Z As Double, ByRef Y As
Double, ByRef X As Double, ByRef IsAdvanced As Boolean) As Long

## Parameters

Name

The name of an existing section cut.

Z

The Rotation about the Z axis.

Y

The rotation about the Y' axis where Y' is the orientation of the Y axis after rotation about the Z
axis.

X

The rotation about the X'' axis where X'' is the orientation of the X axis after rotation about the Z
axis and about the Y' axis.

IsAdvanced

Indicates if advanced local axes are specified.

## Remarks

This function gets the local axes angles for an existing section cut whose result type is Analysis.

The function returns zero if the angles are successfully retrieved, otherwise it returns a nonzero
value.

## VBA Example

```
Sub GetSectionCutLocalAxesAnalysis()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```

```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim Z As Double
```
```
Dim Y As Double
```
```
Dim X As Double
```
```
Dim IsAdvanced As Boolean
```
'create Sap2000 object

```
Set SapObject = New Sap2000v16.SapObject
```
'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
'define new group

```
ret = SapModel.GroupDef.SetGroup("Group1")
```
'add objects to group

```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```

```
'define section cut
```
```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
1)
```
```
'set section cut local axes angles
```
```
ret = SapModel.SectCut.SetLocalAxesAnalysis ("SCut1",
10, 20, 30)
```
```
'get section cut local axes data
```
```
ret = SapModel.SectCut.GetLocalAxesAnalysis
("SCut1",Z, Y, X, IsAdvanced)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

GetLocalAxesAdvancedAnalysis

# GetLocalAxesAngleDesign

## Syntax

SapObject.SapModel.SectCut.GetLocalAxesAngleDesign

## VB6 Procedure


Function GetLocalAxesAngleDesign(ByVal Name As String, ByRef Angle As Double) As Long

## Parameters

Name

The name of an existing section cut.

Angle

For design local axes orientation type wall this is the angle from the global X to the local 2
axis. For orientation types spandrel and slab it is the angle from the global X to the local 1 axis.

## Remarks

This function gets the local axes angle for section cuts whose result type is Design (Wall, Spandrel
or Slab).

The function returns zero if the angle is successfully retrieved, otherwise it returns a nonzero
value.

## VBA Example

```
Sub GetSectionCutLocalAxesAngleDesign ()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim Angle As Double
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```

'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
'define new group

```
ret = SapModel.GroupDef.SetGroup("Group1")
```
'add objects to group

```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
'define section cut with result type of Design - Wall

```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
2)
```
'set section cut local axes angle

```
ret = SapModel.SectCut.SetLocalAxesAngleDesign
("SCut1", 24)
```
'get section cut local axes angle

```
ret = SapModel.SectCut.GetLocalAxesAngleDesign
("SCut1", Angle)
```
'close Sap2000

```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```

```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

# GetNameList

## Syntax

SapObject.SapModel.SectCut. GetNameList

## VB6 Procedure

Function GetNameList(ByRef NumberNames As Long, ByRef MyName() As String) As Long

## Parameters

NumberNames

The number of section cut names retrieved by the program.

MyName

This is a one-dimensional array of section cut names. The MyName array is created as a dynamic,
zero-based, array by the API user:

```
Dim MyName() as String
```
The array is dimensioned to (NumberNames – 1) inside the Sap2000 program, filled with the
names, and returned to the API user.

## Remarks

This function retrieves the names of all defined section cuts.

The function returns zero if the names are successfully retrieved, otherwise it returns nonzero.

## VBA Example

```
Sub GetSectionCutNames()
```

'dimension variables

```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim NumberNames As Long
```
```
Dim MyName() As String
```
'create Sap2000 object

```
Set SapObject = New Sap2000v16.SapObject
```
'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
'define new group

```
ret = SapModel.GroupDef.SetGroup("Group1")
```
'add objects to group

```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```

```
'define section cut
```
```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
1)
```
```
'get section cut names
```
```
ret = SapModel.SectCut.GetNameList(NumberNames,
MyName)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

# GetQuad

## Syntax

SapObject.SapModel.SectCut.GetQuad

## VB6 Procedure

Function AddQuad(ByVal Name As String, ByVal Num As Long, ByRef X() As Double, ByRef
Y() As Double, ByRef Z() As Double) As Long

## Parameters

Name

The name of an existing section cut defined using quadrilateral cutting planes.


Num

The number of a quadirilateral cutting plane in the section cut.

GroupName

X

This is an array of four X coordinates, one for each of the four points defining the quadrilateral.

Y

This is an array of four Y coordinates, one for each of the four points defining the quadrilateral.

Z

This is an array of four Z coordinates, one for each of the four points defining the quadrilateral.

## Remarks

This function returns the coordinates of a quadrilateral cutting plane in a section cut defined by
quadrilaterals.

The function returns zero if the coordinates are successfully returned, otherwise it returns a
nonzero value.

## VBA Example

```
Sub GetSectionCutQuad()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim X() As Double
```
```
Dim Y() As Double
```
```
Dim Z() As Double
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
```

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
'define new group

```
ret = SapModel.GroupDef.SetGroup("Group1")
```
'add objects to group

```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("2", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("3", "Group1")
```
'define section cut

```
Redim X(3)
```
```
Redim Y(3)
```
```
Redim Z(3)
```
```
X(0) = -300
```
```
X(1) = -270
```
```
X(2) = -270
```
```
X(3) = -300
```
```
Y(0) = 10
```

### Y(1) = 10

### Y(2) = -10

### Y(3) = -10

### Z(0) = 10

### Z(1) = 10

### Z(2) = 10

### Z(3) = 10

```
ret = SapModel.SectCut.SetByQuad("SCut1", "Group1", 1,
X, Y, Z)
```
'add a second quadrilateral

```
X(0) = 270
```
```
X(1) = 300
```
```
X(2) = 300
```
```
X(3) = 270
```
```
Y(0) = 10
```
```
Y(1) = 10
```
```
Y(2) = -10
```
```
Y(3) = -10
```
```
Z(0) = 10
```
```
Z(1) = 10
```
```
Z(2) = 10
```
```
Z(3) = 10
```
```
ret = SapModel.SectCut.AddQuad("SCut1", X, Y, Z)
```
'get coordinates of quadrilateral 2

```
ret = SapModel.SectCut.GetQuad("SCut1", 2, X, Y, Z)
```
'close Sap2000


```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

# GetResultLocation

## Syntax

SapObject.SapModel.SectCut.GetResultLocation

## VB6 Procedure

Function GetResultLocation(ByVal Name As String, ByRef IsDefault As Boolean, ByRef X As
Double, ByRef Y As Double, ByRef Z As Double) As Long

## Parameters

Name

The name of an existing section cut.

IsDefault

Indicates if the section cut results are reported at the default location. If so, the X, Y and Z items
are ignored.

X

The X coordinate of the section cut result location when it is not default

Y

The Y coordinate of the section cut result location when it is not default

Z

The Z coordinate of the section cut result location when it is not default


## Remarks

This function gets the results location for an existing section cut.

The function returns zero if the result location is successfully retrieved, otherwise it returns a
nonzero value.

## VBA Example

```
Sub GetSectionCutResultsLocation()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim IsDefault As Boolean
```
```
Dim X As Double
```
```
Dim Y As Double
```
```
Dim Z As Double
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
```
'define new group
```
```
ret = SapModel.GroupDef.SetGroup("Group1")
```
```
'add objects to group
```
```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
```
'define section cut
```
```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
1)
```
```
'set section cut result location
```
```
ret = SapModel.SectCut.SetResultLocation("SCut1",
False, -288, 0, 10)
```
```
'get section cut result location
```
```
ret = SapModel.SectCut.GetResultLocation("SCut1",
IsDefault, X, Y, Z)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.


## See Also

# GetResultsSide

## Syntax

SapObject.SapModel.SectCut.GetResultsSide

## VB6 Procedure

Function GetResultsSide(ByVal Name As String, ByRef Side As Long) As Long

## Parameters

Name

The name of an existing section cut.

Side

This item is either 1 or 2 and indicates the side of the elements from which section cut results are
obtained.

For section cuts defined from quadrilaterals with an Analysis result type:

```
1 = Positive 3-axis side of quadrilateral
2 = Negative 3-axis side of quadrilateral
```
For section cuts with a Design Wall result type:

```
1 = Top
2 = Bottom
```
For section cuts with a Design Spandrel or Design Slab result type:

```
1 = Right
2 = Left
```
## Remarks

This function gets the side of the elements from which results are obtained.

The function returns zero if the side is successfully retrieved, otherwise it returns a nonzero value.


## VBA Example

```
Sub GetSectionCutResultsSide()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim Side As Long
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
```
'define new group
```
```
ret = SapModel.GroupDef.SetGroup("Group1")
```
```
'add objects to group
```
```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```

```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
```
'define section cut with result type of Design - Wall
```
```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
2)
```
```
'set section cut results side
```
```
ret = SapModel.SectCut.SetResultsSide ("SCut1", 2)
```
```
'get section cut results side
```
```
ret = SapModel.SectCut.GetResultsSide ("SCut1", Side)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

# SetByGroup

## Syntax

SapObject.SapModel.SectCut.SetByGroup

## VB6 Procedure

Function SetByGroup(ByVal Name As String, ByVal GroupName As String, ByVal MyType As
Long) As Long


## Parameters

Name

The section cut name. If a section cut with this name already exists then the section cut is
reinitialized with the new data. All previous data assigned to the section cut is lost. If a section cut
with this name does not exist then a new section cut is added.

GroupName

The name of the group on which the section cut is based.

MyType

This is either 1, 2, 3 or 4 indicating the result type of the section cut.

```
1 = Analysis
2 = Design Wall
3 = Design Spandrel
4 = Design Slab
```
## Remarks

This function adds a new section cut defined by a group to the model or reinitializes an existing
section cut to be defined by a group.

The function returns zero if the section cut is successfully added or initialized, otherwise it returns
a nonzero value.

## VBA Example

```
Sub SetSectionCutByGroup()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```

```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
```
'define new group
```
```
ret = SapModel.GroupDef.SetGroup("Group1")
```
```
'add objects to group
```
```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
```
'define section cut
```
```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
1)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes


Initial release in version 16.0.0.

## See Also

SetByQuad

# SetByQuad

## Syntax

SapObject.SapModel.SectCut.SetByQuad

## VB6 Procedure

Function SetByQuad(ByVal Name As String, ByVal GroupName As String, ByVal MyType As
Long, ByRef X() As Double, ByRef Y() As Double, ByRef Z() As Double) As Long

## Parameters

Name

The section cut name. If a section cut with this name already exists then the section cut is
reinitialized with the new data. All previous data assigned to the section cut is lost. If a section cut
with this name does not exist then a new section cut is added.

GroupName

The name of the group associated with the section cut.

MyType

This is either 1, 2, 3 or 4 indicating the result type of the section cut.

```
1 = Analysis
2 = Design Wall
3 = Design Spandrel
4 = Design Slab
```
X

This is an array of four X coordinates, one for each of the four points defining the quadrilateral.

Y

This is an array of four Y coordinates, one for each of the four points defining the quadrilateral.

Z

This is an array of four Z coordinates, one for each of the four points defining the quadrilateral.


## Remarks

This function adds a new section cut defined by a quadrilateral to the model or reinitializes an
existing section cut to be defined by a quadrilateral.

The function returns zero if the section cut is successfully added or initialized, otherwise it returns
a nonzero value.

## VBA Example

```
Sub SetSectionCutByQuad()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim X(3) As Double
```
```
Dim Y(3) As Double
```
```
Dim Z(3) As Double
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
'define new group

```
ret = SapModel.GroupDef.SetGroup("Group1")
```
'add objects to group

```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("2", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("3", "Group1")
```
'define section cut

```
X(0) = -300
```
```
X(1) = 300
```
```
X(2) = 300
```
```
X(3) = -300
```
```
Y(0) = 10
```
```
Y(1) = 10
```
```
Y(2) = -10
```
```
Y(3) = -10
```
```
Z(0) = 10
```
```
Z(1) = 10
```
```
Z(2) = 10
```
```
Z(3) = 10
```
```
ret = SapModel.SectCut.SetByQuad("SCut1", "Group1", 1,
X, Y, Z)
```
'close Sap2000

```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```

```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

SetByGroup

AddQuad

DeleteCut

# SetLocalAxisAdvancedAnalysis

## Syntax

SapObject.SapModel.SectCut.SetLocalAxesAdvancedAnalysis

## VB6 Procedure

Function SetLocalAxesAdvancedAnalysis(ByVal Name As String, ByVal Active As Boolean,
ByVal AxVectOpt As Long, ByVal AxCSys As String, ByRef axdir() As Long, ByRef AxPt() As
String, ByRef AxVect() As Double, ByVal Plane2 As Long, ByVal PlVectOpt As Long, ByVal
PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double)
As Long

## Parameters

Name

The name of an existing section cut.

Active

This is True if advanced local axes exist.

AxVectOpt, PlVectOpt

This is 1, 2 or 3, indicating the axis/plane reference vector option. This item applies only when the
Active item is True.

```
1 = Coordinate direction
2 = Two joints
3 = User vector
```

AxCSys, PlCSys

The coordinate system used to define the axis/plane reference vector coordinate directions and the
axis/plane user vector. This item applies when the Active item is True and the
AxVectOpt/PlVectOpt item is 1 or 3.

AxDir, PlDir

This is an array dimensioned to 1 (2 integers), indicating the axis/plane reference vector primary
and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center
in the specified coordinate system and used to determine the plane reference vector. This item
applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1. Possible coordinate
direction values are:

```
1 = +X -1 = -X
2 = +Y -2 = -Y
3 = +Z -3 = -Z
4 = +CR -4 = -CR
5 = +CA -5 = -CA
6 = +CZ -6 = -CZ
7 = +SR -7 = -SR
8 = +SA -8 = -SA
9 = +SB -9 = -SB
```
AxPt, PlPt

This is an array dimensioned to 1 (2 strings), indicating the labels of two joints that define the
axis/plane reference vector. Either of these joints may be specified as None to indicate the center
of the specified object. If both joints are specified as None, they are not used to define the plane
reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt
item is 2.

AxVect, PlVect

This is an array dimensioned to 2 (3 doubles) that defines the axis/plane reference vector. This
item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 3.

Plane2

This is 12, 13, 21, 23, 31 or 32, indicating that the local plane determined by the plane reference
vector is the 1-2, 1-3, 2-1, 2-3, 3-1, 0r 3-2 plane. This item applies only when the Active item is
True.

## Remarks

```
This function sets the advanced local axes data for an existing section cut whose result
type is Analysis.
```
```
The function returns zero if the data is successfully set, otherwise it returns a nonzero
value.
```

## VBA Example

```
Sub SetSectionCutLocalAxesAdvancedAnalysis()
```
'dimension variables

```
Dim SapObject as cOAPI
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
Dim MyAxDir(1) As Long
```
```
Dim MyAxPt(1) As String
```
```
Dim MyAxVect(2) As Double
```
```
Dim MyPlDir(1) As Long
```
```
Dim MyPlPt(1) As String
```
```
Dim MyPlVect(2) As Double
```
```
'create Sap2000 object
```
```
Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)
```

```
'define new group
```
```
ret = SapModel.GroupDef.SetGroup("Group1")
```
```
'add objects to group
```
```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
```
'define section cut
```
```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1", 1)
```
```
'set section cut advanced local axes data
```
```
MyAxVect(0)=0.707
```
```
MyAxVect(1)=0.707
```
```
MyAxVect(2)=0
```
```
MyPlDir(0) = 2
```
```
MyPlDir(1) = 3
```
```
ret = SapModel.SectCut.SetLocalAxesAdvancedAnalysis("SCut1", True, 3,
"Global", MyAxDir, MyAxPt, MyAxVect, 12, 1, "Global", MyPlDir, MyPlPt,
MyPlVect)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.


## See Also

SetLocalAxesAnalysis

# SetLocalAxesAnalysis

## Syntax

SapObject.SapModel.SectCut.SetLocalAxesAnalysis

## VB6 Procedure

Function SetLocalAxesAnalysis(ByVal Name As String, ByVal Z As Double, ByVal Y As
Double, ByVal X As Double) As Long

## Parameters

Name

The name of an existing section cut.

Z

The Rotation about the Z axis.

Y

The rotation about the Y' axis where Y' is the orientation of the Y axis after rotation about the Z
axis.

X

The rotation about the X'' axis where X'' is the orientation of the X axis after rotation about the Z
axis and about the Y' axis.

## Remarks

This function sets the local axes angles for an existing section cut whose result type is Analysis.

The function returns zero if the angles are successfully set, otherwise it returns a nonzero value.

## VBA Example

```
Sub SetSectionCutLocalAxesAnalysis()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```

```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
'create Sap2000 object

```
Set SapObject = New Sap2000v16.SapObject
```
'start Sap2000 application

```
SapObject.ApplicationStart
```
'create SapModel object

```
Set SapModel = SapObject.SapModel
```
'initialize model

```
ret = SapModel.InitializeNewModel
```
'create model from template

```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
'define new group

```
ret = SapModel.GroupDef.SetGroup("Group1")
```
'add objects to group

```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
'define section cut

```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
1)
```

```
'set section cut local axes angles
```
```
ret = SapModel.SectCut.SetLocalAxesAnalysis ("SCut1",
10, 20, 30)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

SetLocalAxesAdvancedAnalysis

# SetLocalAxisAngleDesign

## Syntax

SapObject.SapModel.SectCut.SetLocalAxesAngleDesign

## VB6 Procedure

Function SetLocalAxesAngleDesign(ByVal Name As String, ByVal Angle As Double) As Long

## Parameters

Name

The name of an existing section cut.

Angle

For design local axes orientation type wall this is the angle from the global X to the local 2
axis. For orientation types spandrel and slab it is the angle from the global X to the local 1 axis.


## Remarks

This function sets the local axes angle for section cuts whose result type is Design (Wall, Spandrel
or Slab).

The function returns zero if the angle is successfully set, otherwise it returns a nonzero value.

## VBA Example

```
Sub SetSectionCutLocalAxesAngleDesign ()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
```
'define new group
```
```
ret = SapModel.GroupDef.SetGroup("Group1")
```

```
'add objects to group
```
```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
```
'define section cut with result type of Design - Wall
```
```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
2)
```
```
'set section cut local axes angle
```
```
ret = SapModel.SectCut.SetLocalAxesAngleDesign
("SCut1", 24)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

# SetResultLocation

## Syntax

SapObject.SapModel.SectCut.SetResultLocation

## VB6 Procedure


Function SetResultLocation(ByVal Name As String, ByVal IsDefault As Boolean, Optional
ByVal X As Double = 0, Optional ByVal Y As Double = 0, Optional ByVal Z As Double = 0) As
Long

## Parameters

Name

The name of an existing section cut.

IsDefault

Indicates if the section cut results are reported at the default location. If so, the X, Y and Z items
are ignored.

X

The X coordinate of the section cut result location when it is not default

Y

The Y coordinate of the section cut result location when it is not default

Z

The Z coordinate of the section cut result location when it is not default

## Remarks

This function sets the results location for an existing section cut.

The function returns zero if the result location is successfully set, otherwise it returns a nonzero
value.

## VBA Example

```
Sub SetSectionCutResultsLocation()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```

```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
```
'define new group
```
```
ret = SapModel.GroupDef.SetGroup("Group1")
```
```
'add objects to group
```
```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
'define section cut

```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
1)
```
```
'set section cut result location
```
```
ret = SapModel.SectCut.SetResultLocation("SCut1",
False, -288, 0, 10)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```

```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also

# SetResultsSide

## Syntax

SapObject.SapModel.SectCut.SetResultsSide

## VB6 Procedure

Function SetResultsSide(ByVal Name As String, ByVal Side As Long) As Long

## Parameters

Name

The name of an existing section cut.

Side

This item is either 1 or 2 and indicates the side of the elements from which section cut results are
obtained.

For section cuts defined from quadrilaterals with an Analysis result type:

```
1 = Positive 3-axis side of quadrilateral
2 = Negative 3-axis side of quadrilateral
```
For section cuts with a Design Wall result type:

```
1 = Top
2 = Bottom
```
For section cuts with a Design Spandrel or Design Slab result type:


```
1 = Right
2 = Left
```
## Remarks

This function sets the side of the elements from which results are obtained.

The function returns zero if the side is successfully set, otherwise it returns a nonzero value.

## VBA Example

```
Sub SetSectionCutResultsSide()
```
```
'dimension variables
```
```
Dim SapObject As Sap2000v16.SapObject
```
```
Dim SapModel As cSapModel
```
```
Dim ret As Long
```
```
'create Sap2000 object
```
```
Set SapObject = New Sap2000v16.SapObject
```
```
'start Sap2000 application
```
```
SapObject.ApplicationStart
```
```
'create SapModel object
```
```
Set SapModel = SapObject.SapModel
```
```
'initialize model
```
```
ret = SapModel.InitializeNewModel
```
```
'create model from template
```
```
ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2,
288)
```
```
'define new group
```

```
ret = SapModel.GroupDef.SetGroup("Group1")
```
```
'add objects to group
```
```
ret = SapModel.PointObj.SetGroupAssign("1", "Group1")
```
```
ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")
```
```
'define section cut with result type of Design - Wall
```
```
ret = SapModel.SectCut.SetByGroup("SCut1", "Group1",
2)
```
```
'set section cut results side
```
```
ret = SapModel.SectCut.SetResultsSide ("SCut1", 2)
```
```
'close Sap2000
```
```
SapObject.ApplicationExit False
```
```
Set SapModel = Nothing
```
```
Set SapObject = Nothing
```
```
End Sub
```
## Release Notes

Initial release in version 16.0.0.

## See Also


